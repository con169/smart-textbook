
---PAGE BREAK---
This page intentionally left blank
---PAGE BREAK---
A course in combinatorics
Thisisthesecondeditionofapopularbookoncombinatorics,asubject
dealingwithwaysofarranginganddistributingobjects,andwhichinvolvesideasfromgeometry,algebraandanalysis. Thebreadthofthetheoryismatchedbythatofitsapplications,whichincludetopicsasdiverseascodes,circuitdesignandalgorithmcomplexity. Ithasthusbecomeessentialforworkersinmanyscientiﬁcﬁeldstohavesomefamiliaritywiththesubject.Theauthorshavetriedtobeascomprehensiveaspossible,dealinginauni-ﬁedmannerwith,forexample,graphtheory,extremalproblems,designs,coloringsandcodes. Thedepthandbreadthofthecoveragemakethebookauniqueguidetothewholeofthesubject. Thebookisidealforcoursesoncombinatorialmathematicsattheadvancedundergraduateorbeginninggraduatelevel. Workingmathematiciansandscien tistswillalsoﬁndita
valuableintroductionandreference.
J.H. VAN LINT isEmeritusProfessorofMathematicsattheTechnicalUni-
versityofEinhoven.
R.M. WILSONisProfessorofMathematicsattheCaliforniaInstituteof
Technology.
---PAGE BREAK---

---PAGE BREAK---
A Course in
Combinatorics
SECONDEDITION
J. H. van Lint
Technical University of Eindhoven
and
R. M. Wilson
California Institute of Technology
---PAGE BREAK---
CAMBRIDGE UNIVERSITY PRESS
Cambridge, New York, Melbourne, Madrid, Cape Town, Singapore,
São Paulo, Delhi, Dubai, Tokyo
Cambridge University Press
The Edinburgh Building, Cambridge CB2 8RU, UK
First published in print format
ISBN-13    978-0-521-80340-3
ISBN-13    978-0-521-00601-9ISBN-13    978-0-511-67289-7© Cambridge University Press 1992, 2001
2001Information on this title: www.cambrid ge.org/9780521803403
This publication is in copyright. Subject to statutory exception and to the provision of relevant collective licensing agreements, no reproduction of any partmay take place without the written permission of Cambridge University Press.
Cambridge University Press has no responsibility for the persistence or accuracy of urls for external or third-party internet websites referred to in this publication, and does not guarantee that any content on such websites is, or will remain, accurate or appropriate.Published in the United States of America by Cambridge University Press, New York
www.cambridge.org
PaperbackeBook (EBL )
Hardback
---PAGE BREAK---
CONTENTS
Preface to the ﬁrst edition xi
Preface to the second edition xiii
1. Graphs 1
Terminology of graphs and digraphs, Eulerian cir-
cuits, Hamiltonian circuits
2. Trees 12
Cayley’s theorem, spanning trees and the greedy
algorithm, search trees, strong connectivity
3. Colorings of graphs and Ramsey’s theorem 24
Brooks’ theorem, Ramsey’s theorem and Ramsey
numbers, the L´ ovasz sieve, the Erd˝ os–Szekeres
theorem
4. Tur´ an’s theorem and extremal graphs 37
Tur´ an’s theorem and extremal graph theory
5. Systems of distinct representatives 43
Bipartite graphs, P. Hall’s condition, SDRs, K¨ onig’s
theorem, Birkhoﬀ’s theorem
6. Dilworth’s theorem and extremal set theory 53
Partially ordered sets, Dilworth’s theorem, Sperner’s
theorem, symmetric chains, the Erd˝ os–Ko–Radotheorem
7. Flows in networks 61
The Ford–Fulkerson theorem, the integrality theorem,
a generalization of Birkhoﬀ’s theorem, circulations
8. De Bruijn sequences 71
The number of De Bruijn sequences
---PAGE BREAK---
vi A Course in Combinatorics
9. Two(0,1,⋆)problems: 77
addressing for graphs and
a hash-coding scheme
Quadratic forms, Winkler’s theorem, associative
block designs
10. The principle of inclusion and exclusion; 89
inversion formulae
Inclusion–exclusion, derangements, Euler indica-
tor, M¨ obius function, M¨ obius inversion, Burnside’s
lemma, probl` eme des m´ enages
11. Permanents 98
Bounds on permanents, Schrijver’s proof of the Minc
conjecture, Fekete’s lemma, permanents of doubly
stochastic matrices
12. The Van der Waerden conjecture 110
The early results of Marcus and Newman, London’s
theorem, Egoritsjev’s proof
13. Elementary counting; Stirling numbers 119
Stirling numbers of the ﬁrst and second kind, Bell
numbers, generating functions
14. Recursions and generating functions 129
Elementary recurrences, Catalan numbers, counting
of trees, Joyal theory, Lagrange inversion
15. Partitions 152
The function pk(n), the partition function, Ferrers
diagrams, Euler’s identity, asymptotics, the Jacobitriple product identity, Young tableaux and the hookformula
16.(0,1)-Matrices 169
Matrices with given line sums, counting (0,1)-
matrices
17. Latin squares 182
Orthogonal arrays, conjugates and isomorphism,
partial and incomplete Latin squares, counting Latinsquares, the Evans conjecture, the Dinitz conjecture
18. Hadamard matrices, Reed–Muller codes 199
Hadamard matrices and conference matrices, re-
cursive constructions, Paley matrices, Williamson’smethod, excess of a Hadamard matrix, ﬁrst orderReed–Muller codes
---PAGE BREAK---
Contents vii
19. Designs 215
The Erd˝ os–De Bruijn theorem, Steiner systems,
balanced incomplete block designs, Hadamard designs,
counting, (higher) incidence matrices, the Wilson–Petrenjuk theorem, symmetric designs, projective
planes, derived and residual designs, the Bruck–Ryser–Chowla theorem, constructions of Steiner triplesystems, write-once memories
20. Codes and designs 244
Terminology of coding theory, the Hamming bound,
the Singleton bound, weight enumerators andMacWilliams’ theorem, the Assmus–Mattson theorem,symmetry codes, the Golay codes, codes from projec-tive planes
21. Strongly regular graphs and partial geometries 261
The Bose–Mesner algebra, eigenvalues, the integrality
condition, quasisymmetric designs, the Krein condi-tion, the absolute bound, uniqueness theorems, partialgeometries, examples, directed strongly regular graphs,neighborhood regular graphs
22. Orthogonal Latin squares 283
Pairwise orthogonal Latin squares and nets, Euler’s
conjecture, the Bose–Parker–Shrikhande theorem,asymptotic existence, orthogonal arrays and transver-sal designs, diﬀerence methods, orthogonal subsquares
23. Projective and combinatorial geometries 303
Projective and aﬃne geometries, duality, Pasch’s
axiom, Desargues’ theorem, combinatorial geometries,geometric lattices, Greene’s theorem
24. Gaussian numbers and q-analogues 325
Chains in the lattice of subspaces, q-analogue of
Sperner’s theorem, interpretation of the coeﬃcients ofthe Gaussian polynomials, spreads
25. Lattices and M¨ obius inversion 333
The incidence algebra of a poset, the M¨ obius func-
tion, chromatic polynomial of a graph, Weisner’stheorem, complementing permutations of geometriclattices, connected labeled graphs, MDS codes
26. Combinatorial designs and projective geometries 351
Arcs and subplanes in projective planes, blocking
sets, quadratic and Hermitian forms, unitals, general-ized quadrangles, M¨ obius planes
---PAGE BREAK---
viii A Course in Combinatorics
27. Diﬀerence sets and automorphisms 369
Block’s lemma, automorphisms of symmetric de-
signs, Paley–Todd and Stanton–Sprott diﬀerence sets,
Singer’s theorem
28. Diﬀerence sets and the group ring 383
The Multiplier Theorem and extensions, homomor-
phisms and further necessary conditions
29. Codes and symmetric designs 396
The sequence of codes of a symmetric design,
Wilbrink’s theorem
30. Association schemes 405
Examples, the eigenmatrices and orthogonality re-
lations, formal duality, the distribution vector of asubset, Delsarte’s inequalities, polynomial schemes,perfect codes and tight designs
31. (More) algebraic techniques in graphth eory 432
Tournaments and the Graham–Pollak theorem, the
spectrum of a graph, Hoﬀman’s theorem, Shannoncapacity, applications of interlacing and Perron–Frobenius
32. Graphconnectivity 451
Vertex connectivity, Menger’s theorem, Tutte connec-
tivity
33. Planarity and coloring 459
The chromatic polynomial, Kuratowski’s theorem,
Euler’s formula, the Five Color Theorem, list-colorings
34. Whitney Duality 472
Whitney duality, circuits and cutsets, MacLane’s
theorem
35. Embeddings of graphs on surfaces 491
Embeddings on arbitrary surfaces, the Ringel–Youngs
theorem, the Heawood conjecture, the Edmonds embed-ding technique
36. Electrical networks and squared squares 507
The matrix-tree theorem, De Bruijn sequences, the
network of a squared rectangle, Kirchhoﬀ’s theorem
37. P´ olya theory of counting 522
The cycle index of a permutation group, counting
orbits, weights, necklaces, the symmetric group, Stir-ling numbers
---PAGE BREAK---
Contents ix
38. Baranyai’s theorem 536
One-factorizations of complete graphs and complete
designs
Appendix 1. Hints and comments on problems 542
Hints, suggestions, and comments on the problems in
each chapter
Appendix 2. Formal power series 578
Formal power series ring, formal derivatives, inverse
functions, residues, the Lagrange–B¨ urmann formula
Name Index 584
Subject Index 590
---PAGE BREAK---

---PAGE BREAK---
Preface to the ﬁrst edition
Oneofthemostpopularupperlevelmathematicscoursestaught
atCaltechforverymanyyearswasH.J.Ryser’scourse Combina-
torial Analysis,Math121.OneofRyser’smaingoalswastoshow
eleganceandsimplicity.Furthermore,inthiscoursethathetaughtsowell,hesoughttodemonstratecoherenceofthesubjectofcom-binatorics. WededicatethisbooktothememoryofHerbRyser,ourfriendwhomweadmiredandfromwhomwelearnedmuch.
Workonthepresentbookwasstartedduringtheacademicyear
1988–89whenthetwoauthorstaughtthecourseMath121together.OuraimwasnotonlytocontinueinthestyleofRyserbyshowingmanylinksbetweenareasofcombinatoricsthatseemunrelated,butalsototrytomore-or-lesssurveythesubject.Wehadinmindthatafteracourselikethis,studentswhosubsequentlyattendaconferenceon“Combinatorics”wouldhearnotalkswheretheyarecompletelylostbecauseofunfamiliaritywiththetopic. Well,atleasttheyshouldhaveheardmanyofthewordsbefore.Westronglybelievethatastudentstudyingcombinatoricsshouldseeasmanyofitsbranchesaspossible.
Ofcourse,noneofthechapterscouldpossiblygiveacomplete
treatmentofthesubjectindicatedintheirtitles.Instead,wecoversomehighlights—butweinsistondoingsomethingsubstantialornontrivialwitheachtopic. Itisouropinionthatagoodwaytolearncombinatoricsistoseesubjectsrepeatedatintervals. Forthisreason,severalareasarecoveredinmorethanonepartofthebook.Forexample,partiallyorderedsetsandcodesappearseveraltimes.Enumerationproblemsandgraphtheoryoccurthroughout
---PAGE BREAK---
xii ACourseinCombinatorics
thebook.Afewtopicsaretreatedinmoredetail(becausewelike
them)andsomematerial,likeourproofoftheVanderWaerdenpermanentconjecture, appearshereinatextbookfortheﬁrsttime.
Acourseinmodernalgebraissuﬃcientbackgroundforthisbook,
butisnotabsolutelynecessary; agreatdealcanbeunderstoodwithonlyacertainlevelofmaturity.Indeed,combinatoricsiswellknownforbeing“accessible”. Butreadersshouldﬁndthisbookchallengingandwillbeexpectedtoﬁllindetails(thatwehopeareinstructiveandnottoodiﬃcult). Wementioninpassingthatwebelievethereisnosubstituteforahumanteacherwhentryingtolearnasubject. Anacquaintancewithcalculus,groups,ﬁniteﬁelds,elementarynumbertheory,andespeciallylinearalgebrawillbenecessaryforsometopics. BothundergraduatesandgraduatestudentstakethecourseatCaltech.Thematerialineverychapterhasbeenpresentedinclass,butwehavenevermanagedtodoallthechaptersinoneyear.
Thenotesattheendofchaptersoftenincludebiographicalre-
marksonmathematicians. Wehavechosentorefrainfromanymentionoflivingmathematiciansunlesstheyhaveretired(withtheexceptionofP.Erd˝os).
Exercisesvaryindiﬃculty. Forsomeitmaybenecessaryto
consultthehintsinAppendix1. WeincludeashortdiscussionofformalpowerseriesinAppendix2.
Thismanuscriptwastypesetbytheauthorsin AMS-TEX.
J.H.v.L.,R.M.W.
EindhovenandPasadena,1992
---PAGE BREAK---
Preface to the 2nd edition
Thefavorablereceptionofourbookanditsuseforavarietyof
coursesoncombinatorialmathematicsatnumerouscollegesanduniversitieshasencouragedustopreparethissecondedition. Wehaveaddednewmaterialandhaveupdatedreferencesforthisver-sion. Anumberoftypographicalandothererrorshavebeencor-rected. Wehadtochange“thiscentury”to“thelastcentury”inseveralplaces.
Thenewmaterialhas,forthemostpart,beeninsertedintothe
chapterswiththesametitlesasintheﬁrstedition. Anexceptionisthatthematerialofthelaterchaptersongraphtheoryhasbeenreorganizedintofourchaptersratherthantwo.Theaddedmaterialincludes,forexample,discussionoftheLov´aszsieve,associativeblockdesigns,andlistcoloringsofgraphs.
Manynewproblemshavebeenadded,andwehopethatthislast
change,inparticular,willincreasethevalueofthebookasatext.Wehavedecidednottoattempttoindicateinthebookthelevelofdiﬃcultyofthevariousproblems,butremarkagainthatthiscanvarygreatly.Thediﬃcultywilloftendependontheexperienceandbackgroundofthereader,andaninstructorwillneedtodecidewhichexercisesareappropriateforhisorherstudents.Weliketheideaofstatingproblemsatthepointinthetextwheretheyaremostrelevant,buthavealsoaddedsomeproblemsattheendofthechapters. Itisnottruethattheproblemsappearinglaterarenecessarilymorediﬃcultthanthoseatthebeginningofachapter.AnumberofthehintsandcommentsinAppendix1havebeenimproved.
---PAGE BREAK---
xiv ACourseinCombinatorics
Preparationofthesecondeditionwasdoneduringasix-month
visittotheCaliforniaInstituteofTechnologybytheﬁrstauthor
asMooreDistinguishedScholar. HegratefullyacknowledgesthesupportoftheMooreFoundation.
---PAGE BREAK---
1
Graphs
AgraphGconsists of a set V(orV(G)) of vertices , a setE(or
E(G)) ofedges, and a mapping associating to each edge e∈E(G)
an unordered pair x,yof vertices called the endpoints (or simply
theends)o fe. We say an edge is incident with its ends, and that
itjoins its ends. We allow x=y, in which case the edge is called
aloop. A vertex is isolated when it is incident with no edges.
It is common to represent a graph by a drawing where we repre-
sent each vertex by a point in the plane, and represent edges by line
segments or arcs joining some of the pairs of points. One can thinke.g. of a network of roads between cities. A graph is called planar
if it can be drawn in the plane such that no two edges (that is, theline segments or arcs representing the edges) cross. The topic ofplanarity will be dealt with in Chapter 33; we wish to deal withgraphs more purely combinatorially for the present.
edge ends
ax,z
by,w
cx,z
dz,w
ez,w
fx,y
gz,w
Figure 1.1
Thus a graph is described by a table such as the one in Fig. 1.1
that lists the ends of each edge. Here the graph we are describing
---PAGE BREAK---
2 A Course in Combinatorics
has vertex set V={x,y,z,w }and edge set E={a,b,c,d,e,f,g };
a drawing of this graph may be found as Fig. 1.2(iv).
A graph is simple when it has no loops and no two distinct edges
have exactly the same pair of ends. Two nonloops are parallel
when they have the same ends; graphs that contain them are called
multigraphs by some authors, or are said to have ‘multiple edges’.
If anordered pair of vertices is associated to each edge, we have
adirected graph ordigraph. In a drawing of a digraph, we use an
arrowhead to point from the ﬁrst vertex (the tail) towards the sec-
ond vertex (the head) incident with an edge. For a simple digraph,
we disallow loops and require that no two distinct edges have thesame ordered pair of ends.
When dealing with simple graphs, it is often convenient to iden-
tify the edges with the unordered pairs of vertices they join; thusan edge joining xandycan be called {x,y}. Similarly, the edges
of a simple digraph can be identiﬁed with ordered pairs ( x,y)o f
distinct vertices.
(i) graph (ii) graph with loop (iii) digraph (iv) multiple edges
Figure 1.2
There are several ways to draw the same graph. For example,
the two graphs of Fig. 1.3 are essentially the same.
We make this more precise, but to avoid unnecessarily technical
deﬁnitions at this point, let us assume that all graphs are undirectedand simple for the next two deﬁnitions.
We say two graphs are isomorphic if there is a one-to-one cor-
respondence between the vertex sets such that if two vertices arejoined by an edge in one graph, then the corresponding vertices arejoined by an edge in the other graph. To show that the two graphsin Fig. 1.3 are the same, ﬁnd a suitable numbering of the vertices
---PAGE BREAK---
1. Graphs 3
in both graphs (using 1 ,2,3,4,5,6) and observe that the edge sets
are the same sets of unordered pairs.
Figure 1.3
A permutation σof the vertex set of a graph Gwith the property
that{a,b}is an edge if and only if {σ(a),σ (b)}is an edge, is called
anautomorphism ofG.
Problem 1A. (i) Show that the drawings in Fig. 1.4 represent the
same graph (or isomorphic graphs).
(ii) Find the group of automorphisms of the graph in Fig. 1.4.
Remark: There is no quick or easy way to do this unless you are
lucky; you will have to experiment and try things.
Figure 1.4
Thecomplete graphKnonnvertices is the simple graph that
has all/parenleftbign
2/parenrightbig
possible edges.
Two vertices aandbof a graph Gare called adjacent if they are
distinct and joined by an edge. We will use Γ( x) to denote the set
of all vertices adjacent to a given vertex x; these vertices are also
called the neighbors ofx.
---PAGE BREAK---
4 A Course in Combinatorics
The number of edges incident with a vertex xis called the degree
or thevalency ofx. Loops are considered to contribute 2 to the
valency, as the pictures we draw suggest. If all the vertices of a
graph have the same degree, then the graph is called regular .
One of the important tools in combinatorics is the method of
counting certain objects in two diﬀerent ways. It is a well known
fact that if one makes no mistakes, then the two answers are thesame. We give a ﬁrst elementary example. A graph is ﬁnite when
bothE(G) andV(G) are ﬁnite sets. We will be primarily con-
cerned with ﬁnite graphs, so much so that it is possible we haveoccasionally forgotten to specify this condition as a hypothesis insome assertions.
Theorem 1.1. A ﬁnite graph Ghas an even number of vertices
with odd valency.Proof: Consider a table listing the ends of the edges, as in Fig.
1.1. The number of entries in the right column of the table is twice
the number of edges. On the other hand, the degree of a vertex x
is, by deﬁnition, the number of times it occurs in the table. So thenumber of entries in the right column is
(1.1)/summationdisplay
x∈V(G)deg(x)=2 |E(G)|.
The assertion follows immediately. /square
The equation (1.1) is simple but important. It might be called
the ‘ﬁrst theorem of graph theory’, and our Theorem 1.1 is its ﬁrst
corollary.
Asubgraph of a graph Gis a graph Hsuch that V(H)⊆V(G),
E(H)⊆E(G), and the ends of an edge e∈E(H) are the same
as its ends in G.His aspanning subgraph when V(H)=V (G).
The subgraph of Ginduced by a subset Sof vertices of Gis the
subgraph whose vertex set is Sand whose edges are allthe edges
ofGwith both ends in S.
Awalkin a graph Gconsists of an alternating sequence
x0,e1,x1,e2,x2,...,xk−1,ek,xk
---PAGE BREAK---
1. Graphs 5
of vertices xi, not necessarily distinct, and edges eiso that the ends
ofeiare exactly xi−1andxi,i=1,2,...,k . Such a walk has length
k. If the graph is simple, a walk is determined by its sequence of
vertices, any two successive elements of which are adjacent.
If the edge terms e1,...,ekare distinct, then the walk is called a
pathfromx0toxk.I fx0=xk, then a walk (or path) is called closed.
Asimple path is one in which the vertex terms x0,x1,...,xkare
also distinct, although we say we have a simple closed path when
k≥1 and all vertex terms are distinct except x0=xk.
If a path from xtoyexists for every pair of vertices x,yofG,
thenGis called connected . Otherwise Gconsists of a number of
connected components (maximal connected subgraphs). It will be
convenient to agree that the null graph with no vertices and no
edges is not connected.
Problem 1B. SupposeGis a simple graph on 10 vertices that is
not connected. Prove that Ghas at most 36 edges. Can equality
occur?
The length of the shortest walk from atob, if such walks exist, is
called the distanced(a,b) between these vertices. Such a shortest
walk is necessarily a simple path.Example 1.1. A well known graph has the mathematicians of the
world as vertices. Two vertices are adjacent if and only if they
have published a joint paper. The distance in this graph fromsome mathematician to the vertex P. Erd˝ os is known as his or herErd˝ os-number.
Figure 1.5
Apolygon is the ‘graph of’ a simple closed path, but more pre-
cisely it can be deﬁned as a ﬁnite connected graph that is regularof degree 2. There is, up to isomorphism, exactly one polygon P
n
---PAGE BREAK---
6 A Course in Combinatorics
withnvertices (often called the n-gon) for each positive integer n.
The sequence of polygons is shown in Fig. 1.5.
A connected graph that contains no simple closed paths, i.e. that
has no polygons as subgraphs, is called a tree.
Problem 1C. Show that a connected graph on nvertices is a tree
if and only if it has n−1 edges.
Problem 1D. Thecomplete bipartite graph Kn,mhasn+mver-
ticesa1,...,anandb1,...,bm, and as edges all mnpairs{ai,bj}.
Show that K3,3is not planar.
No introduction to graph theory can omit the problem of the
bridges of K¨ onigsberg (formerly a city in Prussia). The river Pregel
ﬂowed through this city and split into two parts. In the river wasthe island Kneiphof. There were seven bridges connecting diﬀerentparts of the city as shown in the diagram of Fig. 1.6.
Figure 1.6
In a paper written in 1736 by L. Euler (considered the ﬁrst paper
on graph theory) the author claims that the following question wasconsidered diﬃcult: Is it possible to make a walk through the city,returning to the starting point and crossing each bridge exactlyonce? This paper has led to the following deﬁnition. A closed paththrough a graph using every edge once is called an Eulerian circuit
and a graph that has such a path is called an Eulerian graph .
Theorem 1.2. Aﬁnitegraph Gwithnoisolatedvertices (butpos-
sibly with multiple edges )is Eulerian if and only if it is connected
and every vertex has even degree.
---PAGE BREAK---
1. Graphs 7
Proof: ThatGmust be connected is obvious. Since the path
enters a vertex through some edge and leaves by another edge, it
is clear that all degrees must be even. To show that the conditionsare suﬃcient, we start in a vertex xand begin making a path. We
keep going, never using the same edge twice, until we cannot gofurther. Since every vertex has even degree, this can only happenwhen we return to xand all edges from xhave been used. If
there are unused edges, then we consider the subgraph formed bythese edges. We use the same procedure on a component of thissubgraph, producing a second closed path. If we start this secondpath in a point occurring in the ﬁrst path, then the two paths canbe combined to a longer closed path from xtox. Therefore the
longest of these paths uses all the edges. /square
The problem of the bridges of K¨ onigsberg is described by the
graph in Fig. 1.6. No vertex has even degree, so there is no Euleriancircuit.
One can consider a similar problem for digraphs. The necessary
and suﬃcient condition for a directed Eulerian circuit is that thegraph is connected and that each vertex has the same ‘in-degree’as ‘out-degree’.
Example 1.2. A puzzle with the name Instant Insanity concerns
four cubes with faces colored red, blue, green, and yellow, in such a
way that each cube has at least one face of each color. The problemis to make a stack of these cubes so that all four colors appear oneach of the four sides of the stack. In Fig. 1.7 we describe fourpossible cubes in ﬂattened form.
R
RYGB
R
cube 1R
RYBG
Y
cube 2G
BBRY
G
cube 3B
GYRG
Y
cube 4
Figure 1.7
It is not a very good idea to try all possibilities. A systematic
approach is as follows. The essential information about the cubesis given by the four graphs in Fig. 1.8.
---PAGE BREAK---
8 A Course in Combinatorics
Figure 1.8
An edge indicates that the two adjacent colors occur on opposite
faces of the cube. We obtain a graph Gby superposition of the
four graphs and number the edges according to their origin. It is
not diﬃcult to see that we need to ﬁnd in Gtwo subgraphs that
are regular of degree 2, with edges numbered 1 ,2,3,4 and such that
they have no edge in common. One of the subgraphs tells us whichpairs of colors to align on the left side and right side of the stack.The other graph describes the colors on front and back. Of courseit is easy to rotate the cubes in such a way that the colors are wherewe wish them to be. The point of the example is that it takes onlya minute to ﬁnd two subgraphs as described above. In this examplethe solution is unique.
We mention a concept that seems similar to Eulerian circuits but
that is in reality quite diﬀerent. A Hamiltonian circuit in a graph
Gis a simple closed path that passes through each vertex exactly
once (rather than each edge). So a graph admits a Hamiltonian
circuit if and only if it has a polygon as a spanning subgraph. Inthe mid-19th century, Sir William Rowan Hamilton tried to popu-larize the exercise of ﬁnding such a closed path in the graph of thedodecahedron (Fig. 1.9).
Figure 1.9
---PAGE BREAK---
1. Graphs 9
The graph in Fig. 1.4 is called the Petersen graph (cf. Chapter 21)
and one of the reasons it is famous is that it is not‘Hamiltonian’;
it contains n-gons only for n=5,6,8,9, and not when n=7o r
n= 10.
By Theorem 1.2, it is easy to decide whether a graph admits an
Eulerian circuit. A computer can easily be programmed to check
whether the degrees of a graph are even and whether the graph isconnected, and even to produce an Eulerian circuit when one exists.In contrast to this, the problem of deciding whether an arbitrarygraph admits a Hamiltonian circuit is likely ‘intractable’. To bemore precise, it has been proved to be NP-complete—see Garey
and Johnson (1979).
Problem 1E. LetA
1,...,A nbendistinct subsets of the n-set
N:={1,...,n }. Show that there is an element x∈Nsuch that
the sets Ai\{x},1 ≤i≤n, are all distinct. To do this, form a graph
Gon the vertices Aiwith an edge with ‘color’ xbetween AiandAj
if and only if the symmetric diﬀerence of the sets AiandAjis{x}.
Consider the colors occurring on the edges of a polygon. Show that
one can delete edges from Gin such a way that nopolygons are
left and the number of diﬀerent colors remains the same. Then use1C. (This idea is due to J. A. Bondy (1972).)
Problem 1F. The girth of a graph is the length of the smallest
polygon in the graph. Let Gbe a graph with girth 5 for which all
vertices have degree ≥d. Show that Ghas at least d
2+ 1 vertices.
Can equality hold?
Problem 1G. Show that a ﬁnite simple graph with more than one
vertex has at least two vertices with the same degree.
Problem 1H. A graph on the vertex set {1,2,...,n }is often de-
scribed by a matrix Aof size n, where aijand ajiare equal to
the number of edges with ends iandj. What is the combinatorial
interpretation of the entries of the matrix A2?
Problem 1I. LetQ:={1,2,...,q }.L e t Gbe a graph with the
elements of Qnas vertices and an edge between ( a1,a2,...,a n)a n d
(b1,b2,...,b n) if and only if ai/negationslash=bifor exactly one value of i. Show
that Gis Hamiltonian.
---PAGE BREAK---
10 A Course in Combinatorics
Problem 1J. LetGbe a simple graph on nvertices (n>3) with
no vertex of degree n−1. Suppose that for any two vertices of G,
there is a unique vertex joined to both of them.
(i) Ifxandyare not adjacent, prove that they have the same
degree.
(ii) Now show that Gis a regular graph.
Notes.
Paul Erd˝ os (1913–1996) (cf. Example 1.1) was probably the most
proliﬁc mathematician of the 20th century with well over 1400 pa-
pers having been published. His contributions to combinatorics,number theory, set theory, etc., include many important results.He collaborated with many mathematicians all over the world, allof them proud to have Erd˝ os-number 1, among them the authorsof this book; see J. W. Grossman (1997).
Leonhard Euler (1707–1783) was a Swiss mathematician who
spent most of his life in St. Petersburg. He was probably the mostproductive mathematician of all times. Even after becoming blindin 1766, his work continued at the same pace. The celebration in1986 of the 250th birthday of graph theory was based on Euler’spaper on the K¨ onigsberg bridge problem. K¨ onigsberg is now thecity of Kaliningrad in Russia.
For an elementary introduction to graph theory, we recommend
R. J. Wilson (1979), and J. J. Watkins and R. J. Wilson (1990).
Sir William Rowan Hamilton (1805–1865) was an Irish mathe-
matician. He was considered a genius. He knew 13 languages atthe age of 12 and was appointed professor of astronomy at TrinityCollege Dublin at the age of 22 (before completing his degree). Hismost important work was in mathematical physics.
References.
M. Garey and D. S. Johnson (1979), Computers and Intractability;
A Guide to the Theory of NP-completeness , W. H. Freeman and
Co.
J. W. Grossman (1997), Paul Erd˝ os: The Master of Collaboration,
pp. 467–475 in The Mathematics of Paul Erd˝ os, R. L. Graham
and J. Neˇ setˇ ril (eds.), Springer-Verlag.
---PAGE BREAK---
1. Graphs 11
J. J. Watkins and R. J. Wilson (1990), Graphs (An Introductory
Approach), J. Wiley & Sons.
R. J. Wilson (1979), Introduction to Graph Theory , Longman.
---PAGE BREAK---
2
Trees
We come to the ﬁrst not so easy theorem. It is due to A. Cayley
(1889). We shall give three diﬀerent proofs here. Two more proofswill occur in later chapters; see Example 14.14 and Example 38.2.The ﬁrst two proofs illustrate a method that is used very often incombinatorics. In order to count certain objects that seem hard tocount, one ﬁnds a one-to-one mapping onto a set of other objectswhose number is easier to determine.
Theorem 2.1. Thereare n
n−2diﬀerentlabeledtreeson nvertices.
The term labeled emphasizes that we are not identifying isomor-
phic graphs. We have ﬁxed the set of vertices, and two trees are
counted as the same if and only if exactly the same pairs of verticesare adjacent. A spanning tree of a connected graph Gis a spanning
subgraph of Gthat is a tree. The theorem could have been stated:
the complete graph K
nhasnn−2spanning trees.
Example 2.1. Here are the 16 labeled trees on four vertices:

---PAGE BREAK---
2. Trees 13
Example 2.2. There are three nonisomorphic trees on ﬁve ver-
tices:
The number of spanning trees in K5isomorphic to a speciﬁc tree
Ton ﬁve vertices is 5! divided by the order of the automorphism
group ofT(why?). Thus there are 5!/4! = 5 trees in K5isomorphic
to the ﬁrst tree above, and 5! /2 = 60 trees isomorphic to either of
the other two trees, for a total of 125 spanning trees.
Problem 2A. Find the six nonisomorphic trees on 6 vertices, and
for each compute the number of distinct spanning trees in K6iso-
morphic to it.
Before starting the proofs, we make the following observations.
(Probably the reader has already noticed these things in solving
Problem 1C.) Firstly, every tree with n≥2 vertices has at least
two monovalent vertices (vertices of degree 1). This is immediate,for example, from Problem 1C and equation (1.1): the sum of thedegreesd
1,d2,...,dn, all of which are at least 1, is 2 n−2. Secondly,
if a monovalent vertex and its incident edge are deleted from a tree,the resulting graph is still a tree. Finally, given a tree T,i fw e
introduce a new vertex xand a new edge joining xtoanyvertex
ofT, the new graph is again a tree.
Figure 2.1
Proof 1: The ﬁrst proof we present, due to H. Pr¨ ufer (1918), uses
an algorithm that associates to any tree Ta ‘name’ P(T) (called
thePr¨ ufer code ) that characterizes the tree.
---PAGE BREAK---
14 A Course in Combinatorics
For the vertices of Kn, we take the ordered set V={1,2,3,...,n}.
Given a spanning tree TinKn, we letT1=Tand generate a se-
quence of trees T1,T2,...,Tn−1and two sequences of vertices as
follows: Given the tree Tiwithn−i+1 vertices, i=1,2,...,n−1,
letxibe the least monovalent vertex of Tiand delete xiand its
incident edge {xi,yi}fromTito obtain a tree Ti+1onn−ivertices.
Thename ofTis to be
P(T)=(y1,y2,...,yn−2).
We claim that the mapping P, from the set of all spanning trees
inKnto the set Vn−2of all possible names, is one-to-one and onto
(bijective). This will prove that the number of spanning trees in
Knisnn−2.
For the tree in Fig. 2.1, where n= 10, we have (x 1,y1)=( 3,2),
(x2,y2)=( 4,2), (x 3,y3)=( 2,1),... ,(x9,y9)=( 9,10); these edges
are the columns of the matrix below.
/bracketleftbigg
342567 1 8 92211711 01 01 0/bracketrightbigg
SoP(T)=( 2,2,1,1,7,1,10,10). Don’t include y
9= 10.
To understand why Pis bijective, we ﬁrst note some simple facts
about the xi’s andyi’s. First,yn−1=n, always. This is because
every tree (with at least two vertices) has at least two monovalentvertices, so the vertex nwill never be the least monovalent vertex.
Second,x
k,xk+1,...,xn−1andnare the vertices of the tree Tk.
Third,{xi,yi},k≤i≤n−1, are exactly the edges of Tk, in some
order.
The number of times a vertex voccurs among y1,y2,...,yn−2is
degT(v)−1. This is because voccurs degT(v) times among the edges
{xi,yi},1≤i≤n−1, and exactly once in x1,x2,...,xn−1,yn−1.
Similarly, the number of times a vertex vofTkoccurs among
yk,yk+1,...,yn−2is its degree in the tree Tkless 1. In particular,
the monovalent vertices of Tkare those elements of Vnot in
{x1,x2,...,xk−1}∪{yk,yk+1,...,yn−1},
and this means that xk, the least monovalent vertex of Tk, is the
least element of {1,2,...,n}not in the above set. In particular,
---PAGE BREAK---
2. Trees 15
x1is the least element of Vnot in the name P(T), and we can
uniquely determine xkfromP(T) andx1,...,xk−1. /square
Problem 2B. How many trees Tare there on the set of vertices
{1,2,3,4,5,6,7}in which the vertices 2 and 3 have degree 3, vertex
5 has degree 2, and hence all others have degree 1? Do not just
draw pictures but consider the possible Pr¨ ufer codes of these trees.
Proof 2: We give another proof, again by a reversible algorithm.
Consider any mapping ffrom{2,3,...,n−1}to{1,2,...,n}.
There are nn−2such mappings f. Construct a digraph Don the
vertices 1 to nby deﬁning ( i,f(i)),i=2,...,n−1, to be the edges.
Fig. 2.2 shows an example with n= 21.
Dconsists of two trees ‘rooted’ at 1 and nand a number (say k)o f
circuits (directed polygons) to which trees are attached. (Directed
trees with all the edges pointing in the direction of one vertex, calledthe root, are called arborescences .) These circuits are placed as in
Fig. 2.2 where the rightmost vertex in the i-th component, denoted
byr
i, is its minimal element (and liis the vertex on the left). The
circuits are ordered by the condition r1<r2<···<rk.T oDwe
adjoin the tree obtained by adding the edges {1,l 1},{r1,l2},...,
{rk−1,lk},{rk,n}and deleting the edges {ri,li}as in Fig. 2.3.
Figure 2.2
If the tree of Fig. 2.3 is given, consider the path from 1 to n
(=21). Let r0:= 1. Deﬁne r1to be the minimal number on this
path (excluding r0= 1) and in general rias the minimal number
on the path from ri−1ton. It is easily seen that we recover the
functionfin this way. /square
---PAGE BREAK---
16 A Course in Combinatorics
Figure 2.3
Generalizations of this proof may be found in Eˇ gecioˇ glu and Rem-
mel (1986).
Problem 2C. LetGbe a directed graph with vertices x1,...,xn
for which a (directed) Eulerian circuit exists. A spanning arbores-
cence with root xiis a spanning tree TofG, with root xi, such
that for all jLnegationslash=ithere is a directed path from xjtoxiinT. Show
that the number of spanning arborescences of Gwith root xidoes
not depend on i. (This is diﬃcult; see the hints.)
Proof 3: We now give a proof by counting since it is useful to
have seen this method. We remind the reader of the deﬁnition of
amultinomial coeﬃcient . Letr1,r2,...,rkbe nonnegative integers
with sum n. Then/parenleftbign
r1,...,rk/parenrightbig
is deﬁned by
(2.1) (x1+x2+···+xk)n=/summationdisplay/parenleftbiggn
r1,...,rk/parenrightbigg
xr1
1xr2
2...xrk
k,
where the sum is over all k-tuples (r 1,...,rk) with sum n.
Since (x 1+···+xk)n=(x1+···+xk)n−1(x1+···+xk), we have
(2.2)/parenleftbiggn
r1,...,rk/parenrightbigg
=k/summationdisplay
i=1/parenleftbiggn−1
r1,...,ri−1,...,r k/parenrightbigg
.
We denote the number of labeled trees with nvertices for which the
degrees are d1,d2,...,dnbyt(n;d1,d2,...,dn). Clearly this number
is 0 if one of the diis 0. The value of t(n;d1,d2,...,dn) depends
only on the multiset of numbers diand not on their order. We
may assume without loss of generality that d1≥d2≥· · ·≥d n,
sodn= 1. Take the vertex vncorresponding to dn. It is joined to
some vertex viof degreedi≥2, and any of the remaining vertices
---PAGE BREAK---
2. Trees 17
is a candidate. Therefore
(2.3)t(n;d1,...,dn)=n−1/summationdisplay
i=1t(n−1;d1,...,di−1,...,d n−1).
It is trivial to check by hand that
(2.4) t(n;d1,...,dn)=/parenleftbiggn−2
d1−1,...,d n−1/parenrightbigg
forn= 3. Since the numbers on the left-hand side, respectively
right-hand side, of (2.4) satisfy the same recurrence relation ( (2.3),
respectively (2.2) ) it follows by induction that (2.4) is true for all n.
In (2.1), we replace nbyn−2,kbyn,ribydi−1 andxiby 1.
We ﬁnd
nn−2=/summationdisplay
t(n;d1,d2,...,dn).
/square
Compare (2.4) with Problem 2B.A spanning tree is easily constructed by starting at any vertex,
taking the edges to vertices at distance 1, then one edge to eachvertex at distance 2, etc. Several other constructions are possible(e.g. by starting with Gand deleting suitable edges).
A graph with no polygons as subgraphs is called a forest . Each
component C
1,C2,...,Ckof a forest Gis a tree, so if a forest with
nvertices has kcomponents, it has
(|V(C1)|−1 )+( |V(C2)|−1) + ···+(|V(Ck)|−1) =n−k
edges.
Aweighted graph is a graph Gtogether with a function associat-
ing a real number c(e) (usually nonnegative) to each edge e, called
itslength orcostaccording to context. Let us use the term ‘cost’
here. Given a weighted connected graph G, deﬁne the costof a
spanning tree TofGas
c(T): =/summationdisplay
e∈E(T)c(e).
---PAGE BREAK---
18 A Course in Combinatorics
The graph may represent a network of cities where c({x,y}) is the
cost of erecting a telephone line joining cities xandy, and so it
is clear that ﬁnding a cheapest spanning tree in Gis a problem of
practical importance.
The following method is often called the greedy algorithm . In fact,
it is only one of a number of algorithms which can be called greedy
algorithms, where one does not plan ahead but takes what seemsto be the best alternative at each moment and does not look back.It is surprising that such a simple procedure actually produces acheapest spanning tree, but this is proved in Theorem 2.2 below.Let us say that a set Sof edges of a graph Gisindependent when
the spanning subgraph with edge set S(denotedG:S) is a forest.
Greedy algorithm. LetGbe a connected weighted graph with
nvertices. At each point, we will have a set {e
1,e2,...,ei}ofi
independent edges ( i= 0 to start), so that G:{e 1,e2,...,ei}hasn−i
components. If i<n−1, letei+1be an edge with ends in diﬀerent
components of G:{e 1,e2,...,ei}and whose cost is minimum with
respect to this property. Stop when we have chosen n−1 edges.
Theorem 2.2. Withe1,...,en−1chosen as above, the spanning
treeT0:=G:{e 1,...,en−1}has the property that c(T0)≤c(T)for
any spanning tree T.
Proof: Let{a1,a2,...,an−1}be the edge set of a tree T, numbered
so thatc(a1)≤c(a2)≤···≤c(an−1). We claim something much
stronger than c(T0)≤c(T); namely, we claim that c(ei)≤c(ai) for
eachi=1,2...,n−1. If this is false, then
c(ek)>c(ak)≥c(ak−1)≥···≥c(a1)
for somek. Since none of a1,a2,...,akwas chosen at the point
whenekwas chosen, each of these kedges has both ends in the
same component of G:{e 1,e2,...,ek−1}. Then the number of com-
ponents of G:{a 1,a2,...,ak}is at least the number n−k+1o f
components of G:{e 1,e2,...,ek−1}and this contradicts the fact that
{a1,a2,...,ak}is independent. /square
Problem 2D. Here is a variation on the above greedy algorithm.
Letx1be any vertex of a weighted connected graph Gwithn
---PAGE BREAK---
2. Trees 19
vertices and let T1be the subgraph with the one vertex x1and
no edges. After a tree (subgraph) Tk,k<n , has been deﬁned,
letekbe a cheapest edge among all edges with one end in V(Tk)
and the other end notinV(Tk), and let Tk+1be the tree obtained
by adding that edge and its other end to Tk. Prove that Tnis a
cheapest spanning tree in G.
In many practical situations, it is necessary to search through a
tree starting from a particular vertex. (A tree with a distinguished
vertex—the root—is called a rooted tree.) There are two well known
methods known as depth-ﬁrst search andbreadth-ﬁrst search.W e
explain the terminology by the example of Fig. 2.4.
Figure 2.4
In a depth-ﬁrst search starting at a, one essentially considers the
tree as a fence and walks around it, keeping the fence on the left,i.e. along the walk abdidjdbebfk...lhca . If one decides to number
the vertices in accordance with the search, one ﬁnds the numberinga=1 ,b=2 ,d=3 ,i=4 ,...,l= 12. In this description, we rely
on a planar drawing of the tree; but see below.
In a breadth-ﬁrst search, one proceeds as in the construction of
a spanning tree mentioned above. The vertices are then numberedin the order of Fig. 2.4, i.e. alphabetically.
These ideas apply, more generally, to searching through the ver-
tices of a connected graph.
Given a ﬁnite connected graph G, we can obtain a numbering
of the vertices of Gand a spanning tree TofG, called a ‘depth-
ﬁrst search tree’ for G, in the following manner. Pick a vertex v
0
and start with the tree T0with vertex v0and no edges. Proceed
inductively: once vertices v0,v1,v2,...,vkand a tree Tkwith exactly
those vertices and some of the edges of Ghave been chosen, let plscript
---PAGE BREAK---
20 A Course in Combinatorics
be the largest index ≤kso thatvplscriptis adjacent to some vertex not
inTk. Such a vertex will exist if Tkis not yet a spanning tree;
otherwise stop and let T=Tk. Call that new vertex vk+1and add
it and the edge {vplscript,vk+1}toTkto obtain a tree Tk+1. We consider
Tas a rooted tree with root v0.
We give two properties of depth-ﬁrst search trees and use them
to give a simple constructive proof of a theorem on orientations of
graphs.
Given a vertex xof a rooted tree with root v0, theancestors ofx
are the vertices traversed by the (unique) path from xto the root
v0. The ﬁrst vertex other than xon that path is the parent ofx.I f
xis an ancestor of y, we also say that yis adescendant ofx.W e
will count xas a descendent and ancestor of itself.
Proposition 2.3. If vertices xandyare adjacent in G, then one
of them is a descendant of the other in any depth-ﬁrst search treeTofG.
Proof: Supposexis numbered with a smaller index than yin the
depth-ﬁrst search, say x=v
k.
At the stage when v0,v1,v2,...,vkhave been chosen, the largest
indexplscriptso thatvplscriptis adjacent to an as-yet-unnumbered vertex is
clearlyplscript=k.S ovk+1is joined to vk(and not to some viwithi<k)
inT.I fvk+1=y, we are done; yis a descendant of vk. Otherwise,
sincevkis still adjacent to an as-yet-unnumbered vertex, namely
y, the choice of plscriptwill beplscript=korplscript=k+ 1, andvk+2is adjacent to
eithervkorvk+1inT.I fvk+2=y, we are done; yis a descendant
ofvk.
Inductively, as long as yremains unnumbered ,vk,vk+1,...,vk+j
will be descendants of vkand the next choice of plscriptwill be as one of
k,k+1,...,k +j. Then the vertex vk+j+1numbered next will be
adjacent to one of vk,vk+1,...,vk+jand hence will be a descendant
ofvk. Since the graph is ﬁnite, eventually this newly numbered
vertex must be y. /square
Anisthmus of a connected graph Gis an edge whose deletion
results in a disconnected graph. (Some authors call this a bridge .)
Proposition 2.4. Let{x,y}be an edge of Twhich is not an
isthmus in G;s a yxis the parent of y. Then there is an edge in G
---PAGE BREAK---
2. Trees 21
but not in Tjoining some descendant aofyand some ancestor b
ofx.
Proof: LetDbe the set of descendants of y.S oy∈Dandx/∈D.
SinceGwith{x,y}deleted is still connected, there is some edge
{a,b} Lnegationslash={x,y}with one end a∈Dand the other end b/∈D. This
edge{a,b} is certainly not in Tand by Proposition 2.3, bis an
ancestor of a(since it cannot be a descendant of abecause then it
would be a descendant of ytoo and hence would be in D). The
(unique) path in Tfromatov0passes through y(an ancestor of
a) and then x(the parent of y); butbmust be on this path (since
it is an ancestor of a), sobmust be an ancestor of xtoo. /square
Any directed graph obtained from an undirected graph Gby
assigning a direction to each edge of Gis called an orientation of
G. A walk in a digraph Dmay be called strong when each edge is
traversed by the walk according to its direction, i.e. from its tail to
its head, and the digraph Disstrongly connected when for any two
verticesx,y, there is a strong walk from xtoy.
Theorem 2.5. LetGbe a ﬁnite connected graph without isth-
muses. Then Gadmits a strong orientation, i.e. an orientation
that is a strongly connected digraph.
Proof: We will construct a digraph DfromGby choosing a direc-
tion for each edge. Find a depth-ﬁrst search tree Tand numbering
v0,v1,...of the vertices of G. Let{vi,vj}be an edge of Gwith
i<j .I f{vi,vj}is inT, direct it from vitovj, i.e. (v i,vj)i sa n
edge ofD.I f{vi,vj}is in notT, direct it from vjtovi, i.e. (vj,vi)
is an edge of D.
It remains to show that Dis strongly connected. There is a
strong walk from v0to any vertex xofG(using only edges of the
treeT), so it will suﬃce to show that we can ﬁnd a strong walk
from any vertex xtov0.
Given a vertex xk,k>0, Proposition 2.4 says that some edge
{a,b} inGbut not in Tjoins some descendant aofyto some
ancestorb=viofvk. We get a strong walk in Dfromvktoviby
appending the directed edge ( a,vi) to a strong walk in Tfromvk
to its descendant a. Of course, i<k sinceviis an ancestor of vk.
Ifi= 0 we are done. Otherwise, we repeat the argument to ﬁnd
---PAGE BREAK---
22 A Course in Combinatorics
a strong walk from vito somevjwithj<i and concatenate the
walks to get a strong walk from vktovj. Continue in this manner
until you reach v0. /square
Problem 2E. Agraceful labeling of a treeTonnvertices is a
mappingf:V(T)→{1,2,...,n}so that the numbers |f(x)−f(y)|
computed across edges {x,y}are all diﬀerent. Show that the path-
graphs (trees with exactly two monovalent vertices) admit graceful
labelings. (It is conjectured that all trees admit graceful labelings.)
Problem 2F. Suppose a tree Ghas exactly one vertex of degree
ifor 2≤i≤mand all other vertices have degree 1. How many
vertices does Ghave?
Problem 2G. LetGbe a graph with exactly one vertex of degree
ifor 2≤i≤mandkother vertices, all of degree 1. Prove that
k≥⌊m+3
2⌋. Give a construction for such a graph.
Problem 2H. Consider labeled trivalent rooted trees Twith 2n
vertices, counting the root labeled 2 n; see Figure 14.3. The labels
are chosen in such a way that the procedure leading to P(T) has
1,2,3,..., 2n−1 as ﬁrst row. How many possible codes P(T) are
there?
Notes.
A. Cayley (1821–1895), professor at Cambridge from 1863 until
his death, was one of the great mathematicians of the 19th century.
His work includes important contributions to the theory of ellipticfunctions, analytic geometry and algebra, e.g. the theory of invari-ants. His paper on trees appeared in 1889 but it did not containwhat we would consider a proof. Of the many proofs (ﬁve of whichare treated in this book) the one by Pru ¨fer is the best known.
H. Pru ¨fer (1896–1934) was one of I. Schur’s many pupils. He was
professor at Mu ¨nster.
References.
A. Cayley (1889), A theorem on trees, Quart. J. Pure and App.
Math.23, 376–378.
---PAGE BREAK---
2. Trees 23
¨O. Eˇ gecioˇ glu and J. B. Remmel (1986), Bijections for Cayley trees,
spanning trees, and their q-analogues, J. Combinatorial Theory
(A)42, 15–30.
H. Pr¨ ufer (1918), Neuer Beweis eines Satzes ¨ uber Permutationen,
Archiv der Math. und Phys. (3)27, 142–144.
---PAGE BREAK---
3
Colorings of graphs and
Ramsey’s theorem
We shall ﬁrst look at a few so-called coloring problems for graphs.
Aproper coloring of a graph Gis a function from the vertices to
a setCof ‘colors’ (e.g. C={1,2,3,4}) such that the ends of every
edge have distinct colors. (So a graph with a loop will admit no
proper colorings.) If |C|=k, we say that Gisk-colored.
Thechromatic number χ(G) of a graph Gis the minimal number
of colors for which a proper coloring exists.
Ifχ(G)=2( o r χ(G) = 1, which is the case when and only when
Ghas no edges), then Gis called bipartite. A graph with no odd
polygons (equivalently, no closed paths of odd length) is bipartiteas the reader should verify.
The famous ‘Four Color Theorem’ (K. Appel and W. Haken,
1977) states that if Gis planar, then χ(G)≤4.
Clearlyχ(K
n)=n.I fkis odd then χ(Pk) = 3. In the following
theorem, we show that, with the exception of these examples, thechromatic number is at most equal to the maximum degree (R. L.Brooks, 1941).
Theorem 3.1. Letd≥3andletGbeagraphinwhichallvertices
have degree ≤dand such that K
d+1is not a subgraph of G. Then
χ(G)≤d.
Proof 1: As is the case in many theorems in combinatorial analy-
sis, one can prove the theorem by assuming that it is not true, then
considering a minimal counterexample (in this case a graph with
the minimal number of vertices) and arriving at a contradiction.We shall use the technique of recoloring: it is possible to change
---PAGE BREAK---
3. Colorings of graphs and Ramsey’s theorem 25
the colors of certain vertices to go from one proper coloring to an-
other. For example, let Sbe a subset of the set Cof colors. On any
connected component of the subgraph induced by the vertices withcolors from S, we arbitrarily permute the colors (without changing
those of the vertices with colors in C\S). Clearly we again have a
proper coloring.
So letGbe a counterexample with the minimum number of ver-
tices. Let x∈Gand let Γ(x )={x
1,...,xl},l≤d. SinceGis
a minimal counterexample, the graph H, obtained by deleting x
and the edges incident with x, has ad-coloring, say with colors
1,2,...,d . If one of these colors is not used in the coloring of Γ( x),
then we can assign this color to xand obtain a d-coloring of G.I t
follows that l=dand every d-coloring of Hmust use all the colors
on the set Γ(x ). Let us assume that xihas colorifori=1,2,...,d .
Now consider xiandxjand the induced subgraph HijofHwith
colorsiandj.I fxiandxjwere in diﬀerent connected components
ofHij, then we could interchange the colors in one of these com-
ponents, after which xiandxjwould have the same color, which
is impossible. So xiandxjare in the same component (say Cij)
ofHij. We shall now show that this component is (the graph of)
asimple path (with alternating colors iandj) fromxitoxj.I f
two neighbors of xiinHhad colorj, then the neighbors of xiinH
would have at most d−2 diﬀerent colors. Then we could recolor
xiand that is impossible. Suppose yis the ﬁrst vertex on a path
fromxitoxjinCijthat has degree ≥3. The neighbors of yinH
have at most d−2 colors, so we can recolor yto some color /∈{i,j}
and thenxiandxjare no longer connected in Hij, which we know
to be impossible. So such a ydoes not exist, proving that Cijis a
path.
Suppose that zis a vertex Lnegationslash=xionCijand onCik. Thenzhas two
neighbors with color jand two with color k. Again the neighbors
ofzinHhave at most d−2 colors and zcan be recolored to some
color/∈{i,j,k}, again a contradiction. Hence Cij∩Cik={xi}.
Our assumption that Kd+1/notsubseteqlGshows that there are two vertices
in Γ(x), sayx1andx2, that are not connected by an edge. We have
the situation of Fig. 3.1. The vertex ais the neighbor of x1with
color 2 on C12.
---PAGE BREAK---
26 A Course in Combinatorics
We recolor Hby interchanging the colors 1 and 3 on the subgraph
C13. For the new coloring, we have new paths that we call CLprime
ij.
Clearlya∈CLprime
23(sincex1now has color 3). However, on C12no point
exceptx1has changed color, so a∈CLprime
12. HenceCLprime
12∩CLprime
23Lnegationslash={x2},
contradicting what we proved above. The contradiction shows that
our assumption that a minimal counterexample exists is false. /square
Figure 3.1
In preparation for a second proof of Brook’s Theorem, the reader
should do the following problem without applying the theorem.
Problem 3A. Fix an integer d≥3. LetHbe a simple graph with
all degrees ≤dwhich cannot be d-colored and which is minimal
(with the fewest vertices) subject to these properties. (We claim H
is complete on d+1 vertices, but we don’t know that yet.) (i) Show
thatHis nonseparable (this means that every graph obtained from
Hby deleting a vertex is connected). (ii) Then show that if the
vertex set V(H) is partitioned into sets XandYwith|Y|≥3,
then there are at least three vertices a,b,c∈Yeach of which is
adjacent to at least one vertex in X.
Proof 2: LetdandHbe as in Problem 3A. If His not complete,
there are vertices x1,xn−1,xnso thatx1is adjacent to xn−1andxn
but so that these last two vertices are not adjacent. We want to
number the other n−3 vertices so that the sequence
x1,x2,...,xn−1,xn
has the property that each xk,k≥2, is adjacent to at least one of
the vertices xipreceding it, i.e. with i<k . This is simple: when
x1,x2,...,xkhave been chosen, k<n−2, choosexk+1to be any
---PAGE BREAK---
3. Colorings of graphs and Ramsey’s theorem 27
vertex other than xn−1orxnadjacent to one of x1,x2,...,xk; since
there are at least three such vertices, this is always possible.
Once this is done, we d-color the vertices starting at the end of
the sequence. Assign xn−1andxnthe same color. When the last
kverticesxk+1,...,xn−1,xnhave been colored, k≥2, there is a
color available for xksincexkis adjacent to at most d−1o ft h e
already-colored vertices. Finally, there is a color available for x1
since two of the vertices adjacent to x1have been given the same
color. /square
We now consider a coloring problem of a completely diﬀerent
nature. It serves as an introduction to a very important theorem of
combinatorics, namely Ramsey’s theorem. Before reading on, thereader should try the following problem.
Problem 3B. Let the edges of K
7be colored with the colors red
and blue. Show that there are at least four subgraphs K3with all
three edges the same color ( monochromatic triangles ). Also show
that equality can occur.
The example that is always used to introduce this subject is K6
with its edges colored red or blue. We shall show that there is at
least one monochromatic triangle. A proof is as follows. Let abe
any vertex. Because ahas degree 5, it is incident with at least three
edges of the same color, say red edges to the vertices b,c,d. If one
of the edges between these three vertices is red, then we have a redtriangle; if not, then they form a blue triangle.
The idea of the proof is the same as for the more diﬃcult situation
of Ramsey’s theorem. However, it does not show as much as thefollowing counting argument.
Theorem 3.2. If the edges of K
nare colored red or blue, and ri,
i=1,2,...,n,denotesthenumberofrededgeswithvertex iasan
endpoint,andif ∆denotesthenumberofmonochromatictriangles,
then
(3.1) ∆ =/parenleftbiggn
3/parenrightbigg
−1
2n/summationdisplay
i=1ri(n−1−ri).
Proof: Every triangle in Knthat is not monochromatic has ex-
actly two vertices where a red and a blue edge meet. On the i-th
---PAGE BREAK---
28 A Course in Combinatorics
vertex, two such edges can be chosen in ri(n−1−ri) ways. So the
sum in (3.1) counts the bichromatic triangles twice. /square
Corollary.
(3.2) ∆ ≥/parenleftbiggn
3/parenrightbigg
−⌊n
2⌊(n−1
2)2⌋⌋.
Proof: From (3.1) we see that ∆ is minimized if ri=(n−1−ri)
for alliwhennis odd, or if ri=n
2orri=n
2−1 for alliin the
case thatnis even. Since ∆ is an integer, the ﬁrst situation cannot
always arise. It is easy to show that (3.2) cannot be improved. /square
Note that this argument shows that a red-blue coloring of K6
must always have at least two monochromatic triangles.
We now treat Ramsey’s theorem (Ramsey, 1930).
Theorem 3.3. Letr≥1andqi≥r,i=1,2,...,sbe given.
There exists a minimal positive integer N(q1,q2,...,qs;r)with the
following property. Let Sbe a set with nelements. Suppose that
all/parenleftbign
r/parenrightbig
r-subsetsof Saredividedinto smutuallyexclusivefamilies
T1,...,Ts(‘colors’). Then if n≥N(q1,q2,...,qs;r)there is an i,
1≤i≤s, and some qi-subset of Sfor which every r-subset is in
Ti.
(The reader should compare this with our introductory example
and show that N(3,3; 2) = 6.)
Proof: We give the proof only for s= 2. The general case only
involves a little more bookkeeping.
(a) Trivially, the theorem is true for r= 1 and N(p,q;1 ) =
p+q−1.
(b) For any randp≥rit is also obvious that N(p,r;r)=p and
similarlyN(r,q;r)=q forq≥r.
(c) We proceed by induction on r. So assume the theorem is true
forr−1. We now use induction on p+q, using (b). So we can
deﬁnep1=N(p−1,q;r),q1=N(p,q−1;r). LetSbe a set with
nelements, where n≥1+N (p1,q1;r−1). Let the r-subsets of S
be colored with two colors, say red and blue. As in the proof for
K6, we pick an arbitrary element aofS. We now deﬁne a coloring
of the (r−1)-subsets of SLprime:=S\{a} by giving X⊆SLprimethe same
---PAGE BREAK---
3. Colorings of graphs and Ramsey’s theorem 29
color asX∪{a}. By induction SLprimeeither contains a subset Aof
sizep1such that all its ( r−1)-subsets are red or a subset Bof size
q1such that all its ( r−1)-subsets are colored blue. Without loss
of generality the ﬁrst situation occurs. Since AhasN(p−1,q;r)
elements, there are two possibilities. The ﬁrst is that Ahas a subset
ofqelements with all its r-subsets blue, in which case we are done.
The other possibility is that Ahas a subset ALprimeofp−1 elements
with all its r-subsets red. The set ALprime∪{a}also has this property
becauseALprime⊆A. This proves the theorem and furthermore we have
shown
(3.3)N(p,q;r)≤N(N(p−1,q;r),N(p,q−1;r);r−1 )+1.
/square
A special case of (3.3) occurs when we go back to the coloring of
edges (r= 2) of a graph with two colors. Using (a) from the proof,
we ﬁnd(3.4) N(p,q;2 )≤N(p−1,q;2 )+N(p,q−1; 2).
Problem 3C. Show that equality cannot hold in (3.4) if both
terms on the right-hand side are even.
Theorem 3.4.
N(p,q;2 )≤/parenleftbiggp+q−2
p−1/parenrightbigg
.
Proof: SinceN(p,2; 2) =p, the result follows from (3.4) because
binomial coeﬃcients satisfy the same relation with equality. /square
Let us look at what we now know about N(p,q; 2). By Problem
3C, we have N(3,4; 2)≤9. To show that equality holds, we have
to colorK
8such that there is no red triangle and no blue K4.W e
do this as follows: number the vertices with the elements of Z8. Let
the edge{i,j}be red if and only if i−j≡±3o ri−j≡4 (mod 8).
One easily checks that this coloring does the job.Problem 3D. Use the same method to show that N(4,4; 2) = 18
and thatN(3,5; 2) = 14.
With a lot more work it has been shown that
N(3,6; 2) = 18,N(3,7; 2) = 23,N (3,8; 2) = 28,N(3,9; 2) = 36,
---PAGE BREAK---
30 A Course in Combinatorics
N(4,5; 2) = 25.
No other values of N(p,q; 2) are known.
One of the interesting problems in this area that has seen virtu-
ally no progress for 30 years is the asymptotic behavior of N(p,p; 2).
We know by Theorem 3.4 that
(3.5) N(p,p;2 )≤/parenleftbigg2p−2
p−1/parenrightbigg
≤22p−2.
We now show that N(p,p; 2) grows exponentially, using a method
that is used quite often in combinatorics. It is often referred to
as ‘probabilistic’ since it estimates the probability that a random
coloring has a monochromatic Kp. Consider a Kn. There are 2(n
2)
diﬀerent ways of coloring the edges red or blue. Now ﬁx a subgraphK
p. There are 2(n
2)−(p
2)+1colorings for which that Kpis monochro-
matic. The number of colorings for which some Kpis monochro-
matic is at most/parenleftbign
p/parenrightbig
times as large (because we may count some
colorings more than once). If this number is less than the total
number of colorings, then there exist colorings with no monochro-maticK
p. Using the fact that/parenleftbign
p/parenrightbig
<np/p!, we ﬁnd that such a
coloring certainly exists if n<2p/2(unlessp= 2). This proves the
following theorem.
Theorem 3.5. N(p,p;2 )≥2p/2.
From (3.5) and Theorem 3.5, we know that
√
2≤p/radicalbig
N(p,p;2 )≤4(p≥2).
It would be very nice if one could show that this p-th root has a
limit forp→∞.
To give a considerable improvement of Theorem 3.5, we discuss a
probabilistic method that is useful in many parts of combinatorics.
We consider eventsA1,A2,...,Anin a probability space. Denote
byPr[Ai] the probability of the event Aiand, as usual, let Ai
denote the complement of Ai, i.e. non-occurrence of Ai. We are
interested in applications where the Aidenote situations we do not
wish to occur and where we would like to assert that there is a
---PAGE BREAK---
3. Colorings of graphs and Ramsey’s theorem 31
positive probability that none of the events Aioccurs. In some
easy counting situations one can use
n/summationdisplay
i=1Pr[Ai]<1⇒∩AiLnegationslash=∅.
Cf. Problem 5E. However, in general, dependence among the unde-
sirable events leads to multiple counting which results in a sum thatis much larger than 1. Of course, if the events A
iare independent,
then it suﬃces that each has probability less than one to guaranteethat non-occurrence of all of them has positive probability. TheLov´asz Sieve handles situations where there is indeed some depen-
dence but simultaneously there are many obviously independentcombinations of events.
We deﬁne what we shall call a dependency graph for the events
A
1,...,An. This is a graph Gon the set of indices {1,2,...,n}
with the property that for everyithe event Aiis independent of
every subset of{Aj:{i,j}/∈E(G)}. Note that we require a lot
more than that Aiis independent of each of the Ajin this subset.
Theorem 3.6. LetGbe some dependency graph for the events
A1,...,An. Suppose that Pr[Ai]≤p,i=1,...,nand that every
vertex inGhas degree ≤d.I f4dp< 1, then∩AiLnegationslash=∅.
Proof: We ﬁrst show that for every subset {i1,i2,...,im}of the
index set,
(3.6) Pr[Ai1|Ai2...Aim]≤1
2d.
The casem= 1 is trivial and for m= 2 we have
Pr[A1|A2]≤p1
1−p2≤1
4d−1<1
2d,
where for convenience of notation we have taken ij=jandpi:=
Pr[Ai]. We proceed by induction.
Suppose that in G, 1 is adjacent to 2 ,3,...,q and not adjacent
toq+1,...,m . We have
Pr[A1|A2...Am]=Pr[A1A2...Aq|Aq+1...Am]
Pr[A2...Aq|Aq+1...Am].
---PAGE BREAK---
32 A Course in Combinatorics
The numerator is (by deﬁnition of G) at most
Pr[A1|Aq+1...Am]=Pr [A1]≤1
4d.
Using the induction hypothesis, we ﬁnd that the denominator is at
least
1−q/summationdisplay
i=2Pr[A1|Aq+1...Am]≥1−q−1
2d≥1
2.
This proves (3.6). We now have
Pr[A1...An]=n/productdisplay
i=1Pr[Ai|A1...Ai−1]≥(1−1
2d)n>0,
where we have used (3 .6) for each term in the product. /square
We apply this method to obtain a lower bound for N(p,p; 2).
Theorem 3.7. N(p,p;2 )≥c·p·2p/2, wherecis a constant.
Proof: ConsiderKnand color the edges randomly with two col-
ors. For each set Sofkvertices let ASbe the event that the
subgraph on Sis colored monochromatically. We wish to assert
that among the random colorings, there is at least one in which nomonochromatic subgraph on kvertices occurs. We deﬁne a depen-
dency graph by making SandTadjacent if and only if |S∩T|≥2,
i.e. the subgraphs on SandThave an edge in common. The degree
dofGis clearly at most/parenleftbig
k
2/parenrightbig/parenleftbign
k−2/parenrightbig
. The events ASall have prob-
ability 21−(k
2). From Theorem 3.6, Stirling’s formula and a little
manipulation, we ﬁnd the result (and if we wish an estimate for c).
/square
We have given some examples of an area of combinatorics known
as Ramsey theory. We just mention one more example, namelya theorem due to B. L. van der Waerden (1927). It states thatthere exists a number N(r) such that if N≥N(r) and the integers
from 1 toNare colored red or blue, then there is a monochromatic
arithmetic progression of length rin the set. For a short (but not
easy) proof see Graham and Rothschild (1974). A general reference
---PAGE BREAK---
3. Colorings of graphs and Ramsey’s theorem 33
for this area is the book Ramsey Theory by R. L. Graham, B. L.
Rothschild and J. L. Spencer (1980).
An interesting application of Ramsey’s theorem is the following
theorem due to Erd˝ os and Szekeres (1935).
Theorem 3.8. For a given n, there is an integer N(n)such that
any collection of N≥N(n)points in the plane, no three on a line,
has a subset of npoints forming a convex n-gon.
Proof: (i) First we observe that if we have npoints, no three on a
line, then they form a convex n-gon if and only if every quadrilateral
formed by taking four of the points is convex.
(ii) We now claim that N(n)=N(n,n; 3) will do the job. Let
Sbe a set of N(n) points. Number the points and then color tri-
angles red, respectively blue, if the path from the smallest number
via the middle one to the largest number is clockwise, respectivelycounterclockwise. There is an n-subset with all its triangles the
same color, say red. We shall show that this set cannot contain theconﬁguration of Fig. 3.2.
Figure 3.2
Without loss of generality a<b<c . From triangle adc, we see
thata<d<c . Then from triangle abdit follows that a<b<d .
But then triangle bcdis blue, a contradiction. So all quadrilaterals
formed from the n-subset are convex and by (i), we are done. /square
Problem 3E. Atournament onnvertices is an orientation of Kn.
Atransitive tournament is a tournament for which the vertices can
be numbered in such a way that ( i,j) is an edge if and only if i<j.
(a) Show that if k≤log2n, every tournament on nvertices has
a transitive subtournament on kvertices.
(b) Show that if k>1+2l o g2n, there exists a tournament on n
vertices with no transitive subtournament on kvertices.
---PAGE BREAK---
34 A Course in Combinatorics
Problem 3F. Prove that for all r∈Nthere is a minimal number
N(r) with the following property. If n≥N(r) and the integers in
{1,2,...,n}are colored with rcolors, then there are three elements
x,y,z (not necessarily distinct) with the same color and x+y=z.
(A result due to I. Schur.) Determine N(2). Show by an elementary
argument that N(3)>13.
Problem 3G. Letmbe given. Show that if nis large enough,
everyn×n(0,1)-matrix has a principal submatrix of size m,i n
which all the elements below the diagonal are the same, and all the
elements above the diagonal are the same.
Problem 3H. Show that if the edges of K17are colored with three
colors, there must be a monochromatic triangle.
Problem 3I. Let{1,α,α2,...,α14}be the multiplicative group
ofF16. Number the vertices of K16with the elements of F16.W e
will color the edges of K16with three colors. Edge {i,j}is to be
colored with a color that depends only on ν, wherei−j=αν.D o
this in such a way that there is nomonochromatic triangle. (In the
notation of Theorem 3.3, this problem and the previous one show
thatN(3,3,3; 2) = 17.)
Problem 3J. The edges of Knare colored red and blue in such a
way that a red edge is in at most one red triangle. Show that thereis a subgraph K
kwithk≥⌊√
2n⌋that contains nored triangle.
Problem 3K. LetGsatisfy the conditions of Theorem 3.1. Show
that by removing at most n/dedges we can ﬁnd a subgraph GLprime
with chromatic number ≤d−1.
Notes.
The four color conjecture was considered one of the most famous
open problems in combinatorics until 1976. Its solution by Appeland Haken has caused much debate because the proof depends onan extensive computer analysis of many cases. The validity of theargument depends on one’s trust in computers and programs. (SeeChapter 34 for two proofs of the Five Color Theorem.)
The theorem by Brooks, Theorem 3.1, which he discovered while
an undergraduate at Cambridge, is a typical example of the inge-
---PAGE BREAK---
3. Colorings of graphs and Ramsey’s theorem 35
nious arguments that are quite often necessary in that part of graph
theory where algebraic methods do not apply.
F. P. Ramsey (1902–1928) died too young to produce the results
that he probably would have. He was interested in decision pro-cedures for logical systems and, strangely enough, this led to thetheorem that in turn led to so-called Ramsey theory.
Theorem 3.5 is due to P. Erd˝ os (1947). For more on probabilistic
methods, see Erd˝ os and Spencer (1974).
Values of and estimates for the numbers N(p,q; 2) can be found
in Radziszowski (1999). The value of N(3,9; 2) is from Grinstead
and Roberts (1982).
The proof of Theorem 3.6 is not the original proof by Erd˝ os and
Szekeres that one usually ﬁnds in books. This proof was producedby a student in Haifa (M. Tarsy) during an examination! He hadmissed the class in which the proof had been presented. See Lewin(1976). A proof in a similar vein was given by Johnson (1986).
References.
K. Appel and W. Haken (1977), Every planar map is four-color-
able,Illinois J. Math. 21, 429–567.
R. L. Brooks (1941), On colouring the nodes of a network, Cam-
bridge Philos. Soc. 37, 194–197.
P. Erd˝ os (1947), Some remarks on the theory of graphs, Bull. Amer.
Math. Soc. 53, 292–294.
P. Erd˝ os and J. L. Spencer (1974), Probabilistic Methods in Com-
binatorics , Academic Press.
P. Erd˝ os and G. Szekeres (1935), A combinatorial problem in ge-
ometry, Compositio Math. 2, 463–470.
R. L. Graham and B. L. Rothschild (1974), A short proof of van
der Waerden’s theorem on arithmetic progressions, Proc. Amer.
Math. Soc. 42, 385–386.
R. L. Graham, B. L. Rothschild, and J. L. Spencer (1980), Ramsey
Theory , Wiley.
C. M. Grinstead and S. M. Roberts (1982), On the Ramsey numbers
R(3,8) andR(3,9),J. Combinatorial Theory (B)33, 27–51.
S. Johnson (1986), A new proof of the Erd˝ os–Szekeres convex k-gon
result,J. Combinatorial Theory (A)42, 318–319.
---PAGE BREAK---
36 A Course in Combinatorics
M. Lewin (1976), A new proof of a theorem of Erd˝ os and Szekeres,
The Math. Gazette 60, 136–138, 298.
S. P. Radziszowski (1999), Small Ramsey Numbers, The Electronic
Journal of Combinatorics 1DS 1.
F. P. Ramsey (1930), On a problem of formal logic, Proc. London
Math. Soc. (2)30, 264–286.
B. L. van der Waerden (1927), Beweis einer Baudetschen Vermu-
tung,Nieuw Archief voor Wiskunde 15, 212–216.
---PAGE BREAK---
4
Tur´an’s theorem and
extremal graphs
As an introduction, we ﬁrst ask the question how many edges a
simple graph must have to guarantee that the graph contains atriangle . SinceK
m,mandKm,m+1 do not contain triangles, we see
that if the graph has nvertices, then ⌊n2/4⌋edges are not enough.
We claim that if there are more edges, then the graph contains atriangle (W. Mantel, 1907). The following proof is surprising. LetGhavenvertices, numbered from 1 to n, and no triangles. We
give vertex ia weightz
i≥0 such that/summationtextzi= 1 and we wish
to maximize S:=/summationtextzizj, where the sum is taken over all edges
{i,j}. Suppose that vertex kand vertex lare not joined. Let the
neighbors of khave total weight x, and those of ltotal weight y,
wherex≥y. Since (zk+pepsilonα)x+(zl−pepsilonα)y≥zkx+zly,w ed on o t
decrease the value of Sif we shift some of the weight of vertex l
to the vertex k. It follows that Sis maximal if all of the weight
is concentrated on some complete subgraph of G, i.e. on oneedge!
Therefore S≤1
4. On the other hand, taking all ziequal ton−1
would yield a value of n−2|E|forS. Therefore |E|≤1
4n2.
Note that Ramsey’s theorem states that if a graph on nvertices
hasn≥N(p,q; 2), then the graph either has a complete subgraph
onpvertices or a set of qvertices with no edges between them
(called an independent set). We now ask the question whether some
condition on the number of edges guarantees a Kpas a subgraph.
We saw above what the answer is for p= 3. We also already have
an idea of how to avoid a Kp. Divide the vertices into p−1 subsets
S1,...,Sp−1of almost equal size, i.e. rsubsets of size t+ 1 and
p−1−rsubsets of size t, wheren=t(p−1) +r,1≤r≤p−1.
Within each Sithere are no edges but every vertex in Siis joined to
---PAGE BREAK---
38 A Course in Combinatorics
every vertex in SjifiLnegationslash=j. (This is a complete multipartite graph .)
The number of edges is
M(n,p): =p−2
2(p−1)n2−r(p−1−r)
2(p−1).
Theorem 4.1. (Tur´ an, 1941 )If a simple graph on nvertices has
more than M(n,p)edges, then it contains a Kpas a subgraph.
Proof: The proof is by induction on t.I ft= 0, the theorem
is obvious. Consider a graph Gwithnvertices, no Kp, and the
maximum number of edges subject to those properties. Clearly G
contains a Kp−1(otherwise adding an edge would not produce a
Kp), sayH. Each of the remaining vertices is joined to at most
p−2 vertices of H. The remaining n−p+1 vertices do not contain
aKpas subgraph. Since n−p+1=(t−1)(p−1)+r, we can apply
the induction hypothesis to this set of points. So the number of
edges ofGis at most
M(n−p+1,p)+(n−p+ 1)(p−2) +/parenleftbiggp−1
2/parenrightbigg
and this number is equal to M(n,p). /square
Remark. The argument that was used for Mantel’s theorem would
show that if there is no Kp, then|E|≤p−2
2(p−1)n2.
Problem 4A. LetGbe a simple graph with 10 vertices and 26
edges. Show that Ghas at least 5 triangles. Can equality occur?
Tur´ an’s paper on graph theory that contains Theorem 4.1 is con-
sidered the starting point of what is now known as extremal graphtheory—see Bollob´ as (1978). A simple instance of an extremalproblem will ask for the maximum number of edges a graph with acertain property may have. The graphs whose number of edges is
maximum are called the extremal graphs with respect to the prop-
erty.
The extremal graphs for Tur´ an’s problem are onlythe complete
multipartite graphs described above. This follows from an analysisof the proof of Theorem 4.1; we ask the reader to do this at leastin the case p= 3 in the problem below.
---PAGE BREAK---
4. Tur´ an’s theorem 39
Problem 4B. Show that a simple graph on nvertices with ⌊n2/4⌋
edges and no triangles is a complete bipartite graph Kk,kifn=2k,
orKk,k+1ifn=2k+1 .
Problem 4C. If a simple graph on nvertices has eedges, then it
has at leaste
3n(4e−n2) triangles.
Thegirth of a graph Gis the size of a smallest polygon PninG.
(A forest has inﬁnite girth.) By deﬁnition, a graph is simple if and
only if it has girth ≥3. By Mantel’s theorem, a graph with more
thann2/4 edges has girth ≤3.
Theorem 4.2. Ifagraph Gonnverticeshasmorethan1
2n√n−1
edges, then Ghasgirth ≤4. Thatis, Gisnotsimpleorcontainsa
P3or aP4(a triangle or a quadrilateral ).
Proof: SupposeGhas girth ≥5. Lety1,y2,...,ydbe the vertices
adjacent to a vertex x, whered:= deg(x ). No two of these are
adjacent since Ghas no triangles. Moreover, no vertex (other than
x) can be adjacent to more than one of y1,...,ydsince there are no
quadrilaterals in G. Thus (deg( y1)−1)+···+(deg(yd)−1)+(d +1)
cannot exceed the total number nof vertices. That is,
/summationdisplay
yadjacent to xdeg(y )≤n−1.
Then
n(n−1)≥/summationdisplay
x/summationdisplay
yadjacent to xdeg(y )=/summationdisplay
ydeg(y )2
≥1
n/parenleftBigg/summationdisplay
ydeg(y )/parenrightBigg2
=1
n(2|E(G)|)2.
/square
The number1
2n√n−1 in Theorem 4.2 is only a bound—it is not
the exact answer for all n. Determination of the extremal graphs
for this problem (maximum number of edges subject to girth ≥5)
for all values of nis impossibly diﬃcult; a determination of the
graphs for which equality holds has, however, been almost possible.
---PAGE BREAK---
40 A Course in Combinatorics
Perhaps surprisingly, there are at most four graphs with n>2
vertices, girth ≥5, and1
2n√n−1 edges: The pentagon (n = 5),
the Petersen graph ( n= 10), one with n= 50, and possibly one
withn= 3250. See the notes and Chapter 21.
Problem 4D. SupposeGis regular of degree rand has girth g
or greater. Find a lower bound for |V(G)|. (Consider the cases g
even and odd separately.)
It is not so interesting to ask how many edges are required to
force a Hamiltonian circuit. But we can ask what bound on the
minimum degree will do the job.
Theorem 4.3. If a simple graph Gonnvertices has all vertices
of degree at least n/2, then it contains a Pnas a subgraph, i.e. it
has a Hamiltonian circuit.Proof: Suppose the theorem is not true and let Gbe a graph
satisfying the hypothesis for some nbut having no Hamiltonian
circuits. We may take Gto be such a counterexample with the
maximum number of edges; then the addition of any edge to G(i.e.
joining two nonadjacent vertices by an edge) creates a Hamiltonian
circuit.
Letyandzbe nonadjacent vertices. Since adding {y,z}creates
a Hamiltonian circuit, there exists a simple path from ytozwith
vertex terms, y=x
1,x2,...,xn=z, say. The sets
{i:yis adjacent to xi+1}
and
{i:zis adjacent to xi}
each have cardinality ≥n/2 and are contained in {1,2,3,...,n−1},
so they must meet; let i0belong to both. Then
y=x1,x2,...,xi0,z=xn,xn−1,...,xi0+1,x1=y
is the vertex sequence of a simple closed path of length ninG,
contradicting our choice of Gas a counterexample. /square
Theorem 4.3 is due to G. A. Dirac and is best possible at least
in the sense that it does not remain true if we replace n/2b y
---PAGE BREAK---
4. Tur´ an’s theorem 41
(n−1)/2. For example, the complete bipartite graphs Kk,k+1have
no Hamiltonian circuits. But it does admit improvements and
generalizations—see e.g. Lov´ asz (1979), Problem 10.21.
Problem 4E. A3×3×3 cube of cheese is divided into 27 1 ×1×1
small cubes. A mouse eats one small cube each day and an adjacent
small cube (sharing a face) the next day. Can the mouse eat the
center small cube on the last day?
Problem 4F. LetGbe a simple graph with nvertices. Prove: If
each vertex of Ghas degree ≥(n+1 )/2, then for any edge e, there
exists a Hamiltonian circuit of Gthat passes through e.
Problem 4G. Prove the remark following Theorem 4.1.
Problem 4H. Show that a graph on nvertices that does not
contain a circuit on four vertices has at mostn
4(1+√4n−3) edges.
Notes.
P. Tur´ an (1910–1976), one of the famous Hungarian mathemati-
cians of the 20th century, is best known for his work in analyticnumber theory and real and complex analysis.
For everyr≥2 andg≥2, there exists a graph that is regular of
degreerand has girth ≥g. See Lov´ asz (1979), Problem 10.12.
Analysis of the proof of Theorem 4.2 shows that a graph with
n>2 vertices, girth ≥5, and
1
2n√n−1 edges is regular of degree
k:=√n−1 and also that any two vertices are joined by a (unique)
path of length 2 if they are not adjacent. With the notation ofChapter 21, such a graph is an srg(n,k, 0,1) and the methods of
that chapter show that k=2,3,7,or 57. This was ﬁrst shown
in Hoﬀman and Singleton (1960) where in addition an examplewithk= 7 andn= 50 was described (that is now known as the
Hoﬀman-Singleton graph ). It is not known at this time whether
there exists an srg(3250, 57,0,1).
References.
B. Bollob´ as (1978), Extremal Graph Theory , Academic Press.
A. J. Hoﬀman and R. R. Singleton (1960), On Moore graphs with
diameters two and three, IBM J. Res. Develop. 4, 497–504.
---PAGE BREAK---
42 A Course in Combinatorics
L. Lov´ asz (1979), Combinatorial Problems and Exercises , North
Holland.
W. Mantel (1907), Problem 28, Wiskundige Opgaven 10, 60–61.
P. Tur´ an (1941), An extremal problem in graph theory (in Hungar-
ian),Mat. Fiz. Lapok 48, 435–452.
---PAGE BREAK---
5
Systems of distinct
representatives
We ﬁrst give two diﬀerent formulations of a theorem known as
P. Hall’s marriage theorem . We give a constructive proof and an
enumerative one. If Ais a subset of the vertices of a graph, then
denote by Γ( A) the set/uniontext
a∈AΓ(a). Consider a bipartite graph G
with vertex set X∪Y(every edge has one endpoint in Xand one
inY). Amatching inGis a subset E1of the edge set such that
no vertex is incident with more than one edge in E1.Acomplete
matching from XtoYis a matching such that every vertex in Xis
incident with an edge in E1. If the vertices of XandYare thought
of as boys and girls, respectively, or vice versa, and an edge ispresent when the persons corresponding to its ends have amicablefeelings towards one another, then a complete matching representsa possible assignment of marriage partners to the persons in X.
Theorem 5.1. A necessary and suﬃcient condition for there to
be a complete matching from XtoYinGis that|Γ(A)|≥|A|for
everyA⊆X.
Proof: (i) It is obvious that the condition is necessary.
(ii) Assume that |Γ(A)|≥| A|for everyA⊆X. Let|X|=n,
m<n , and suppose we have a matching Mwithmedges. We shall
show that a larger matching exists. (We mean larger in cardinality ;
we may not be able to ﬁnd a complete matching containing theseparticular medges.)
Call the edges of Mred and all other edges blue. Let x
0∈X
be a vertex not incident with an edge of the matching. We claimthat there exists a simple path (of odd length) starting with x
0and
a blue edge, using red and blue edges alternately, and terminating
---PAGE BREAK---
44 A Course in Combinatorics
with a blue edge and a vertex ynot incident with an edge of the
matching. If we ﬁnd such a path p, we are done because we obtain
a matching with m+ 1 edges by deleting the red edges of pfrom
Mand replacing them with the blue edges of p. In other words,
we switch the colors on the edges of p.
Since|Γ({x 0})|≥1, there is a vertex y1adjacent to x0(obviously
by a blue edge since x0is not incident with any red edges). If y1
is also not incident with any red edges, we have the required path
(of length one); if y1is incident with a red edge, let x1be the other
end of that red edge. Recursively, deﬁne x0,x1,...andy1,y2,...as
follows. If x0,x1,...,xkandy1,...,ykhave been deﬁned, then since
|Γ({x 0,x1,...,xk})|≥k +1, there exists a vertex yk+1, distinct from
y1,...,yk, that is adjacent to at least one vertex in {x0,x1,...,xk}.
Ifyk+1is not incident with a red edge, stop; otherwise, let xk+1be
the other end of that red edge.
When the procedure terminates, we construct the path pby start-
ing withyk+1and the blue edge joining it to, say, xi1,i1<k+1 .
Then add the red edge {xi1,yi1}. By construction, yi1is joined by
an edge (necessarily blue) to some xi2,i2<i1. Then add the red
edge{xi2,yi2}. Continue in this way until x0is reached. /square
Problem 5A. Aperfect matching in a graph G(not necessarily
bipartite) is a matching so that each vertex of Gis incident with
one edge of the matching. (i) Show that a ﬁnite regular bipartite
graph (regular of degree d>0) has a perfect matching. (ii) Find a
trivalent (regular of degree 3) simple graph which does not have aperfect matching. (iii) Suppose Gis bipartite with vertices X∪Y
(every edge having one end in Xand one in Y). Further assume
that every vertex in Xhas the same degree s>0 and every vertex
inYhas the same degree t. (This condition is called semiregular-
ity.) Prove: If |X|≤|Y|(equivalently, if s≥t), then there is a
complete matching MofXintoY.
Example 5.1. A parlor trick involving a standard deck of 52 cards
is as follows. You are dealt ﬁve cards at random. You keep one andput the other four (in a speciﬁc order) into an envelope which istaken to your partner in another room. Your partner looks at theseand announces the name of the ﬁfth card, that you had retained.
Using the values of suits and ranks, it is possible to think of clever
---PAGE BREAK---
5. Systems of distinct representatives 45
or relatively simple ways to determine which card to keep and which
to pass, and for the partner to determine the retained card; seethe notes. Ignoring complexity of solution, however, the relevantgeneral mathematical problem, stated for a deck of Ncards, is
does there exist an injective mapping ffrom the set Xof the/parenleftbig
N
5/parenrightbig
5-element subsets of the Ncards into the set YofN(N−1)(N−
2)(N−3) ordered 4-tuples of distinct cards, subject to the condition
that iff(S)=(c1,c2,c3,c4), then{c1,c2,c3,c4}⊆S .
In terms of matchings, we consider the bipartite graph Gwhose
vertices are X∪Yas deﬁned above, and where there is an edge
joiningS∈Xto{c1,c2,c3,c4}∈Y exactly when {c1,c2,c3,c4}⊆
S. We require a complete matching MofXintoY. The reader
may check that Gis semiregular and that |X|≤|Y|if and only if
N≤124. So by Problem 5A(iii), for N≤124, there exists such a
matching.
We now reformulate Theorem 5.1 in terms of sets and not only
prove the theorem but also give a lower bound for the number ofmatchings. We consider subsets A
0,A1,...,An−1of a ﬁnite set S.
We shall say that this collection has property H(Hall’s condition)
if (for allk) the union of any k-tuple of subsets Aihas at least k
elements. If the union of some k-tuple of subsets contains exactly
kelements (0 <k<n ), then we call this k-tuple a critical block.
We deﬁne a system of distinct representatives (SDR) of the sets
A0,...,An−1to be a sequence of ndistinct elementsa0,...,an−1
withai∈Ai,0≤i≤n−1.
Letm0≤m1≤···≤mn−1. We deﬁne
Fn(m0,m1,...,m n−1): =n−1/productdisplay
i=0(mi−i)∗,
where (a) ∗:= max{1,a }.
From now on, we assume that the sequence mi:=|Ai|is nonde-
creasing.
For the proof of the main theorem, we need a lemma.
Lemma 5.2. Forn≥1, letfn:Zn→Nbe deﬁned by
fn(a0,a1,...,an−1): =Fn(m0,m1,...,m n−1)
---PAGE BREAK---
46 A Course in Combinatorics
if(m0,...,m n−1)is a nondecreasing rearrangement of the n-tuple
(a0,...,an−1). Thenfnisnondecreasingwithrespecttoeachofthe
variablesai.
Proof: Let
m0≤···≤mk−1≤ai=mk≤mk+1≤···
≤ml≤ml+1≤···≤mn−1
be a nondecreasing rearrangement of (a 0,...,an−1). IfaLprime
i≥aiand
m0≤···≤mk−1≤mk+1≤···≤ml≤aLprime
i≤ml+1≤···≤mn−1
is a nondecreasing rearrangement of (a 0,...,ai−1,aLprime
i,ai+1,...,an−1)
then
fn(a0,...,ai−1,aLprimei,ai+1,...,an−1)
fn(a0,...,an−1)=
=(mk+1−k)∗
(ai−k)∗·(aLprimei−l)∗
(ml−l)∗l−1/productdisplay
j=k+1(mj+1−j)∗
(mj−j)∗
and this is ≥1 sinceai≤mk+1,aLprimei≥ml, andmj+1≥mjfor
j=k+1,...,l−1. /square
We now come to the second form of Hall’s theorem. We denote
byN(A0,...,An−1) the number of SDRs of (A 0,...,An−1).
Theorem 5.3. Let(A0,...,An−1)beasequenceofsubsetsofaset
S.Le tmi:=|Ai|(i=0,...,n−1)andletm0≤m1≤···≤mn−1.
If the sequence has property H, then
N(A0,...,An−1)≥Fn(m0,...,m n−1).
Proof: The proof is by induction. Clearly the theorem is true for
n= 1. We distinguish two cases.
Case 1. There is no critical block. In this case, we choose any
elementaofA0as its representative and then remove afrom all the
other sets. This yields sets, that we call A1(a),...,A n−1(a), and
---PAGE BREAK---
5. Systems of distinct representatives 47
for these sets property Hstill holds. By the induction hypothesis
and by the lemma, we ﬁnd
N(A0,...,An−1)≥/summationdisplay
a∈A0fn−1(|A1(a)|,...,|An−1(a)|)
≥/summationdisplay
a∈A0fn−1(m1−1,...,m n−1−1)
=m0fn−1(m1−1,...,m n−1−1)
=Fn(m0,m1,...,m n−1).
Case 2. There is a critical block (A ν0,...,Aνk−1) withν0<···<
νk−1and 0<k<n . In this case, we delete all elements of Aνo∪
···∪Aνk−1from all the other sets Aiwhich produces ALprime
µ0,...,ALprimeµ
l−1,
where{ν0,...,νk−1,µ0,...,µl−1}={0,1,...,n−1},k +l=n.
Now both ( Aν0,...,Aνk−1) and (ALprimeµ
0,...,ALprimeµ
l−1) satisfy property
Hand SDRs of the two sequences are always disjoint. Hence by
the induction hypothesis and the lemma, we have
N(A0,...,An−1)=N (Aν0,...,Aνk−1)N(ALprime
µ0,...,ALprimeµ
l−1)(5.1)
≥fk(mν0,...,m νk−1)fl(|ALprimeµ
0|,...,|ALprimeµ
l−1|)
≥fk(mν0,...,m νk−1)fl(mµ0−k,...,m µl−1−k)
≥fk(m0,...,m k−1)fl(mµ0−k,...,m µl−1−k).
Now we remark that
mνk−1≤|Aν0∪···∪A νk−1|=k,
and therefore we have
(mr−r)∗=1 i f k≤r≤νk−1,
and
(mµi−k−i)∗=1 i f µi≤νk−1.
This implies that
fk(m0,...,m k−1)=/productdisplay
0≤i≤νk−1(mi−i)∗,
fl(mµ0−k,...,m µl−1−k)=/productdisplay
νk−1<j<n(mj−j)∗,
---PAGE BREAK---
48 A Course in Combinatorics
i.e. the product (5.1) is equal to Fn(m0,...,m n−1), which proves
the theorem. /square
Problem 5B. Show that Theorem 5.3 gives the best lower bound
for the number of SDRs of the sets Aithat only involves the num-
bers|Ai|.
We now come to a theorem known as K¨ onig’s theorem. It is
equivalent (whatever that means) to Hall’s theorem. In the theo-
rem,Ais a (0,1)-matrix with entries aij.B yaline, we mean a row
or a column of A.
Theorem 5.4. The minimum number of lines of Athat contain
all the 1’s ofAis equal to the maximum number of 1’s inA,n o
two on a line.
Proof: Letmbe the minimum number of lines of Acontaining all
the 1’s of Aand letMbe the maximum number of 1’s, no two on
a line. Clearly m≥M. Let the minimum covering by lines consist
ofrrows andscolumns (r +s=m). Without loss of generality,
these are the ﬁrst rrows and the ﬁrst scolumns. We now deﬁne
setsAi,1≤i≤r,b yAi:={j>s :aij=1}. If some k-tuple of
theAi’s contained less than kelements, then we could replace the
corresponding krows byk−1 columns, still covering all the 1’s.
Since this is impossible, we see that the Ai’s satisfy property H.S o
theAi’s have an SDR. This means that there are r1’s, no two on a
line, in the ﬁrst rrows and not in the ﬁrst scolumns. By the same
argument there are s1’s, no two on a line, in the ﬁrst scolumns
and not in the ﬁrst rrows. This shows that M≥r+s=mand
we are done. /square
The following theorem of G. Birkhoﬀ is an application of Hall’s
theorem.Theorem 5.5. LetA=(a
ij)beann×nmatrixwithnonnegative
integers as entries, such that every row and column of Ahas sum
l. ThenAis the sum of lpermutation matrices.
Proof: DeﬁneAi,1≤i≤n,b yAi:={j:aij>0}. For any
k-tuple of the Ai’s, the sum of the corresponding rows of Aiskl.
Since every column of Ahas suml, the nonzero entries in the
---PAGE BREAK---
5. Systems of distinct representatives 49
chosenkrows must be in at least kcolumns. Hence the Ai’s satisfy
propertyH. An SDR of the Ai’s corresponds to a permutation
matrixP=(pij) such that aij>0i fpij= 1. The theorem now
follows by induction on l. /square
Problem 5C. In the hypothesis of Theorem 5.5, we replace ‘inte-
gers’ by ‘reals’. Show that in this case, Ais a nonnegative linear
combination of permutation matrices. (Equivalently, every dou-
bly stochastic matrix—see Chapter 11—is a convex combination of
permutation matrices.)
Problem 5D. LetSbe the set {1,2,...,mn }. We partition Sinto
msetsA1,...,Amof sizen. Let a second partitioning into msets
of sizenbeB1,...,Bm. Show that the sets Aican be renumbered
in such a way that Ai∩BiLnegationslash=∅.
Problem 5E. LetAi={i−1,i,i+1}∩{1,2,...,n},i=1,2,...,n .
LetSndenote the number of SDR’s of the collection {A1,...,An}.
Determine Snand lim n→∞S1/n
n.
LetGbe a bipartite graph, ﬁnite or inﬁnite; say the vertex set
is partitioned into sets X,Y of vertices so that every edge of Ghas
one end in Xand one end in Y. We say that a matching MinG
covers a subsetSof the vertices when every vertex in Sis incident
with one of the edges in M.
Theorem 5.6. If there exists a matching M1that covers a subset
X0ofXand there exists a matching M2that covers a subset Y0of
Y, then there exists a matching M3that covers X0∪Y0.
Proof: Think of the edges of M1as ‘red edges’ and the edges of
M2as ‘blue edges’. If an edge belongs to both M1andM2,i ti s
‘purple’.
A connected graph all of whose vertices have degree at most
two is easily seen to be one of: a ﬁnite path-graph (allowing the
trivial case of length 0, when the component has one vertex andno edges), a ﬁnite polygon, an inﬁnte ‘one-sided’ path-graph (withone monovalent vertex), or an inﬁnite ‘two-sided’ path-graph. ThegraphHwhose vertices are those of Gand whose edges M
1∪M2
has the property that every vertex has degree at most two, so itsconnected components are of the types enumerated above. The
---PAGE BREAK---
50 A Course in Combinatorics
edges of any of these components, other than the graphs consisting
of a purple edge and its two ends, are alternately colored red andblue; in particular, all polygons have even length. Every vertex ofX
0∪Y0is in one of these nontrivial components.
For the matching M3, we will take all purple edges, and either
all red edges or all blue edges from every other component of H.
From the cycles and inﬁnite two-sided paths, it doesn’t matter;take all red or all blue edges, and they will cover all vertices of thecomponent. From the paths of odd length and inﬁnite one-sidedpaths, take all red or blue edges depending on whether the ﬁrstedge is red or blue (for a path of odd length, the ﬁrst and last edgehave the same color, so it doesn’t matter what side you start on).Again, the selected edges will cover all vertices of the component.
We have to think just a tiny bit harder for a component that is a
ﬁnite path Pof even length, with vertices v
0,v1,...,vk, say. There
is an odd number of vertices and they alternate between XandY,
sov0andvkare both in Xor both in Y. If they are both in X,
take all red edges of P(those ofM1) and put them in M3; if they
are both in Y, take all blue edges of Pand put them in M3. Only
one end of the path is not covered by the chosen edges.
Consider the case that both v0,vk∈X(the case when they are
inYis completely analogous). If the ﬁrst edge of Pis red, then the
last is blue and it follows that vk/∈X0since no edge of M1covers
vk. Thus the red edges of Pstill cover all vertices of X0andY0that
were inP. Similarly, if the ﬁrst edge of Pis blue, then v0/∈X0and
the red edges of Pstill cover all vertices of X0andY0that were in
P. /square
For the case X0=X,Y0=Y, and when the graph Gis complete
bipartite, matchings that cover X0orY0correspond to, or can be
interpreted as, injective mappings X→YorY→X, respectively.
Theorem 5.6 says:
Corollary. IfXandYare sets and there exist injective map-
pingsf:X→Yandg:Y→X, then there exists a bijective
mapping from XtoY, or fromYtoX, i.e. there is a one-to-one
correspondence between the two sets.
In terms of ‘cardinality’ of sets, this says that if |X|≤|Y|and
---PAGE BREAK---
5. Systems of distinct representatives 51
|Y|≤|X|, then|X|=|Y|. This is the Schr¨ oder-Bernstein Theo-
rem; see Section 22 of P. R. Halmos (1974). It is trivial for ﬁnite
sets, of course.
Problem 5F. LetA1,A2,...,Anbe ﬁnite sets. Show that if
/summationdisplay
1≤i<j≤n|Ai∩Aj|
|Ai|·|Aj|<1,
then the sets A1,A2,...Anhave a system of distinct representatives.
Problem 5G. (i) From Problem 5A we know that a bipartite
graph on 2 nvertices that is regular of degree 3 has a perfect match-
ing. How many diﬀerent perfect matchings are there if n= 4? (ii)
The same question for a bipartite graph on 10 vertices that is reg-
ular of degree 4.
Notes.
Philip Hall published his result in 1935 (with a rather diﬃcult
proof). The proof that we gave is a generalization of ideas of Hal-
mos and Vaughan, Rado, and M. Hall. The proof is due to Ostrand(1970) and Hautus and Van Lint (1972). See Van Lint (1974). Theproblem of complete matchings is often referred to as the marriage
problem .
D. K¨ onig (1884–1944) was professor at Budapest. He wrote the
ﬁrst comprehensive treatise on graph theory (Theorie der endlichenund unendlichen Graphen, 1936). K¨ onig (1916) contains the ﬁrstproof of (one of the theorems called) K¨ onig’s theorem.
Just before Theorem 5.4, we referred to the ‘equivalence’of these
theorems. This expression is often used when each of two theoremsis more or less an immediate consequence of the other.
The theorem by Birkhoﬀ (1946), i.e. Theorem 5.5, is extremely
useful and will be applied a number of times in later chapters.
For the card problem mentioned in Example 5.1, here is one so-
lution. In a set of ﬁve cards, some suit must be represented atleast twice. The ﬁrst card you pass to your partner should bethe ‘larger’ of two cards of the same suit, and you will retain the‘smaller’, where we think of the ranks 2 ,3,..., 10,J,Q,K,A as ar-
ranged clockwise on a circle (modulo 13), and by ‘smaller’ we mean
---PAGE BREAK---
52 A Course in Combinatorics
the card from which we must travel the least distance clockwise
to get to the other. For example, if S={3♠,Q♦,6♣,3♦,7♠},
you pass either the 7♠ or 3♦ to your partner. This already tells
your partner the suit of the retained card and limits that card tosix possibilities in that suit. To determine how far to count back(counterclockwise) from the rank of the ﬁrst card, you and yourpartner use the order of the remaining three cards (the 52 cards
are ordered lexicographically), and agree on some correspondencebetween the six permutations of three objects and the integers from1t o6 .
References.
G. Birkhoﬀ (1946), Tres observaciones sobre el algebra lineal, Univ.
Nac. Tucum´ an, Rev. Ser. A,5, 147–151.
P. Hall (1935), On representatives of subsets, J. London Math. Soc.
10, 26–30.
P. R. Halmos (1974), Naive Set Theory, Springer-Verlag.
D. K¨ onig (1916), ¨Uber Graphen und ihre Anwendung auf Determi-
nantentheorie und Mengenlehre, Math. Annalen 77, 453–465.
J. H. van Lint (1974), Combinatorial Theory Seminar Eindhoven
University of Technology , Lecture Notes in Mathematics 382,
Springer-Verlag.
P. Ostrand (1970), Systems of distinct representatives, J. of Math.
Analysis and Applic. 32,1 – 4 .
---PAGE BREAK---
6
Dilworth’s theorem and
extremal set theory
Apartially ordered set (alsoposet) is a set Swith a binary relation
≤(sometimes ⊆is used) such that:
(i)a≤afor alla∈S(reﬂexivity),
(ii) ifa≤bandb≤cthena≤c(transitivity),
(iii) ifa≤bandb≤athena=b(antisymmetry).
If for any aandbinS, eithera≤borb≤a, then the partial
order is called a total order, or a linear order. Ifa≤bandaLnegationslash=b,
then we also write a<b . Examples of posets include the integers
with the usual order or the subsets of a set, ordered by inclusion.
If a subset of Sis totally ordered, it is called a chain.A n antichain
is a set of elements that are pairwise incomparable.
The following theorem is due to R. Dilworth (1950). This proof
is due to H. Tverberg (1967).
Theorem 6.1. LetPbe a partially ordered ﬁnite set. The min-
imum number mof disjoint chains which together contain all ele-
ments ofPis equal to the maximum number Mof elements in an
antichain of P.
Proof: (i) It is trivial that m≥M.
(ii) We use induction on |P|.I f|P|= 0, there is nothing to
prove. Let Cbe a maximal chain in P. If every antichain in P\C
contains at most M−1 elements, we are done. So assume that
{a1,...,aM}is an antichain in P\C. Now deﬁne S−:={x∈P:
∃i[x≤ai]}, and deﬁne S+analogously. Since Cis a maximal chain,
the largest element in Cis not inS−and hence by the induction
hypothesis, the theorem holds for S−. HenceS−is the union of M
disjoint chains S−
1,...,S−
M, whereai∈S−
i. Suppose x∈S−
iand
---PAGE BREAK---
54 A Course in Combinatorics
x>ai. Since there is a jwithx≤aj, we would have ai<aj,
a contradiction. This shows that aiis the maximal element of the
chainS−
i,i=1,...,m . We do the same for S+. By combining the
chains the theorem follows. /square
A ‘dual’ to Dilworth’s theorem was given by Mirsky (1971).
Theorem 6.2. LetPbeapartiallyorderedset. If Ppossessesno
chain ofm+1elements, then Pis the union of mantichains.
Proof: Form= 1 the theorem is trivial. Let m≥2 and assume
that the theorem is true for m−1. LetPbe a partially ordered set
that has no chain of m+ 1 elements. Let Mbe the set of maximal
elements of P.Mis an antichain. Suppose x1<x 2<···<xm
were a chain in P\M. Then this would also be a maximal chain in
Pand hence we would have xm∈M, a contradiction. Hence P\M
has no chain of melements. By the induction hypothesis, P\Mis
the union of m−1 antichains. This proves the theorem. /square
The following famous theorem due to Sperner (1928) is of a sim-
ilar nature. This proof is due to Lubell (1966).
Theorem 6.3. IfA1,A2,...,Amare subsets of N:={1,2,...,n}
such that Aiis not a subset of AjifiLnegationslash=j, thenm≤/parenleftbign
⌊n/2⌋/parenrightbig
.
Proof: Consider the poset of subsets of N.A:={A1,...,Am}is
an antichain in this poset.
A maximal chain Cin this poset will consist of one subset of each
cardinality 0 ,1,...,n , and is obtained by starting with the empty
set, then any singleton set ( nchoices), then any 2-subset containing
the singleton (n −1 choices), then any 3-subset containing the 2-
subset (n −2 choices), etc. Thus there are n! maximal chains.
Similarly, there are exactly k!(n−k)! maximal chains which contain
a givenk-subsetAofN.
Now count the number of ordered pairs ( A,C) such that A∈A,
Cis a maximal chain, and A∈C. Since each maximal chain C
contains at most one member of an antichain, this number is at
mostn!. If we let αkdenote the number of sets A∈Awith|A|=k,
then this number is/summationtextn
k=0αkk!(n−k)!. Thus
n/summationdisplay
k=0αkk!(n−k)!≤n!, or equivalently,n/summationdisplay
k=0αk/parenleftbign
k/parenrightbig≤1.
---PAGE BREAK---
6. Dilworth’s theorem and extremal set theory 55
Since/parenleftbign
k/parenrightbig
is maximal for k=⌊n/2⌋ and/summationtextαk=m, the result
follows. /square
Equality holds in Theorem 6.3 if we take all ⌊n/2⌋-subsets of N
as the antichain.
We now consider the poset Bn(with 2nelements) of the subsets
of then-setN, ordered by inclusion. The set of i-subsets of Nis
denoted by Ai. We deﬁne a symmetric chain inBnto be a sequence
Pk,Pk+1,...,Pn−kof vertices such that Pi∈AiandPi⊆Pi+1for
i=k,k+1,...,n−k−1. We describe an algorithm due to De
Bruijn, Van Ebbenhorst Tengbergen and Kruyswijk (1949), that
splitsBninto (disjoint) symmetric chains.
Algorithm: Start with B1. Proceed by induction. If Bnhas
been split into symmetric chains, then for each such symmetricchainP
k,...,Pn−kdeﬁne two symmetric chains in Bn+1, namely
Pk+1,...,Pn−kandPk,Pk∪{n+1},Pk+1∪{n+1},...,P n−k∪{n+1}.
It is easy to see that this algorithm does what we claim. Fur-
thermore it provides a natural matching between k-subsets and
(n−k)-subsets in Bn(cf. Theorem 5.1). Also, see Problem 6D
below.
Problem 6A. Leta1,a2,...,an2+1be a permutation of the inte-
gers 1, 2,...,n2+1. Show that Dilworth’s theorem implies that the
sequence has a subsequence of length n+ 1 that is monotone.
A nice direct proof of the assertion of Problem 6A is as follows.
Suppose there is no increasing subsequence of n+ 1 terms. De-
ﬁnebito be the length of the longest increasing subsequence that
starts with the term ai. Then by the pigeonhole principle, there are
at leastn+ 1 terms in the bi-sequence that have the same value.
Sincei<j andbi=bjimply that ai>aj, we have a decreasing
subsequence of n+ 1 terms.
To show a connection between Chapters 5 and 6, we now prove
that Theorem 5.1 immediately follows from Theorem 6.1. We
consider the bipartite graph Gof Theorem 5.1. Let |X|=n,
|Y|=nLprime≥n. We introduce a partial order by deﬁning xi<yj
if and only if there is an edge from vertex xito vertexyj. Suppose
that the largest antichain contains selements. Let this antichain be
{x1,...,xh,y1,...,yk}, whereh+k=s. Since Γ( {x1,...,xh})⊆
---PAGE BREAK---
56 A Course in Combinatorics
Y\{y1,...,yk}, we have h≤nLprime−k. Hences≤nLprime. The partially
ordered set is the union of sdisjoint chains. This will consist of
a matching of size a, the remaining n−aelements of X, and the
remaining nLprime−aelements of Y. Therefore n+nLprime−a=s≤nLprime, i.e.
a≥n, which means that we have a complete matching.
Theorem 6.3 is a (fairly easy) example of an area known as ex-
tremal set theory in which the problems are often quite diﬃcult.
We ﬁrst give one more example as an easy exercise.
Problem 6B. Let the sets Ai,1≤i≤k, be distinct subsets of
{1,2,...,n}. Suppose Ai∩AjLnegationslash=∅for alliandj. Show that
k≤2n−1and give an example where equality holds.
We now give one more example of the method that we used to
prove Sperner’s theorem. We prove the so-called Erd˝ os–Ko–Rado
theorem (1961).
Theorem 6.4. LetA={A1,...,Am}beacollectionof mdistinct
k-subsets of {1,2,...,n}, wherek≤n/2, with the property that
any two of the subsets have a nonempty intersection. Then m≤/parenleftbign−1
k−1/parenrightbig
.
Proof: Place the integers 1 to non a circle and consider the family
F:={F1,...,Fn}of all consecutive k-tuples on the circle, i.e. Fi
denotes{i,i+1,...,i +k−1}where the integers should be taken
modn. We observe that |A∩F|≤ kbecause if some FiequalsAj,
then at most one of the sets {l,l+1,...,l +k−1},{l−k,...,l−1}
(i<l<i +k)i si nA . The same assertion holds for the collection
Fπobtained from Fby applying a permutation πto{1,...,n}.
Therefore
Σ: =/summationdisplay
π∈Sn|A∩Fπ|≤k·n!.
We now count this sum by ﬁxing Aj∈A,Fi∈Fand observing
that there are k!(n−k)! permutations πsuch thatFπ
i=Aj. Hence
Σ=m·n·k!(n−k)!. This proves the theorem. /square
By a slight modiﬁcation of the proof, one can show that the
theorem also holds if the sets in Aare assumed to have size at
mostkand they form an antichain. However we shall give a proof
using Theorem 5.1.
---PAGE BREAK---
6. Dilworth’s theorem and extremal set theory 57
Theorem 6.5. LetA={A1,...,Am}beacollectionof msubsets
ofN:={1,2,...,n}such that Ai/notsubseteqlAjandAi∩AjLnegationslash=∅ifiLnegationslash=j
and|Ai|≤k≤n/2for alli. Thenm≤/parenleftbign−1
k−1/parenrightbig
.
Proof: (i) If all the subsets have size k, then we are done by
Theorem 6.4.
(ii) LetA1,...,Asbe the subsets with the smallest cardinality,
sayl≤n
2−1. Consider all the ( l+ 1)-subsets BjofNthat contain
one or more of the sets Ai,1≤i≤s. Clearly none of these is in A.
Each of the sets Ai,1≤i≤s, is in exactly n−lof theBj’s and
eachBjcontains at most l+1≤n−lof theAi’s. So by Theorem
5.1, we can pick sdistinct sets, say B1,...,Bs, such that Ai⊆Bi.
If we replace A1,...,AsbyB1,...,Bs, then the new collection ALprime
satisﬁes the conditions of the theorem and the subsets of smallest
cardinality now all have size >l. By induction, we can reduce to
case (i). /square
By replacing the counting argument of the proof of Theorem 6.4
by an argument in which the subsets are counted with weights, wecan prove the following generalization due to B. Bollob´ as (1973).
Theorem 6.6. LetA={A
1,...,Am}beacollectionof mdistinct
subsetsof {1,2,...,n},where|Ai|≤n/2fori=1,...,m,withthe
propertythatanytwoofthesubsetshaveanonemptyintersection.
Thenm/summationdisplay
i=11/parenleftbign−1
|Ai|−1/parenrightbig≤1.
Proof: Letπbe a permutation of 1 ,2,...,n placed on a circle
and let us say that Ai∈πif the elements of Aioccur consecutively
somewhere on that circle. By the same argument as in the proofof Theorem 6.4 we see that if A
i∈π, thenAj∈πfor at most |Ai|
values ofj.
Now deﬁne
f(π,i): =/braceleftbigg1
|Ai|,ifAi∈π
0, otherwise.
By the argument above/summationtext
π∈Sn/summationtextm
i=1f(π,i)≤n!.Changing the
order of summation we have to count, for a ﬁxed Ai, the number of
permutations πplaced on a circle such that Ai∈π. This number
---PAGE BREAK---
58 A Course in Combinatorics
(by the same argument as in Theorem 6.4) is n·|Ai|!(n−|Ai|)!. So
we havem/summationdisplay
i=11
|Ai|·n·|Ai|!(n−|Ai|)!≤n!,
which yields the result. /square
Problem 6C. LetA={A1,...,Am}be a collection of mdistinct
subsets of N:={1,2,...,n}such that if iLnegationslash=jthenAi/notsubseteqlAj,
Ai∩AjLnegationslash=∅,Ai∪AjLnegationslash=N. Prove that
m≤/parenleftbiggn−1
⌊n
2⌋−1/parenrightbigg
.
Problem 6D. Consider the decomposition of Bninto symmetric
chains as described above. Show that Theorem 6.3 is an immediate
consequence of this decomposition. Show that Theorem 6.5 reducesto Theorem 6.4 via this decomposition. How many of the chainshave their smallest element in A
i?
Problem 6E. Here is an algorithm to construct a symmetric chain
in the poset Bnwhich contains a given element S(a subset of
{1,2,...,n}). Consider the characteristic vector xofS; for ex-
ample, if n= 7 and S={3,4,7}, thenx= 0011001. Mark
all consecutive pairs 10, temporarily delete these pairs and againmark all consecutive pairs 10, and repeat until only a string of theform 00···01···11 remains. In our example, we obtain 00 ˙1˙1˙0˙01,
where the i-th coordinates are marked for i=3,4,5,6; when these
are deleted, the string 001 remains. The characteristic vectors ofthe subsets in the chain are obtained by ﬁxing all marked coordi-nates and letting the remaining coordinates range over the strings0···000, 0···001, 0···011,. . . , 1···111. In our example, these
characteristic vectors are
00˙1˙1˙0˙00,
00˙1˙1˙0˙01,
01˙1˙1˙0˙01,
11˙1˙1˙0˙01,
---PAGE BREAK---
6. Dilworth’s theorem and extremal set theory 59
which correspond to the subsets
{3,4},{3,4,7},{2,3,4,7},{1,2,3,4,7}.
Show that this algorithm produces exactly the same symmetric
chain containing Sas is produced by the inductive algorithm of De
Bruijnet al. described above.
Notes.
We shall return to partially ordered sets in Chapters 23 and 25.
E. Sperner (1905–1980) is best known for a lemma in combina-
torial topology known as ‘Sperner’s lemma’, which occurred in his
thesis (1928). It was used to give a proof of Brouwer’s ﬁxed pointtheorem. (Another connection to combinatorics: his ﬁrst professor-ship was in K¨ onigsberg!) He was one of the pioneers of the famousOberwolfach research institute.
For a survey of extremal set theory, we refer to Frankl (1988).
The short proof of the Erd˝ os–Ko–Rado theorem is due to Katona
(1974). Theorem 6.5 is due to Kleitman and Spencer (1973) and
Sch¨onheim (1971). The proof of Theorem 6.6 is due to Greene,
Katona and Kleitman (1976).
References.
B. Bollob´ as (1973), Sperner systems consisting of pairs of comple-
mentary subsets, J.Combinatorial Theory (A)15, 363–366.
N. G. de Bruijn, C. van Ebbenhorst Tengbergen and D. Kruyswijk
(1949), On the set of divisors of a number, Nieuw Archief v.
Wisk. (2)23, 191–193.
R. P. Dilworth (1950), A decomposition theorem for partially or-
dered sets, Annals of Math. (2)51, 161–166.
P. Erd˝ os, Chao Ko, and R. Rado (1961), Extremal problems among
subsets of a set, Quart. J. Math. Oxford Ser. (2)12, 313–318.
P. Frankl (1988), Old and new problems on ﬁnite sets, Proc. Nine-
teenth S. E. Conf. on Combinatorics, Graph Th. and Computing,
Baton Rouge, 1988.
C. Greene, G. Katona, and D. J. Kleitman (1976), Extensions of
the Erd˝ os–Ko–Rado theorem, Stud. Appl. Math. 55,1 – 8 .
---PAGE BREAK---
60 A Course in Combinatorics
G. O. H. Katona (1974), Extremal problems for hypergraphs, in
Combinatorics (edited by M. Hall, Jr. and J. H. van Lint), Reidel.
D. J. Kleitman and J. Spencer (1973), Families of k-independent
sets,Discrete Math. 6, 255–262.
D. Lubell (1966), A short proof of Sperner’s lemma, J. Combina-
torial Theory 1,2 9 9 .
L. Mirsky (1971), A dual of Dilworth’s decomposition theorem,
Amer. Math. Monthly 78, 876–877.
J. Sch¨ onheim (1971), A generalization of results of P. Erd˝ os, G.
Katona, and D. J. Kleitman concerning Sperner’s theorem, J.
Combinatorial Theory (A)11, 111–117.
E. Sperner (1928), Ein Satz ¨ uber Untermengen einer endlichen
Menge,Math. Zeitschrift 27, 544–548.
H. Tverberg (1967), On Dilworth’s decomposition theorem for par-
tially ordered sets, J. Combinatorial Theory 3, 305–306.
---PAGE BREAK---
7
Flows in networks
By atransportation network , we will mean a ﬁnite directed graph
Dtogether with two distinguished vertices sandtcalled the source
and the sink, respectively, and which is provided with a function
cassociating to each edge ea nonnegative real number c(e) called
itscapacity. We may further assume that there are no loops, no
multiple edges, and that no edges enter the source sor leave the sink
t(although there would be no harm in admitting any of these types
of edges other than our having to be more careful in a deﬁnition or
two).
Figure 7.1
In Fig. 7.1 we give an example. We could think of a network
of pipes through which some liquid could ﬂow in the direction ofthe arrows. The capacity would indicate the maximal possible ﬂow(per time unit) in that section of pipe.
Aﬂowin a transportation network is a function fassigning a
real number f(e) to each edge esuch that:
(a) 0≤f(e)≤c(e) for all edges e(the ﬂow is feasible );
(b) for each vertex x(not the source or the sink) the sum of the
---PAGE BREAK---
62 A Course in Combinatorics
values offon incoming edges equals the sum of the values of fon
outgoing edges (conservation of ﬂow).
The sum of the values of a ﬂow fon the edges leaving the source
is called the strength of the ﬂow (denoted by |f|). It seems obvious
that the strength of the ﬂow is also equal to the sum of the values
offon edges entering the sink; the reader might try to verify this
formally before reading further.
One of our objectives will be to ﬁnd a method for constructing
amaximum ﬂow , that is, a ﬂow with maximum strength. Before
we begin, it will be good to have a goal or an upper bound for thestrength of a ﬂow; for example, the sum of the capacities of all edgesleaving the source is clearly such an upper bound. More generally,by acut separating s and t (or simply a cut), we mean here a pair
(X,Y ) of subsets of the vertex set V:=V(D) which partition V
and such that s∈Xandt∈Y. We deﬁne the capacityc(X,Y )o f
the cut to be the sum of the capacities of the edges directed fromXtoY(that is, edges e=(x,y) withx∈Xandy∈Y). We claim
that the capacity of any cut is an upper bound for the strength ofany ﬂow. More strongly, we claim that the conservation law implies(see below) that the strength of a ﬂow fcan be computed as
(7.1) |f|=f(X,Y )−f(Y,X ),
wheref(A,B ) denotes the sum of the values of fon all edges
directed from AtoB; then the feasibility of fimmediately implies
that|f|≤c(X,Y ). Thus the minimum capacity of all cuts in a
network (e.g. in Fig. 7.1 the minimum cut capacity is 20) is anupper bound for the strength of a ﬂow in that network.
To establish (7.1), we introduce the function φby deﬁning for
each pair (x,e ), wherexis a vertex incident with the edge e,
φ(x,e ): =−1 if the edge is incoming, and φ(x,e ) := +1 if the
edge is outgoing; φ(x,e )i st ob e0i fx is not incident with e.( W e
remark that φis essentially the incidence matrix of the directed
graph—see Chapter 36.) The conservation law is equivalent to/summationtext
e∈Eφ(x,e )f(e)=0f o r xLnegationslash=s,t. Notice that/summationtext
x∈Xφ(x,e )i s+ 1
ifeis directed from XtoY,−1i fe is directed from YtoX, and
---PAGE BREAK---
7. Flows in networks 63
0i fehas both endpoints in Xor both in Y. Then
|f|=/summationdisplay
e∈Eφ(s,e )f(e)=/summationdisplay
x∈X/summationdisplay
e∈Eφ(x,e )f(e)
=/summationdisplay
e∈Ef(e)/summationdisplay
x∈Xφ(x,e )=f (X,Y )−f(Y,X ).
(In the ﬁrst double sum above, the inner sum is 0 for all terms x
other than s.)
A special instance of (7.1) is |f|=f(V\{t},{t}), the assertion
which we invited the reader to reﬂect on earlier.
We now construct ﬂows. Fix a ﬂow f, possibly the 0-ﬂow. We
shall say that the sequence x0,x1,...,xk−1,xkof distinct vertices is
aspecial path fromx0toxkif for each i,1≤i≤k, either
(i)e=(xi−1,xi) is an edge with c(e)−f(e)>0, or
(ii)e=(xi,xi−1) is an edge with f(e)>0.
Edgesewithf(e)=c(e) are said to be saturated and conditions (i)
and (ii) can be stated in words as requiring that ‘forward’ edges of
the path are unsaturated while ‘backward’ edges are positive—allwith respect to a given ﬂow f. Suppose there exists such a special
path from stot. Deﬁneα
iasc(e)−f(e) in the ﬁrst case and as
f(e) in the second case (picking one of the edges to use if both cases
hold) and let αbe the minimum of these positive numbers αi.O n
each edge of type (i) increase the ﬂow value by α, and on each edge
of type (ii) decrease the ﬂow by α. It is easy to check that the two
conditions for a ﬂow (feasibility and conservation of ﬂow) are stillsatisﬁed. Clearly the new ﬂow has strength |f|+α.
This idea for obtaining a stronger ﬂow becomes an algorithm
when we iterate it (starting with the 0-ﬂow) and incorporate asystematic procedure for searching for special paths from stot
with respect to the current ﬂow. We make brief remarks concerningtermination in the notes to this chapter. But what happens whenwe can go no further?
Suppose that no special path from source to sink exists with re-
spect to some ﬂow f
0. LetX0be the set of vertices xwhich can be
reached from sby a special path, Y0the set of remaining vertices.
---PAGE BREAK---
64 A Course in Combinatorics
In this way we produce a cut. If x∈X0,y∈Y0ande=(x,y)i s
an edge, then emust be saturated or we could adjoin yto a special
path from stoxto get a special path from stoy, contradicting
the deﬁnitions of X0andY0. If, on the other hand, e=(y,x)i sa n
edge, then, for a similar reason, f(e) must be 0. In view of (7.1),
we have then
|f0|=f0(X0,Y0)−f0(Y0,X0)=c(X 0,Y0).
Now it is clear that not only can no stronger ﬂow be obtained by
our method of special paths, but that no stronger ﬂows exist at allbecause|f|≤c(X
0,Y0) for any ﬂow f.
Iff0is chosen to be a maximum ﬂow (which exists by continuity
reasons in case one is unsure of the termination of the algorithm),then surely no special paths from stotexist. Note that the con-
structed cut (X
0,Y0) is a minimum cut (i.e. a cut of minimum ca-
pacity), since c(X,Y )≥|f0|for any cut ( X,Y). Our observations
have combined to prove the following famous theorem of Ford andFulkerson (1956).
Theorem 7.1. In a transportation network, the maximum value
of|f|overallﬂows fisequaltotheminimumvalueof c(X,Y )over
all cuts (X,Y ).
This theorem is usually referred to as the ‘maxﬂow-mincut’ the-
orem. The procedure for increasing the strength of a ﬂow that we
used above shows somewhat more.
Theorem 7.2. If all the capacities in a transportation network
areintegers,thenthereisamaximumstrengthﬂow fforwhichall
valuesf(e)are integers.
Proof: Start with the 0-ﬂow. The argument above provides a way
to increase the strength until a maximum ﬂow is reached. At each
stepαis an integer, so the next ﬂow is integer valued too. /square
Problem 7A. Construct a maximum ﬂow for the transportation
network of Fig. 7.1.
Problem 7B. Anelementary ﬂow in a transportation network is
aﬂ o wf which is obtained by assigning a constant positive value
---PAGE BREAK---
7. Flows in networks 65
αto the set of edges traversed by a simple (directed) path from s
tot, and 0 to all other edges. Show that every ﬂow is the sum of
elementary ﬂows and perhaps a ﬂow of strength zero. (This means
we can arrive at a maxﬂow by starting from the 0-ﬂow and usingonly special paths with ‘forward’ edges.) Give an example of anetwork and a ﬂow which is not maximum, but with respect towhich there are no special paths using only ‘forward’ edges.
Problem 7C. Let (X
1,Y1) and (X2,Y2) be minimum cuts (i.e. cuts
of minimum capacity) in a transportation network. Show that ( X1∪
X2,Y1∩Y2) is also a minimum cut. (This can be done either from
ﬁrst principles, or with an argument involving maximum ﬂows.)Problem 7D. Prove P. Hall’s marriage theorem, Theorem 5.1,
from Theorems 7.1 and 7.2.
It should be clear that the topic of this chapter is of great practi-
cal importance. Routing schemes for all kinds of products depend
on algorithms that produce optimal ﬂows through transportationnetworks. We do not go into the algorithmic aspect of this area.Instead, we shall show a beautiful application of Theorem 7.2 to aproblem related to Birkhoﬀ’s theorem, Theorem 5.5. Before givingthe theorem and its proof, we observe that several attempts weremade to prove it by reducing it to Theorem 5.5 but with no success.The proof below is due to A. Schrijver. (If b=vin Theorem 7.3,
then we have the situation of Theorem 5.5.)
Theorem 7.3. LetAbeab×v(0,1)-matrixwith konesperrow
andrones per column (sobk=vr).Le tαbe a rational number,
0<α< 1, such that k
Lprime=αkandrLprime=αrare integers. Then there
is a(0,1)-matrix ALprimeof sizeb×vwithkLprimeones per row and rLprimeones
percolumnsuchthatentries aLprime
ijofALprimeare1onlyifthecorresponding
entriesofAare1,i.e.ALprimecanbeobtainedfrom Abychangingsome
ones into zeros.
Proof: We construct a transportation network with vertices s(the
source),x1,...,xb(corresponding to the rows of A),y1,...,yv(cor-
responding to the columns of A), andt(the sink). Edges are ( s,xi)
with capacity k,1≤i≤b,(xi,yj) with capacity 1 if and only if
aij= 1, and ( yj,t) with capacity r,1≤j≤v. The deﬁnition
---PAGE BREAK---
66 A Course in Combinatorics
ensures that there is a maximum ﬂow with all edges saturated.
We now change the capacities of the edges from the source to kLprime
and those of the edges to the sink to rLprime. Again, all the capacities
are integers and clearly a maximum ﬂow exists for which the ﬂowsf((x
i,yj)) are equal to α. By Theorem 7.2 there is also a maximum
ﬂowf∗for which all the ﬂows are integers, i.e. f∗((xi,yj) )=0o r
1. From this ﬂow, we immediately ﬁnd the required matrix ALprime./square
The theorem above can be generalized in several ways with es-
sentially the same proof idea, but see below for a slightly diﬀerentapproach.
For some combinatorial applications, it is convenient to use the
following theorem, which does not require the introduction of ca-pacities or the concept of strength. It can be derived from Theorem7.2—see Ford and Fulkerson (1956)—but we choose to give a directproof.
Acirculation on a digraph Dis a mapping ffromE(D) to the
reals satisfying conservation of ﬂow at every vertex. We do notrequire nonnegativity. Circulations may be identiﬁed with vectorsin the null space of the incidence matrix of the digraph.
Theorem 7.4. Letfbeacirculationonaﬁnitedigraph D. Then
thereexistsanintegralcirculation gsuchthatforeveryedge e,g(e)
is equal to one of ⌊f(e)⌋or⌈f(e)⌉.
We may say that the values of gare those of f‘rounded up or
down’. Of course, if f(e) is already an integer, then g(e)=f (e).
Proof: Given a circulation f, consider a circulation gthat satisﬁes
(7.2) ⌊f(e)⌋≤g (e)≤⌈f(e)⌉
and for which the number of edges ewithg(e) an integer is as large
as possible subject to (7.2).
LetHbe the spanning subgraph of Dwith edge set consisting of
those edges of Dfor whichg(e) is not an integer, i.e. for which strict
inequality holds both times in (7.2). Conservation of ﬂow implies
that no vertex can have degree 1 in H,s oi fgis not integral, then
Hcontains a polygon.
LetPbe a polygon in Hand traverse Pwith a simple closed
path; letAbe the set of edges of Pthat are forward edges of the
---PAGE BREAK---
7. Flows in networks 67
path inD, andBthe set of edges of Pthat are backward edges in
this path. For any constant c, we obtain a new circulation gLprimeby
gLprime(e): =

g(e)+c ife∈A,
g(e)−cife∈B,
g(e)i f e/∈E(P).
Ifcis small, (7.2) will still hold with greplaced by gLprime. Now choose
c:= min/braceleftBig
min
e∈A/parenleftBig
⌈f(e)⌉−g (e)/parenrightBig
,min
e∈B/parenleftBig
g(e)−⌊f(e)⌋/parenrightBig/bracerightBig
.
ThengLprimestill satisﬁes (7.2), yet gLprime(e) is an integer for at least one
more edge (any edge for the which term in the expression above
achieves the minimum). This would contradict the choice of g,
weregnot integral. /square
Corollary. Letfbe an integral circulation on a ﬁnite digraph
Danddany positive integer. Then fcan be written as the sum
g1+g2+···+gdof integral circulations such that for each index j
and each edge e,
(7.3) ⌊f(e)/d⌋≤g j(e)≤⌈f(e)/d⌉.
Proof: By induction on d.F o rd= 1, there is nothing to prove.
Givend≥2, apply Theorem 7.4 to f/dto ﬁnd an integral circu-
lationg1satisfying (7.3) for j= 1. Apply the induction hypothesis
to ﬁnd
f−g1=g2+g3+···+gd
where for each j=2,3,...,d ,gjis an integral circulation satisfying
⌊(f(e)−g1(e))/(d−1)⌋≤g j(e)≤⌈(f(e)−g1(e))/(d−1)⌉.
An easy exercise is that if ais an integer and bis either⌊a/d⌋ or
⌈a/d⌉, then
⌊a
d⌋≤⌊a−b
d−1⌋ and⌈a−b
d−1⌉≤⌈a
d⌉,
so that the above inequalities imply (7.3) for j=2,3,...,d ./square
---PAGE BREAK---
68 A Course in Combinatorics
From anm×nmatrixAof real numbers aij, not necessarily
nonnegative or integers, we obtain a circulation on a digraph with
m+n+ 2 vertices and mn+m+n+ 1 edges. The digraph is
similar to the one used in the proof of Theorem 7.3. There are ver-ticesx
1,...,xmcorresponding to the rows, vertices y1,...,yncor-
responding to the columns, and two others called sandt. There
is an edge from xitoyjwith circulation value aij, an edge from s
toxiwith circulation value equal to the i-th row-sum ri, an edge
fromyjtotwith circulation value equal to the j-th column-sum kj
(i=1,...,m ,j=1,...,n ), and an edge from ttoswith circula-
tion value equal to the sum of all entries of M. If we multiply this
circulation fby any scalar α, apply Theorem 7.4 to αf, and rein-
terpret the resulting integral circulation as a matrix, we obtain part(i) of the following theorem. Part (ii) follows from the corollary.
Theorem 7.5. (i)Given a matrix Aand a real number α, there
is an integral matrix Bso that the entries of B, the row-sums of
B, the column-sums of B, and the sum of all entries of B, are the
corresponding values for αArounded up or down. (ii)IfAis an
integral matrix and dany positive integer, then
A=B
1+B2+···+Bd
whereeach Biisanintegralmatrixwhoseentries,row-sums,column-
sums, and sum of all entries, are those of (1/d)A, rounded up or
down.Problem 7E. Show that the following results are quick conse-
quences of Theorem 7.5: (i) Problem 5A(iii); (ii) Theorem 5.5; (iii)
Theorem 7.3; (iv) A ﬁnite graph all of whose vertices have even de-gree has a balanced orientation, where the in-degree and out-degree
of each vertex are equal; (v) If a bipartite graph has minimum de-
greed
and maximum degree d, then its edges may be colored with
dcolors so that the colors that appear at every vertex are distinct,
and withdcolors so that all colors appear at each vertex.
Problem 7F. Show that the dimension of the vector space of all
circulations on a connected digraph Dis|E(D)|−|V(D)|+1 .
---PAGE BREAK---
7. Flows in networks 69
Notes.
The term augmenting path is often used instead of special path.
If the capacities of a transportation network are integers, the spe-
cial path method for constructing maximum ﬂows will terminate af-
ter ﬁnitely many iterations, since the strength increases by at leastone each time. But Ford and Fulkerson (1962) give an example withirrational capacities where certain contrived choices of special pathslead to an inﬁnite sequence of ﬂows whose strengths converge—butonly to one-fourth of the actual maximum ﬂow strength! If oneis careful to pick shortest special paths, however, then it can be
shown that a maximum ﬂow is reached after at most O(n
3) itera-
tions, where nis the number of vertices. See Edmonds and Karp
(1972).
The problem of ﬁnding a maximum ﬂow is an example of a linear
programming problem and can be solved e.g. by the simplex algo-rithm. The network ﬂow problem is special in that its matrix istotally unimodular, and this is one way of explaining why Theorem7.2 holds. See the references below for more discussion of linear andinteger programming. Graphical methods are usually faster thanthe simplex algorithm, and add insight.
Circulations on a digraph are called 1- cycles in algebraic topol-
ogy. An analogue of Theorem 7.4 holds for vectors fin the null
space of any totally unimodular matrix.
Theorems 7.1, 7.2, 7.4, and the algorithm have many further
combinatorial applications, since certain combinatorial problemscan be phrased in terms of transportation networks. For example,ﬁnding a maximum matching in a bipartite graph is equivalent toﬁnding a maximum (integer valued) ﬂow in a certain associatednetwork—see the references—and thus a good algorithm exists toﬁnd a maximum matching. We give further applications of thesetheorems in Chapter 16 to an existence problem on (0,1)-matrices,and in Chapter 38 to a problem on partitions of sets.
References.
J. Edmonds and R. M. Karp (1972), Theoretical improvements
in algorithm eﬃciency for network ﬂow problems, J. Assn. for
Computing Machinery 19, 248–264.
---PAGE BREAK---
70 A Course in Combinatorics
L. R. Ford, Jr. and D. R. Fulkerson (1962), Flows in Networks,
Princeton University Press.
T. C. Hu (1969), Integer Programming and Network Flows, Addi-
son-Wesley.
V. Chv´ atal (1983), Linear Programming , W. H. Freeman.
---PAGE BREAK---
8
De Bruijn sequences
The following problem has a practical origin: the so-called rotating
drum problem . Consider a rotating drum as in Fig. 8.1.
Figure 8.1
Each of the segments is of one of two types, denoted by 0 and 1.
We require that any four consecutive segments uniquely determine
the position of the drum. This means that the 16 possible quadru-ples of consecutive 0’s and 1’s on the drum should be the binaryrepresentations of the integers 0 to 15. Can this be done and, if yes,in how many diﬀerent ways? The ﬁrst question is easy to answer.Both questions were treated by N. G. de Bruijn (1946) and for thisreason the graphs described below and the corresponding circularsequences of 0’s and 1’s are often called De Bruijn graphs andDe
Bruijn sequences , respectively.
We consider a digraph (later to be called G
4) by taking all 3-
tuples of 0’s and 1’s (i.e. 3-bit binary words) as vertices and joiningthe vertex x
1x2x3by a directed edge (arc) to x2x30 andx2x31.
The arc (x 1x2x3,x2x3x4) is numbered ej, wherex1x2x3x4is the
binary representation of the integer j. The graph has a loop at 000
and at 111. As we saw before, the graph has an Eulerian circuitbecause every vertex has in-degree 2 and out-degree 2. Such a
---PAGE BREAK---
72 A Course in Combinatorics
closed path produces the required 16-bit sequence for the drum.
Such a (circular) sequence is called a De Bruijn sequence. Forexample the path 000 →000→001→011→111→111→110→
100→001→010→101→011→110→101→010→100→000
corresponds to 0000111100101101 (to be read circularly). We callsuch a path a complete cycle .
We deﬁne the graph G
nto be the directed graph on ( n−1)-tuples
of 0’s and 1’s in a similar way as above. (So Gnhas 2nedges.)
The graph G4is given in Fig. 8.2. In this chapter, we shall call a
digraph with in-degree 2 and out-degree 2 for every vertex, a ‘2-in2-out graph’. For such a graph Gwe deﬁne the ‘doubled’ graph G
∗
as follows:
(i) to each edge of Gthere corresponds a vertex of G∗;
(ii) ifaandbare vertices of G∗, then there is an edge from ato
bif and only if the edge of Gcorresponding to ahas as terminal
end (head) the initial end (tail) of the edge of Gcorresponding to
b.
ClearlyG∗
n=Gn+1.
Figure 8.2
Theorem 8.1. LetGbea2-in2-outgraphon mverticeswith M
complete cycles. Then G∗has2m−1Mcomplete cycles.
Proof: The proof is by induction on m.
(a) Ifm= 1 thenGhas one vertex pand two loops from ptop.
ThenG∗=G2which has one complete cycle.
---PAGE BREAK---
8. De Bruijn sequences 73
(b) We may assume that Gis connected. If Ghasmvertices
and there is a loop at every vertex, then, besides these loops, Gis
a circuitp1→p2→···→pm→p1. LetAibe the loop pi→piand
Bithe arcpi→pi+1. We shall always denote the corresponding
vertices in G∗by lower case letters. The situation in G∗is as in
Fig. 8.3.
Figure 8.3
Clearly a cycle in G∗has two ways of going from bitobi+1.S o
G∗has 2m−1complete cycles, whereas Ghas only one.
(c) We now assume that Ghas a vertex xthat does not have
a loop on it. The situation is as in Fig. 8.4, where P,Q,R,S are
diﬀerent edges of G(although some of the vertices a,b,c,d may
coincide).
FromGwe form a new 2-in 2-out graph with one vertex less by
deleting the vertex x. This can be done in two ways: G1is obtained
by the identiﬁcation P=R,Q=S, andG2is obtained by P=S,
Q=R. By the induction hypothesis, the theorem applies to G1
and toG2.
Figure 8.4
There are three diﬀerent types of complete cycle in G∗, depending
on whether the two paths leaving rand returning to p, respectively
q, both go to p, both to q, or one to pand one to q. We treat one
---PAGE BREAK---
74 A Course in Combinatorics
case; the other two are similar and left to the reader. In Fig. 8.5
we show the situation where path 1 goes from rtop, path 2 from
stoq, path 3 from stop, and path 4 from rtoq.
Figure 8.5
These yield the following four complete cycles in G∗:
1,p r ,4,q s ,3, ps, 2,q r
1, ps, 2,q r ,4,q s ,3,p r
1, ps, 3,p r ,4,q s ,2,q r
1, ps, 2,q s ,3,p r ,4,q r
InG∗
1andG∗2the situation reduces to Fig. 8.6.
Figure 8.6
In each of G∗1andG∗2onecomplete cycle using the paths 1, 2,3,4
is possible. In the remaining two cases, we also ﬁnd two complete
cycles inG∗
1andG∗2corresponding to four complete cycles in G∗.
Therefore the number of complete cycles in G∗is twice the sum of
the numbers for G∗1andG∗2. On the other hand, the number of
complete cycles in Gis clearly equal to the sum of the correspond-
ing numbers for G1andG2. The theorem then follows from the
induction hypothesis. /square
We are now able to answer the question how many complete
cycles there are in a De Bruijn graph.
---PAGE BREAK---
8. De Bruijn sequences 75
Theorem 8.2. Gnhas exactly 22n−1−ncomplete cycles.
Proof: The theorem is true for n= 1. Since G∗
n=Gn+1, the
result follows by induction from Theorem 8.1. /square
For a second proof, see Chapter 36.
Problem 8A. Letαbe a primitive element in F2n. For 1≤i≤
m:= 2n−1, let
αi=n−1/summationdisplay
j=0cijαj.
Show that the sequence
0,c10,c20,...,cm0
is a De Bruijn sequence.
Problem 8B. Find a circular ternary sequence (with symbols
0,1,2) of length 27 so that each possible ternary ordered triple
occurs as three (circularly) consecutive positions of the sequence.
First sketch a certain directed graph on 9 vertices so that Euleriancircuits in the graph correspond to such sequences.
Problem 8C. We wish to construct a circular sequence a
0,...,a 7
(indices mod 8) in such a way that a sliding window ai,ai+1,ai+3
(i=0,1,...7) will contain every possible three-tuple once. Show
(not just by trial and error) that this is impossible.Problem 8D. Letm:= 2
n−1. An algorithm to construct a De
Bruijn sequence a0,a1,...,amworks as follows. Start with a0=
a1=···=an−1=0 . F o rk>n , we deﬁne akto be the maximal
value in {0,1}such that the sequence (a k−n+1,...,ak−1,ak) has
not occurred in ( a0,...,ak−1) as a (consecutive) subsequence. The
resulting sequence is known as a Ford sequence . Prove that this
algorithm indeed produces a De Bruijn sequence.
Notes.
Although the graphs of this chapter are commonly called De
Bruijn graphs, Theorem 8.1 was proved in 1894 by C. Flye Sainte-
Marie. This went unnoticed for a long time. We refer to De Bruijn(1975).
---PAGE BREAK---
76 A Course in Combinatorics
N. G. de Bruijn (1918–), one of the best-known Dutch mathe-
maticians, worked in many diﬀerent areas such as analysis, number
theory, combinatorics, and also computing science and crystalogra-phy.
We mention a peculiarity concerning the spelling of some Dutch
names. When omitting the initials of N. G. de Bruijn, one shouldcapitalize the word ‘de’ and furthermore the name should be listedunder B. Similarly Van der Waerden is correct when the initials areomitted and he should be listed under W.
For a proof of Theorem 8.1 using algebraic methods, we refer to
Chapter 36.
References.
N. G. de Bruijn (1946), A combinatorial problem, Proc. Kon. Ned.
Akad. v. Wetensch. 49, 758–764.
N. G. de Bruijn (1975), Acknowledgement of priority to C. Flye
Sainte-Marie on the counting of circular arrangements of 2
nzeros
and ones that show each n-letter word exactly once, T. H. report
75-WSK-06, Eindhoven University of Technology.
C. Flye Sainte-Marie (1894), Solution to question nr. 48, Interm´ edi-
aire des Math´ ematiciens 1, 107–110.
---PAGE BREAK---
9
Two (0,1,*) problems:
addressing for graphs and
a hash-coding scheme
The following problem originated in communication theory. For
a telephone network, a connection between terminals AandBis
established before messages ﬂow in either direction. For a networkof computers it is desirable to be able to send a message from A
toBwithoutBknowing that a message is on its way. The idea is
to let the message be preceded by some ‘address’ of Bsuch that
at each node of the network a decision can be made concerning thedirection in which the message should proceed.
A natural thing to try is to give each vertex of a graph Ga
binary address, say in {0,1}
k, in such a way that the distance of two
vertices in the graph is equal to the so-called Hamming distance of
the addresses, i.e. the number of places where the addresses diﬀer.This is equivalent to regarding Gas aninduced subgraph of the
hypercube H
k, which has V(Hk): ={0,1}kand where k-tuples are
adjacent when they diﬀer in exactly one coordinate. The exampleG=K
3already shows that this is impossible. We now introduce a
new alphabet {0,1,∗}and form addresses by taking n-tuples from
this alphabet. The distance between two addresses is deﬁned to bethe number of places where one has a 0 and the other a 1 (so starsdo not contribute to the distance). For an addressing of a graphG, we require that the distance of any two vertices in Gis equal to
the distance of their addresses. It is trivial to show that this can bedone ifnis large enough. We denote by N(G) the minimum value
ofnfor which there exists an addressing of Gwith length n.
---PAGE BREAK---
78 A Course in Combinatorics
For a tree we can do without the stars as follows. We use in-
duction. For a tree with two vertices, we have a trivial addressing
with length 1. Suppose that we can address trees with kvertices.
Ifx0,x1,...,xkare the vertices of the tree Tandx0i sam o n o v a -
lent vertex, then consider an addressing for the tree obtained byremovingx
0. Letxibe the address of xiand suppose x0is joined
tox1. We change all addresses to (0, xi), 1≤i≤k, and give x0
the address (1, x1). Clearly this is now an addressing for T. So for
a tree, we have N(T)≤|V(T)|−1.
As a second example, consider Km. In the identity matrix of
sizem−1, we replace the zeros above the diagonal by stars and
add a row of zeros. Any two rows now have distance 1 and henceN(K
m)≤m−1.
As a third example, we consider the graph of Fig. 9.1.
Figure 9.1
A possible (though not optimal) addressing is
1 111∗∗21 0 ∗1∗
3∗0001
4 001∗∗5 00000
We now show a correspondence between addressings of a graph
andquadratic forms (an idea of Graham and Pollak, 1971). Con-
sider the graph Gof Fig. 9.1 and the addressing given above.
To the ﬁrst column of the addressing, we associate the product(x
1+x2)(x4+x5). Herexiis in the ﬁrst, respectively second, factor
if the address of ihas a 1, respectively a 0, in the ﬁrst column.
If we do the same thing for each column and then add the terms,we obtain a quadratic form/summationtextd
ijxixj, wheredijis the distance of
---PAGE BREAK---
9. Two (0,1,*)problems 79
the vertices iandjinG. Thus an addressing of Gcorresponds to
writing the quadratic form/summationtextdijxixjas a sum of nproducts
(xi1+···+xik)(xj1+···+xjl)
such that no xioccurs in both of the factors. The number of vari-
ables is|V(G)|.
Theorem 9.1. Letn+,respectively n−,bethenumberofpositive,
respectivelynegative,eigenvaluesofthedistancematrix (dij)ofthe
graphG. ThenN(G)≥max{n +,n−}.
Proof: Each of the quadratic forms mentioned above can be rep-
resented as1
2xLlatticetopAx, where x:= (x1,x2,...,xn) andAhas entry
aij= 1 if the term xixjoccurs in the quadratic form and 0 other-
wise. Such a matrix has rank 2 and trace 0. Therefore it has one
positive and one negative eigenvalue. Since (d ij) is the sum of the
matrices corresponding to the quadratic forms, it can have at mostnpositive (respectively negative) eigenvalues. /square
Theorem 9.2. N(K
m)=m−1.
Proof: We have already seen that N(Km)≤m−1. SinceJ−I,
of sizem, is the distance matrix of Kmand the eigenvalues of J−I
arem−1, with multiplicity 1, and −1, with multiplicity m−1, the
result follows from Theorem 9.1. /square
With slightly more work, we shall now show that the shortest
addressing for a tree Thas length |V(T)|−1.
Theorem 9.3. IfTis a tree on nvertices, then N(T)=n−1.
Proof: We ﬁrst calculate the determinant of the distance matrix
(dij)o fT . We number the vertices p1,...,pnin such a way that pnis
an endpoint adjacent to pn−1. In the distance matrix, we subtract
rown−1 from row n, and similarly for the columns. Then all
the entries in the new last row and column are 1 except for thediagonal element which is equal to −2. Now renumber the vertices
p
1,...,pn−1in such a way that the new vertex pn−1is an endpoint
---PAGE BREAK---
80 A Course in Combinatorics
ofT\{pn}adjacent to pn−2. Repeat the procedure for the rows and
columns with numbers n−1 andn−2. Aftern−1 steps, we have
the determinant
/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle01 1... 1
1−20... 0
10−2 ... 0...............
10 0... −2/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle/vextendsingle.
From this we ﬁnd the remarkable result that the determinant D
n
of the distance matrix of a tree on nvertices satisﬁes
Dn=(−1)n−1(n−1)2n−2,
i.e. it depends only on |V(T)|. If we number the vertices accord-
ing to the procedure described above, then the k×kprincipal
minor in the upper left-hand corner of the distance matrix is the
distance matrix of a subtree on kvertices. Therefore the sequence
1,D 1,D2,...,Dn, whereDkis the determinant of the k×kminor,
is equal to
1,0,−1,4,−12,..., (−1)n−1(n−1)2n−2.
If we consider the sign of 0 to be positive, then this sequence hasonly one occurrence of two consecutive terms of the same sign. Byan elementary theorem on quadratic forms this implies that thecorresponding quadratic form has index 1, and hence ( d
ij) has one
positive eigenvalue; see B. W. Jones (1950), Theorem 4. Now theresult follows from Theorem 9.1. /square
The conjecture that in fact N(G)≤|V(G)|−1 for all (connected)
graphsGwas proved by P. Winkler in 1983. The proof is construc-
tive. In order to describe the addressing, we need some preparation.Consider the graph of Fig. 9.2.
---PAGE BREAK---
9. Two (0,1,*)problems 81
Figure 9.2
We pick a vertex x0, then construct a spanning tree Tby a
breadth-ﬁrst search, and then number the vertices by a depth-ﬁrst
search. The result is shown on the right-hand side of Fig. 9.2, whereedges ofE(G)\E (T) are dashed.
Letn:=|V(G)|−1. We need several deﬁnitions.
Fori≤n, we deﬁne
P(i): ={j :x
jis on a path from x0toxiinT}.
For example, P(6) ={0,3,4,6}. Let
iLtrianglej:= max(P(i)∩P(j)).
We describe the general situation in Fig. 9.3.
Figure 9.3
Note that in Fig. 9.3, we have i<j if and only if k<l.
Fori≤n, we deﬁne
iLprime:= max(P (i)\{i}).
For example, 7Lprime= 3 in Fig. 9.2. Deﬁne
i∼j⇔P(i)⊆P(j)o rP(j)⊆P(i).
---PAGE BREAK---
82 A Course in Combinatorics
We denote distances in G, respectively T,b ydG, respectively dT.
Thediscrepancy function c(i,j) is now deﬁned by
c(i,j): =dT(xi,xj)−dG(xi,xj).
For example, in Fig. 9.2, c(6,9 )=4 .
Lemma 9.4.
(i)c(i,j)=c(j,i )≥0;
(ii)ifi∼j, thenc(i,j)=0 ;
(iii)ifiLnegationslash∼j, thenc(i,jLprime)≤c(i,j)≤c(i,jLprime)+2.
Proof: (i) is trivial; (ii) follows from the deﬁnition of Tsince
dG(xi,xj)≥|dG(xj,x0)−dG(xi,x0)|=dT(xi,xj);
(iii) follows from the fact that |dG(xi,xj)−dG(xi,xj/prime)|≤1 and that
dT(xi,xj)=1+dT(xi,xj/prime). /square
Now we can deﬁne the addressing. For 0 ≤i≤nthe vertex xi
is given the address ai∈{0,1,∗}n, where
ai=(ai(1),ai(2),...,a i(n))
and
ai(j): =

1i fj∈P(i),
∗if

c(i,j)−c(i,j
Lprime)=2,or
c(i,j)−c(i,jLprime)=1,i<j ,c (i,j) even, or
c(i,j)−c(i,jLprime)=1,i>j ,c (i,j)o d d,
0 otherwise.
Theorem 9.5. d(ai,ak)=dG(xi,xk).
Proof: We may assume i<k.
(i) Suppose i∼k. ThendG(xi,xk)=|P (k)\P(i)|. The values of
jsuch that j∈P(k)\P(i) are exactly the positions where ak(j)=
1,ai(j)Lnegationslash= 1. For these values of jwe see that c(i,j) = 0, hence
ai(j) = 0 and we are done.
(ii) The hard case is when iLnegationslash∼k. The key observation is the
following. Let n1≤n2≤···≤nlbe a nondecreasing sequence of
---PAGE BREAK---
9. Two (0,1,*)problems 83
integers such that |ni+1−ni|≤2 for alli.I fmis an even integer
betweenn1andnlthat does notoccur in the sequence, then there
is anisuch that ni=m−1,ni+1=m+ 1. Now consider the
sequence
c(i,k)≥c(i,kLprime)≥c(i,kLprimeLprime)≥···≥c(i,iLtrianglek)=0.
By the deﬁnition of ai(j) and the observation above, ai(j)=∗ and
ak(j) = 1 exactly as many times as there are even integers between
c(i,iLtrianglek) andc(i,k). Similarly ak(j)=∗ andai(j) = 1 as many
times as there are odd integers between c(i,iLtrianglek) andc(i,k). So
d(ai,ak)=|P (k)\P(i)|+|P(i)\P(k)|−c(i,k )
=dT(xi,xk)−c(i,k)=dG(xi,xk).
/square
Therefore we have proved the following theorem.
Theorem 9.6. N(G)≤|V(G)|−1.
Problem 9A. If we use the scheme deﬁned above, what are the
addresses of x2andx6in Fig. 9.2?
Problem 9B. LetGbe a cycle (polygon) on 2 nvertices. Deter-
mineN(G).
Problem 9C. LetGbe a cycle (polygon) on 2 n+1 vertices. Prove
thatN(G)=2n. Hint: if Ckis the permutation matrix with
entriescij= 1 if and only if j−i≡1( m o dk) andζk= 1, then
(1,ζ,ζ2,...,ζk−1) is an eigenvector of Ck.
***
We now look at a second problem involving k-tuples from the
alphabet {0,1,⋆}. The objects we shall study were introduced by
Rivest (1974) and given the (unfortunate) name associative block
design; cf. Chapter 19 for block designs. An ABD (k,w) is a set of
b:= 2welements of {0,1,⋆}kwith the following properties: if the
elements are the rows of a b×kmatrixC, then
---PAGE BREAK---
84 A Course in Combinatorics
(i) each row of Chask−wstars;
(ii) each column of Chasb(k−w)/kstars;
(iii) any two distinct rows have distance at least 1.
Note that the deﬁnition implies that each vector in Fk
2has dis-
tance 0 to exactly one row of C.
The origin of the problem is the following. Consider a ﬁle of k-bit
binary words. Each sequence in {0,1,⋆}kis called a partial match
query . The partial match retrieval problem is to retrieve from the
ﬁle all words agreeing with the query in those positions where the
query speciﬁes a bit. So-called hash-coding schemes divide a ﬁle
intobdisjoint lists L1,L2,...,Lb. A record xwill be stored in the
list with index h(x), where his the ‘hash-function’ mapping {0,1}k
onto{1,2,...,b}. For a given partial match query, some of the lists
must be searched. An analysis of the worst-case number of lists tobe searched led to the concept of ABD . In this case h(x)i st h e
index of the unique row of Cwhich has distance 0 to x.
Example 9.1. The following matrix is an ABD (4,3):

⋆000
0⋆10
00⋆ 1
010⋆
⋆111
1⋆01
11⋆ 0
101⋆
.
We ﬁrst prove some elementary properties of an ABD .
Theorem 9.7. If anABD (k,w)exists, then:
(1)it has exactly bw/(2k )zeros and bw/(2k )ones in each col-
umn;
(2)for eachxinF
k
2it has exactly/parenleftbigw
u/parenrightbig
rows which agree with x
inupositions;
(3)the parameters satisfy
w2≥2k/parenleftbigg
1−1
b/parenrightbigg
;
---PAGE BREAK---
9. Two (0,1,*)problems 85
(4)for any row, the number of rows with stars in the same
positions is even.
Proof: LetCbe theABD (k,w).
(1) A row of Cwith a star, respectively a zero, in column jrep-
resents (i. e. has distance 0 to) 2k−w−1, respectively 2k−w, elements
ofFk
2. From (i) and (ii) of the deﬁnition, it follows that column j
must contain bw/(2k ) zeros.
(2) Letx∈Fk2. Denote by nithe number of rows of Cwhich
agree with xinipositions. There are/parenleftbigk
l/parenrightbig
vectors in Fk2which agree
withxin exactly lpositions. Therefore/parenleftbigk
l/parenrightbig
=/summationtextni/parenleftbigk−w
l−i/parenrightbig
,i . e .
(1 +z)k=( 1+z)k−w·/summationdisplay
nizi.
This proves that ni=/parenleftbigw
i/parenrightbig
.
(3) The sum of the distances between pairs of rows of Cisk(bw
2k)2
by (1). Since any two rows have distance at least 1, this sum is at
least/parenleftbigb
2/parenrightbig
.
(4) Consider a row of C. Count vectors in Fk
2which have zeros
in the positions where the row has stars. Each row with a diﬀerent
star pattern represents an even number of such vectors whereas arow with the same star pattern represents exactly one such vector.
/square
Note that property (1) in Theorem 9.7(3) implies that a neces-
sary condition for the existence of an ABD (k,w) is thatkdivides
w·2
w−1.
The following strengthening of Theorem 9.7(3) is due to A. E.
Brouwer (1999).
Theorem 9.8. LetCbeanABD (k,w)withw>3.
(1)If two rows of Cagree in all but one position, then
/parenleftbiggw
2/parenrightbigg
≥k;
(2)otherwise w2>2k.
---PAGE BREAK---
86 A Course in Combinatorics
Proof: Suppose c1andc2are two rows of Cwhich diﬀer only
in position one. Then all the other rows of Cmust diﬀer from c1
in some other position. So, by (i) of the deﬁnition and Theorem
9.7(3), we ﬁnd
b−2≤(w−1)·bw
2k.
To prove the assertion, we must show that the right-hand side ofthe inequality cannot be equal to b−2o rb−1. In both cases,
equality would imply 2
w−1|kwhich contradicts Theorem 9.7 unless
w= 4, which is excluded by substitution.
(ii) Consider two rows of Cwhich have the same star pattern.
By hypothesis, they diﬀer in more than one position. Again, countthe sum of the distances of all the rows from one of this pair. Thissum is at least 2 + ( b−2) =band, by Theorem 9.7.1, it is equal
tow·(bw)/(2k ). Sow
2≥2k. We must show that equality cannot
hold. By the argument above, equality would imply that rows withthe same star pattern occur in pairs which have distance 2, andfurthermore all the other rows have distance 1 to each row of sucha pair. Without loss of generality, such a pair would be
(⋆⋆···⋆00...000) and (⋆⋆··· ⋆00...011).
Thebw/(2k )−1 other rows ending in a 1 would have to end in
01, for otherwise they would have distance 0 to the second row ordistance>1 to the ﬁrst row. Similarly, there would be bw/(2k )−1
rows ending in 10. Since we now have rows with distance 2, weﬁnd that necessarily bw/(2k )−1 = 1. Therefore 2
w=2w, which is
impossible if w≥3. /square
Corollary. AnABD (8,4)does not exist.
Using these results, it is easy to ﬁnd all ABD (k,w) withw≤4.
Of course, w= 0 is trivial. For w=1,2,or 4, we must have k=w
(no stars). If w= 3, then either k= 3 (no stars) or k= 4. In that
case there are two types of ABD , one given in Example 9.1.
Problem 9D. Construct an ABD (4,3) that has the same ﬁrst
four rows as Example 9.1 but diﬀers in the others.
In 1987 La Poutr´ e and Van Lint proved that an ABD (10,5)
does not exist but the smaller possibility ABD (8,5) turned out to
---PAGE BREAK---
9. Two (0,1,*)problems 87
be quite diﬃcult to handle. In 1999 D. E. Knuth asked Brouwer
whether any progress had been made in this area since the earlyresults and this made Brouwer decide it was time the question wassettled. An example can be found in Brouwer (1999). It does notseem to have any structure. Now the smallest open case is thequestion whether an ABD (12,6) exists.
We shall now describe some construction methods. Some of the
ideas will be used in other chapters.
Theorem 9.9. If anABD (k
i,wi)exists for i=1,2, then an
ABD (k1k2,w1w2)exists.
Proof: We can assume w2>0. Partition the rows of ABD (k2,w2)
into two classes R0andR1of equal size. In ABD (k1,w1) we replace
each star by a row of k2stars, each 0 by a row from R0and each 1
by a row from R1in all possible ways. A trivial calculation shows
that the resulting matrix is an ABD (k1k2,w1w2). /square
Corollary. AnABD (4t,3t)exists.
For the proof of the next theorem, we introduce a new symbol,
namely−.Ak-tuple consisting of the symbols 0 ,1,⋆,and−rep-
resents all possible words with only 0 ,1,⋆that can be obtained by
replacing each −b ya0o ra1i na l lp ossible ways.
Theorem 9.10. Letw>0.Suppose an ABD (k,w)exists, where
k=k0·2l,k0odd. Then an ABD (k,w +ik0)exists for 0≤i≤
(k−w)/k0.
Proof: It is suﬃcient to consider i= 1. LetCbe theABD (k,w).
Deﬁne a matrix Aof the same size by requiring aij=1i fCij=⋆
andaij= 0 otherwise. By Theorem 7.3, Ais the sum of two
matricesA1andA2, whereA1hask0ones in each row and 2w−l
ones in each column. In a row of C, replace stars by −if the star
occurs in a position where A1has a one. This produces the required
ABD (k,w +k0). /square
Theorem 9.11. IfABD (k,w)exists and α≥1is a number such
thatαkandαware integers, then an ABD (αk,αw )exists.
Proof: It is suﬃcient to show that ABD (k+l,w+m) exists for
(k+l)/(w+m)=k/w and (l,m) = 1. Let k=k0·2e,k0odd.
---PAGE BREAK---
88 A Course in Combinatorics
From (ii) of the deﬁnition we know that k0|w. Therefore wl=mk
and (l,m) = 1 imply that lis a power of 2. Consider the l×l
circulant matrix with a row of l−mstars and mminus signs as
ﬁrst row. Since ldividesbwe can adjoin a column of b/lcopies
of this circulant to the matrix Cof theABD (k,w). It is easy to
check that this larger matrix is an ABD (k+l,w+m). /square
Example 9.2. From the corollary to Theorem 9.9 we have an
ABD (64,27). Theorem 9.10 then shows that an ABD (64,w ) exists
for 27≤w≤64. In particular, there is an ABD (64,32). Then
Theorem 9.11 implies that an ABD (2w,w) exists for all w≥32.
As mentioned before, nonexistence has been shown for w= 4 and
w= 5 and the case w= 6 is still open.
Notes.
The ﬁrst problem considered in this chapter was introduced by
J. R. Pierce at Bell Laboratories as the loop switching problem .
Several people (including one of the present authors) tried in vain
to solve it. Shortly after R. L. Graham raised the reward for thesolution to $200, it was solved by P. Winkler. It is worth noting thatWinkler stated that the idea of numbering the vertices as was donein the proof was a regular habit due to his background in computerscience. Going over the proof, one sees that this numbering indeedplayed a crucial role.
References.
A. E. Brouwer (1999), An Associative Block Design ABD (8,5),
SIAM J.Comput. 28, 1970–1971.
R. L. Graham and H. O. Pollak (1971), On the addressing problem
for loop switching, Bell System Tech. J. 50, 2495–2519.
B. W. Jones (1950), The Theory of Quadratic Forms , Carus Math.
Monogr. 10, Math. Assoc. of America.
J. A. La Poutr´ e and J. H. van Lint (1985), An associative block
designABD (10,5) does not exist, Utilitas Math. 31, 219–225.
P. Winkler (1983), Proof of the squashed cube conjecture, Combi-
natorica 3, 135–139.
---PAGE BREAK---
10
The principle of inclusion
and exclusion;
inversion formulae
As we have seen in several of the previous chapters, many problems
of combinatorial analysis involve the counting of certain objects.
We now treat one of the most useful methods for counting. Itis known as the principle of inclusion and exclusion . The idea is
as follows. If AandBare subsets of Sand we wish to count
the elements of S\{A∪B}, then the answer is not |S|−|A|−|B|
because the elements of A∩Bhave been subtracted twice. However
|S|−|A|−|B|+|A∩B|is correct. The following theorem generalizes
this idea.
Theorem 10.1. LetSbe anN-set;E
1,...,Ernot necessarily
distinct subsets of S. For any subset Mof{1,...,r}, we deﬁne
N(M)to be the number of elements of Sin/intersectiontext
i∈MEiand for 0≤
j≤r,wedeﬁne Nj:=/summationtext
|M|=jN(M). Thenthenumberofelements
ofSnotin any of the subsets Ei,1≤i≤r,i s
(10.1) N−N1+N2−N3+···+(−1)rNr.
Proof: (i) Ifx∈Sandxis in none of the Ei, thenxcontributes
1 to the expression (10.1).
(ii) Ifx∈Sandxis in exactly kof the sets Ei, then the contri-
bution to (10.1) equals
1−/parenleftbiggk
1/parenrightbigg
+/parenleftbiggk
2/parenrightbigg
−···+(−1)k/parenleftbiggk
k/parenrightbigg
=( 1−1)k=0.
/square
---PAGE BREAK---
90 A Course in Combinatorics
Remark. If we truncate the sum in (10.1) after a positive (respec-
tively, negative) term, then we have an upper (respectively, lower)
bound for the number of elements of Snot in any of the Ei.
Because this method is of great importance, we shall give several
examples as illustration.
Example 10.1. Letdndenote the number of permutations πof
1,2,...,n such that π(i)Lnegationslash=ifor alli(these are called derange-
ments). Let S:=Sn, and letEibe the subset of those permutations
πwithπ(i)=i. By (10.1) we ﬁnd
(10.2) dn=n/summationdisplay
i=0(−1)i/parenleftbiggn
i/parenrightbigg
(n−i)! =n!n/summationdisplay
i=0(−1)i
i!.
From this formula, we see that for large values of nthe probability
that a permutation is a derangement is nearly e−1. From (10.2) for
nandn−1, we ﬁnd a recursion formula for dn:
(10.3) dn=ndn−1+(−1)n.
The formula (10.2) can also be obtained by inversion as follows.
Consider the power series D(x): =/summationtext∞
n=0dnxn
n!(d0= 1). Now if
F(x): =exD(x), then
F(x)=∞/summationdisplay
m=0/parenleftBiggm/summationdisplay
r=0/parenleftbiggm
r/parenrightbigg
dm−r/parenrightBigg
xm
m!
and since/summationtextmr=0/parenleftbigm
r/parenrightbig
dm−r=m!, we ﬁnd F(x)=( 1−x)−1. It follows
thatD(x)=e−x(1−x)−1and by multiplying the power series for
the two factors, we ﬁnd (10.2) again.
Example 10.2. LetXbe ann-set,Y={y1,...,yk}ak-set. We
count the surjections of XtoY. LetSbe the set of all mappings
fromXtoY,Eithe subset of mappings for which yiis not in the
image ofX. By (10.1) we ﬁnd the number of surjections to be/summationtextk
i=0(−1)i/parenleftbigk
i/parenrightbig
(k−i)n.Now this number is trivially 0 if k>n and
clearlyn!i fk=n. So we have proved:
(10.4)k/summationdisplay
i=0(−1)i/parenleftbiggk
i/parenrightbigg
(k−i)n=/braceleftbiggn!i fk=n,
0i fk>n .
---PAGE BREAK---
10. Inclusion-exclusion; inversion formulae 91
There are many formulae like (10.4) that are often quite hard to
prove directly. The occurrence of ( −1)iis usually a sign that count-
ing the right kind of objects using the principle of inclusion and ex-clusion can produce the formula, as in this example. Neverthelessit is useful in this case to see another proof.
LetP(x) be a polynomial of degree n, with highest coeﬃcient a
n.
We denote the sequence of values P(0),P (1),... byP.W e n o w
consider the sequence of diﬀerences P(1)−P(0),P (2)−P(1),....
This isQ1, whereQ1(x): =P(x+1 )−P(x), a polynomial of
degreen−1 with highest coeﬃcient nan. By repeating this pro-
cedure a number of times, we ﬁnd a sequence Qkwhose terms are/summationtextk
i=0(−1)i/parenleftbigk
i/parenrightbig
P(x+k−i), corresponding to the polynomial Qk(x)
of degreen−kwith highest coeﬃcient n(n−1)...(n−k+1 )an.
Ifk=n, then all the terms of Qkaren!anand ifk>n , then they
are all 0. Take P(x)=xn. We again ﬁnd (10.4).
Example 10.3. The following identity is a well known relation
between binomial coeﬃcients:
(10.5)n/summationdisplay
i=0(−1)i/parenleftbiggn
i/parenrightbigg/parenleftbiggm+n−i
k−i/parenrightbigg
=/braceleftbigg/parenleftbigm
k/parenrightbig
ifm≥k,
0i fm<k.
We see that if we wish to prove this using inclusion-exclusion, then
the setsEithat we wish to exclude involve choosing from an n-
set, and after choosing iof them, we must choose k−ielements
from some set of size m+n−i. This shows us that the following
combinatorial problem will lead us to the result (10.5). Consider asetZ=X∪Y, whereX={x
1,...,xn}is ann-set of blue points
andYis anm-set of red points. How many k-subsets consist of red
points only? The answer is trivially the right-hand side of (10.5).If we take Sto be all the k-subsets of ZandE
ithosek-subsets
that contain xi, then (10.1) gives us the left-hand side of (10.5).
Again we can ask whether this result can be proved directly. The
answer is yes. To do this, we use the following expansion:
(10.6)∞/summationdisplay
j=0/parenleftbigga+j
j/parenrightbigg
xj=( 1−x)−a−1.
---PAGE BREAK---
92 A Course in Combinatorics
Note that (−1)i/parenleftbign
i/parenrightbig
is the coeﬃcient of xiin the expansion of (1 −
x)n. From (10.6) we ﬁnd that/parenleftbigm+n−i
k−i/parenrightbig
is the coeﬃcient of xk−iin
the expansion of (1 −x)k−m−n−1. So the left-hand side of (10.5) is
the coeﬃcient of xkin the expansion of (1 −x)k−m−1.I fm≤k−1,
this is obviously 0 and if m≥k,i ti s/parenleftbigm
k/parenrightbig
, again by (10.6).
Example 10.4. (TheEuler function ) Letn=pa1
1pa2
2...parrbe a
positive integer. We denote by φ(n) the number of integers kwith
1≤k≤nsuch that the g.c.d. ( n,k) = 1. We apply Theorem 10.1
withS:={1,2,...,n}andEithe set of integers divisible by pi,
1≤i≤r. Then (10.1) yields
(10.7)φ(n)=n −r/summationdisplay
i=1n
pi+/summationdisplay
1≤i<j≤rn
pipj−··· =nr/productdisplay
i=1(1−1
pi).
The next theorem is used quite often.
Theorem 10.2./summationtext
d|nφ(d)=n.
Proof: Consider {1,2,...,n}=N. For each m∈N,w eh a v e
(m,n)|n. The number of integers mwith (m,n)=d, i.e. m=m1d,
n=n1dand (m1,n1) = 1 clearly equals φ(n1)=φ(n/d). So
n=/summationtext
d|nφ(n/d) which is equivalent to the assertion. /square
At this point, it is useful to introduce the so-called M¨ obius func-
tion:
(10.8)µ(d): =

1i fd= product of an even number of distinct primes,
−1i fd= product of an odd number of distinct primes,
0 otherwise, i.e. dnot squarefree.
Theorem 10.3.
/summationdisplay
d|nµ(d)=/braceleftbigg1ifn=1,
0otherwise.
Proof: Ifn= 1, there is nothing to prove. If n=pa1
1...parr, then
---PAGE BREAK---
10. Inclusion-exclusion; inversion formulae 93
by (10.8) we have
/summationdisplay
d|nµ(d)=r/summationdisplay
i=0/parenleftbiggr
i/parenrightbigg
(−1)i=( 1−1)r=0.
/square
Note how similar the proofs of Theorems 10.1 and 10.3 are.
Using the M¨ obius function, we can reformulate (10.7) as follows:
(10.9)φ(n)
n=/summationdisplay
d|nµ(d)
d.
Problem 10A. How many positive integers less than 1000 have
no factor between 1 and 10?
Problem 10B. How many monic polynomials of degree nare
there in Fp[x] that do not take on the value 0 for x∈Fp?
Problem 10C. Determine/summationtext
n≤xµ(n)⌊x
n⌋.
Problem 10D. One of the most famous functions in complex
analysis is the so-called Riemannζ-functionζ(s): =/summationtext∞
n=1n−s, de-
ﬁned in the complex plane for Re( s)>1. Prove that 1 /ζ(s)=/summationtext∞n=1µ(n)n−s.
Problem 10E. Letfn(z) be the function that has as its zeros all
numbersηfor which ηn= 1 butηkLnegationslash= 1 for 1 ≤k<n . Prove that
fn(z)=/productdisplay
k|n(zk−1)µ(n/k ).
Theorem 10.3 makes it possible to derive a very useful inversion
formula known as the M¨ obius inversion formula .
Theorem 10.4. Letf(n)andg(n)be functions deﬁned for every
positive integer nsatisfying
(10.10) f(n)=/summationdisplay
d|ng(d).
---PAGE BREAK---
94 A Course in Combinatorics
Thengsatisﬁes
(10.11) g(n)=/summationdisplay
d|nµ(d)f(n
d).
Proof: By (10.10) we have
/summationdisplay
d|nµ(d)f (n
d)=/summationdisplay
d|nµ(n
d)f(d)
=/summationdisplay
d|nµ(n
d)/summationdisplay
d/prime|dg(dLprime)=/summationdisplay
d/prime|ng(dLprime)/summationdisplay
m|(n/d/prime)µ(m).
By Theorem 10.3 the inner sum on the right-hand side is 0 unless
dLprime=n. /square
Remark. The equation (10.11) also implies (10.10).
Example 10.5. We shall count the number Nnof circular se-
quences of 0’s and 1’s, where two sequences obtained by a rotationare considered the same. Let M(d) be the number of circular se-
quences of length dthat are not periodic. Then N
n=/summationtext
d|nM(d).
We observe that/summationtext
d|ndM(d)=2nsince this counts all possible cir-
cular sequences. By Theorem 10.4 we ﬁnd from this equation thatnM(n)=/summationtext
d|nµ(d)2n/dand therefore
(10.12)Nn=/summationdisplay
d|nM(d)=/summationdisplay
d|n1
d/summationdisplay
l|dµ(d
l)2l
=/summationdisplay
l|n2l
l/summationdisplay
k|n
lµ(k)
k=1
n/summationdisplay
l|nφ(n
l)2l.
The ﬁnal expression has the advantage that all the terms are posi-tive. This raises the question whether we could have obtained thatexpression by some other counting technique. We shall see thatthe following theorem, known as Burnside’s lemma (although the
theorem is actually due to Cauchy and Frobenius; see the notes),provides the answer.
---PAGE BREAK---
10. Inclusion-exclusion; inversion formulae 95
Theorem 10.5. LetGbeapermutationgroupactingonaset X.
Forg∈Gletψ(g)denote the number of points of Xﬁxed byg.
Then the number of orbits of Gis equal to1
|G|/summationtext
g∈Gψ(g).
Proof: Count pairs ( g,x), whereg∈G,x∈X,xg=x. Starting
withg, we ﬁnd/summationtext
g∈Gψ(g). For each x∈Xthere are |G|/|Ox|
such pairs, where Oxis the orbit of x. So the total number equals
|G|/summationtext
x∈X1/|Ox|. The orbits of GpartitionX, and if we sum the
terms 1/|Ox|over allxin a particular orbit, we obtain 1. Thus/summationtext
x∈X1/|Ox|is the number of orbits. /square
Example 10.5 (continued). LetGbe the cyclic group of order
n, i.e. the group of rotations of a circular sequence of 0’s and 1’s.
Ifd|nthere areφ(n/d)integersgsuch that (n,g)=dand for each
suchgthereare 2dcircularsequencesthatareﬁxedbytherotation
overgpositions. So Theorem 10.5 immediately yields the result
(10.12).
Example 10.6. The following problem, introduced by Lucas in
1891, is known as the ‘probl` eme des m´ enages’. We wish to seat n
couples at a circular table so that men and women are in alternate
places and no husband will sit on either side of his wife. In howmany ways can this be done? We assume that the women havebeen seated at alternate places. Call the ladies 1 to nand the
corresponding men also 1 to n. The problem amounts to placing
the integers 1 to non a circle with positions numbered 1 to nsuch
that for all ithe integer iis not in position ior position i+1
(modn). LetE
ibe the set of seatings in which husband iis sitting
next to his wife. We now wish to use inclusion-exclusion and wemust therefore calculate in how many ways it is possible to seat r
husbands incorrectly. Call this number A
r. We do this as follows.
Consider a circular sequence of 2 npositions. Put a 1 in position
2i−1 if husband iis sitting to the right of his wife; put a 1 in
position 2 iif he is sitting to the left of his wife. Put zeros in
the remaining positions. The conﬁgurations that we wish to counttherefore are circular sequences of 2n zeros and ones, with exactly r
ones, no two adjacent. Let A
Lprime
rbe the number of sequences starting
with a 1 (followed by a 0). By considering 10 as one symbol, we
see that we must choose r−1 out of 2n−r−1 positions. To count
---PAGE BREAK---
96 A Course in Combinatorics
the number ALprimeLprime
rof sequences starting with a 0, we place the 0 at the
end, and then it amounts to choosing rout of 2n−rplaces. Hence
Ar=ALprime
r+ALprimeLprimer=/parenleftbigg2n−r−1
r−1/parenrightbigg
+/parenleftbigg2n−r
r/parenrightbigg
=2n
2n−r/parenleftbigg2n−r
r/parenrightbigg
.
By (10.1) we ﬁnd that the number of ways to seat the men is
(10.13)n/summationdisplay
r=0(−1)r(n−r)!/parenleftbigg2n−r
r/parenrightbigg2n
2n−r.
Problem 10F. We color the integers 1 to 2n red or blue in such
a way that if iis red then i−1 is not blue. Prove that
n/summationdisplay
k=0(−1)k/parenleftbigg2n−k
k/parenrightbigg
22n−2k=2n+1.
Can you prove this identity directly?
Problem 10G. Count the number of permutations x1,x2,...,x 2n
of the integers 1 to 2n such that xi+xi+1Lnegationslash=2n+ 1 fori=
1,2,..., 2n−1.
Problem 10H. Prove that for 0 ≤k≤n
k/summationdisplay
i=0/parenleftbiggk
i/parenrightbigg
Dn−i=n−k/summationdisplay
j=0(−1)j/parenleftbiggn−k
j/parenrightbigg
(n−j)!.
Notes.
The principle of inclusion and exclusion occurred as early as 1854
in a paper by Da Silva and later in a paper by Sylvester in 1883.
For this reason (10.1) and similar formulae are sometimes called theformula of Da Silva, respectively Sylvester. A better name that isalso often used is ‘sieve formula’. The formula is indeed an exampleof a principle that is used extensively in number theory, referred toas ‘sieve methods’. An example that is probably familiar to mostreaders is the sieve of Eratosthenes: to ﬁnd the primes ≤n
2,t a k e
the integers ≤n2and sieve out all the multiples of primes ≤n.
---PAGE BREAK---
10. Inclusion-exclusion; inversion formulae 97
The derangements treated in Example 10.1 occur again in Exam-
ple 14.1 and Example 14.10. The ﬁrst occurrence of this question
is in one of the early books on games of chance: Essai d’analyse
sur les jeuxde hazard by P. R. de Montmort (1678–1719). It is
still often referred to by the name that he gave it: ‘probl` eme desrencontres’. Formula (10.2) is sometimes stated as follows. If n
persons check their umbrellas (a typical Dutch example; it’s alwaysraining in Holland) and subsequently pick one at random in thedark after a power failure, then the probability that nobody getshis own umbrella is roughly e
−1(ifnis large).
The second proof in Example 10.2 is an example of the use of
‘calculus of ﬁnite diﬀerences’, used extensively in numerical analy-sis.
A. F. M¨ obius (1790–1868) was an astronomer (and before that an
assistant to Gauss) who made important contributions to geometryand topology (e.g. the M¨ obius band).
G. F. B. Riemann (1826–1866) was professor in G¨ ottingen, where
he also obtained his doctorate under Gauss. He is famous for manyof his ideas, which include the Riemann integral, Riemann surfacesand manifolds, and of course the so-called Riemann hypothesis on
the location of the zeros of the ζ-function. One wonders what he
would have left us if he had not died so young.
In most books in which it occurs, Theorem 10.5 is called Burn-
side’s lemma. This is just one of many examples of theorems, etc.attributed to the wrong person. For a history of this misnomer, werefer to Neumann (1979).
F. E. A. Lucas (1842–1891) was a French number theorist. He
is known for his books on number theory and mathematical recre-ations. The former book contained the problem of Example 10.6.TheFibonacci numbers were given this name by Lucas. See the
notes to Chapter 14.
References.
F. E. A. Lucas (1891), Th´ eorie des nombres, Gauthier-Villars,
Paris.
P. M. Neumann (1979), A lemma that is not Burnside’s, Math.
Scientist, 4, 133–141.
---PAGE BREAK---
11
Permanents
Before introducing the main topic of this chapter, we present a
generalization of Theorem 10.1. As in Theorem 10.1, let Sbe an
n-set,E1,...,Er(not necessarily distinct) subsets of S. Let Fbe
any ﬁeld. To each element a∈S, we assign a weightw(a)i n F.
For any subset Mof{1,2,...,r}, we deﬁne W(M) to be the sum
of the weights of the elements of Sin/intersectiontext
i∈MEi. For 0≤j≤r,w e
deﬁneWj:=/summationtext
|M|=jW(M) (soW0=/summationtext
a∈Sw(a)).
Theorem 11.1. IfE(m)denotes the sum of the weights of the
elements of Sthat are contained in exactly mof the subsets Ei,
1≤i≤r, then
(11.1) E(m)=r−m/summationdisplay
i=0(−1)i/parenleftbiggm+i
i/parenrightbigg
Wm+i.
Proof: The proof is nearly the same as for Theorem 10.1. If
x∈Sandxis contained in exactly mof the subsets Ei, then the
contribution of xto the sum in (11.1) is w(x). Ifx∈Sandxis
contained in exactly m+kof the subsets Ei, then the contribution
to the sum equals
w(x)k/summationdisplay
i=0(−1)i/parenleftbiggm+i
i/parenrightbigg/parenleftbiggm+k
m+i/parenrightbigg
=w(x)/parenleftbiggm+k
k/parenrightbiggk/summationdisplay
i=0(−1)i/parenleftbiggk
i/parenrightbigg
=0.
/square
---PAGE BREAK---
11. Permanents 99
We now give the deﬁnition of a permanent. Let A=(a1,...,an)
be ann×nmatrix with columns aj=(a1j,...,anj)Llatticetop.Then per
A, the permanent of A, is deﬁned by
(11.2) per A:=/summationdisplay
π∈Sna1π(1)···anπ(n).
So the permanent is deﬁned in the same way as the determinant
but without the signs depending on whether the permutation πis
even or odd.
From the deﬁnition, the following properties of the permanent
are obvious.
(11.3) per A=p e rALlatticetop;
(11.4)
ifPandQare permutation matrices, then perA=p e rPAQ ;
(11.5) per Ais a linear function of aj,1≤j≤n.
Of course per Ais also a linear function of each of the rows of
A. The permanent of Ais much more diﬃcult to calculate than
its determinant. However, it is clear from (11.2) that expansion by
rows or columns is possible. So deﬁne Aijto be the matrix obtained
fromAby deleting row iand column j. Then
(11.6) per A=/braceleftbigg/summationtextn
i=1aijperAij,1≤j≤n,/summationtextnj=1aijperAij,1≤i≤n.
The following method of calculating a permanent (due to Ryser) is
an application of Theorem 11.1.
Theorem 11.2. LetAbeann×nmatrix. If Arisobtainedfrom
Aby deleting rcolumns, then S(Ar)denotes the product of the
row-sumsof Ar. Wedeﬁne Σrtobethesumofthevaluesof S(Ar)
for all possible choices of Ar. Then
(11.7) per A=n−1/summationdisplay
r=0(−1)rΣr.
---PAGE BREAK---
100 A Course in Combinatorics
Proof: LetSbe the set of all products p=a1i1...aninand deﬁne
w(p): =p. Deﬁne Ejto be the set of products pfor which j/∈
{i1,...,in}. Then the permanent of Ais the sum of the weights of
the elements of Sthat are not in any of the subsets Ej. So (11.7)
is an immediate consequence of (11.1). /square
Problem 11A. Prove (10.4) using Theorem 11.2.
Remark. IfA1,...,Anare subsets of {1,...,n}andaij=1i f
j∈Ai, 0 otherwise, then per Acounts the number of SDRs of the
setsA1,...,An.
Example 11.1. We ﬁnd another formula for the number of de-
rangements of 1, 2,...,n . The permanent of the matrix J−Iof
sizenis clearlydn. From (11.7) we ﬁnd
(11.8) dn=n−1/summationdisplay
r=0(−1)r/parenleftbiggn
r/parenrightbigg
(n−r)r(n−r−1)n−r.
By expanding the term (n −1−r)n−rand applying (10.4) after
changing the order of summation, we ﬁnd a complicated proof of
(10.2).
During the 1970’s, several well known conjectures on permanents
of (0,1)-matrices were proved, often by ingenious arguments. Infact, much of the research on permanents was motivated by theseconjectures. Therefore we will devote attention to a number ofthese results in this and the next chapter. As an introduction, weconsider (0,1)-matrices with two ones in each row and column.
Theorem 11.3. IfAis a(0,1)-matrix in which all row-sums and
column-sums are 2, then
perA≤2
⌊1
2n⌋.
Proof: Consider the graph Gwhose vertices correspond to the
rows ofA, whose edges correspond to the columns of A, and where
vertexiand edge jare incident exactly when A(i,j ) = 1. This
graph is regular of degree 2, and hence is the disjoint union of
polygons. The submatrix corresponding to the vertices and edges
---PAGE BREAK---
11. Permanents 101
of a polygon is, after reordering rows and columns if necessary, a
circulant 
1100··· 00
0110··· 00
0011··· 00..................
0000··· 11
1000··· 01
.
(This may degenerate int oa2b y2m a trix of 1’s.) The matrix A
is the direct sum of such matrices, each of which has permanent
2. The number of factors is at most ⌊
1
2n⌋and we see that equality
holds in the theorem if Ais the direct sum of ⌊1
2n⌋matricesJof
size 2. /square
This elementary theorem is concerned with the relationship be-
tween the row-sums of a matrix and the permanent of that matrix,and the same is true for many of the following theorems. Thisbrings us to the ﬁrst diﬃcult question. It was conjectured by H.Minc in 1967 that if Ais a (0,1)-matrix with row-sums r
1,...,rn,
then
(11.9) per A≤n/productdisplay
j=1(rj!)1/rj.
Observe that the proof of Theorem 11.3 shows that equality can
hold in (11.9) and in fact, we have equality if Ais the direct sum of
matricesJm.Severalresultsthatwereweakerthan(11.9)wereproved,
often by intricate and long arguments. The conjecture was ﬁnallyproved in 1973 by L. M. Br´ egman. All the more surprising is the factthat A. Schrijver came up with an extremely elegant and very shortproof of Minc’s conjecture in 1977. The proof depends on thefollowing lemma.
Lemma 11.4. Ift
1,t2,...,trare nonnegative real numbers, then
/parenleftbiggt1+···+tr
r/parenrightbiggt1+···+tr
≤tt1
1···ttrr.
Proof: Sincexlogxis a convex function, we have
t1+···+tr
rlog/parenleftbiggt1+···+tr
r/parenrightbigg
≤t1logt1+...trlogtr
r,
---PAGE BREAK---
102 A Course in Combinatorics
which proves the assertion. /square
In the following, we use (11.6) in the following form:
perA=/summationdisplay
k,aik=1perAik.
Theorem 11.5. LetAbe ann×n(0,1)-matrix with riones in
rowi,1≤i≤n. Then
perA≤n/productdisplay
i=1(ri)!1/ri.
Proof: The proof is by induction on n.F o rn= 1, the theorem is
trivial. We assume that the theorem is true for matrices of size n−1.
The idea is to estimate (per A)nperAand to split this expression
into several products. Now note that riis the number of values of
kfor which aik= 1 and apply the lemma. We ﬁnd:
(11.10) (per A)nperA=n/productdisplay
i=1(perA)perA
≤n/productdisplay
i=1
rperA
i/productdisplay
k,aik=1perAperAik
ik.
Now, letSdenote the set of all permutations νof{1,...,n}for
whicha
iνi= 1 fori=1,...,n .S o|S|=p e rA. Furthermore,
the number of ν∈Ssuch that νi=kis perAikifaik= 1 and 0
otherwise. So the right-hand side of (11.10) is equal to
(11.11)/productdisplay
ν∈S/braceleftBigg/parenleftBiggn/productdisplay
i=1ri/parenrightBigg
·/parenleftBiggn/productdisplay
i=1perAiνi/parenrightBigg/bracerightBigg
.
We now apply the induction hypothesis to each Aiνi. This yields
(11.12) (per A)nperA≤
/productdisplay
ν∈S

/parenleftBiggn/productdisplay
i=1ri/parenrightBigg
·n/productdisplay
i=1
/productdisplay
j/negationslash=i,
ajνi=0(rj!)1/rj/productdisplay
j/negationslash=i,
ajνi=1((rj−1)!)1/(rj−1)


.
---PAGE BREAK---
11. Permanents 103
Since the number of isuch thatiLnegationslash=jandajνi=0i sn−rj, and the
number of isuch that iLnegationslash=jandajνi=1i srj−1, we can replace
the right-hand side of (11.12) by
/productdisplay
ν∈S/braceleftBigg/parenleftBiggn/productdisplay
i=1ri/parenrightBigg
·/bracketleftBiggn/productdisplay
j=1(rj!)(n−r j)/rj(rj−1)!/bracketrightBigg/bracerightBigg
=
/productdisplay
ν∈Sn/productdisplay
i=1(ri)!n/ri=/parenleftBiggn/productdisplay
i=1(ri!)1/ri/parenrightBiggnperA
and the assertion is proved. /square
We now shall consider a special class of (0,1)-matrices, namely
the (0,1)-matrices that have exactly kones in each row and column.
We denote this class by A(n,k ). We deﬁne:
(11.13) M(n,k) := max{per A:A∈A(n,k)},
(11.14) m(n,k ): =m i n{perA:A∈A(n,k)}.
By taking direct sums, we ﬁnd the following inequalities:
(11.15) M(n1+n2,k)≥M(n1,k)M(n2,k),
(11.16) m(n 1+n2,k)≤m(n 1,k)m(n 2,k).
These two inequalities allow us to introduce two more functions
using the following result, known as Fekete’s lemma .
Lemma 11.6. Letf:N→Nbe a function for which f(m+n)≥
f(m)f(n)for allm,n∈N. Then limn→∞f(n)1/nexists (possibly
∞).
Proof: Fixmand ﬁxl,l≤m. By induction, we ﬁnd from the
inequality for fthatf(l+km)≥f(l)[f(m)]k. Therefore
lim inff(l+km)1/(l+km)≥f(m)1/m
---PAGE BREAK---
104 A Course in Combinatorics
and since there are mpossible values for l, we in fact have
lim inff(n)1/n≥f(m)1/m.
Now letm→∞. We ﬁnd that
lim inff(n)1/n≥lim supf(m)1/m,
but then these are equal. /square
The assertion of the lemma is also true if in the inequality for f
we replace ≥by≤. By applying the lemma to (11.15) and (11.16),
we can deﬁne:
(11.17) M(k) := lim
n→∞{M(n,k)}1/n,
(11.18) m(k) := lim
n→∞{m(n,k )}1/n.
Problem 11B. Prove that M(n,k)≥k!. Prove that M(k)≤
(k!)1/k. Show by example that M(k)≥(k!)1/k. This shows that
M(k)=(k!)1/k.
The function m(n,k ) is much more diﬃcult to handle. What we
should expect is based on a famous problem still referred to as the
Van der Waerden conjecture, although in 1981 two diﬀerent proofsof the conjecture appeared (after nearly 50 years of research on thisquestion!). We formulate the conjecture below, and the proof willbe given in the next chapter.
Conjecture. IfAis ann×nmatrix with nonnegative entries in
which all row-sums and column-sums are 1, then
(11.19) perA≥n!n
−n.
The matrices considered in the conjecture are usually called dou-
bly stochastic matrices .I fA∈A(n,k), then dividing all the ele-
ments ofAbykyields a doubly stochastic matrix. Therefore the
conjecture (now a theorem) shows that m(k)≥k/e. This is re-
markable because the value of M(k) given in Problem 11B tends
---PAGE BREAK---
11. Permanents 105
tok/efork→∞ (see the notes). This means that for large n,
andAan arbitrary element of A(n,k ), the value of (per A)1/nis
nearlyk/e. For a long time, the best lower bound for m(n, 3) was
n+ 3 and even that was not easy to prove. Once again, the next
improvement was both considerable and elementary. We now give
the proof of that result, due to Voorhoeve (1979).
Theorem 11.7. m(n, 3)≥6·(4
3)n−3.
Proof: LetUndenote the set of n×nmatrices with nonnegative
integers as entries and all row-sums and column-sums 3; u(n): =
min{perA:A∈Un}. Denote by Vnthe set of all matrices obtained
from elements of Unby decreasing one positive entry by 1; v(n): =
min{perA:A∈Vn}. We ﬁrst show that
(11.20) u(n)≥/ceilingleftbigg3
2v(n)/ceilingrightbigg
.
LetAbe an element of Unwith ﬁrst row a=(α1,α2,α3,0,..., 0),
whereαi≥0 fori=1,2,3. Since
2a=α1(α1−1,α2,α3,0,..., 0) +α2(α1,α2−1,α3,0,..., 0)
+α3(α1,α2,α3−1,0,..., 0),
we ﬁnd from (11.5) that 2 u(n)≥(α1+α2+α3)v(n)=3v(n),
proving the assertion.
Next, we show that
(11.21) v(n)≥/ceilingleftbigg4
3v(n−1)/ceilingrightbigg
.
We must distinguish between two cases. In the ﬁrst one, Ais an
element of Vnwith ﬁrst row (1 ,1,0,..., 0) and the matrix obtained
fromAby deleting the ﬁrst row has the form ( c1,c2,B). The
column-sum of c3:=c1+c2is either 3 or 4. By (11.6), we have
perA= per (c1,B)+p e r(c2,B)=p e r( c3,B).
If the column-sum of c3is 3, then the matrix ( c3,B)i si nUn−1and
we are done by (11.20). If the sum is 4, then we use the same trick as
---PAGE BREAK---
106 A Course in Combinatorics
above: write 3c 3as a linear combination of four vectors disuch that
each matrix (d i,B)i si nV n−1and we ﬁnd that 3 per A≥4v(n−1).
The second case that we have to consider is that Ahas (2, 0,..., 0)
as ﬁrst row. If we delete the ﬁrst row and column of A, then there
are again two possibilities. We obtain a matrix Bthat is either in
Un−1or inVn−1.S ow eh a v ep e r A≥2 min{u(n −1),v(n−1)}and
we are done by (11.20). By combining (11.20) and (11.21) with the
trivial value v(1) = 2, the assertion of the theorem follows. /square
We now consider a larger class of n×nmatrices, namely those
with nonnegative integers as entries and all row-sums and column-sums equal to k. We denote this class by Λ(n,k ) and the minimal
permanent within the class by λ(n,k ). Again we have λ(m+n,k)≤
λ(m,k )λ(n,k ) and by Fekete’s lemma, we can deﬁne
(11.22) θ(k) := lim
n→∞(λ(n,k ))1/n.
From Theorem 11.3 and Theorem 11.7, we know that λ(n,2) = 2
andλ(n,3)≥6·(4
3)n−3. From (11.19), we have seen above that
λ(n,k )≥n!(k
n)n. We have also seen that there is a connection
between permanents and SDRs. We now show a proof in whichthis connection is exploited.
Theorem 11.8. λ(n,k )≤k
2n//parenleftbignk
n/parenrightbig
.
Proof: We denote by Pn,kthe collection of all ordered partitions
of the set {1,2,...,nk}into classes of size k.W eh a v e
(11.23) pn,k:=|Pn,k|=(nk)!
(k!)n.
Now let A:= (A 1,...,An) be such a partition. The number of
SDRs of the subsets A1,...,Aniskn. Consider a second partition
B:= (B 1,...,Bn). We denote by s(A,B) the number of common
SDRs of AandB. We deﬁne an n×nmatrixAwith entries αij
byαij:=|Ai∩Bj|. The point of the proof is the fact that per A
counts the number of common SDRs of AandB. Furthermore, by
deﬁnition of the partitions, the matrix Ais in Λ(n,k ). Therefore
s(A,B)=p e rA≥λ(n,k ).
---PAGE BREAK---
11. Permanents 107
IfA∈Pn,kis given and some SDR of Ais given, then there are
n!pn,k−1ordered partitions Bthat have this same SDR. Hence we
have /summationdisplay
B∈Pn,ks(A,B)=kn·n!pn,k−1.
Combining this with (11.23) and the inequality for λ(n,k ), we ﬁnd
λ(n,k )≤kn·n!pn,k−1
pn,k=k2n
/parenleftbignk
n/parenrightbig.
/square
This proof is due to Schrijver and Valiant (1980) who also gave
the following corollary.
Corollary. θ(k)≤(k−1)k−1
kk−2.
Proof: This follows in the usual way from the previous theorem
by using Stirling’s formula: n!∼nne−n(2πn)1/2. /square
The corollary combined with Theorem 11.7 gives us one more
value ofθ(k), namely θ(3) =4
3.
Problem 11C. Consider the set of integers 1, 2,..., 64. We ﬁrst
remove the integers ≡1 (mod 9), i.e. x1=1,...,x 8=6 4.Then
we remove the integers xi+ 8, where 72 is to be interpreted as
8. This leaves us with a set Sof 48 elements. We partition S
into subsets A1,...,A 8and also into subsets B1,...,B 8, whereAi
contains integers in the interval (8(i −1),8i] andBicontains the
integers≡i(mod 8). How many common SDRs are there for the
systemsA1,...,A 8andB1,...,B 8?
Problem 11D. We return to Problem 5G. Again, consider a bi-
partite graph on 2 nvertices that is regular of degree 3. Give a
lower bound for the number of perfect matchings.
Problem 11E. On a circular arrangement of the integers 1, 2,...,n
consider the subsets {i,i+1,i+2}wherei=1,2,...,n and inte-
gers are interpreted mod n. How many SDR’s does this collection
of sets have?
---PAGE BREAK---
108 A Course in Combinatorics
Notes.
In his book Permanents , H. Minc (1978) mentions that the name
permanent is essentially due to Cauchy (1812) although the word as
such was ﬁrst used by Muir in 1882. Nevertheless, a referee of one ofMinc’s earlier papers admonished him for inventing this ludicrousname! For an extensive treatment of permanents, we refer to Minc’sbook. There, one can ﬁnd much of the theory that was developedmainly to solve the Van der Waerden conjecture (without successat the time of writing of the book).
Theorem 11.2 is from Ryser (1963).For a number of results related to the Minc conjecture, we refer
to Van Lint (1974).
The lemma known as Fekete’s lemma occurs in Fekete (1923).
For another application, we refer to J. W. Moon (1968).
The term doubly stochastic matrix can be motivated by consid-
ering the entries to be conditional probabilities. However, perma-nents do not seem to play a role of importance in probability theory.
The remarks concerning m(k) andM(k) preceding Theorem 11.7
are based on Stirling’s formula and the related inequality n!≥
n
ne−n. This inequality is easily proved by induction, using the fact
that (1+n−1)nis increasing with limit e. Actually Stirling’s formula
was ﬁrst given by de Moivre. Stirling derived an asymptotic seriesfor the gamma function which leads to the estimate
Γ(x)=x
x−1
2e−x(2π)1
2eθ/(12x),
where 0<θ<1. (n!=Γ ( n+1 ).)
A. Schrijver (1998) has established equality in the Corollary to
Theorem 11.8 by proving that
λ(n,k )≥/parenleftbigg(k−1)k−1
kk−2/parenrightbiggn
.
References.L. M. Br´ egman (1973), Certain properties of nonnegative matri-
ces and their permanents, Dokl. Akad. Nauk SSSR 211, 27–30
(Soviet Math. Dokl. 14, 945–949).
---PAGE BREAK---
11. Permanents 109
M. Fekete (1923), ¨Uber die Verteilung der Wurzeln bei gewissen
algebraischen Gleichungen mit ganzzahligen Koeﬃzienten, Math.
Zeitschr. 17, 228–249.
J. H. van Lint (1974), Combinatorial Theory Seminar Eindhoven
University of Technology , Lecture Notes in Mathematics 382,
Springer-Verlag.
H. Minc (1967), An inequality for permanents of (0,1) matrices, J.
Combinatorial Theory 2, 321–326.
H. Minc (1978), Permanents, Encyclopedia of Mathematics and
its Applications, vol. 6, Addison-Wesley, reissued by Cambridge
University Press.
J. W. Moon (1968), Topics on Tournaments, Holt, Rinehart and
Winston.
H. J. Ryser (1963), Combinatorial Mathematics , Carus Math.
Monograph 14.
A. Schrijver (1978), A short proof of Minc’s conjecture, J. Combi-
natorial Theory (A)25, 80–83.
A. Schrijver and W. G. Valiant (1980), On lower bounds for per-
manents, Proc. Kon. Ned. Akad. v. Wetensch. A83, 425–427.
A. Schrijver (1998), Counting 1-factors in regular bipartite graphs,
J. Combinatorial Theory (B) 72, 122–135.
M. Voorhoeve (1979), A lower bound for the permanents of certain
(0,1)-matrices, Proc. Kon. Ned. Akad. v. Wetensch. A82, 83–86.
---PAGE BREAK---
12
The Van der Waerden
conjecture
In this chapter, we denote the set of all doubly stochastic matrices
of sizen×Ωn. The subset consisting of matrices for which all
entries are positive is denoted by Ω∗
n. We deﬁne Jn:=n−1J, where
Jdenotes the n×nmatrix for which all entries are 1. The vector
(1,1,..., 1)Llatticetopis denoted by j.
In 1926, B. L. van der Waerden proposed as a problem to deter-
mine the minimal permanent among all doubly stochastic matrices.
It was natural to assume that this minimum is per Jn=n!n−n(as
stated in (11.19)). The assertion
(12.1) (A ∈ΩnandALnegationslash=Jn)⇒(perA>perJn)
became known as the ‘Van der Waerden conjecture’ (although in
1969 he told one of the present authors that he had not heard thisname before and that he had made no such conjecture). In 1981 twodiﬀerent proofs of the conjecture appeared, one by D. I. Falikman,submitted in 1979, and one by G. P. Egoritsjev, submitted in 1980.We shall give our version of Egoritsjev’s proof which had a slightlystronger result than Falikman’s, cf. Van Lint (1981).
In the following, we shall use the term minimizing matrix for a
matrixA∈Ω
nsuch that per A= min{per S:S∈Ωn}.As usual,
the matrix obtained from Aby deleting row iand column jis
denoted by Aij. We often consider Aas a sequence of ncolumns and
writeA=(a1,...,an). Later on, we shall consider permanents of
matrices of size n−1 but we wish to use the notation for matrices of
sizen. The trick is to write per ( a1,...,an−1,ej), whereejdenotes
thej-th standard basis vector. This permanent does not change
---PAGE BREAK---
12. The Van der Waerden conjecture 111
value if the j-th row and n-th column are deleted. We remind the
reader that by Problem 5C (Birkhoﬀ), the set Ω nis a convex set
with the permutation matrices as vertices.
We need a few elementary results on matrices in Ω n. The ﬁrst
statement is the same as Theorem 5.4.
Theorem 12.1. IfAisann×nmatrixwithnonnegativeentries,
then perA=0if and only if Acontains an s×tzero submatrix
such that s+t=n+1.
We shall call an n×nmatrixpartly decomposable if it contains
ak×n−kzero submatrix. So Ais partly decomposable if there
exist permutation matrices PandQsuch that
PAQ =/parenleftbigg
BC
OD/parenrightbigg
,
whereBandDare square matrices. If a matrix is not partly
decomposable, then we shall say that it is fully indecomposable .I f
A∈ΩnandAis partly decomposable, then, in the representation
given above, we must have C=O, because the sum of the entries
ofBequals the number of columns of Band the sum of the entries
ofBandCis equal to the number of rows of B. So in that case,
Ais the direct sum B∔Dof an element of Ω kand an element of
Ωn−k.
Problem 12A. LetAbe ann×nmatrix with nonnegative entries
(n≥2). Prove that Ais fully indecomposable if and only if per
Aij>0 for alliandj.
Problem 12B. LetAbe ann×nmatrix with nonnegative en-
tries. Prove that if Ais fully indecomposable, then AALlatticetopandALlatticetopA
are also fully indecomposable.Theorem 12.2. A minimizing matrix is fully indecomposable.
Proof: LetA∈Ω
nbe a minimizing matrix and suppose that A
is partly decomposable. Then, as we saw above, A=B∔C, where
B∈ΩkandC∈Ωn−k. By Theorem 12.1, we have per Ak,k+1=0
and perAk+1,k= 0. By Birkhoﬀ’s theorem, we may assume that B
andChave positive elements on their diagonals. In Awe replace
---PAGE BREAK---
112 A Course in Combinatorics
bkkbybkk−pepsilonαandc11byc11−pepsilonαand we put an pepsilonαin the positions
k,k+ 1 andk+1,k. The new matrix is again in Ω n,i fpepsilonαis small
enough. The permanent of the new matrix is equal to
perA−pepsilonαperAkk−pepsilonαperAk+1,k+1+O(pepsilonα2).
Since perAkkand perAk+1,k+1are both positive, this new perma-
nent is smaller than per Aifpepsilonαis suﬃciently small. This contradic-
tion proves the assertion. /square
Corollary. (i)Arowofaminimizingmatrixhasatleasttwopos-
itive entries.
(ii)For anyaijinaminimizingmatrix, thereisapermutation σ
such that σ(i)=jandas,σ(s)>0for1≤s≤n,sLnegationslash=i.
Proof: Clearly (i) is trivial, and (ii) follows from Problem 12A.
/square
Let us now look at how far we can get with calculus . A very
important step in the direction of a proof of (12.1) is the following
surprising result due to Marcus and Newman (1959).
Theorem 12.3. IfA∈Ωnis a minimizing matrix and ahk>0,
thenperAhk=p e rA.
Proof: LetSbe the subset of Ω nconsisting of the doubly stochas-
tic matrices Xfor which xij=0i faij= 0. Then Ais an interior
point of the set S, which is a subset of Rmfor somem. If we denote
the set of pairs (i,j ) for which aij=0b yZ, we can describe Sby
the relations:
n/summationdisplay
i=1xij=1,j =1,...,n ;
n/summationdisplay
j=1xij=1,i =1,...,n ;
xij≥0,i , j =1,...,n ;
xij=0,(i,j)∈Z.
SinceAis minimizing, the permanent function has a relative mini-
mum in the interior point Aof the set Sand we can use Lagrange
---PAGE BREAK---
12. The Van der Waerden conjecture 113
multipliers to describe the situation. So we deﬁne:
F(X): =p e rX−n/summationdisplay
i=1λi/parenleftBiggn/summationdisplay
k=1xik−1/parenrightBigg
−n/summationdisplay
j=1µj/parenleftBiggn/summationdisplay
k=1xkj−1/parenrightBigg
.
For (i,j)/∈Z,w eh a v e :
∂F(X)/∂xij=p e rXij−λi−µj.
It follows that per Aij=λi+µjand from this we ﬁnd that for
1≤i≤n
(12.2) per A=n/summationdisplay
j=1aijperAij=n/summationdisplay
j=1aij(λi+µj)=λi+n/summationdisplay
j=1aijµj,
and similarly for 1 ≤j≤n,
(12.3) perA=µj+n/summationdisplay
i=1aijλi.
We introduce the vectors λ=(λ1,...,λn)Llatticetopandµ=(µ1,...,µn)Llatticetop.
From (12.2) and (12.3), we ﬁnd
(12.4) (per A)j=λ+Aµ=µ+ALlatticetopλ.
Multiplying by ALlatticetopgives us
(perA)j=ALlatticetopλ+ALlatticetopAµ,
and hence µ=ALlatticetopAµ, and similarly λ=AALlatticetopλ. The matrices AALlatticetop
andALlatticetopAare both in Ω nand by Problem 12B and Theorem 12.2,
they have eigenvalue 1 with multiplicity one corresponding to the
eigenvector j. So we see that both λandµare multiples of j.B y
(12.4), we have λi+µj=p e rAand since per Aij=λi+µj, we are
ﬁnished. /square
---PAGE BREAK---
114 A Course in Combinatorics
Remark. It was shown by Marcus and Newman that Theorem
12.3 implies that a minimizing matrix in Ω∗
nmust beJn. The proof
depends on the following idea. Let Abe an element of Ω nwith
the property that per Ahk=p e rAfor allh,k. If we replace any
column of Aby a vector xfor which/summationtextn
i=1xij= 1, then the value of
the permanent does not change (by (11.6)). We shall refer to this
idea as the substitution principle .I fAis a minimizing matrix in Ω∗
n,
then the substitution principle allows us to replace any two columns
ofAby their average and thus obtain a new minimizing matrix. In
this way, one constructs a sequence of minimizing matrices whichtends toJ
n. The uniqueness of the minimum takes a little extra
work.
A ﬁnal result that uses ideas from calculus is the following gen-
eralization of Theorem 12.3 due to London (1971).
Theorem 12.4. IfA∈Ωnisaminimizingmatrix,then perAij≥
perAfor alliandj.
Proof: Letiandjbe given. By Corollary (ii) of Theorem 12.2,
there is a permutation σsuch that σ(i)=j andas,σ(s)>0 for
1≤s≤n,sLnegationslash=i. LetPbe the corresponding permutation matrix.
For 0≤θ≤1 we deﬁne f(θ) := per ((1 −θ)A+θP). SinceAis a
minimizing matrix, fLprime(0)≥0, i.e.
0≤n/summationdisplay
i=1n/summationdisplay
j=1(−aij+pij)perAij=−nperA+n/summationdisplay
s=1perAs,σ(s).
By Theorem 12.3 we have per As,σ(s)=p e rAforsLnegationslash=iand therefore
perAij≥perA. /square
Problem 12C. Show that Theorem 12.3 implies that if A∈Ω∗
5
is a minimizing matrix, then there is a minimizing matrix B∈Ω∗5
that hasaJof size 4 as a principal submatrix. Then show that a
must be1
5.
We now come to the main tool in the proof of the Van der Waer-
den conjecture. This time we need linear algebra . We shall give a
direct proof of a theorem on symmetric bilinear forms which leads
---PAGE BREAK---
12. The Van der Waerden conjecture 115
to the inequality that was derived by Egoritsjev from the so-called
Alexandroﬀ–Fenchel inequalities (which we do not treat).
Consider the space Rnwith a symmetric inner product Langbracketleftx,yLangbracketright=
xLlatticetopQy.I fQhas one positive eigenvalue and n−1 negative eigen-
values, we shall speak of a Lorentz space. We use the following
standard terminology: a nonzero vector xisisotropic ifLangbracketleftx,xLangbracketright=0 ,
positive, respectively negative,i f Langbracketleftx,xLangbracketrightis positive, respectively neg-
ative.
Every nonzero vector in the ( n−1)-dimensional span of the neg-
ative eigenvectors is negative, so if ais positive and bis not a
scalar multiple of a, then the plane spanned by aandbmust con-
tain a negative vector. Therefore the quadratic form in λgiven by
Langbracketlefta+λb,a+λbLangbracketrightmust have a positive discriminant. Thus we have
the following inequality, which is like the Cauchy inequality but theother way around.
Theorem 12.5. Ifais a positive vector in a Lorentz space and b
is arbitrary, then
Langbracketlefta,bLangbracketright
2≥Langbracketlefta,aLangbracketrightLangbracketleftb,bLangbracketright
and equality holds if and only if b=λafor some constant λ.
The connection with permanents is provided by the following
deﬁnition. Consider vectors a1,...,an−2inRnwithpositive coor-
dinates. As usual, let e1,...,enbe the standard basis of Rn.W e
deﬁne an inner product on Rnby
(12.5) Langbracketleftx,yLangbracketright:= per (a1,a2,...,an−2,x,y),
i.e.
Langbracketleftx,yLangbracketright=xLlatticetopQy,
whereQis given by
(12.6) qij:= per (a1,a2,...,an−2,ei,ej).
Note that if Ais a matrix with columns a1,...,anand we delete
the last two columns and the rows with index iandj, then the
reduced matrix has permanent equal to qij.
---PAGE BREAK---
116 A Course in Combinatorics
Theorem 12.6. The space Rnwith the inner product deﬁned by
(12.5)is a Lorentz space.
Proof: The proof is by induction. For n= 2, we have Q=/parenleftBig01
10/parenrightBig
and the assertion is true. Now assume the theorem is true for Rn−1.
In the ﬁrst step of the proof, we show that Qdoes not have the
eigenvalue 0. Suppose Qc= 0, i.e.
(12.7) per ( a1,...,an−2,c,ej) = 0 for 1 ≤j≤n.
By deleting the last column and the j-th row, we can consider (12.7)
as a relation for vectors in Rn−1. We consider the inner product
given by
(12.8) per ( a1,...,an−3,x,y,ej)jn
and apply the induction hypothesis, (12.7) and Theorem 12.5. Sub-
stitution of x=an−2,y=an−2in (12.8) gives a positive value, and
x=an−2,y=cgives the value 0. Therefore
(12.9) per ( a1,...,an−3,c,c,ej)≤0 for 1 ≤j≤n
and for each jequality holds if and only if all coordinates of c
exceptcjare 0. If we multiply the left-hand side of (12.9) by the
j-th coordinate of an−2and sum over j, we ﬁnd cLlatticetopQc. Therefore
the assumption Qc= 0 implies that c=0 .
For 0≤θ≤1, we deﬁne a matrix Qθby taking (12.5) and
replacing every aibyθai+( 1−θ)j. From what we have shown
above, it follows that for every θin [0,1] the matrix Qθdoes not
have the eigenvalue 0. Therefore the number of positive eigenvaluesis constant. Since this number is one for θ= 0, it is also one for
θ= 1, which proves our assertion. /square
We formulate the combination of Theorem 12.5 and Theorem
12.6 as a corollary. (The ﬁnal assertion follows by continuity.)
Corollary. Ifa
1,...,an−1are vectors in Rnwith positive coordi-
nates and b∈Rn, then
(per (a 1,...,an−1,b))2
≥per (a1,...,an−1,an−1)·per (a1,...,an−2,b,b)
---PAGE BREAK---
12. The Van der Waerden conjecture 117
and equality holds if and only if b=λan−1for some constant λ.
Furthermore, the inequality also holds if some of the coordinates
oftheaiare0,buttheassertionabouttheconsequenceofequality
then cannot be made.
We are now able to generalize Theorem 12.3.
Theorem 12.7. IfA∈Ωnisaminimizingmatrix,then perAij=
perAfor alliandj.
Proof: Suppose that the statement is false. Then by Theorem
12.4, there is a pair r,ssuch that per Ars>perA.
Choosetsuch that art>0. Consider the product of two factors
perA. In the ﬁrst of these we replace asbyat, and in the second,
we replace atbyas. Subsequently, we develop the ﬁrst permanent
by column sand the second permanent by column t. By Theorem
12.5 and the Corollary to Theorem 12.6, we have
(perA)2≥/parenleftBiggn/summationdisplay
k=1aktperAks/parenrightBigg/parenleftBiggn/summationdisplay
k=1aksperAkt/parenrightBigg
.
By Theorem 12.4, every subpermanent on the right-hand side is atleast perAand perA
rs>perA. Since per Arsis multiplied by
artwhich is positive, we see that the right-hand side is larger than
(perA)2, a contradiction. /square
We now use the substitution principle as follows. Take a mini-
mizing matrix Aand letuandvbe two columns of A. Replace u
andvby1
2(u+v). The new matrix is again a minimizing matrix
by Theorem 12.7.
LetAbe any minimizing matrix and let bbe any column of A,
say the last column. From Corollary (i) to Theorem 12.2, we knowthat in every row of Athere are at least two positive elements. We
now apply the substitution principle (as sketched above) a num-ber of times but we never change the last column. In this way,we can ﬁnd a minimizing matrix A
Lprime=(aLprime
1,...,aLprimen−1,b) for which
aLprime1,...,aLprimen−1all have positive coordinates. Now apply the Corollary
to Theorem 12.6. By the substitution principle, equality must hold.
Hencebis a multiple of aLprime
ifor anyiwith 1≤i≤n−1. This implies
thatb=n−1jand therefore A=n−1Jn, which completes the proof
of the Van der Waerden conjecture.
---PAGE BREAK---
118 A Course in Combinatorics
Theorem 12.8. The implication (12.1)is true.
Notes.
For a survey of the two proofs of the Van der Waerden conjec-
ture, we refer to Van Lint (1982). There one also ﬁnds historical
comments and a nice anecdote concerning the conjecture.
B. L. van der Waerden (1903–1996), a Dutch mathematician,
was known mostly for his work in algebra, although he publishedin several ﬁelds. His work Moderne Algebra (1931) set the trend
for many decades.
Minc’s book on permanents is the best reference for all the work
that was done in relation to the Van der Waerden conjecture up to1978.
The name Lorentz space is related to relativity theory and the
group of transformations that leave the quadratic form x
2+y2+
z2−t2invariant. H. A. Lorentz was a Dutch physicist who won the
Nobel prize for his work.
References.
J. H. van Lint (1981), Notes on Egoritsjev’s proof of the Van der
Waerden conjecture, Linear Algebra and its Applications 39, 1–8.
J. H. van Lint (1982), The van der Waerden Conjecture: Two proofs
in one year, The Math. Intelligencer 39, 72–77.
D. London (1971), Some notes on the van der Waerden conjecture,
Linear Algebra and its Applications 4, 155–160.
M. Marcus and M. Newman (1959), On the minimum of the per-
manent of a doubly stochastic matrix, Duke Math. J. 26, 61–72.
H. Minc (1978), Permanents, Encyclopedia of Mathematics and
its Applications, vol. 6, Addison-Wesley, reissued by CambridgeUniversity Press (1984).
B. L. van der Waerden (1926), Jber. D. M. V. 35.
---PAGE BREAK---
13
Elementary counting;
Stirling numbers
The next few chapters will be devoted to counting techniques and
some special combinatorial counting problems. We start with sev-eral elementary methods that are used quite often. Consider map-pings from {1,2,...,n}to{1,2,...,k}. Their total number is k
n.
In Example 10.2, we studied the case where the mappings wererequired to be surjective. We return to this question in Theorem13.5. If the mappings are injections, then their number is the falling
factorial
(13.1) ( k)
n:=k(k−1)...(k−n+1 )=k!/(k−n)!.
We now consider a similar problem. The nobjects to be mapped
are no longer distinguishable but the images are. We formulate this
as follows. We have nindistinguishable balls that are to be placed
inkboxes, marked 1, 2,...,k . In how many diﬀerent ways can this
be done? The solution is found by using the following trick. Thinkof the balls as being colored blue and line them up in front of theboxes that they will go into. Then insert a red ball between twoconsecutive boxes. We end up with a line of n+k−1 balls,k−1o f
them red, describing the situation. So the answer to the problem
is/parenleftbig
n+k−1
k−1/parenrightbig
. We formulate this as a theorem.
Theorem 13.1. The number of solutions of the equation
(13.2) x1+x2+···+xk=n
in nonnegative integers is/parenleftbign+k−1
k−1/parenrightbig
.
Proof: Interpretxias the number of balls in box i. /square
---PAGE BREAK---
120 A Course in Combinatorics
Corollary. Thenumberofsolutionsoftheequation (13.2)inpos-
itive integers is/parenleftbign−1
k−1/parenrightbig
.
Proof: Replacexibyyi:=xi−1. Then/summationtextyi=n−k.Apply
Theorem 13.1. /square
Example 13.1. By analogy with the question we encountered in
Example 10.6, we consider the problem of selecting rof the integers
1,2,...,n such that no two selected integers are consecutive. Let
x1<x 2<···<xrbe such a sequence. Then x1≥1,x2−x1≥
2,...,x r−xr−1≥2.Deﬁne
y1:=x1,yi:=xi−xi−1−1,2≤i≤r, yr+1:=n−xr+1.
Then theyiare positive integers and/summationtextr+1
i=1yi=n−r+ 2. By the
Corollary to Theorem 13.1, we see that there are/parenleftbign−r+1
r/parenrightbig
solutions.
Problem 13A. On a circular array with npositions, we wish to
place the integers 1, 2,...,r in order, clockwise, such that consecu-
tive integers, including the pair ( r,1), are not in adjacent positions
on the array. Arrangements obtained by rotation are considered
the same. In how many ways can this be done?
Example 13.2. In how many ways can we arrange r1balls of color
1,r2balls of color 2 ,...,rkballs of color kin a sequence of length
n:=r1+r2+···+rk? If we number the balls 1 to n, then there are
n! arrangements. Since we ignore the numbering, any permutation
of the set of riballs of color i,1≤i≤k, produces the same
arrangement. So the answer to the question is the multinomialcoeﬃcient/parenleftbig
n
r1,...,rk/parenrightbig
; see (2.1).
Example 13.3. We wish to split {1,2,...,n}intob1subsets of size
1,b2subsets of size 2, ..., bksubsets of size k.H e r e/summationtextk
i=1ibi=n.
The same argument as used in Example 13.2 applies. Furthermore,
the subsets of the same cardinality can be permuted among them-selves without changing the conﬁguration. So the solution is
(13.3)n!
b1!...bk!(1!)b1(2!)b2...(k!)bk.
Several counting problems (often involving binomial coeﬃcients)
can be done in a more or less obvious way that leads to a (sometimes
---PAGE BREAK---
13. Elementary counting; Stirling numbers 121
diﬃcult) calculation. Often there is a less obvious ‘combinatorial’
way to do the counting that produces an immediate answer. Wegive a few examples.
Example 13.4. LetArun through all subsets of {1,2,...,n}.
Calculate S=/summationtext|A|. Since there are/parenleftbig
n
i/parenrightbig
subsets of size i,w e
apparently must calculate/summationtextn
i=0i/parenleftbign
i/parenrightbig
. By diﬀerentiating (1 + x)n,
we ﬁndn/summationdisplay
i=1i/parenleftbiggn
i/parenrightbigg
xi−1=n(1 +x)n−1
and substitution of x= 1 yields the answer S=n·2n−1. If we had
spent a little more time thinking, then this answer would have been
obvious! A set Aand its complement together contain nelements
and there are exactly 2n−1such pairs.
Example 13.5. In Chapter 10 we saw some examples of formulae
involving binomial coeﬃcients for which a combinatorial proof waseasier than a direct proof. The familiar relation
(13.4) n/summationdisplay
k=0/parenleftbiggn
k/parenrightbigg2
=/parenleftbigg2n
n/parenrightbigg
is another example. Of course one can calculate this sum by de-
termining the coeﬃcient of xnin (1 +x)n(1 +x)nand using the
binomial formula. However, each side of (13.4) just counts (in twoways) the number of ways of selecting nballs from a set consisting
ofnred balls and nblue balls.
Problem 13B. Show that the following formula for binomial co-
eﬃcients is a direct consequence of (10.6):
/parenleftbiggn+1
a+b+1/parenrightbigg
=n/summationdisplay
k=0/parenleftbiggk
a/parenrightbigg/parenleftbiggn−k
b/parenrightbigg
.
Give a combinatorial proof by considering ( a+b+ 1)-subsets of
the set{0,1,...,n}, ordering them in increasing order, and then
looking at the value of the integer in position a+1 .
Example 13.6. We consider a slightly more complicated example
where our previous knowledge could lead us to an involved solu-tion. How many sequences A
1,...,Akare there for which Ai⊆
---PAGE BREAK---
122 A Course in Combinatorics
{1,2,...,n},1≤i≤k, and/uniontextk
i=1Ai={1,2,...,n}? Since we wish
to avoid that j,1≤j≤n, is not an element of the union of the
Ai’s, we are tempted to use inclusion-exclusion. If we choose iele-
ments from {1,2,...,n}and consider all sequences A1,...,Aknot
containing any of these ielements, then we ﬁnd (2n−i)ksequences.
So by Theorem 10.1, the solution to the problem is
n/summationdisplay
i=0(−1)i/parenleftbiggn
i/parenrightbigg
2(n−i)k=( 2k−1)n.
This answer shows that another approach would have been better.
If we describe a sequence A1,...,Akb ya( 0,1)-matrix Aof size
k×n, with the characteristic functions of the subsets as its rows,
then the condition on the sequences states that Ahas no column
of zeros. So there are (2k−1)nsuch matrices!
Problem 13C. Give a solution involving binomial coeﬃcients and
a combinatorial solution to the following question. How many pairs(A
1,A2) of subsets of {1,2,...,n}are there such that A1∩A2=∅?
Problem 13D. Consider the set Sof all ordered k-tuplesA=
(A1,...,Ak) of subsets of {1,2,...,n}. Determine
/summationdisplay
A∈S|A1∪A2∪···∪A k|.
Problem 13E. The familiar relation
l/summationdisplay
m=k/parenleftbiggm
k/parenrightbigg
=/parenleftbiggl+1
k+1/parenrightbigg
is easily proved by induction. The reader who wishes to, can ﬁnd amore complicated proof by using (10.6). Find a combinatorial proofby counting paths from (0,0) to ( l+1,k+1) in the X-Yplane where
each step is of type (x,y )→(x+1,y)o r(x,y)→(x+1,y+ 1).
Then use the formula to show that the number of solutions of
x
1+x2+···+xk≤n
---PAGE BREAK---
13. Elementary counting; Stirling numbers 123
in nonnegative integers is/parenleftbign+k
k/parenrightbig
. Can you prove this result combi-
natorially?
It is often possible to prove relations between binomial coeﬃ-
cients by considering/parenleftbiga
k/parenrightbig
formally as a polynomial in adeﬁned by
/parenleftbigga
k/parenrightbigg
:=a(a−1)···(a−k+1 )
k!.
If two polynomials of degree ≤kagree for k+ 1 values of the
variable, they are identical. We give an example.
Let
F(a): =n/summationdisplay
k=0/parenleftbigga
k/parenrightbigg
xkyn−k,G(a): =n/summationdisplay
k=0/parenleftbiggn−a
k/parenrightbigg
(−x)k(x+y)n−k.
From the binomial theorem we know that if ais an integer in the
interval [0,n ], thenF(a)=(x+y)ayn−abut so isG(a), again by
the binomial theorem. So, the polynomials are identical and we
can substitute any numbers for a,x, andyto obtain relations for
binomial coeﬃcients. For instance, y=2xanda=2n+ 1 yields:
n/summationdisplay
k=0/parenleftbigg2n+1
k/parenrightbigg
2n−k=n/summationdisplay
k=0/parenleftbiggn+k
k/parenrightbigg
3n−k,
a relation that would be extremely diﬃcult to prove by counting.
Two kinds of numbers that come up in many combinatorial prob-
lems are the so-called Stirling numbers of the ﬁrst and second kind .
The numbers are often deﬁned by the formulae (13.8) and (13.12)given below. We prefer a combinatorial deﬁnition.
Letc(n,k ) denote the number of permutations π∈S
nwith ex-
actlykcycles. (This number is called a signless Stirling number of
the ﬁrst kind.) Furthermore deﬁne c(0,0) = 1 and c(n,k )=0i f
n≤0o rk≤0, (n,k )Lnegationslash=( 0,0). The Stirling numbers of the ﬁrst
kinds(n,k ) are deﬁned by
(13.5) s(n,k ): =(−1)n−kc(n,k ).
---PAGE BREAK---
124 A Course in Combinatorics
Theorem 13.2. The numbers c(n,k )satisfy the recurrence rela-
tion
(13.6) c(n,k )=(n−1)c(n−1,k)+c(n−1,k−1).
Proof: Ifπis a permutation in Sn−1withkcycles, then there
aren−1 positions where we can insert the integer nto produce
a permutation πLprime∈Snwithkcycles. We can also adjoin (n)a sa
cycle to any permutation in Sn−1withk−1 cycles. This accounts
for the two terms on the right-hand side of (13.6). /square
Theorem 13.3. Forn≥0we have
(13.7)n/summationdisplay
k=0c(n,k )xk=x(x+1 )...(x+n−1)
and
(13.8)n/summationdisplay
k=0s(n,k )xk=(x)n,
where (x)nis deﬁned as in (13.1).
Proof: Write the right-hand side of (13.7) as
Fn(x)=n/summationdisplay
k=0b(n,k )xk.
Clearlyb(0,0) = 1. Deﬁne b(n,k ): =0i fn≤0o rk≤0, (n,k )Lnegationslash=
(0,0). Since
Fn(x)=(x+n−1)Fn−1(x)
=n/summationdisplay
k=1b(n−1,k−1)xk+(n−1)n−1/summationdisplay
k=0b(n−1,k)xk,
we see that the numbers b(n,k ) satisfy the same recurrence relation
as thec(n,k ), namely (13.6). Since the numbers are equal if n≤0
ork≤0, they are equal for all nandk.
---PAGE BREAK---
13. Elementary counting; Stirling numbers 125
To prove (13.8) replace xby−xand use (13.5). /square
We remark that it is possible to give a combinatorial proof of
(13.7) by showing that both sides of the equation count the same
objects.
We now deﬁne the Stirling numbers of the second kind: denote
byP(n,k) the set of all partitions of an n-set into knonempty
subsets (blocks). Then
(13.9) S(n,k): =|P (n,k)|.
Again we have S(0,0) = 1 and take the numbers to be 0 for all
values of the parameters not covered by the previous deﬁnition.
Again we have an easy recurrence relation.
Theorem 13.4. The Stirling numbers of the second kind satisfy
the relation
(13.10) S(n,k)=kS (n−1,k)+S(n−1,k−1).
Proof: The proof is nearly the same as for Theorem 13.3. A
partition of the set {1,2,...,n−1}can be made into a partition
of{1,2,...,n}by adjoining nto one of the blocks or by increasing
the number of blocks by one by making {n}a block. /square
We deﬁne the Bell number B(n)t ob et h etotal number of parti-
tions of an n-set, i.e.
(13.11) B(n): =n/summationdisplay
k=1S(n,k), (n≥1).
For the Stirling numbers of the second kind there is a formula
similar to (13.8).
Theorem 13.5. Forn≥0we have
(13.12) xn=n/summationdisplay
k=0S(n,k)(x)k.
Proof: We ﬁrst remark that by (13.9) the number of surjective
mappings from an n-set to a k-set isk!S(n,k) (a block of the parti-
tion is the inverse image of an element of the k-set). So by Example
10.2, we have
---PAGE BREAK---
126 A Course in Combinatorics
(13.13)S(n,k)=1
k!k/summationdisplay
i=0(−1)i/parenleftbiggk
i/parenrightbigg
(k−i)n=1
k!k/summationdisplay
i=0(−1)k−i/parenleftbiggk
i/parenrightbigg
in.
Now letxbe an integer. There are xnmappings from the n-set
N:={1,2,...,n}to thex-set{1,2,...,x}. For any k-subsetYof
{1,2,...,x}, there are k!S(n,k) surjections from NtoY.S o w e
ﬁnd
xn=n/summationdisplay
k=0/parenleftbiggx
k/parenrightbigg
k!S(n,k)=n/summationdisplay
k=0S(n,k)(x)k.
/square
In Example 10.1, we saw that it can be useful to associate a so-
calledgenerating function with a sequence a1,a2,...of numbers.
In Chapter 14, we will see many uses of the generating function.
At this point we treat the generating functions for the Stirlingnumbers.
Theorem 13.6./summationtext
n≥kS(n,k)xn
n!=1
k!(ex−1)k(k≥0).
Proof: LetFk(x) denote the sum on the left-hand side. By (13.10)
we have
FLprime
k(x)=kFk(x)+F k−1(x).
The result now follows by induction. Since S(n,1) = 1, the as-
sertion is true for k= 1 and the induction hypothesis yields a
diﬀerential equation for Fk, which with the condition S(k,k)=1
has the right-hand side of the assertion as unique solution. /square
For the Stirling numbers of the ﬁrst kind, it is slightly more
diﬃcult to ﬁnd the generating function.Theorem 13.7./summationtext
∞
n=ks(n,k )zn
n!=1
k!(log(1 +z))k.
Proof: Since
(1 +z)x=exlog(1+z)=∞/summationdisplay
k=01
k!(log(1 +z))kxk,
---PAGE BREAK---
13. Elementary counting; Stirling numbers 127
the right-hand side in the assertion is the coeﬃcient of xkin the
expansion of (1 + z)x. On the other hand, we have for |z|<1,
(1 +z)x=∞/summationdisplay
n=0/parenleftbiggx
n/parenrightbigg
zn=∞/summationdisplay
n=01
n!(x)nzn
=∞/summationdisplay
n=0zn
n!n/summationdisplay
r=0s(n,r )xr=∞/summationdisplay
r=0xr∞/summationdisplay
n=rs(n,r )zn
n!.
This completes the proof. /square
Problem 13F. Show directly that the number of permutations of
the integers 1 to nwith an even number of cycles is equal to the
number of permutations with an odd number of cycles ( n>1).
Also show that this is a consequence of Theorem 13.7.
Finally we mention that the Stirling numbers of the ﬁrst and
second kind are related by
(13.14)n/summationdisplay
k=mS(n,k)s(k,m )=δmn.
This follows immediately if we substitute (13.8) in (13.12). Since
the functions xn, respectively (x) n, withn≥0 both form a basis
of the vector space C[x], the formula (13.14) is just the standard
relation between the matrices for basis transformation.
Problem 13G. Show that (13.12) leads to B(n)=1
e/summationtext∞
k=0kn
k!.
Problem 13H. LetAbe then×nmatrix with aij:=/parenleftbigi
j/parenrightbig
for
i,j=0,...,n−1. Determine A−1.
Problem 13I. From (10.6) one ﬁnds, by taking x=1
2, that/summationtext∞j=0/parenleftbiga+j
j/parenrightbig
2−j=2a+1. Using a method from this chapter prove
thata/summationdisplay
j=0/parenleftbigga+j
j/parenrightbigg
2−j=2a.
Prove the same result directly by deﬁning
an=a/summationdisplay
j=0/parenleftbigga+j
j/parenrightbigg
2−a−j,
---PAGE BREAK---
128 A Course in Combinatorics
substituting the basic recurrence for binomial coeﬃcients, thus ﬁnd-
ing thatan=1
2an+1
2an−1.
Problem 13J. Suppose we call a set niceif its cardinality is di-
visible by 3. How many nice subsets does an n-set have?
Problem 13K. Prove that/summationtext∞
n=1S(n,n−2)xn=x(1+2x )
(1−x)5.
Notes.
Stirling numbers of the ﬁrst and second kind appear in many
areas of mathematics; for example, they play a role in a number
of interpolation formulae and in the calculus of ﬁnite diﬀerences.There are tables of the numbers in several books on tables of math-ematical functions.
Later, in Chapter 37, these numbers will reappear.James Stirling (1692–1770), a Scottish mathematician, studied
at Oxford. He taught mathematics at Venice and London butswitched to a career in business at the age of 43.
---PAGE BREAK---
14
Recursions and
generating functions
Many combinatorial counting problems with a solution andepend-
ing on a parameter n, can be solved by ﬁnding a recursion relation
foranand then solving that recursion. Sometimes this is done by
introducing an ordinary generating function
f(x): =/summationdisplay
n≥0anxn,
or anexponential generating function
f(x): =/summationdisplay
n≥0anxn
n!,
and using the recursion to ﬁnd an equation or a diﬀerential equation
forf(x), and solving that equation. We shall demonstrate several
of the techniques involved.
Example 14.1. As an introduction, consider once again Example
10.1. Let πbe a derangement of {1,2,...,n +1}. There are n
choices for π(n+ 1). Ifπ(n+1 )=iandπ(i)=n + 1, then πis
also a derangement on the set {1,2,...,n}\{i}.I fπ(n+1)=iand
π(i)Lnegationslash=n+1=π(j), then replacing π(j)b yiyields a derangement
on the set {1,2,...,n}. Therefore
(14.1) dn+1=n(dn+dn−1),
which is also an immediate consequence of (10.3). Let D(x)b e
theexponential generating function for the sequence d0=1,d1=
0,d2,.... From (14.1) we immediately ﬁnd
(1−x)DLprime(x)=xD (x),
---PAGE BREAK---
130 A Course in Combinatorics
and from this we ﬁnd D(x)=e−x/(1−x) and (10.2).
In many cases, we use the generating functions only as a book-
keeping device, and our operations of addition, multiplication (and
even substitution and derivation, as we shall see below) are to beinterpreted formally. It is possible to give a completely rigoroustheory of formal power series (as algebraic objects) and we givean introduction to this theory in Appendix 2. In most cases, it isintuitively clear and easy to check that the operations are legiti-mate. If the series that we use actually converge, then we can useall appropriate knowledge from analysis concerning these series, aswe did in Example 14.1. We give another elementary example.
Example 14.2. Suppose that we have kboxes numbered 1 to k
and suppose that box icontainsr
iballs, 1≤i≤k. A formal
bookkeeping device to list all possible conﬁgurations is to let the
named one correspond to the term xr1
1xr2
2···xrk
kin the product
(1 +x1+x2
1+···)(1 +x2+x22+···)···(1 +xk+x2k+···).
We can collect all the terms involving exactly nballs by taking
xi=xfor alli, and considering the terms equal to xn. Therefore we
ﬁnd that the number of ways to divide nballs overkdistinguishable
boxes is the coeﬃcient of xnin the expansion of (1 −x)−k, and by
(10.6) this is/parenleftbigk−1+n
n/parenrightbig
, giving a second proof of Theorem 13.1.
In many cases, the combinatorial problem that we are interested
in leads to a linear recursion relation with constant coeﬃcients,
which is easily solved by standard methods.
Example 14.3. We consider paths of length nin theX-Yplane
starting from (0,0) with steps R:(x,y)→(x+1,y),L:(x,y)→
(x−1,y), andU:(x,y)→(x,y+1) (i.e. to the right, to the left, or
up). We require that a step Ris not followed by a step Land vice
versa. Let andenote the number of such paths. First observe that
if we denote by bnthe number of paths of length nstarting with a
stepU, thenbn=an−1and furthermore trivially bn+m≥bnbmand
bn≤3n−1. So by Fekete’s lemma, Lemma 11.6, lim n→∞b1/n
nexists
and is at most 3. Next, note that a0= 1 anda1= 3. We split
the set of paths of length ninto subsets depending on the last one
---PAGE BREAK---
14. Recursions and generating functions 131
or two steps. Clearly there are an−1paths ending with the step U.
Take a path of length n−1 and repeat the last step if it is LorR,
and adjoin a step Lif the last step was U. In this way, we obtain
all the paths of length nthat end in LL,RR,o rUL . So there are
an−1of these. It remains to count the paths ending with URand
again it is trivial that there are an−2of these. We have shown that
an=2an−1+an−2 (n≥2).
Letf(x)=/summationtext∞
n=0anxn. Then the recursion implies that
f(x)=1+3 x+2x(f(x)−1) +x2f(x),
i.e.
f(x)=1+x
1−2x−x2=1
2α
1−αx+1
2β
1−βx,
whereα=1+√
2,β=1−√
2. Therefore
an=1
2(αn+1+βn+1)
and we ﬁnd lim n→∞a1/n
n=1+√
2.
Problem 14A. (i) Letandenote the number of sequences of 0’s
and 1’s that do not contain two consecutive 0’s. Determine an.
(ii) Letbndenote the number of sequences of 0’s and 1’s with no
two consecutive 1’s and for which a run of 0’s always has length 2
or 3, including possibly at the beginning or end of the sequence.
Show that b1/n
n→cfor somecand approximate c.
Example 14.4. Leta(r,n ), where 0 ≤r≤n, denote the number
of solutions of the problem of Example 13.1 ( a(0,0) = 1). We
divide the set of possible sequences into two subsets: those with
x1= 1 and those with x1>1. The ﬁrst subset clearly contains
a(r−1,n−2) elements, the second one a(r,n−1) elements. So
(14.2) a(r,n )=a(r,n −1) +a(r−1,n−2) (n>1).
---PAGE BREAK---
132 A Course in Combinatorics
From this recursion, we can prove the result a(r,n )=/parenleftbign−r+1
r/parenrightbig
by
induction. Using the generating function is more diﬃcult. Try
f(x,y): =∞/summationdisplay
n=0∞/summationdisplay
r=0a(r,n )xnyr.
From (14.2) we ﬁnd
f(x,y)=1+x+xy+x(−1+f (x,y)) +x2yf(x,y),
i.e.
f(x,y)=1+xy
1−x−x2y=1
1−x+∞/summationdisplay
a=1x2a−1ya
(1−x)a+1.
Substitution of (10.6) for (1 −x)−a−1produces the required binomial
coeﬃcient for a(r,n ).
As we saw in Example 14.3 (and Problem 14A) a linear recursion
with constant coeﬃcients leads to a rational function as generating
function (and vice versa). Indeed, if an=/summationtextl
k=1αkan−k(n>l ) and
f(x)=/summationtext∞n=0anxn, then (1 −/summationtextlk=1αkxk)f(x) is a power series for
which the coeﬃcient of xni s0i fn>l.
The following example due to Klarner (1967) shows an inter-
esting case of a linear recursion that is found with the help of the
generating function and that is not at all obvious in a combinatorialway.
Example 14.5. Consider conﬁgurations in the plane, called poly-
ominoes, as in Fig. 14.1. The conﬁguration consists of layers, each
consisting of consecutive squares. Two consecutive layers meetalong the edges of a number ( ≥1) of squares. (More precisely,
we are considering horizontally convexpolyominoes .)
12
91011
678
12345
Figure 14.1
---PAGE BREAK---
14. Recursions and generating functions 133
Letandenote the number of polyominoes with nsquares and
deﬁnef(x): =/summationtext∞
n=1anxn. To ﬁndf, we introduce a(m,n) for the
number of polyominoes for which the bottom layer has msquares
(and a total of n). We deﬁne a(m,n): =0i f m>n . Clearly
(14.3) a(m,n)=∞/summationdisplay
l=1(m+l−1)a(l,n−m).
We deﬁne
(14.4) F(x,y): =∞/summationdisplay
n=1∞/summationdisplay
m=1a(m,n)xnym.
Thenf(x)=F (x,1). Because the series will turn up below, we
also deﬁne
g(x): =∞/summationdisplay
n=1∞/summationdisplay
m=1ma(m,n)xn.
We would like to write
(14.5) g(x)=/parenleftbigg∂F
∂y/parenrightbigg
y=1.
Even though we have a theory of formal power series, it may be
instructive to show that the righthand side of (14.4) converges ina suﬃciently large region. This gives us the opportunity to show aquick way of getting a rough estimate for a
n. Number the squares
of the polyomino in the obvious way as in Fig. 14.1. To each squareassociate a quadruple (x
0,x1,x2,x3) of 0’s and 1’s, where x0=1
means that there is a square of the polyomino below this square,x
1= 1 means that there is a square of the polyomino to the left,
x2= 1 means that there is a square above, and x3= 1 means
that there is a square to the right. For example, in Fig. 14.1 theﬁrst quadruple is (0,0,1,1). The sequence of quadruples uniquelydetermines the polyomino (e.g. the ﬁfth quadruple is the ﬁrst onein the sequence that ends in a 0, showing that m= 5, etc.). This
shows that a
n≤15n. From this and (14.3) we ﬁnd a(m,n)≤
---PAGE BREAK---
134 A Course in Combinatorics
n·15n−mwhich is enough to justify (14.5). From (14.4) we ﬁnd by
substituting (14.3) and a straightforward calculation
(14.6) F(x,y)=xy
1−xy+(xy)2
(1−xy)2f(x)+xy
1−xyg(x).
Diﬀerentiation of both sides of (14.6) with respect to yand taking
y= 1 yields (using (14.5)):
(14.7) g(x)=x
(1−x)2+2x2
(1−x)3f(x)+x
(1−x)2g(x).
From (14.7) we can ﬁnd g(x) and substitute this in (14.6); then
takey= 1, which yields
(14.8) f(x)=x(1−x)3
1−5x+7x2−4x3.
From (14.8) we see that ansatisﬁes the recurrence relation
(14.9) an=5an−1−7an−2+4an−3 (n≥5).
As we remarked above, it is not at all clear how one could prove
this directly; it has been done however.
Remark. From (14.9) we ﬁnd that lim n→∞a1/n
n=θ, whereθis the
zero with largest absolute value of the polynomial x3−5x2+7x−4
(θ≈3.2).
The following example produces a result that is important for the
theory of ﬁnite ﬁelds. In this example, we combine a generalization
of the idea of Example 14.2 with the method of formal operationswith power series. The reader should convince herself that theoperations with logarithms are correct without using convergence.
Example 14.6. We shall count the number of irreducible polyno-
mials of degree nover a ﬁeld of qelements.
Number all the monic irreducible polynomials of degree at least
one over a ﬁeld of qelements:
f
1(x),f 2(x),f 3(x),...
---PAGE BREAK---
14. Recursions and generating functions 135
with, say, respective degrees d1,d2,d3,.... LetNddenote the num-
ber of degree d,d=1,2,3,... .
Now for any sequence i1,i2,i3,...of nonnegative integers (all but
ﬁnitely many of which are zero), we get a monic polynomial
f(x)=(f1(x))i1(f2(x))i2(f3(x))i3...
whose degree is n=i1d1+i2d2+i3d3+···. By unique factor-
ization, every monic polynomial of degree narises exactly once in
this way. To repeat, there is a one-to-one correspondence between
monic polynomials of degree nand sequences i1,i2,...of nonneg-
ative integers satisfying n=i1d1+i2d2+i3d3+···.
Of course, the number of monic polynomials of degree nisqn,
i.e. the coeﬃcient of xnin
1
1−qx=1+qx+(qx)2+(qx)3+···.
Clearly (cf. Example 14.2), the number of sequences i1,i2,...with
n=i1d1+i2d2+...is the coeﬃcient of xnin the formal power
series
(1 +xd1+x2d1+x3d1+···)(1 +xd2+x2d2+x3d2+···)... .
Thus we conclude
1
1−qx=∞/productdisplay
i=11
1−xdi=∞/productdisplay
d=1/parenleftbigg1
1−xd/parenrightbiggNd
.
Recalling that log1
1−z=z+1
2z2+1
3z3+···, we take (formal)
logarithms of both extremes of the above displayed equation toﬁnd
∞/summationdisplay
n=1(qx)n
n=∞/summationdisplay
d=1Nd∞/summationdisplay
j=1xjd
j.
Then, comparing coeﬃcients of xnon both sides, we get
qn
n=/summationdisplay
d|nNd1
n/d,
---PAGE BREAK---
136 A Course in Combinatorics
i.e.
qn=/summationdisplay
d|ndNd.
This last equation was our goal. We have derived it combinatori-
ally from unique factorization, but we remark that it has in fact an
elegant interpretation in terms of the factorization of xqn−xover
the ﬁeld of qelements. Applying M¨ obius inversion (cf. Theorem
10.4), we obtain the following theorem.
Theorem 14.1. For a prime power q, the number of monic irre-
duciblepolynomialsofdegree novertheﬁeldof qelementsisgiven
by
Nn=1
n/summationdisplay
d|nµ(n
d)qd.
We note that a direct consequence of Theorem 14.1 is that Nd>
0, that is, there exist irreducible polynomials of every degree d.
This immediately leads to a proof of the existence of ﬁelds of pd
elements for every prime p, without the usual expedient of reference
to the algebraic closures of the prime ﬁelds.
***
We now come to a large class of counting problems, all with
the same solution. The class is known as the Catalan family be-
cause Catalan (1838) treated Example 14.7. Actually, the equiva-
lent problem called Question 3 in Example 14.9 below was treatedby von Segner and Euler in the 18th century. We denote the so-lutions to the problems by u
n. We shall show that un=1
n/parenleftbig2n−2
n−1/parenrightbig
.
These numbers are called Catalan numbers .
Example 14.7. Suppose that we have a set Swith anonasso-
ciative product operation. An expression x1x2...xnwithxi∈S
does not make sense, and brackets are needed to indicate the orderin which the operations are to be carried out. Let u
ndenote the
number of ways to do this if there are nfactorsxi. For example,
u4=1
4/parenleftbig6
3/parenrightbig
= 5 corresponding to the products ( a(b(cd))), ( a((bc)d)),
((ab)(cd)), (( a(bc))d), and ((( ab)c)d). Each product contains within
the outer brackets two expressions, the ﬁrst a product of mfactors
---PAGE BREAK---
14. Recursions and generating functions 137
and the second a product of n−mfactors, where 1 ≤m≤n−1.
It follows that the numbers unsatisfy the recurrence relation
(14.10) un=n−1/summationdisplay
m=1umun−m (n≥2).
From (14.10) and u1= 1, we ﬁnd that the generating function
f(x): =/summationtext∞
n=1unxnsatisﬁes the equation
(14.11) f(x)=x +∞/summationdisplay
n=2/parenleftBiggn−1/summationdisplay
m=1umun−m/parenrightBigg
xn=x+(f(x))2.
Solving the quadratic equation and taking into account that f(0) =
0, we ﬁnd
f(x)=1−√1−4x
2.
From the binomial series we then obtain
(14.12) un=1
n/parenleftbigg2n−2
n−1/parenrightbigg
.
The operations carried out above can all be justiﬁed as formal op-
erations on power series, and the binomial series can also be treatedformally without being concerned about convergence. If one feelsuneasy about this approach, there are two remedies. The ﬁrst isto ﬁnd the solution as we did above and afterwards prove that it iscorrect by using (14.10) and induction. If one really wishes to besure that the generating function is deﬁned by a convergent powerseries, then use the result of the calculation to ﬁnd some rough es-timate for u
nand prove that the estimate is correct using (14.11),
and then show that the series converges. For example, we couldtryu
n≤cn−1/n2. This is true for n= 1 and any positive cand it
is true for n=2i fc≥4. The induction step with (14.11) yields
un≤cn−2n−1/summationdisplay
m=11
m2(n−m)2≤cn−2 2
(n/2)2∞/summationdisplay
m=11
m2<cn−1
n2
---PAGE BREAK---
138 A Course in Combinatorics
ifc>4
3π2. So the radius of convergence of/summationtext∞
n=1unxnis positive.
Remark. Formula (14.10) shows that un≥umun−m,and then
Fekete’s lemma implies that lim n→∞u1/n
nexists. In fact, (14.12)
now shows that this limit is 4.
As we remarked above, the Catalan numbers reappear regularly
in combinatorial counting problems. This has led to the question
of proving the other results combinatorially, i.e. by showing thatthere is a one-to-one correspondence between the objects to becounted and those of Example 14.7. Some of these will be treatedin Example 14.9. First we look at another famous counting problemthat has the Catalan numbers as solution.
Example 14.8. Consider walks in the X-Yplane where each step
isU:(x,y)→(x+1,y+1) orD:(x,y)→(x+1,y−1). We start
at (0,0) and ask in how many ways we can reach (2 n,0) without
crossing theX-axis. The solution of this problem uses an elegant
trick known as Andr´ e’s reﬂection principle (1887). In Fig. 14.2 we
consider two points AandBin the upper halfplane and a possible
path between them which meets and/or crosses the X-axis.
By reﬂecting the part of the path between Aand the ﬁrst meeting
with theX-axis (i.e.Cin Fig. 14.2) with respect to the X-axis, we
ﬁnd a path from the reﬂected point A
LprimetoB. This establishes a
one-to-one correspondence between paths from ALprimetoBand paths
fromAtoBthat meet or cross the X-axis.
Figure 14.2
It follows that if A=( 0,k) andB=(n,m), then there are/parenleftbign
l1/parenrightbig
paths from AtoBthat cross or meet the X-axis, where 2l 1:=n−
k−m. Since there are/parenleftbign
l2/parenrightbig
paths from AtoB, where 2l 2:=n−m+k,
---PAGE BREAK---
14. Recursions and generating functions 139
we ﬁnd/parenleftbign
l2/parenrightbig
−/parenleftbign
l1/parenrightbig
paths from AtoBthat do not meet the X-axis.
Any path from (0,0) to (2 n,0) in the upper halfplane that does not
meet theX-axis between these points goes from (0,0) to (1,1):=A,
fromAtoB:= (2n−1,1) without meeting the X-axis, and then
from (2n−1,1) to (2n, 0). By the argument above, we ﬁnd that
there areunsuch paths. If we allow the paths to meet the X-axis
without crossing, then there are un+1such paths.
We remark that the number of paths from (0,0) to (2n, 0) in the
upper halfplane that do not meet the X-axis between these points is
equal to the number of sequences of zeros and ones (x 1,x2,...,x 2n)
with
(14.13) x1+x2+···+xj/braceleftbigg<1
2jfor 1≤j≤2n−1,
=nforj=2n.
The correspondence is given by letting a 1 correspond to a step D
of the path.
We now show by combinatorial arguments that several counting
problems lead to the Catalan numbers.
Example 14.9. Consider the following three questions.
Question 1. A tree that is drawn in the plane is called a plane
tree. How many rooted plane trees are there with nvertices and a
root with degree 1 (so-called planted plane trees)?
Question 2. A planted plane tree is called trivalent or abinary
tree if every vertex has degree 1 or 3. How many trivalent planted
plane trees are there with nvertices of degree 1?
Question 3. In how many ways can one decompose a convex
n-gon into triangles by n−3 nonintersecting diagonals?
The ﬁrst correspondence we shall show is between Question 2
and Example 14.7.
---PAGE BREAK---
140 A Course in Combinatorics
For this, Fig. 14.3 suﬃces.
Figure 14.3
It follows that the solution to Question 2 is un−1.
The correspondence between Question 1 and Example 14.8 is also
seen from a ﬁgure, namely Fig. 14.4.
Figure 14.4
In the ﬁgure, the tree can be described by a walk around it as
shown by the dotted line. This walk can be described by calling
the stepsUfor a step going up, and Dfor a step going down. This
yields a sequence of twelve steps. Replacing Uby 0 and Dby 1
yields a sequence that obviously satisﬁes (14.13). This shows thatthe solution to Question 1 is also u
n−1.
Finally, we show a correspondence between Question 3 and Ques-
tion 2. Consider an n-gon decomposed into triangles and distin-
guish some edge. We now construct a tree as in Fig. 14.5.
---PAGE BREAK---
14. Recursions and generating functions 141
Figure 14.5
The tree is a binary tree with vertices of degree 1 corresponding
to the sides of the n-gon, and vertices of degree 3 corresponding to
the triangles. The tree is planted at the vertex corresponding to
the special edge. So again we ﬁnd that the number of solutions isu
n−1.
Problem 14B. Describe (with a ﬁgure) a correspondence between
the graphs of Question 1 and those of Question 2.
Problem 14C. Find a direct one-to-one mapping from the n-gons
of Question 3 to the products of Example 14.7.
We now turn to several problems in which the exponential gen-
erating function turns out to be useful. We shall give a somewhat
more systematic treatment for this case. For a complete treatmentof the methods, we refer to A. Joyal (1981).
LetMdenote a ‘type’ of combinatorial structure. For example,
trees, polygons, sets (the ‘uniform’ structures), permutations, etc.Letm
kbe the number of ways of giving a labeled k-set such a
structure. In each separate case we shall specify whether we takem
0=0o rm0= 1. We use capital letters for the structure and
lower case letters for the counting sequence. We deﬁne
(14.14) M(x): =∞/summationdisplay
k=0mkxk
k!.
So ifTdenotes the structure (labeled) tree, then we know from
---PAGE BREAK---
142 A Course in Combinatorics
Theorem 2.1 that
T(x)=∞/summationdisplay
k=0kk−2xk
k!.
IfSdenotes the uniform structure (a set) then sk=1 for all kand
thereforeS(x)=ex.I fCdenotes ‘oriented circuit’, then we can
start at vertex 1 and there are clearly ( k−1)! ways to proceed.
Therefore C(x)=− log(1−x).
Suppose we wish to consider the number of ways a labeled n-set
can be partitioned into two parts, one with a structure of type A
and the other with a structure of type B. It is easy to see that the
number of ways that we can do this is/summationtextn
k=0/parenleftbign
k/parenrightbig
akbn−k.It follows
that if we call this a structure of type A·B, then
(14.15) ( A·B)(x)=∞/summationdisplay
n=0/parenleftBiggn/summationdisplay
k=0/parenleftbiggn
k/parenrightbigg
akbn−k/parenrightBigg
xn
n!=A(x)·B(x).
The reader should be careful with the result (14.15). The asser-
tion is only true if, from the compound structure there is a unique
way of ﬁnding the partition into the two parts that led to this struc-ture. For example, if AandBare the same, the result is clearly
false.
Example 14.10. Once again we consider derangements. Call this
a structure of type Dand let Π denote the structure ‘permutation’.
Clearly Π(x )=( 1−x)
−1. Any permutation consists of a set of ﬁxed
points (that we interpret as just a set) and a derangement on the
remaining points. So by (14.15) we have
(1−x)−1=D(x)·S(x),i.e.D(x)=e−x(1−x)−1
as was shown in Example 10.1.
Example 14.11. In how many ways can a labeled n-set be split
into a number of pairs (= P) and a number of singletons (= S)?
First, observe that if we wish to split 2 kpoints into pairs, we must
choose a point x1to go with point 1 and then split the remaining
2k−2 points into pairs. Therefore p2k=( 2k−1)!! and we ﬁnd that
P(x)=∞/summationdisplay
k=0(2k−1)!!x2k
(2k)!= exp(1
2x2).
---PAGE BREAK---
14. Recursions and generating functions 143
It follows that
(14.16) (P ·S)(x) = exp(x+1
2x2).
Let us now try to ﬁnd the same result using a recursion relation.
We denote the structure P·SbyB. In the set {1,2,...,n}we can
either letnbe a singleton or make a pair {x,n}with 1≤x≤n−1.
So
bn=bn−1+(n−1)bn−2 (n≥1).
It follows that
BLprime(x) = (1 + x)B(x),
and since B(0) = 1, we again ﬁnd (14.16) as solution.
We return to the recurrence of Example 14.11 in Example 14.15.
Problem 14D. Consider the structures M0:= mapping of a set
to itself with no ﬁxed point, M1:= mapping of a set to itself with
exactly one ﬁxed point, and A:= arborescence. Find a relation
betweenM0(x),M1(x), andA(x) and check the ﬁrst few terms to
see if the result is correct.
We make things slightly more diﬃcult. We wish to partition an
n-set into parts and then impose structure Non each of the parts,
wheren0= 0. We claim that the exponential generating func-
tion for the compound structure is exp( N(x)).A simple example
is the case where Nis the uniform structure (with the convention
n0= 0) and hence N(x)=ex−1. The compound structure is of
course ‘partition’ for which we know from Theorem 13.6 that theexponential generating function is equal to
∞/summationdisplay
n=0/parenleftBiggn/summationdisplay
k=0S(n,k)/parenrightBigg
xn
n!=∞/summationdisplay
k=0(ex−1)k
k!= exp(ex−1) = exp(N(x)).
We formulate this method as a theorem.
Theorem 14.2. If the compound structure S(N)is obtained by
splitting a set into parts, each of which gets a structure of type N,
then
S(N)(x) = exp( N(x)).
---PAGE BREAK---
144 A Course in Combinatorics
Proof: By a slight generalization of (13.3) we see that if the par-
tition of the n-set consists of b1parts of size 1, b2parts of size 2,
...,bkparts of size k, whereb1+2b2+···+kbk=n, then there are
/parenleftBign1
1!/parenrightBigb1.../parenleftBignk
k!/parenrightBigbk·n!
b1!...bk!
ways to make the compound structure, and this has to be divided
byn! to obtain the contribution to the coeﬃcient of xnin the
exponential generating function. If b1+···+bk=m, then this same
contribution is found in exp( N(x)) from the term ( N(x))m/m!,
namely as
1
m!/parenleftbiggm
b1,...,bk/parenrightbigg/parenleftBig
n1x
1!/parenrightBigb1.../parenleftbigg
nkxk
k!/parenrightbiggbk
.
This proves the assertion. /square
In fact, it is not diﬃcult to see that this theorem is a special
case of a more general method. Interpret the previous situationas follows. We have a uniform structure on a k-set of points and
we replace each point by some structure of type N. The resulting
conﬁguration is an element of the compound structure that we justdiscussed. If the ﬁrst of the structures is not uniform but, say, oftypeR, then the exponential generating function for the compound
structure will be R(N(x)) by the same argument as we used above.
We sometimes call this procedure the substitution of NintoR,
and it is nice that we then must do the same for the generatingfunctions!
Example 14.12. If we substitute the structure ‘oriented cycle’
into the uniform structure, then we are considering the compound
structure consisting of a partition of an n-set into oriented cycles,
i.e. the structure Π with as usual π
0= 1. So we must have Π( x)=
exp(C (x)) and, indeed, Π( x)=( 1−x)−1andC(x)=− log(1−x).
Example 14.13. Let us look at Fig. 2.2 again, adding loops at 1
and 21. We then have a description of a mapping of an n-set (with
n= 21 in this case) to itself. But we can also interpret the ﬁgure as
an element of the structure Π, namely (1)(4 ,5,3)(7)(20, 12)(21) in
---PAGE BREAK---
14. Recursions and generating functions 145
which each point has been replaced by an arborescence with that
point as root. Letting Adenote arborescence, we ﬁnd from Cayley’s
theorem, Theorem 2.1, that
(14.17) A(x)=∞/summationdisplay
n=1nn−1xn
n!.
(The extra factor ncomes from the choice of the root.) Since there
arennmappings from an n-set to itself, the method of Theorem
14.2 shows that the following relation must hold:(14.18) Π( A(x)) =1
1−A(x)=∞/summationdisplay
n=0nnxn
n!.
We shall verify this after the next example.
The following well known result from complex analysis often
plays a role in combinatorial problems involving generating func-
tions. It is known as the Lagrange inversion formula .I t m a y b e
found in textbooks on analysis with analytic proofs; see the notes.It is possible to prove the theorem within the theory of formal powerseries (using formal derivation, etc.) and we give such a formal proofin Appendix 2.
Theorem 14.3. Letfbeanalyticinaneighborhoodof z=0and
f(0)Lnegationslash=0. Then,if w=z/f(z),zcanbeexpressedasapowerseries
z=/summationtext
∞
k=1ckwkwith a positive radius of convergence, in which
(14.19) ck=1
k!/braceleftBigg/parenleftbiggd
dz/parenrightbiggk−1
(f(z))k/bracerightBigg
z=0.
Example 14.14. We shall ﬁnd a fourth proof of Theorem 2.1. Let
Tbe the structure ‘labeled tree’. We wish to show that tn=nn−2
forn≥1. IfAdenotes arborescences as before, then obviously
an=ntn, i.e.A(x)=xTLprime(x). Furthermore, from Theorem 14.2
we see that exp(A(x)) is the exponential generating function for
the structure ‘rooted forest’ (= F). Consider a labeled tree on
n+ 1 vertices as an arborescence with vertex n+ 1 as its root and
---PAGE BREAK---
146 A Course in Combinatorics
then delete the root and all incident edges. The result is a rooted
forest onnvertices. Since we can reverse this process, we have a
one-to-one correspondence. Therefore
(14.20)eA(x)=1+∞/summationdisplay
n=1fnxn
n!=∞/summationdisplay
n=0tn+1xn
n!=TLprime(x)=x−1A(x),
i.e.
(14.21)A(x)
eA(x)=x.
We apply Theorem 14.3 to (14.21) with z=A(x),f(z)=ez=
eA(x),w=x. We ﬁnd A(x)=/summationtext∞
k=1ckxkwith
ck=1
k!/braceleftBigg/parenleftbiggd
dz/parenrightbiggk−1
ekz/bracerightBigg
z=0=kk−1
k!
and it follows that tn=nn−2. Furthermore we see that the number
of labeled rooted forests on nvertices is ( n+1 )n−1.
Remark. We now have veriﬁcation of (14.18) because (14.20) im-
plies that ALprime(x)=eA(x)+xeA(x)ALprime(x), i.e.
∞/summationdisplay
n=1nnxn
n!=xALprime(x)=xeA(x)
1−xeA(x)=A(x)
1−A(x).
Remark. The procedure of removing a point from a combinatorial
structure with n+1 points that we used in Example 14.14 is called
derivation and it indeed corresponds to the derivation of generating
functions. Another example is removing a vertex from an oriented
cycle onn+ 1 vertices. This yields an oriented path on nvertices,
of which there are n!. So their exponential generating function is
(1−x)−1and that is CLprime(x).
Problem 14E. Letandenote the number of ways of decomposing
a convexn+ 1-gon into quadrilaterals by inserting a number of
nonintersecting chords. By convention a0=0 ,a1= 1. Show that/summationtext
k+l+m=nakalam=anforn≥3. Iff(x) is the ordinary generating
---PAGE BREAK---
14. Recursions and generating functions 147
function for the sequence an, then ﬁnd a functional equation for
f(x) and solve this equation using Theorem 14.3. (We remark that
the result that is obtained can also be proved combinatorially.)
Although we have stressed that in most cases the power series
can be considered as formal power series, it has been clear in a
number of examples that analysis can be an important tool in manycombinatorial problems. We give one more example that shows amethod that can be used for many recurrences.
Example 14.15. In Example 14.11 we encountered the recursion
(14.22) a
n=an−1+(n−1)an−2
and the corresponding exponential generating function. In previous
examples we showed that the counting function grows more or lessasc
nfor some constant c. Clearly angrows more rapidly, but what
is a good approximation for its asymptotic behavior? The ﬁrst stepin obtaining the answer to this question involves a method that isapplicable to many recurrences. In (14.22) we substitute
(14.23) a
n=/integraldisplay
Cψ(z)zndz,
whereCis a path in Cthat we can still choose and ψis a function
also still to be determined. We substitute (14.23) into (14.22).
The term (n −1)an−2yields/integraltext
Cψ(z)(n−1)zn−2dz, and we require
that integration by parts yields only the integral involving ψLprime(z),
the other term being 0 by a suitable choice of C. Then (14.22)
becomes
(14.24)/integraldisplay
C/braceleftbig
ψ(z)[zn−zn−1]+ψLprime(z)zn−1/bracerightbig
dz=0,
which is true for all n∈Nifψ(z)(1−z)=ψLprime(z), i.e.ψ(z)=αez−1
2z2.
Once we know ψ, the requirement on Cshows that the real axis
from−∞to∞is a good choice for the path of integration. From
a0= 1 we ﬁnd that α=( 2πe)−1
2.
To ﬁnd the asymptotic behavior of an, we must now analyze the
behavior of
(14.25) I:=/integraldisplay∞
−∞ex−1
2x2xndx.
---PAGE BREAK---
148 A Course in Combinatorics
Since the integrand is maximal near x=√n, we substitute x=
y+√nand ﬁnd
(14.26)
I=e−1
2n+√nn1
2n/integraldisplay∞
−∞ey−1
2y2exp/parenleftbigg
−y√n+nlog(1 +y√n)/parenrightbigg
dy.
Now note that if uandvare negative, then |eu−ev|<|u−v|and
use the representation log(1 + t)=/integraltextt
0ds
1+s=s−s2
2+/integraltextt
0s2
1+sdsto
obtain /vextendsingle/vextendsingle/vextendsingle/vextendsingle−y√
n+nlog(1 +y√n)+y2
2/vextendsingle/vextendsingle/vextendsingle/vextendsingle≤|y|
3
√n.
Substitution in (14.26) shows that the integral tends to
/integraldisplay∞
−∞ey−y2dy=√πe1
4.
We have proved that
(14.27) an∼e−1
4√
2n1
2ne−1
2n+√n.
It is clear that this result cannot be found in an easy way!
Problem 14F. LetFn(x) denote the expansion of (1 −xn)−µ(n)/n
in a power series. Also consider the expansion of exas a formal
power series. Prove that
ex=∞/productdisplay
n=1Fn(x)
is true as a relation between formal power series.Problem 14G. Find the exponential generating function for the
number of symmetric n×npermutation matrices.
Problem 14H. On a circle we place nsymbols 0 and nsymbols
1 in an arbitrary order. Show that it is possible to number the
positions on the circle consecutively from 1 to 2 nsuch that the
---PAGE BREAK---
14. Recursions and generating functions 149
sequence satisﬁes (14.13) if we replace the strict inequality ‘<’ with
‘≤’.
Problem 14I. Let the points 1,..., 2nbe on a circle (consecu-
tively). We wish to join them in pairs by nnonintersecting chords.
In how many ways can this be done?Problem 14J. Find the exponential generating function for the
number of labeled regular graphs of valency 2, with nvertices.
Problem 14K. Consider walks in the X-Yplane where each step
isR:(x,y)→(x+1,y)o rU :(x,y)→(x,y+1). We start at (0,0)
and ask in how many ways we can reach (2 n,2n) without passing
through one of the points (2 i−1,2i−1) ,i=1,...,n . Prove that
this number is the Catalan number u
2n+1.
Problem 14L. Consider walks in the X-Yplane where each step
isR:(x,y)→(x+1,y)o rUa:(x,y)→(x,y+a), withaa
positive integer. There are ﬁve walks that contain a point on the
linex+y= 2, namely: RR,RU1,U1R,U1U1, andU2. Letandenote
the number of walks that contain a point on the line x+y=n(so
a2= 5). Show that an=F2n, whereFnare the Fibonacci numbers
starting with F0=F1=1 .
Problem 14M. Count pairs ( f,g) of functions f,g, wherefmaps
{1,2,...,r}to{1,2,...,n}andgis a permutation of {1,2,...,n}
that ﬁxes the image of fpointwise. Doing this in two ways prove
that forn≥r
n/summationdisplay
k=1/parenleftbiggn
k/parenrightbigg
krdn−k=B(r)·n!,
wheredmdenotes the number of derangements of 1 ,2,...,m and
B(r) is a Bell number.
Problem 14N. Consider walks in the X-Yplane where each step
i sR: (x,y)→(x+1,y), U :(x,y )→(x,y+ 1), or D: ( x,y)→
(x+1,y+ 1). We wish to count walks from (0,0) to ( n,n) that are
below or on the line x=y. Find a recurrence for the number of
walks like (14.10).
---PAGE BREAK---
150 A Course in Combinatorics
Notes.
For an extensive treatment of the material in this chapter, we
refer to Goulden and Jackson (1983) and Stanley (1986). A very
readable survey is Stanley (1978).
The ﬁrst of the references mentioned above has much on the the-
ory of formal power series. For this topic also see Niven (1969) andAppendix 2. Generally speaking, operations with power series are‘formal’ and require no discussion of convergence when the coeﬃ-cient of any monomial x
n, say, in a sum or product is determined
by a ﬁnite number of operations (i.e. no limits). For example,/summationtext∞
n=0(1
2+x)nis not allowed in formal operations since even the
constant term is not a ﬁnite sum; but/summationtext∞n=0(n!x+x2)nisallowed
(even though it does not converge for xLnegationslash= 0) since the coeﬃcient
of any power of xrequires only a ﬁnite computation (cf. Problem
14F).
The ﬁrst linear recurrence that one usually learns to solve is
an+1=an+an−1. It leads to the famous Fibonacci sequence ; cf.
Problem 14A. As we observed in Chapter 10, this name is due to
Lucas. The sequence is related to a problem occurring in the bookLiber abaci (1203) by Leonardo of Pisa (known as Fibonacci).
The number a
nof polyominoes of size n, treated in Example
14.5, was shown to be less than cn(where we used c= 15). Note
that this assertion also follows from Fekete’s lemma. We derivedthe inequality by using a suitable coding for the cells. The readermay wish to try to prove that a(m,n)<m·c
nfor a suitable
cby using (14.3) and induction. The remark following (14.9) is
based on a statement in Stanley (1986), attributing an unpublishedcombinatorial proof to D. Hickerson.
The result of Example 14.6 is related to the fact that F
pnhas
as subﬁelds the ﬁelds Fpd, whereddividesn. From this, one ﬁnds
thatxpn−xis the product of all the irreducible polynomials over
Fpwith a degree ddividingn. This yields the formula proved in
the example.
Despite the fact that there is extensive literature on all the prob-
lems with the Catalan numbers as solution, the problems reappearregularly (e.g. in problem sections of journals). As stated earlier,the Belgian mathematician E. Catalan (1814–1894) studied well-
---PAGE BREAK---
14. Recursions and generating functions 151
formed bracketings (as in Example 14.7).
The reﬂection principle of Fig. 14.2 was used by the French com-
binatorialist D. Andr´ e (1840–1917) in his solution of Bertrand’s
famous ballot problem : if, at the end of an election, candidate P
haspvotes and Qhasqvotes,p<q , then the probability that Q
was ahead all the time during the election is ( q−p)/(q +p).
The Lagrange inversion formula is one of the many contributions
to analysis by J. L. Lagrange (see notes to Chapter 19). For aproof see §7.32 in Whittaker and Watson (1927). The theorem was
published in 1770. We also refer the reader to G. N. Raney (1960).
References.
E. Catalan (1838), Note sur une ´ equation aux diﬀ´ erences ﬁnies, J.
M. Pures Appl. 3, 508–516.
I. P. Goulden and D. M. Jackson (1983), Combinatorial Enumera-
tion, Wiley-Interscience.
A. Joyal (1981), Une th´ eorie combinatoire des s´ eries formelles, Ad-
vances in Mathematics 42, 1–82.
D. A. Klarner (1967), Cell growth problem, Canad. J. Math. 19,
851–863.
I. Niven (1969), Formal power series, Amer. Math. Monthly 76,
871–889.
G. N. Raney (1960), Functional composition patterns and power
series reversion, Trans. Amer. Math. Soc. 94, 441–451.
R. P. Stanley (1978), Generating functions, pp. 100–141 in Studies
in Combinatorics (G.-C. Rota, ed.), Studies in Math. 17, Math.
Assoc. of America.
R. P. Stanley (1986), Enumerative Combinatorics , Vol. I, Wads-
worth and Brooks/Cole.
E. T. Whittaker and G. N. Watson (1927), A Course in Modern
Analysis, Cambridge University Press.
---PAGE BREAK---
15
Partitions
We have considered several partition problems in the previous chap-
ters. We now come to the most diﬃcult one, namely the problemofunordered partitions of nintokparts, respectively any number
of parts. We deﬁne p
k(n) as the number of solutions of
(15.1) n=x1+x2+···+xk,x 1≥x2≥···≥xk≥1.
For example, 7 = 5 + 1 + 1 = 4 + 2 + 1 = 3+3+1=3+2+2 ,s o
p3(7) = 4.
Using the same idea as in the Corollary to Theorem 13.1, we see
thatpk(n) equals the number of solutions of n−k=y1+···+yk
withy1≥···≥yk≥0. If exactly sof the integers yiare positive,
then by (15.1) there are ps(n−k) solutions ( y1,...,yk). Therefore
(15.2) pk(n)=k/summationdisplay
s=1ps(n−k).
Problem 15A. Show that pk(n)=p k−1(n−1) +pk(n−k) and
use this to prove (15.2).
Since we have the trivial initial conditions pk(n) = 0 for n<k
andpk(k) = 1, we can recursively calculate the numbers pk(n).
Clearlyp1(n)=1a n d p2(n)=⌊n/2⌋.
Example 15.1. We shall show that p3(n)={n2
12}, i.e. the number
nearest ton2
12, using a method that can be used for other values of
k. Leta3(n) denote the number of solutions of n=x1+x2+x3,
x1≥x2≥x3≥0. Thena3(n)=p 3(n+ 3) and writing y3=x3,
y2=x2−x3,y1=x1−x2, we see that a3(n) is the number of
---PAGE BREAK---
15. Partitions 153
solutions of n=y1+2y2+3y3,yi≥0,i=1,2,3. Therefore (cf.
Example 14.2)
(15.3)∞/summationdisplay
n=0a3(n)xn=( 1−x)−1(1−x2)−1(1−x3)−1.
Letω=e2πi/3. The partial fraction decomposition of (15.3) yields
(15.4)∞/summationdisplay
n=0a3(n)xn=1
6(1−x)−3+1
4(1−x)−2+17
72(1−x)−1
+1
8(1 +x)−1+1
9(1−ωx)−1+1
9(1−ω2x)−1.
Using (10.6), we ﬁnd from (15.4)
a3(n)=1
12(n+3 )2−7
72+(−1)n
8+1
9(ωn+ω2n),
and this implies that
|a3(n)−1
12(n+3 )2|≤7
72+1
8+2
9<1
2.
Therefore
(15.5) p3(n)={1
12n2}.
Problem 15B. We choose three vertices of a regular n-gon and
consider the triangle they form. Prove directly that there are
{1
12n2}mutually incongruent triangles that can be formed in this
way, thereby providing a second proof of (15.5).
We shall now show that (15.5) is an example of a more general
result.
Theorem 15.1. Ifkis ﬁxed then
pk(n)∼nk−1
k!(k−1)!(n→∞).
---PAGE BREAK---
154 A Course in Combinatorics
Proof: (i) Ifn=x1+···+xk,x1≥· · ·≥xk≥1, then the
k! permutations of (x 1,...,xk) yield solutions of (13.2) in positive
integers, not necessarily all diﬀerent. So
(15.6) k!pk(n)≥/parenleftbiggn−1
k−1/parenrightbigg
.
Ifn=x1+···+xk,x1≥···≥xk≥1, then if yi:=xi+(k−i),
1≤i≤k, the integers yiare distinct and y1+···+yk=n+k(k−1)
2.
Therefore
(15.7) k!pk(n)≤/parenleftbiggn+k(k−1)
2−1
k−1/parenrightbigg
.
The result follows from (15.6) and (15.7). /square
Problem 15C. Leta1,a2,...,atbe positive integers (not neces-
sarily distinct) with greatest common divisor 1. Let f(n) denote
the number of solutions of
n=a1x1+a2x2+···+atxt
in nonnegative integers x1,...,xt. What is the generating function
F(x): =/summationtextf(n)xn? Show that f(n)∼cnt−1for some constant c
and explicitly give cas a function of a1,...,at.
The problem that we considered in the Corollary to Theorem
13.1 concerns what is called the number of compositions ofninto
kparts. By this corollary the total number of compositions of n
equals/summationtextn
k=1/parenleftbign−1
k−1/parenrightbig
=2n−1.The method that we used in Theorem
13.1 shows this directly as follows: consider nblue balls with a
space between any two of them in which we can place a red ball
if we wish. The total number of conﬁgurations that can be madein this way is clearly 2
n−1and they represent all compositions of
n. We could have proved the same result without our knowledge ofChapter 13 as follows. Let c
nkdenote the number of compositions
ofnintokparts. Deﬁne
ck(x): =∞/summationdisplay
n=kcnkxn.
---PAGE BREAK---
15. Partitions 155
Then, using a method that we have used several times before, we
ﬁnd
ck(x)=(x+x2+x3+···)k=xk(1−x)−k=∞/summationdisplay
n=k/parenleftbiggn−1
k−1/parenrightbigg
xn
and∞/summationdisplay
k=1ck(x)=∞/summationdisplay
k=1xk(1−x)−k=x
1−2x,
i.e.nhas 2n−1compositions.
Problem 15D. Show that in a list of all 2n−1compositions of n,
n≥4, the integer 3 occurs exactly n·2n−5times.
The most diﬃcult and mathematically the most interesting and
important function of all in this area of combinatorics is deﬁned by
(15.8) p(n) := number of unordered partitions of n.
For example, p(5) = 7, the partitions of 5 being
1+1+1+1+1 = 2+1+1+1 = 3+1+1 = 2+2+1 = 4+1 = 3+2 = 5 .
Clearly,p(n) is the number of solutions of
(15.9) n=x1+x2+···+xn (x1≥x2≥...xn≥0).
As we saw above, this can also be formulated as the number of
solutions of n=y1+2y2+···+nyn, whereyi≥0, 1≤i≤n. (Here
yidenotes the number of terms xkequal toiin the ﬁrst deﬁnition.)
The study of the so-called partition function p(n) has led to some
of the most fascinating areas of analytic number theory, analysis,algebraic geometry, etc. We shall obviously only be able to look atproperties that are proved by combinatorial arguments.
Theorem 15.2. Thegeneratingfunctionforthepartitionfunction
is
P(x): =
∞/summationdisplay
n=0p(n)xn=∞/productdisplay
k=1(1−xk)−1.
---PAGE BREAK---
156 A Course in Combinatorics
Proof: We again use the idea of Example 14.2. The partition of
n=/summationtextm
i=1iriwithriterms equal to i(for 1≤i≤m) corresponds
to the term xr1
1···xrmmin the (formal) inﬁnite product/producttext(1 +xk+
x2
k+···). Replacing xkbyxk, we ﬁnd the result. /square
Many theorems about partitions can be proved easily by repre-
senting each partition by a diagram of dots, known as a Ferrers
diagram . Here we represent each term of the partition by a row
of dots, the terms in descending order, with the largest at the top.
Sometimes it is more convenient to use squares instead of dots (inthis case the diagram is called a Young diagram by some authors
but we shall use Ferrers diagram as the name for the ﬁgure). Forexample, the partition (5,4,2,1) of 12 is represented by each of thediagrams of Fig. 15.1.
••••••••••••
Figure 15.1
The partition we get by reading the Ferrers diagram by columns
instead of rows is called the conjugate of the original partition. So
the conjugate of 12 = 5 + 4 + 2 + 1 is 12 = 4+3+2+2+1 . T h e
relationship is symmetric. We ﬁrst show a few easy examples ofthe use of a Ferrers diagram.
Theorem 15.3. The number of partitions of ninto parts, the
largest of which is k,i sp
k(n).
Proof: For each partition for which the largest part is k, the
conjugate partition has kparts (and vice versa). /square
Problem 15E. Show with a Ferrers diagram that the number of
partitions of n+kintokparts equals the number of partitions of
ninto at most kparts. (This is (15.2).)
In some cases a proof using generating functions requires less
ingenuity than using a Ferrers diagram would. The next theorem
can be proved with a diagram similar to a Ferrers diagram thoughwe shall use generating functions instead.
---PAGE BREAK---
15. Partitions 157
Theorem 15.4. The number of partitions of ninto odd parts
equals the number of partitions of ninto unequal parts.
Proof: The generating function for the number of partitions of n
into odd parts is (by an obvious generalization of Theorem 15.2)
equal to/producttext∞
m=1(1−x2m−1)−1, and the generating function for the
number of partitions of ninto unequal parts is (by the same argu-
ment as used in the proof of Theorem 15.2)/producttext∞k=1(1 +xk). Since
∞/productdisplay
k=1(1 +xk)=∞/productdisplay
k=1(1−x2k)
(1−xk)
=∞/productdisplay
k=1(1−x2k)∞/productdisplay
l=1(1−xl)−1=∞/productdisplay
m=1(1−x2m−1)−1,
the proof is complete. /square
Now consider the function ( P(x))−1=/producttext∞k=1(1−xk).In the ex-
pansion of this product, a partition of ninto unequal parts con-
tributes +1 to the coeﬃcient of xnif the number of parts is even,
and−1 if the number of parts is odd. So the coeﬃcient of xnis
pe(n)−po(n), where pe(n), respectively po(n), denotes the number
of partitions of ninto an even, respectively odd, number of unequal
parts. It was shown by Euler that pe(n)=p o(n) unless nhas the
formn=ω(m): =( 3 m2−m)/2o rn =ω(−m)=( 3 m2+m)/2,
in which case pe(n)−po(n)=(−1)m. The numbers ω(m) and
ω(−m) are called pentagonal numbers. This name is explained by
the relation ω(m)=/summationtextm−1k=0(3k+ 1) and Fig. 15.2.
Figure 15.2
The following extremely elegant pictorial proof of Euler’s identity
is due to Franklin (1881).
---PAGE BREAK---
158 A Course in Combinatorics
Theorem 15.5. We have
∞/productdisplay
k=1(1−xk)=1+∞/summationdisplay
m=1(−1)m/parenleftBig
xω(m)+xω(−m)/parenrightBig
.
Proof: Consider a Ferrers diagram of a partition of ninto unequal
parts as for 23 = 7+6+5+3+2i n Fig. 15.3.
Figure 15.3
The last row is called the baseof the diagram. The number of
dots in the base is denoted by b. In Fig. 15.3 the base is indicated by
a line segment with b= 2 dots. The longest 45◦line segment joining
the last point in the top row with other points of the diagram is
called the slope of the diagram. Its number of points is denoted
bys. In Fig. 15.3 the slope is indicated by a segment with s=3
points. We now deﬁne two operations on the diagram, which wecallAandB.
A:I fb≤s, then remove the base and adjoin it to the diagram
at the right to form a new slope parallel to the original one, unlessb=sand the base and the slope have a point in common. This
exception is considered below.
B:I fb>s, remove the slope and adjoin it at the bottom of the
diagram as a new base, except if b=s+ 1 and the base and the
slope have a point in common.
In Fig. 15.3 operation Acan be carried out and it yields the
partition 23 = 8+ 7+5+3. An example of the exceptional situation
for operation Bis shown in Fig. 15.4.
Figure 15.4
---PAGE BREAK---
15. Partitions 159
The exception for operation Acan occur only if
n=b+(b+1 )+···+( 2b−1),
i.e.n=ω(b). The exception for operation Boccurs ifn=(s+
1) +···+2s, i.e.n=ω(−s). In all other cases exactly one of
the operations can be carried out and we thus have a one-to-one
correspondence between partitions of ninto an even number of
unequal parts and partitions of ninto an odd number of unequal
parts; and hence for these values of n,w eh a v e pe(n)−po(n)=0 .
In the exceptional cases the diﬀerence is +1 or −1. /square
Euler used Theorem 15.5 to ﬁnd the following recursion formula
forp(n).
Theorem 15.6. Letp(n)=0forn<0. Then for n≥1,
(15.10) p(n)=∞/summationdisplay
m=1(−1)m+1{p(n−ω(m)) +p(n−ω(−m))}.
Proof: This is an immediate consequence of Theorem 15.2 and
Theorem 15.5. /square
Note that the sum in (15.10) is ﬁnite. With this recursion one
can rapidly generate a table for p(n) for small values of n.
The ﬁrst two terms of the recursion formula are the same as in
the famous Fibonacci recursion (cf. Problem 5E). Although theseare followed by two negative terms, one might think that p(n) will
increase in a way similar to the Fibonacci numbers, i.e. as c
nfor
some constant c. This is not the case. We shall show that p(n)
grows much more slowly. The actual asymptotics of p(n) involve
complicated methods from analytic number theory. We mentiononly the main term of the asymptotic formula:
lim
n→∞n−1
2logp(n)=π/radicalbigg
2
3.
One can show that in fact p(n) is much smaller than exp/parenleftBig
π/radicalBig
2
3n/parenrightBig
.
---PAGE BREAK---
160 A Course in Combinatorics
Theorem 15.7. Forn>2we have
p(n)<π/radicalbig
6(n−1)eπ√
2
3n.
Proof: Letf(t): =l o gP(t). From Theorem 15.2 we ﬁnd
f(t)=−∞/summationdisplay
k=1log(1−tk)=∞/summationdisplay
k=1∞/summationdisplay
j=1tkj
j=∞/summationdisplay
j=1j−1tj
1−tj.
From now on let 0 <t<1. Then from
(1−t)−1(1−tj)=1+t+···+tj−1>jtj−1,
we ﬁnd
f(t)<t
1−t∞/summationdisplay
j=1j−2=1
6π2t
1−t.
Sincep(n) is increasing, we have P(t)>p(n)tn(1−t)−1.By com-
bining the two inequalities and then substituting t=( 1+u)−1,w e
ﬁnd
logp(n)<f(t)−nlogt+ log(1−t)
<π2
6·t
1−t−nlogt+l o g ( 1− t)
=π2
6u−1+nlog(1 +u) + logu
1+u.
Therefore
logp(n)<1
6π2u−1+(n−1)u+ logu.
We get the required inequality by substituting u=π{6(n−1)}−1
2.
/square
Euler’s identity is a special case of a famous identity of Jacobi
that is important in the theory of theta functions. We would not
mention this so-called Jacobi triple product identity if we had not
known of the beautiful combinatorial proof using a Ferrers diagram,due to Wright (1965).
---PAGE BREAK---
15. Partitions 161
Theorem 15.8. We have
∞/productdisplay
n=1(1−q2n)(1 +q2n−1t)(1 +q2n−1t−1)=∞/summationdisplay
r=−∞qr2tr.
Proof: We rewrite the assertion as
∞/productdisplay
n=1(1 +q2n−1t)(1 +q2n−1t−1)=∞/summationdisplay
r=−∞qr2tr∞/productdisplay
n=1(1−q2n)−1,
and substitute x=qt,y=qt−1. This yields the relation
(15.11)∞/productdisplay
n=1/braceleftbig
(1 +xnyn−1)(1 +xn−1yn)/bracerightbig
=∞/summationdisplay
r=−∞x1
2r(r+1)y1
2r(r−1)∞/productdisplay
n=1(1−xnyn)−1.
We shall prove this relation by interpreting both sides as generating
functions corresponding to the counting of appropriate combinato-rial objects, and then showing a one-to-one mapping between theseobjects. For the left-hand side, we ﬁnd as a combinatorial interpre-tation the generating function for the number of partitions of theGaussian integer n+miinto parts a+(a−1)iand (b−1) +bi
(a≥1,b≥1), with no two parts equal. Call this number α(n,m).
So the left-hand side of (15.11) is/summationtext
∞
n=1/summationtext∞m=1α(n,m)xnym.On
the right-hand side, we use Theorem 15.2 and replace the product
by/summationtext∞
k=1p(k)xkyk. We must therefore prove that α(n,m)=p(k ),
wheren=k+1
2r(r+ 1) andm=k+1
2r(r−1). Without loss of
generality, we may assume that n≥m, i.e.r≥0. A partition of
n+mimust have v≥0 terms of type (b −1) +biandv+rterms
of typea+(a−1)i, and therefore n≥1
2r(r+ 1), sok≥0. In Fig.
15.5 below, we consider the example (n,m) = (47, 44), sor=3
andk= 41. We have taken the Ferrers diagram of the partition
4 1=1 2+1 0+8+5+2+2+2a n da b o v et h et o pr o ww eh a v e
added rows of length r,r−1,..., 1.
---PAGE BREAK---
162 A Course in Combinatorics
Figure 15.5
The resulting diagram is split into two parts. The shaded part on
the left is determined by the ‘staircase’ starting with the part that
was added at the top. We read the shaded part by columns. By theconstruction, the sequence is decreasing. These numbers are the a’s
for terms of type a+(a−1)i. The unshaded part is read by rows
and again the numbers are decreasing. These are the b−1’s for
terms of type (b −1)+bi(the lastbcould be 1, corresponding to one
empty unshaded row). The number of a’s exceeds the number of
b−1’s byrand the sum of the a’s andb−1’s is clearly k+
1
2r(r+1).
So we have indeed produced a partition of n+miof the required
type. It is easy to see that the procedure can be reversed, i.e. wehave deﬁned the one-to-one mapping we were looking for. /square
Problem 15F. Prove that the number of self-conjugate partitions
ofnequals the number of partitions of ninto unequal odd parts.
As a ﬁnal problem related to partitions we shall consider objects
known as Young tableaux orstandard tableaux. A Young tableau of
shape (n
1,n2,...,nm) is a Ferrers diagram (or Young diagram) of
squares in which the integers 1 to nhave been inserted (one in each
square) in such a way that all rows and columns are increasing. Forexample, in Fig. 15.6 we display a Young tableau of shape (5,4,2,1).
---PAGE BREAK---
15. Partitions 163
134711
251012
69
8
Figure 15.6
We are interested in determining the number of Young tableaux
of a given shape. At ﬁrst, this may seem like a somewhat unnatural
problem. However, Young tableaux play an important role in thetheory of group representations (and other areas). One of the inter-esting facts concerning these tableaux is that there is a one-to-onecorrespondence between the Young tableaux with nsquares (that
we shall call ‘cells ’) and involutions of 1 to n, where we include
the identity as an involution. (Note that we can therefore countthe total number of tableaux using Problem 14G.) For a treatmentof this one-to-one correspondence and several related problems werefer to D. Knuth (1973).
In order to count the Young tableaux of a given shape, we need
to introduce the function ∆( x
1,...,xm) deﬁned by
(15.12) ∆(x 1,...,xm): =/productdisplay
1≤i<j≤m(xi−xj).
(Note that ∆ is the value of the Vandermonde determinant.)
Lemma 15.9. Let
g(x1,...,xm;y): =x 1∆(x 1+y,x2,...,xm)
+x2∆(x 1,x2+y,...,x m)+··· +xm∆(x 1,x2,...,xm+y).
Then
g(x1,...,xm;y)=/parenleftbigg
x1+···+xm+/parenleftbiggm
2/parenrightbigg
y/parenrightbigg
∆(x 1,...,xm).
Proof: Clearly the function gis a homogeneous polynomial of
degree 1 + deg ∆(x 1,...,xm) in the variables x1,...,xm,y.I f w e
interchange xiandxj, thengchanges sign. So if xi=xj, then
---PAGE BREAK---
164 A Course in Combinatorics
gmust be 0, i.e. gis divisible by xi−xjand hence by the poly-
nomial ∆(x 1,...,xm). Ify= 0, the assertion is obvious. There-
fore we only have to prove the coeﬃcient/parenleftbigm
2/parenrightbig
fory. I fw ee x -
pandg, then the terms of degree 1 in yarexiy
xi−xj∆(x 1,...,xm) and
−xjy
xi−xj∆(x 1,...,xm) for all pairs ( i,j) with 1≤i<j≤m. The sum
of these terms is clearly/parenleftbigm
2/parenrightbig
∆(x 1,...,xm). /square
We introduce a function fdeﬁned on all m-tuples (n 1,...,nm),
m≥1, with the following properties:
f(n1,...,nm) = 0 unless n1≥n2≥···≥ 0;(15.13)
f(n1,...,nm,0) =f(n1,...,nm);(15.14)
f(n1,...,nm)=f (n1−1,n2,...,nm)+(15.15)
f(n1,n2−1,...,n m)+··· +f(n1,n2,...,nm−1),
ifn1≥n2≥···≥nm≥0;
f(n)=1 i f n≥0. (15.16)
Clearlyfis well deﬁned. We claim that f(n1,...,nm) counts the
number of Young tableaux of shape ( n1,...,nm). Condition (15.13)
is obvious and so are (15.14) and (15.16). To see that the number of
Young tableaux of shape ( n1,...,nm) satisﬁes (15.15), we consider
the entry n. It must be the last entry in one of the rows, and if
we remove the square with n, then we obtain a Young tableau for
n−1. In fact, if two or more rows of the tableau have the same
length, then ncan only be the last entry in the lowest of these; but
including all terms in (15.15) does not matter since if, say, n1=n2,
thenf(n1−1,n2,...,nm)=0 .
Theorem 15.10. ThenumberofYoungtableauxthathaveshape
(n1,...,nm)satisﬁes
(15.17)f(n1,...,nm)=∆(n 1+m−1,n2+m−2,...,n m)n!
(n1+m−1)!(n 2+m−2)!...nm!,
andinfactthisformulafor fiscorrectif n1+m−1≥n2+m−2≥
···≥nm.
---PAGE BREAK---
15. Partitions 165
Proof: We ﬁrst observe that, if for some iwe haveni+m−i=
ni+1+m−i−1, then the expression ∆ on the right-hand side
of (15.17) is 0, in accordance with the fact that the shape is not
allowed. We must show that the right-hand side of (15.17) satisﬁes(15.13) to (15.16). All but (15.15) are trivial. We ﬁnd the relation(15.15) by substituting x
i=ni+m−iandy=−1 in Lemma 15.9.
/square
There is a formulation of this theorem that makes it more in-
teresting. We introduce the concept of ‘ hook’ in a Young tableau.
The hook corresponding to a cell in a tableau is the union of thecell and all cells to the right in the same row and all cells below itin the same column. The ‘hook-length’is the number of cells in thehook. In Fig. 15.7 we show a Young diagram with in each cell anumber equal to the length of the corresponding hook. The shadedarea is the hook corresponding to the cell in row 2 and column 3.
Figure 15.7
We now have the following remarkable theorem due to J. S.
Frame, G. de Beauregard Robinson and R. M. Thrall (1954).
Theorem 15.11. ThenumberofYoungtableauxofagivenshape
andatotalof ncellsisn!dividedbytheproductofallhook-lengths.
Proof: If we have a Young tableau of shape ( n1,...,nm), then the
hook-length for the cell in row 1 and column 1 is n1+m−1. Consider
the hook-lengths for the cells in row 1. In Fig. 15.7 the second
column has the same length as column 1 and hence the hook-lengthfor the next cell is n
1+m−2. For the next cell the length drops
by 2 because of the ‘missing cell’ indicated by a dot in the last row.Similarly, there is a jump of 3 for the column with two dots. So inrow 1 we ﬁnd as hook-lengths the numbers from 1 to n
1+m−1 with
---PAGE BREAK---
166 A Course in Combinatorics
the exception of the numbers ( n1+m−1)−(nj+m−j), 2≤j≤m.
Similarly row icontains the integers from 1 to ni+m−iexcept for
(ni+m−i)−(nj+m−j),i+1≤j≤m. It follows that the product
of the hook-lengths is {/producttextm
i=1(ni+m−i)!}/∆(n 1+m−1,...,n m).
By Lemma 15.9 we are done. /square
Problem 15G. Consider a Young tableau of shape ( n,n). Deﬁne
a sequence ak,1≤k≤2n,b yak:=iifkis in rowiof the tableau,
i=1,2. Use this to show that the number of Young tableaux of
this shape is the Catalan numberun+1(in accordance with Theorem
15.11).
Problem 15H. How many Ferrers diagrams are there that ﬁt in
a box of size k×n−k?
Problem 15I. Prove that the number of partitions of ninto parts
not divisible by dequals the number of partitions in which no part
occurs more than d−1 times.
Problem 15J. DeﬁnePn:=/producttextn
k=1k!. Prove that P2
n−1·(n2)! is
divisible by P2n−1.
Notes.
The use of Ferrers diagrams to prove theorems such as Theorem
15.3 was introduced by Sylvester in 1853. He wrote that the proof
had been communicated to him by N. M. Ferrers.
For other proofs involving Ferrers diagrams and analogues (e.g.
a proof of Theorem 15.4) we refer to Hardy and Wright (1954),MacMahon (1916), and Van Lint (1974).
Euler’s proof of Theorem 15.5 was by induction. Polygonal num-
bers occurred in ancient mathematics, e.g. triangular numbers wereconsidered by Pythagoras before 500 BC.
Theorem 15.7 is due to Van Lint (1974).
The asymptotic behavior of the partition function p(n) was given
by G. H. Hardy and S. Ramanujan (1918) in the paper in which
they developed the famous ‘circle method’ that has had so many ap-plications in number theory. A further asymptotic result was givenby H. Rademacher (1937). The proofs depend on the remarkable
---PAGE BREAK---
15. Partitions 167
functional equation for the famous Dedekind η-function
η(z): =eπiz
12∞/productdisplay
n=1/parenleftbig
1−e2πinz/parenrightbig
.
For an exposition of these proofs see Chandrasekharan (1970).
C. G. J. Jacobi (1804–1851) is best known for developing the
theory of elliptic functions. He became professor at K¨ onigsberg at
the age of 23. Two years later he published his book Fundamenta
Nova Theoriae Functionum Ellipticarum .I n§64 we ﬁnd what is
now known as the triple product identity.
The ﬁrst to use tableaux such as in Fig. 15.6 was Frobenius! A
year later (1901) A. Young independently introduced them in hiswork on matrix representations of permutation groups. The nameYoung tableaux has become standard terminology.
References.
K. Chandrasekharan (1970), Arithmetical Functions, Springer-Ver-
lag.
J. S. Frame, G. de Beauregard Robinson, and R. M. Thrall (1954),
The hook graphs of S
n,Canad. J. Math. 6, 316–324.
F. Franklin (1881), Sur le d´ eveloppement du produit inﬁni (1 −
x)(1−x2)(1−x3)(1−x4)···,Comptes Rendus Acad. Sci. (Paris)
92, 448–450.
G. H. Hardy and S. Ramanujan (1918), Asymptotic formulae in
combinatory analysis, Proc. London Math. Soc. (2)17, 75–115.
G. H. Hardy and E. M. Wright (1954), An Introduction to the
Theory of Numbers , 3d edn., Clarendon Press.
D. Knuth (1973), The Art of Computer Programming , Vol. 3, Addi-
son-Wesley .
J. H. van Lint (1974), Combinatorial Theory Seminar Eindhoven
University of Technology , Lecture Notes in Math. 382, Springer-
Verlag.
P. A. MacMahon (1916), Combinatory Analysis Vol. II, Cambridge
University Press.
H. Rademacher (1937), On the partition function p(n),Proc. Lon-
don Math. Soc. 43, 241–254.
---PAGE BREAK---
168 A Course in Combinatorics
E. M. Wright (1965), An enumerative proof of an identity of Jacobi,
J. London Math. Soc. 40, 55–57.
A. Young (1901), On quantitative substitutional analysis, Proc.
London Math. Soc. 33, 97–146.
---PAGE BREAK---
16
(0,1)-Matrices
In the previous chapters (0,1)-matrices have turned up a number
of times; and especially those with constant line-sums led to in-teresting problems. In this chapter we shall consider the existenceproblem for (0,1)-matrices with given line-sums, and try to countor estimate how many there are in the case of constant line-sums.In the ﬁrst problem, the matrices are not necessarily square. Ifthe row-sums of a matrix Aarer
1,r2,...,rk, then we shall call the
vectorr:= (r1,r2,...,rk) therow-sum ofA, and similarly for the
column-sums.
We consider the problem of the existence of a (0 ,1)-matrix with
given row-sum rand column-sum s. For convenience, we shall
assume that the coordinates of randsare nonincreasing; that is,
randsarepartitions (we may allow trailing zero coordinates in
partitions for the purposes of this chapter).
Given two partitions r=(r1,r2,...,rn) ands=(s1,s2,...,sm)
of the same integer N, we say that rmajorizes swhen
r1+r2+···+rk≥s1+s2+···+sk
for allk, interpreting rkorskas 0 when kexceedsnorm, respec-
tively. Recall that the conjugate of a partition ris the partition r∗
wherer∗
iis the number of jsuch that rj≥i.
Problem 16A. Prove the following assertion: rmajorizes sif and
only if the latter can be obtained from the former by a sequence ofoperations ‘pick two parts (coordinates) aandbso thata≥b+2
and replace them by a−1 andb+ 1’. (That is, sis ‘more average’
thanr.) For example, (5 ,4,1) majorizes (3, 3,3,1) and the latter
---PAGE BREAK---
170 A Course in Combinatorics
can be obtained from the former in several ways with sequences of
such operations, including
(5,4,1,0)→(5,3,2,0)→(5,3,1,1)→(4,3,2,1)→(3,3,3,1)
and
(5,4,1,0)→(4,4,1,1)→(4,3,2,1)→(3,3,3,1).
Theorem 16.1. Letr1,r2,...,rnands1,s2,...,smbe two nonin-
creasingsequencesofnonnegativeintegerseachsummingtoacom-mon value N. There exists an n×m(0,1)-matrix with row-sum
rand column-sum sif and only if r
∗majorizes s.
Proof: To prove necessity, let kbe given and consider the ﬁrst k
columns of a hypothetical (0 ,1)-matrix with row-sum rand column-
sums. The number of 1’s in these columns is
s1+s2+···+sk≤n/summationdisplay
i=1min(k,r i)=k/summationdisplay
j=1r∗
j.
The latter equality is most evident from the Ferrers diagram of thepartition r(see Fig. 16.1) where we see both expressions count the
number of cells in the ﬁrst kcolumns.
Figure 16.1
We now introduce a transportation network with a source S,
a sinkT, one vertex xifor each row, and one vertex yjfor each
column. There is to be an edge of capacity ridirected from Sto
xi,1≤i≤n, an edge of capacity sjfromyjtoT,1≤j≤m, and
an edge of capacity 1 from xitoyj,1≤i≤n,1≤j≤m. We claim
---PAGE BREAK---
16.(0,1)-Matrices 171
that a (0, 1)-matrix M=(aij) with row-sum rand column-sum s
exists if and only if this network admits a ﬂow of strength N(there
are at least two cuts of capacity N, so this would be a maxﬂow).
Given such a matrix, we get a ﬂow of strength Nby saturating the
edges incident with SandTand assigning ﬂow aijto the edge from
xitoyj. Conversely, if the network admits a ﬂow of strength N,
then there exists an integral ﬂow of that strength (cf. Theorem 7.2);
clearly, the edges incident with either SorTmust be saturated,
and on the other edges the ﬂow must be either 0 or 1.
Consider a cut A,B in this network which separates SandT.
SayAconsists of S,n0vertices of X:={xi:i=1,...,n}, andm0
vertices of Y:={yi:i=1,...,m}. The edges crossing from Ato
Bincluden−n0edges leaving S,m0edges into T, andn0(m−m0)
edges from XtoY. The capacity of this cut is at least
rn0+1+rn0+2+···+rn+sm−m 0+1+sm−m 0+2+···+sm+n0(m−m0).
Figure 16.2
It is again convenient to refer to the Ferrers diagram of the parti-
tionr(see Fig. 16.2). The number of cells in the Ferrers diagram is
N. So clearly Nis at most n0(m−m0) plus the number of cells in
the lastn−n0rows plus the number of cells in the last m0columns.
The number of cells in the last m0columns is the sum of the last
m0parts of the conjugate r∗. But under the assumption that r∗
majorizes s,
r∗
m−m 0+1+r∗
m−m 0+2+···+r∗
m≤sm−m 0+1+sm−m 0+2+···+sm,
---PAGE BREAK---
172 A Course in Combinatorics
and we conclude that the capacity of any cut is at least N.B y
the maxﬂow-mincut theorem, Theorem 7.1, the required ﬂow of
strengthNexists. /square
We have given the above proof in order to establish the connec-
tion between ﬂows and (0 ,1)-matrices, but it is possible to give a
more direct proof of suﬃciency of the condition in Theorem 16.1.Our exposition is similar to that given by Krause (1996).
First suppose we have a (0, 1)-matrix A
1with row-sum rand
column-sum s1, and that s2is obtained from s1by the operation
of Problem 16A. Then we claim it is easy to construct a (0 ,1)-
matrixA2with row-sum rand column-sum s2: If the parts a,b
witha≥b+2i ns1(that are replaced by a−1 andb+ 1 to obtain
s2) are the sums of columns jandk, respectively, there must be a
rowiso that the (i,j )-entry in A1is 1 and the (i,k )-entry in A1
is 0; if we interchange these two entries, we obtain a matrix A2as
desired.
Now assume r∗majorizes s. Start with the matrix A0correspond-
ing to the Ferrers diagram of r, adding columns of 0’s if necessary
to obtain size n×m. The column-sum of A0isr∗.I fr∗majorizes
s, we can ﬁnd a sequence of partitions
r∗=s0,s1,s2,...,splscript=s
so that each partition in the sequence is obtained from the pre-ceding one by the operation of Problem 16A. Then a (0 ,1)-matrix
Awith row-sum rand column-sum scan, by the observation of
the preceding paragraph, be obtained from A
0by a sequence of plscript
interchanges.
Example 16.1. Taker=( 3,2,2,2,1) ands=( 3,3,3,1). Then
r∗=( 5,4,1), and this majorizes s. The algorithm described above
might give rise to the following sequence of matrices:

1110
1100110011001000
→
1110
0110110011001000
→
1110
0110011011001000
→
1011
0110011011001000

---PAGE BREAK---
16.(0,1)-Matrices 173
Here the column-sum vectors are
(5,4,1,0)→(4,4,2,0)→(3,4,3,0)→(3,3,3,1).
(We do not care if the vectors are not always nonincreasing.)
We extend the idea of the algorithm in the theorem below, and
ﬁnd a (rough) estimate for the number of (0 ,1)-matrices with cer-
tain line-sums as a consequence.
Theorem 16.2. Given partitions randsof an integer N, let
M(r,s)denote the number of (0,1)-matrices Awith row-sum r
and column-sum s.I frmajorizes r0andsmajorizes s0, then
M(r0,s0)≥M(r,s).
Proof: We will establish the following simple observation. Let us
ﬁx a row-sum vector r=(r1,r2,...,rn) of length nand a column-
sum vector s=(s1,s2,...,sm) of length mthat have equal sums.
(We do not require them to be nonincreasing.) If s1>s2, then we
claim that
M(r,(s1−1,s2+1,s3,...,sm))≥M(r,(s1,s2,s3,...,sm)).
Of course, the same will hold for any two columns (we have used the
ﬁrst two only for notational convenience). The same idea appliesto the transpose, where keeping sconstant and replacing r
iand
rj(ri>rj)b yri−1 andrj+ 1 will not decrease the number
of associated (0, 1)-matrices. The inequality of the theorem then
follows from this observation and the result of Problem 16A.
To prove the observation, consider (0 ,1)-matrices Aof sizen×
(m−2) with column-sum ( s3,s4,...,sm). For a given matrix A,
it may or may not be possible to prepend two columns to Ato
get row-sum r; if it is possible, we need to add two 1’s to arows,
o n e1t ob rows, and no 1’s to crows, say, where a+b+c=n
and 2a+b=s1+s2. But the number of ways to prepend the two
columns to get new column-sums s1ands2is
/parenleftbiggb
s1−a/parenrightbigg
=/parenleftbiggb
s2−a/parenrightbigg
,
---PAGE BREAK---
174 A Course in Combinatorics
and this is at most the number/parenleftbiggb
s1−1−a/parenrightbigg
=/parenleftbiggb
s2+1−a/parenrightbigg
of ways to prepend the two columns to get new column-sums s1−1
ands2+ 1 since the latter sums are closer to b/2. /square
The suﬃciency of the condition of Theorem 16.1 is a quick corol-
lary of Theorem 16.2. If r∗majorizes s, then
M(r,s)≥M(r,r∗)≥1.
Problem 16B. Prove that M(r,r∗)=1 .
We will use A(n,k ) to denote the number of n×n(0,1)-matrices
with all line-sums equal to k.
Corollary.
A(n,k )≥/braceleftbigg/parenleftbiggn
k/parenrightbigg
/2k+1/bracerightbiggn
.
Proof: The number of (0 ,1)-matrices with row-sum ( k,k,...,k )
is/parenleftbign
k/parenrightbign. Each has a column-sum s=(s1,s2,s3,...,sn) satisfying
0≤si≤n,s1+···+sn=nk. Ignoring the restriction si≤n,
we see that by Theorem 13.1 there are at most/parenleftbignk+n−1
n−1/parenrightbig
≤2n(k+1)
such column-sums. Since the greatest number of associated (0, 1)-
matrices occurs for column-sum ( k,k,...,k ), the number of such
matrices is at least the average number. /square
Problem 16C. Prove the following theorem.
Theorem 16.3. LetdanddLprimebetwopartitionsofan (even)integer
N.I fdmajorizes dLprime,thenthereareatleastasmanylabeledsimple
graphs with degree sequence dLprimeas with degree sequence d.
Problem 16D. Ifnis even, then
A(n,1
2n)≥2n2
n2n.
Show this by modifying the proof of the Corollary to Theorem 16.2.
(Substituting k=1
2nin the corollary would give a poor result.)
Problem 16E. Letd=(d1,d2,...,dn) be a partition (possibly
including 0’s) of/parenleftbign
2/parenrightbig
. Prove that there exists a tournament on the
---PAGE BREAK---
16.(0,1)-Matrices 175
vertex set 1 ,2,...,n (an orientation of Kn) so that vertex ihas
outdegree difor alliif and only if dis majorized by
(n−1,n−2,..., 2,1,0).
Problem 16F. (i) Given an integer m≤/parenleftbign
2/parenrightbig
, consider the graph
with vertex set 1, 2,...,n and whose edges are the ﬁrst mof the
2-subsets in lexicographical order:
{1,2},{1,3},...,{1,n},{2,3},{2,4},...{2,n },{3,4},....
This graph has a certain degree sequence r, which is a partition of
2m. For example, when n= 8 andm=2 0 ,r=( 7,7,7,5,4,4,3,3).
Givenn,m≤/parenleftbign
2/parenrightbig
, and a partition d(possibly including 0’s) of
2m, prove that there exists a simple graph on nvertices with de-
gree sequence dif and only if dis majorized by the partition ras
described above.
(ii) Generalize for simple k-uniform hypergraphs (a set of points
and a set of k-element subsets).
***
As in Chapter 11, let A(n,2) denote the set of (0, 1)-matrices of
sizenwith all line-sums equal to 2. A method that we learned in
Chapter 14 allows us to count the number A(n,2) of elements of
A(n,2).
LetA(n,2)∗denote the subset of A(n,2) consisting of indecom-
posable matrices (cf. Chapter 11). Deﬁne an:=|A∗(n,2)|.I t i s
easy to see that an=1
2n!(n−1)! as follows. We have/parenleftbign
2/parenrightbig
choices
for the ﬁrst row. If we choose (1 1 0 ...0) as ﬁrst row, then there
is one more row (out of n−1 )w i t ha1i nt h eﬁrst column and a
second 1 not in the second column (so n−2 choices). This gives us
(n−1)(n−2) possibilities, etc.
Now deﬁne
mn:=A(n,2)/(n!)2,
bk:=ak/(k!)2.
---PAGE BREAK---
176 A Course in Combinatorics
Then by the same argument as was used in Theorem 14.2, we have
(16.1) 1 +∞/summationdisplay
n=2mnxn= exp/parenleftBigg∞/summationdisplay
k=2bkxk/parenrightBigg
.
Therefore we ﬁnd
(16.2) 1 +∞/summationdisplay
n=2mnxn= exp/parenleftbigg−x−log(1−x)
2/parenrightbigg
=e−1
2x(1−x)−1
2.
It is an easy exercise to show that from the expansion
(1−x)−1
2=∞/summationdisplay
n=0/parenleftbigg2n
n/parenrightbigg/parenleftBigx
4/parenrightBign
,
we can conclude that
mn∼e−1
2/parenleftbigg2n
n/parenrightbigg
4−nforn→∞.
We have thus proved the following theorem.
Theorem 16.4.
A(n,2)∼e−1
2(2n)!
(2!)2n.
This theorem is a special case of the following theorem (that we
shall only prove for k= 3, using a method that can be applied for
other values of k).
Theorem 16.5.
A(n,k )=(nk)!
(k!)2nexp/bracketleftbigg
−(k−1)2
2/bracketrightbigg/braceleftbigg
1+O/parenleftbigg1
n3
4/parenrightbigg/bracerightbigg
(n→∞),
uniformly in kfor1≤k<logn.
For more information on this question and generalizations to the
case where the line-sums are not constant we refer to B. D. McKay
(1984).
---PAGE BREAK---
16.(0,1)-Matrices 177
For the case k= 3, we now prove a result slightly stronger than
obtained by setting kto 3 above. We shall use the truncated form of
the principle of inclusion and exclusion (cf. Theorem 10.1, Remark).
ConsiderN:= 3nelements, numbered
1a,1b,1c,2a,2b,2c,...,na,nb,nc.
Form a permutation of these Nelements and subsequently form the
corresponding ordered partition into triples: ( x,y,z )(u,v,w )....
We shall say that a repetition occurs if, in at least one of these
triples, some number occurs more than once, as in (5 a,3b,5c). As-
sume that the chosen permutation results in a sequence of n
triples with norepetition. In that case, we associate an n×n
(0,1)-matrix with the permutation as follows. If the i-th triple is
(xα,yβ,zγ), where{α,β,γ}⊆{a,b,c}, then the matrix has ones in
rowiin the columns numbered x,y,z , and zeros elsewhere. Since
the indices a,b,c do not inﬂuence the matrix, and the order of the
three elements within one triple is also irrelevant, each such matrix
corresponds to (3!)2ndiﬀerent permutations. Clearly the matrix is
inA(n,3). We must ﬁnd an estimate for the number Pof permu-
tations with no repetition among all N0:=N! permutations of the
3nelements.
Let 1≤r≤n. Specify rtriples and count the permutations that
have a repetition in these triples. Then sum this over all choices ofthertriples. As in Theorem 10.1, we call this number N
r. Then if
Riseven,w eh a v e
(16.3)R+1/summationdisplay
r=0(−1)rNr≤P≤R/summationdisplay
r=0(−1)rNr.
The diﬃcult part of the proof is ﬁnding a suitable upper estimateand lower estimate for N
r.
We start with the upper estimate. The rtriples can be chosen
in/parenleftbign
r/parenrightbig
ways. Within each triple we specify two positions, where we
require a repetition. This can be done in 3rways. Now we choose
rnumbers that will occur in the repetitions, and the indices a,b,c.
This can also be done in/parenleftbign
r/parenrightbig
·3rways. Subsequently we distribute
the chosen numbers over the chosen positions, and that can be
---PAGE BREAK---
178 A Course in Combinatorics
done in 2r·r! ways. Finally, we distribute the remaining N−2r
numbers arbitrarily. Clearly, a permutation with a repetition of
type (5 a,5b,5c) has been counted more than once. So we have
Nr≤/parenleftbiggn
r/parenrightbigg2
·32r·2r·r!·(N−2r)!(16.4)
≤2r
r!(32·n2)r(N−2r)!≤N!2r
r!/parenleftbiggN−2r
N/parenrightbigg−2r
≤N!2r
r!/parenleftbigg
1+8r2
N/parenrightbigg
,
ifr<1
2√n. Here the last step is based on the power series expan-
sion of (1 −2r
N)−2r, and choosing rin such a way that each term is
at most half of the previous term.
For the lower estimate, we start in the same way. After the rpairs
have been chosen and distributed over the chosen positions, we ﬁrstcomplete the rtriples that have a repetition, using elements with a
number that diﬀers from the two repeated numbers for each triple.This can clearly be done in more than ( N−3r)
rways. Then we
distribute the remaining numbers. Some permutations that shouldbe counted are not, i.e.
N
r≥/parenleftbiggn
r/parenrightbigg2
·32r·2r·r!·(N−3r)r(N−3r)!(16.5)
≥N!2r
r!(32·n2)r/bracketleftbiggn(n−1)...(n−r+1 )
nr/bracketrightbigg2(N−3r)r
N3r
≥N!2r
r!/parenleftBig
1−r
n/parenrightBig2r/parenleftbigg
1−3r
N/parenrightbiggr
≥N!2r
r!/parenleftbigg
1−3r2
n/parenrightbigg
ifr<√n. Here in the last step, we used the well known inequality
/parenleftBig
1−r
n/parenrightBigr
≥1−r2
nif 1≤r≤√n.
---PAGE BREAK---
16.(0,1)-Matrices 179
We now combine (16.3), (16.4) and (16.5). We take R=⌊1
2√n⌋.
We ﬁnd
P
N!=e−2+∆, where |∆|<2R+1
(R+ 1)!+3
n∞/summationdisplay
r=02rr2
r!,
and hence
|∆|<48
n+18e2
n<200
n.
We have therefore found the following estimate (in accordance with
Theorem 16.5).
Theorem 16.6. We have
A(n,3) =(3n)!
(3!)2ne−2/parenleftbigg
1+O (1
n)/parenrightbigg
(n→∞).
Remark. Note that for k= 3, we ﬁnd from the Corollary to The-
orem 16.2 that A(n,3) grows at least as fast as ( cn3)n, for a suitable
constantc, and this diﬀers from Theorem 16.6 only in the constant.
Problem 16G. Determine A(5,3).
We now describe another connection between (16.2) and Chapter
14. Note that squaring the right-hand side of (16.2) yields the
exponential generating function for the number of derangementsas given in Example 14.10. This means that we should be able toshow combinatorially that
(16.6) n!d
n=n/summationdisplay
k=0/parenleftbiggn
k/parenrightbigg2
AkAn−k,
where we have used AnforA(n,2).
As a preparation, consider an indecomposable component of an
element of A(n,2), for example the following 5 ×5 submatrix for
the casen=9 :
13459
1 11000
2 101003 010017 001109 00011
---PAGE BREAK---
180 A Course in Combinatorics
Starting with the two 1’s in the top row, there are two ways to
describe the cyclic structure:
(1,3),(3,9),(9,5),(5,4),(4,1)
corresponding to the permutation (1 3 9 7 2) of the rows and
(3,1),(1,4),(4,5),(5,9),(9,3)
corresponding to the reversed permutation (1 2 7 9 3).
The ﬁrst case (1 <3) we call the redvariety, the second the blue
variety.
Consider the set Sconsisting of elements of A(n,2) with the
1’s colored red or blue in such a way that in an indecomposablecomponent all 1’s have the same color. Clearly
|S|=n/summationdisplay
k=0/parenleftbiggn
k/parenrightbigg2
AkAn−k.
We deﬁne a one-to-one mapping from Sto the set of pairs of per-
mutations ( a1,a2,...,an), (b 1,b2,...,bn)o f1,2,...,n in which the
ﬁrst is a derangement. There are n!dnsuch pairs. We do this by
example.
Let
a:= (a1,a2,...,a 9)=( 2,7,1,8,4,5,9,6,3),
b:= (b1,b2,...,b 9)=( 3,1,4,5,9,2,6,8,7).
The canonical cycle decomposition of ais (1 2 7 9 3)(4 8 6 5).
We splitbaccordingly into (3 1 4 5 9) and (2 6 8 7). The ﬁrst
pair describes the 5 ×5 blue submatrix treated above; the second
describes a red 4 ×4 submatrix.
This establishes (16.6).
The following problem gives one more relation with Chapter 14.
Problem 16H. Again let An:=A(n,2). Consider a matrix in
A(n,2). There are/parenleftbign
2/parenrightbig
ways to choose the two 1’s in row 1. Suppose
these are in the ﬁrst two columns. Possibly some other row also has
---PAGE BREAK---
16.(0,1)-Matrices 181
two 1’s in the ﬁrst two columns. Now, consider the other possibility
and show that
(16.7) An=n(n−1)
2(2An−1+(n−1)An−2).
Problem 16I. Letf(x) be the function deﬁned by the left-hand
side of (16.1). From (16.7) derive the diﬀerential equation
2(1−x)fLprime−xf=0
and give a second proof of (16.2).
Notes.
Theorem 16.1 is due to D. Gale (1957) and to H. J. Ryser (1957).
For a more extensive treatment of the classes of (0,1)-matrices that
we have considered, we refer to Ryser (1963).
The relation between (16.2) and the generating function for de-
rangements was pointed out to us by D. G. E. D. Rogers. Theproof of (16.6) is due to P. Diaconis and D. E. Knuth (privatecommunication).
The relation (16.7) was announced without proof by R. Bricard
(1901).
References.
R. Bricard (1901), Probl` eme de combinaisons, L’Interm´ ediaire des
Math´ ematiciens 8, 312–313.
D. Gale (1957), A theorem on ﬂows in networks, Paciﬁc J. Math.
7, 1073–1082.
M. Krause (1996), A simple proof of the Gale-Ryser theorem, Amer.
Math. Monthly 103, 335–337.
B. D. McKay (1984), Asymptotics for (0, 1)-matrices with pre-
scribed line sums, in: Enumeration and Design (D. M. Jackson
and S. A. Vanstone, eds.), Academic Press.
H. J. Ryser (1957), Combinatorial properties of matrices of zeros
and ones, Canad. J. Math. 9, 371–377.
H. J. Ryser (1963), Combinatorial Mathematics , Carus Math.
Monograph 14.
---PAGE BREAK---
17
Latin squares
ALatin square of order nis a quadruple ( R,C,S ;L) whereR,C,
andSare sets of cardinality nandLis a mapping L:R×C→S
such that for any i∈Randx∈S, the equation
L(i,j)=x
has a unique solution j∈C, and for any j∈C,x∈S, the same
equation has a unique solution i∈R. That is, any two of i∈R,
j∈C,x∈Suniquely determine the third so that L(i,j)=x.
Elements of Rare called rows, elements of Care called columns ,
and elements of Sare called the symbols orentries of the Latin
square. A Latin square is usually written as an n×narray for
which the cell in row iand column jcontains the symbol L(i,j ).
In Fig. 17.1 we have an example of a Latin square of order 5.
abcde
baecd
cdbea
deabc
ecdab
Figure 17.1
The terminology ‘Latin square’ originated with Euler who used
a set of Latin letters for S.
Aquasigroup is a Latin square ( X,X,X ;◦) with a common row,
column, and symbol set X. Here we abbreviate the quadruple and
simply denote the quasigroup by ( X,◦). The mapping ◦is now a
binary operation on Xand the image of (x,y ) under◦is denoted
---PAGE BREAK---
17. Latin squares 183
byx◦y. So as a special case, we obtain Latin squares that are the
multiplication tables of groups.
Problem 17A. If we ﬁx the ﬁrst two rows in Fig. 17.1, then there
are many ways to ﬁll in the remaining three rows to obtain a Latin
square (in fact 24 ways). Show that none of these Latin squares isthe multiplication table of a group.
Note that if (R,C,S ;L) is a Latin square and the mappings σ:
R→R
Lprime,τ:C→CLprime,π:S→SLprimeare bijections, and if we deﬁne
LLprime(σ(i),τ(j)) :=π(L(i,j)), then (RLprime,CLprime,SLprime;LLprime) is a Latin square.
The two Latin squares are called equivalent . So with this notion of
equivalence, we may assume that a Latin square of order non the
setS:={1,2,...,n}has the integers from 1t on in that order as its
ﬁrst row and as its ﬁrst column. Note that two Latin squares thatare normalized in this way and diﬀerent, can still be equivalent.
Sometimes we denote a Latin square as just ‘L :R×C→S’.
Anorthogonal array OA(n,3) ofordernanddepth 3i sa3b y
n
2array with the integers 1 to nas entries, such that for any two
rows of the array, the n2vertical pairs occurring in these rows are
diﬀerent. Suppose that we have such an array. Call the rows r,c,
ands, in any order. For any pair ( i,j), there is a ksuch thatrk=i,
ck=j. We make a square with entry skin thei-th row and j-th
column (for all i,j). The deﬁnition of orthogonal array ensures that
this is a Latin square and we can reverse the procedure. Thereforethe concepts of Latin square and orthogonal array are equivalent.Fig. 17.2 shows an OA(4,3) and two corresponding Latin squares.
Two Latin squares for which the corresponding orthogonal arrays
have the same three rows (possibly in diﬀerent order) are called con-
jugates. For example, one of the conjugates of a Latin square (withR=C) is its transpose. As an exercise the reader should write out
the six conjugates of the Latin square in Fig. 17.2. Two orthogonalarrays are called isomorphic if one can be obtained from the other
by permutations of the elements in each of the rows and permuta-tions of the rows and columns of the array. Two Latin squares forwhich the corresponding orthogonal arrays are isomorphic are alsocalledisomorphic . This means that one is equivalent to a conjugate
of the other.
---PAGE BREAK---
184 A Course in Combinatorics
rows
columnssymbols1111222233334444
1234123412341234
32411423431221343241
1423
4312
2134
symbolscolumnsrows 1111222233334444
1234123412341234
32411423431221342431
4123
1342
3214
Figure 17.2
Problem 17B. Consider the two Latin squares obtained from Fig.
17.3 by setting a=1 ,b= 2, respectively a=2 ,b=1 .
12345
21453
35ab4
435ab
54b3a
Figure 17.3
Show that these two squares are equivalent. Show that a square
that is not equivalent to these corresponds to the cyclic group of
order 5.
One can also interpret a Latin square as a three-dimensional
array of 0’s and 1’s with exactly one 1 in each line of the array thatis parallel to one of the sides. For example, in Fig. 17.3 the entry4 in row 2 and column 3 should then be interpreted as an entry 1in position (2 ,3,4) of the array.
In a later chapter we shall consider orthogonal arrays with depth
greater than 3. These are often much more diﬃcult to constructthan the arrays OA(n,3).
Problem 17C. Construct an OA(4,4), i.e. a 4 by 16 matrix A
with entries 1,2,3,4, such that for any two rows of A, say row iand
rowj, the 16 pairs (a
ik,ajk), 1≤k≤16, are all diﬀerent.
---PAGE BREAK---
17. Latin squares 185
Asub-Latin square (orsubsquare ) of a Latin square (R,C,S ;L)
is a Latin square (R 1,C1,S1;L1) withR1⊆R,C1⊆C,S1⊆S,
andL1(i,j)=L (i,j) for (i,j )∈R1×C1.
Problem 17D. Letmandnbe positive integers, m<n . Show
thatm≤1
2nis a necessary and suﬃcient condition for the existence
of a Latin square of order ncontaining a subsquare of order m.
The following problems are all of a similar nature. They concern
a problem similar to the situation of Problems 17B and 17D, namely
the completion of a square that has been partly ﬁlled. An n×
narrayAwith cells which are either empty or contain exactly
one symbol is called a partial Latin square if no symbol occurs
more than once in any row or column. (It might be better to saythat the array ‘has the Latin property’, but we will use the formerterminology.) We are interested in conditions that ensure that apartial Latin square can be completed to a Latin square of order n,
i.e. when the empty cells can be ﬁlled with symbols so that a Latinsquare is obtained. For example, if Ais a partial Latin square with
ﬁlled (i.e. nonempty) cells everywhere except in the last row, thereis clearly a unique way to complete Ato a Latin square. On the
other hand, the two partial Latin squares of Fig. 17.4 are clearlynot completable.
1234
51
1
1
1
2
Figure 17.4
To a partial Latin square we can associate an array in the same
way that we did for Latin squares by only considering ﬁlled cells.This allows us to deﬁne the conjugate of a partial Latin square.The two partial Latin squares in Fig. 17.4 are not really essen-tialy diﬀerent but are conjugates, as is evident from their ‘partial
---PAGE BREAK---
186 A Course in Combinatorics
OA(5,3)’s’ shown below:
rows
columns
symbols/parenleftbigg11112
1234512345/parenrightbigg/parenleftbigg123451234511112/parenrightbigg
If the ﬁrst krows of a partial Latin square (k ≤n) are ﬁlled
and the remaining cells are empty, then Ais called a k×nLatin
rectangle.
Theorem 17.1. Ak×nLatinrectangle, k<n,canbeextended
to ak+1×nLatin rectangle (and hence it can be completed).
Proof: LetBjdenote the set of positive integers that do notoccur
in column jofA. Each of the numbers 1 to noccursktimes in
Aand therefore n−ktimes in the sets Bj.A n ylof the sets Bj
together contain l(n−k) elements, and therefore at least ldiﬀerent
ones. So the sets Bj,1≤j≤n, have property Hof Chapter 5,
and by Theorem 5.1 they therefore have an SDR. This SDR can be
adjoined as the (k + 1)-st row of the Latin rectangle. /square
We denote by L(n) the total number of diﬀerent Latin squares
of ordern. The exact value of L(n) is known only for n≤9.
The numbers grow very rapidly, e.g. although there are only twoinequivalent Latin squares of order 5, there are 5! ·4!·56 diﬀerent
ones.
Theorem 17.2. L(n)≥(n!)
2n/nn2.
Proof: To construct a Latin square of order n, we can take any
permutation of 1 to nas the ﬁrst row. If we have constructed a
Latin rectangle with krows, then by the proof of Theorem 17.1,
the number of choices for the next row is per Bwherebij=1i f
i∈Bj. By Theorem 12.8 (the Van der Waerden conjecture) this
permanent is at least (n −k)n·n!/nn.S ow eﬁ n d
(17.1) L(n)≥n!n−1/productdisplay
k=1{(n−k)nn!/nn}=(n!)2n/nn2.
/square
---PAGE BREAK---
17. Latin squares 187
Remark. If we had applied Theorem 5.3, we would have found
the estimate L(n)≥n!(n−1)!···1! (H. J. Ryser, 1969), which is
better for small nbut asymptotically much smaller than (17.1).
Forn= 8, the estimate (17.1) is less than 10−4times the true
value but asymptotically (17.1) is best possible as the next theorem
shows.
Theorem 17.3. If we deﬁne L(n): ={L(n)}1/n2, then
L(n)∼e−2nforn→∞.
Proof: From (17.1) and Stirling’s formula we ﬁnd n−1L(n)≥e−2.
By the same argument as in the proof of Theorem 17.2, and by
estimating per Busing Theorem 11.5, we ﬁnd
L(n)≤n/productdisplay
k=1M(n,k)≤n/productdisplay
k=1(k!)n/k.
Hence, again using Stirling’s formula with Csome constant >√
2π,
we have
logL(n)≤1
nn/summationdisplay
k=11
klogk!
≤1
nn/summationdisplay
k=1/braceleftbigg
logk−1+1
2klogk+1
klogC/bracerightbigg
=1
nn/summationdisplay
k=1logk−1+o(1)
=−2 + logn+o(1) forn→∞.
Combining this with the lower bound, we ﬁnd the result. /square
The following theorem due to H. J. Ryser (1951) is a generaliza-
tion of Problem 17D.
Theorem 17.4. LetAbe a partial Latin square of order nin
which cell (i,j)is ﬁlled if and only if i≤randj≤s. ThenAcan
---PAGE BREAK---
188 A Course in Combinatorics
becompletedifandonlyif N(i)≥r+s−nfori=1,...,n,where
N(i)denotes the number of elements of Athat are equal to i.
Proof: First, observe that in a Latin square of order n, the ﬁrst
rrows contain exactly relements equal to iof which at most n−s
are in the last n−scolumns. So the condition on N(i) is trivially
necessary. We show that the condition is also suﬃcient. Let B
be the (0, 1)-matrix of size r×nwithbij= 1 if and only if the
elementjdoes not occur in row iofA. Clearly every row of Bhas
sumn−s. Thej-th column of Bhas sumr−N(j)≤n−s.B y
Theorem 7.5 (with d:=n−s)w eh a v e
B=L(s+1)+···+L(n)
where each L(t)is anr×n(0,1)-matrix with one 1 in each row
and at most one 1 in each column.
As an example, suppose r=s=4 ,n= 7, and the ﬁrst four rows
ofAare
1234
5316
3152
7425
Then e.g.
B:=
0000111
010100100010111010010
=L(5)+L(6)+L(7)=
0000001
000100000000101000000
+0000010
000000100010000010000
+0000100
010000000000010000010
.
SayL(t)=[l(t)
ij]. Then we ﬁll the cell in position ( i,j)o fA,
i=1,...,r ,j=s+1,...,n ,b ykifl(j)
ik= 1. In our example, we
would ﬁll in the last three columns with
7
4
6
1,6
7
4
3,5
2
7
6.
---PAGE BREAK---
17. Latin squares 189
ThusAis changed into a partial Latin square of order nwithr
complete rows, i.e. a Latin rectangle. By Theorem 17.1 this can be
completed to a Latin square of order n. /square
The examples of partial Latin squares that cannot be completed
that were given in Fig. 17.4 both have nﬁlled cells. The conjecture
that a partial Latin square with less than nﬁlled cells is completable
to a Latin square was known as the Evans conjecture until it was
ﬁnally proved by B. Smetaniuk (1981). Perhaps the most importantpart of Smetaniuk’s proof is the construction of Theorem 17.5.
Theorem 17.5. LetAbe a Latin square of order n.Le tBbean
n+1×n+1array whose (i,j)-entry is the (i,j)-entry of Afor
i,j≥1,i+j≤n+1, which has a new symbol αon the back-
diagonal,andwhosecellsbelowtheback-diagonalareempty. Then
Bcan be completed to a Latin square of order n+1.
An example of a Latin square Aof order 5 and the corresponding
arrayBare shown below.
12345
43512
25134
51423
3425112345α
4351α
251α
51α
3α
α
Proof: LetCbe then×narray obtained from Bby dropping
the last row and column. In our example, Cis the array below.
12345
4351α
251α
51α
3α
We describe an algorithm that ﬁlls in the empty cells of Crow
by row subject to the constraint that after the ﬁrst rrows are
ﬁlled in, we will have r×na Latin rectangle on n+ 1 symbols
---PAGE BREAK---
190 A Course in Combinatorics
1,2,...,n,α so that the j-the column contains the same symbols,
in some order, as there were in the ﬁrst rrows ofA, except for
one so-called ‘missing’ symbol in each of the columns containing x,
and such that the r−1 missing symbols are all distinct. This is
trivial for r= 1 andr= 2. Assume this has been done for some r,
2≤r<n and that the missing symbols at this point are
xn−r+2,xn−r+3,...,xn.
To ﬁll in the ( r+ 1)-st row, we proceed as follows.
Let the last rsymbols in row r+1 ofA(that have been removed
in constructing C)b e
yn−r+1,yn−r+2,yn−r+3,...,yn.
Hereyn−r+1is the symbol displaced by αand must be the new
missing element in that column. We may consider ﬁlling in row
r+ 1 with
yn−r+2,yn−r+3,...,yn,
and this is satisfactory if
yn−r+1,xn−r+2,xn−r+3,...,xn
(which would be the new missing symbols) are distinct. If not,consider the sequence
y
n−r+1=xk1
yk1=xk2
...
ykm−1=xkm
extended as far as it can go, i.e. so that ykmis not equal to any
of thexj’s. We then ﬁll in row r+ 1 with yn−r+2,yn−r+3,...,yn
except that yk1,yk2,...,ykmare omitted and replaced, respectively,
byxk1,xk2,...,xkm. It must be checked that the entire row r+1
contains distinct sysmbols. The new missing symbols will be yn−r+1
andxn−r+2,xn−r+3,...,xnexcept that xk1,xk2,...,xkmare omitted
---PAGE BREAK---
17. Latin squares 191
and replaced, respectively, by yk1,yk2,...,ykm. It must be checked
that these are distinct.
Once the empty cells of Care ﬁlled, the ﬁrst ncells of the last
row ofBare to be ﬁlled with xand the missing sysmbols (when
r=n). We now have an n+1×nLatin rectangle, which completes
uniquely to a Latin square of order n+1 . /square
Problem 17E. LetAdenote the Latin square of order 10 on the
left below, and let Cbe the partial 10 by 10 Latin rectangle on
the 11 symbols 0, 1,2,..., 9,αon the right (not including the last
row and column). Use the algorithm of the proof of Theorem
17.5 to complete Cto a 10 by 10 Latin rectangle on the sym-
bols 0, 1,2,..., 9,α. Then complete this Latin rectangle to a Latin
square of order 11.
4135960287
5892673410
9456037821
1347528906
2613745098
7901482365
6789104532
8560291743
3024856179
02783196544135960287 α
589267341 α
94560378 α
1347528 α
261374 α
79014 α
6789 α
856α
30α
0α
α
(For example, the algorithm ﬁlls in the ﬁrst ﬁve rows of Cas
indicated on the right below. The elements ‘missing’ from the sev-enth through tenth columns at this point are, respectively, 5 ,9,2,0.
Now consider the sixth row. The αin column six forces 8 to be
the missing element from column six. But 8 is distinct from theelements currently missing from the other columns. So there isnothing more to do; we just ﬁll in row six with the entries 2 ,3,6,5
from the sixth row of A.)
---PAGE BREAK---
192 A Course in Combinatorics
4135960287
5892673410
9456037821
1347528906
2613745098
79014823654135960287
589267341 α
94560378 α1
1347528 α06
261374 α098
79014 α
Problem 17F.
(i) LetAandBbe Latin squares of order non symbols 1, 2,...,n .
LetALprimeandBLprimebe the Latin squares on symbols 1 ,2,...,n +1 (with
n+ 1’s on their back diagonals) that agree with AandB, respec-
tively, above their back diagonals as constructed in the proof of
Theorem 17.5. Show that if AandBare distinct, then ALprimeandBLprime
are distinct. This proves that the number of Latin squares of ordern+ 1 withn+ 1 on the back diagonal is greater than or equal to
the number N(n) of Latin squares of order n.
(ii) Explain how part (i) leads to the result
L(n)≥n!(n−1)!···2!1!
mentioned in the Remark following Theorem 17.2.
Theorem 17.6. A partial Latin square of order nwith at most
n−1ﬁlled cells can be completed to a Latin square of order n.
Proof: The theorem will be proved by induction. Assume it holds
fornand letLbe a partial Latin square of order n+1 with at most
nﬁlled cells.
First, suppose there is a symbol xofLthat occurs only once in
L. We propose to permute rows and columns to move the ﬁlled
cells above the back-diagonal, except that the single symbol xwill
be beonthe back diagonal. Say that the rows with ﬁlled cells have
f
1,f2,...,fkﬁlled cells, where f1+···+fk≤n, and where xis
in the row with f1ﬁlled cells. Put the row with f1ﬁlled cells in
positionn+1−f1; permute columns to push the ﬁlled cells to the
left. Put the row with f2ﬁlled cells in position n+1−f1−f2;
permute columns, other than the ﬁrst f1, to move the ﬁlled cells
to the left; the ﬁrst f1+f2cells in that row will contain the ﬁlled
cells. Put the row with f3ﬁlled cells in position n+1−f1−f2−f3,
---PAGE BREAK---
17. Latin squares 193
etc., and continue until all ﬁlled cells are above the back-diagonal.
Then, if the cell containing xin rown+1−f1is in column j,
interchange column jand column f1+1 .
By the induction hypothesis, the part above the back diagonal,
which has at most n−1 ﬁlled cells, can be completed to a Latin
squareAof ordernbased on symbols other than x. The array Bas
described in the statement of Theorem 17.5 contains the originalﬁlled cells of a partial Latin square that diﬀers from Lonly by
row and column permutations. The theorem says that Bcan be
completed, and hence so can L.
At this point we can also assert that Lcan be completed if there
is a row that contains exactly one ﬁlled cell, or a column thatcontains exactly one ﬁlled cell, because a conjugate of Lwill have
the property that some symbol appears exactly once (for example,every row of the partial square on the right of Fig 17.4 containsexactly one ﬁlled cell, and its conjugate on the left has the propertythat every symbol occurs exactly once) and a conjugate of Lcan
be completed if and only if Lcan be completed.
So we may now assume that no row or column contains exactly
one ﬁlled cell. Thus the ﬁlled cells are contained in at most mrows
andmcolumns, where m:=⌊n/2⌋. We may permute rows and
columns so that all ﬁlled cells lie in the upper left subarray of orderm. Theorem 17.4 implies that every m×mLatin rectangle can be
completed to a Latin square of order n+1. So it will suﬃce to ﬁll in
the unﬁlled cells of the the upper left subarray of order mto get a
Latin rectangle. But this is easy, as we have n+1 symbols available
and we may proceed in any order, ﬁlling in a cell of the subsquarewith a symbol not yet used in the row or column containing thecell. /square
We now come to a generalization of the idea of a Latin square.
Suppose we are given a collection Cofn-setsC(i,j),i,j=1,2,...,n .
One can ask the question whether there exists a matrix Aof size
n×nin which in each row, respectively column, all the entries a
ij
are diﬀerent and for which aij∈C(i,j) for alliandj. If all the
n-sets are {1,2,...,n}, the answer is yes since any Latin square is
a solution. If the elements of Care pairwise disjoint, the question
is trivial. It is perhaps surprising that the increased freedom of not
---PAGE BREAK---
194 A Course in Combinatorics
requiring the n-sets to be the same makes the question harder. In
fact, an analog of Theorem 17.1 does not hold in this case. Until it
was proved by F. Galvin (1995), the conjecture that such a matrixAindeed exists was known as the Dinitz conjecture .
We shall use the terminology of colorings of graphs (a problem
treated extensively in Chapter 33). Let Gbe a simple graph. A
list assignment ofGis a function Cthat assigns a set C(v) to each
vertexvofG.AC-coloring of Gis a function Adeﬁned on the
vertex set such that A(v)∈C(v) and such that A(v) andA(w) are
diﬀerent if vandware adjacent in G.
Letfbe a function from the vertex set of Gto the integers. We
say thatGisf-colorable if a C-coloring of Gexists for every C
with the property |C(v)|≥f (v) for allv∈G.I fkis an integer,
a graph is called k-list-colorable ifGisf-colorable for the constant
functionf(v)=k. Clearly, if Gisk-list-colorable, then kis at least
the chromatic number χ(G), deﬁned in Chapter 3.
Theline graph L=L(G) of a simple graph Gis the simple graph
with vertex set V(L): =E(G) and where a,b∈E(G) are adjacent
as vertices of Lif and only if, as edges in G,aandbhave a common
incident vertex. Now, consider the line graph L
2(n)o fK n,n(see
Chapter 21). It has n2vertices{i,j},i,j=1,2,...,n , where
pairs are joined if and only if they have an element in common.The Dinitz conjecture can be formulated as follows: L
2(n)i sn-
list-colorable. The theorem proved by Galvin states that for abipartite graph G, the line graph L=L(G)i sχ(L )-list-colorable.
Since Latin squares exist, L
2(n) has chromatic number nand the
Dinitz conjecture is therefore true.
We shall prove two propositions from which the theorem will
follow.
A subsetKof the vertex set of a digraph Dis called a kernel of
Dif no two vertices of Kare joined by an edge and for every v/∈K
there is a w∈Ksuch that there is an edge in Dfromvtow.
Proposition 17.7. LetDbe a digraph for which every induced
subgraphhasakernel. Let f(v) := 1+outdegree(v )foreveryvertex
vofD. ThenDisf-colorable.
---PAGE BREAK---
17. Latin squares 195
Proof: We use induction on the number of vertices. Small cases
are easily checked. (Note that the only digraph on three vertices
for which the condition and the assertion of the problem do nothold is the directed circuit.)
LetCbe a list assignment of Dwith|C(v)|≥f(v) for allv. Pick
an element xfrom one of the sets in Cand consider all vertices
vsuch that x∈C(v). We call the induced subgraph on these
verticesD
1. By our assumption, D1has a kernel K. LetD2be
the induced subgraph on the vertices in D\K. For a vertex v/∈K
deﬁneCLprime(v): =C (v)\{x}. By the induction hypothesis D2has a
CLprime-coloringALprime. If we deﬁne AonDby
A(v): =/braceleftbiggALprime(v)i fv/∈K,
xifv∈K,
thenAis clearly a C-coloring of D. /square
For the next proposition we deﬁne an orientation of a graph G
to benormal if every clique in Gis a transitive tournament.
Proposition 17.8. Everynormalorientationofthelinegraph L=
L(G)of a bipartite graph Ghas a kernel.
Proof: We use induction on the number of edges of G. For small
numbers, the statement is easily checked. Suppose V(G)=X ∪Y
(and all edges between XandY). We may assume that every
vertex ofGhas a positive degree. Let Dbe a normal orientation
ofL(G). The cliques in L(G) correspond to vertices in Xor inY.
For every vertex x∈X, we consider the corresponding clique
inL(G) and deﬁne e(x): ={x,y(x)}to be the sink of this clique
(with respect to D). First, assume that for every x∈X, this vertex
e(x)o fL(G) is the source of the clique deﬁned by y(x)∈Y.I t i s
then obvious that all the y(x) forx∈Xare distinct. Therefore
K:={{x,y (x)}:x∈X}is a kernel of L(G).
Next, assume that for some x∈X,e(x): ={x,y (x)}is the sink
of the clique corresponding to xbut thateLprime:={xLprime,y(x)}, where
xLprimeLnegationslash=x, is the source of the clique corresponding to y(x). Remove
the edge{xLprime,y(x)}fromG. The resulting line graph has a kernel K
by the induction hypothesis. We claim that Kis also a kernel for
---PAGE BREAK---
196 A Course in Combinatorics
D. Wehavetoshowthatthereisanedgefrom e/primetoK.I fe(x)∈K
we are done (because e/primeis a source). However, if e(x) /∈K, then
there is an edge from e(x) to some element in K, which must be
of type {x/prime/prime,y(x)}by deﬁnition of e(x). Because the tournament
deﬁned by y(x) is transitive, we are again done. /square
We can now prove the main result.
Theorem 17.9. IfGis a bipartite graph, then L=L(G) isχ(L)-
colorable.
Proof:LetGbe a bipartite graph on the vertex set X∪Y. Let g
be a coloring of the vertices of L=L(G) with colors 1 ,2...,χ(L).
We orient Lto form a digraph Das follows: if e1={x1,y1}and
e2={x2,y2}are adjacent vertices of Landg(e1)<g(e2), then
/braceleftbiggthe edge is from e1toe2ifx1=x2,
the edge is from e2toe1ify1=y2.
Sinceeverycliquein Lcorrespondstoavertex x∈Xory∈Y,this
orientation is normal. By Proposition 17.8 every induced subgraph
ofDhasakernel. Clearly, 1+outdegree( e)<χ(L)foreveryvertex
e∈D.So, by Proposition 17.7 the proof is complete.
/square
Problem 17G.
(a) Let nbe even. Find a permutation x1,x2,...,x nof the ele-
ments of Znsuch that the diﬀerences xi+1−xi,1≤i<n, are all
diﬀerent.
(b) Show that this is not possible if nis odd.
(c) Consider the permutation of (a). Deﬁne aij:=xi+xj. Show
that the square with entries aij,1≤i, j≤n, is a Latin square that
has the following property: The n(n−1) adjacent pairs ( aij,ai,j+1)
are diﬀerent. Such a square is called row-complete. This square is
also column-complete.
Problem 17H. Describe a one-to-one correspondence between
symmetric Latin squares of order nin which all symbols appear
on the main diagonal and symmetric Latin squares of order n+1
with all (n +1)’s on the diagonal.−
---PAGE BREAK---
17. Latin squares 197
Problem 17I. Let 1, 2,...,n be the ﬁrst row of a Latin square
and 2, 3,...,n,1 the second row. How many candidates are there
for the third row?
Problem 17J. Let 1, 2,..., 2n−1,2nbe the ﬁrst row of a Latin
square of order 2 n. Let 2, 1,4,3,..., 2n,2n−1 be the second row.
(i) Find a formula for the number of candidates for the third row.
(ii) Give a permanent that has this number as value.
Notes.
Although Latin squares have been studied for more than 200
years, much of the material in this chapter is recent. Theorem 17.1
is the oldest; it is due to M. Hall, Jr. (1945).
Theorem 17.2 and the remark following it can be found in H. J.
Ryser (1969). At the time that paper was written, the Van derWaerden conjecture was still open.
Theorem 17.3 is new.Theorem 17.4 is again due to H. J. Ryser (1951).The so-called Evans conjecture occurs as a question (not as a
conjecture) in a paper by T. Evans (1960). Before the proof by B.Smetaniuk appeared, several partial results were published.
Our treatment of the Galvin proof of the Dinitz conjecture is
based on some unpublished notes of D. Hoﬀman.
The most extensive treatment of Latin squares can be found in
the book Latin Squares by J. D´ enes and A. D. Keedwell (1991).
References.J. D´ enes and A. D. Keedwell (1991), Latin squares. New develop-
ments in the theory and applications., Annals of Discrete Math-ematics46, North-Holland.
T. Evans (1960), Embedding incomplete Latin squares, Amer.
Math. Monthly 67, 958–961.
F. Galvin (1995), The list chromatic index of a bipartite multi-
graph,J. Combin. Theory Ser. B 63, 153–158.
M. Hall, Jr. (1945), An existence theorem for Latin squares, Bull.
Amer. Math. Soc. 51, 387–388.
H. J. Ryser (1951), A combinatorial theorem with an application
to Latin rectangles, Proc. Amer. Math. Soc. 2, 550–552.
---PAGE BREAK---
198 A Course in Combinatorics
H. J. Ryser (1969), Permanents and systems of distinct representa-
tives, in: Combinatorial Mathematics and its Applications , Uni-
versity of North Carolina Press.
B. Smetaniuk (1981), A new construction on Latin squares I: A
proof of the Evans conjecture, Ars Combinatoria 11, 155–172.
---PAGE BREAK---
18
Hadamard matrices,
Reed–Muller codes
Hadamard considered the following question. Let Abe ann×n
matrix with real entries of absolute value at most 1. How large can
the determinant of Abe (in absolute value)? Since each row of A
is a vector with length ≤√n, the determinant cannot be larger
thannn/2. (The absolute value of the determinant is the n-dimen-
sional volume of the parallelopiped spanned by the row vectors inEuclidean n-space.) Can equality hold? In that case all entries
must be +1 or −1 and furthermore any two rows must be orthog-
onal, i.e. they have inner product 0. This leads to the followingdeﬁnition.
AHadamard matrix ofordernis ann×nmatrixHwith entries
+1 and−1, such that
(18.1) HH
Llatticetop=nI.
Of course, any two columns of Hare also orthogonal. This property
does not change if we permute rows or columns or if we multiplysome rows or columns by −1. Two such Hadamard matrices are
called equivalent. For a given Hadamard matrix, we can ﬁnd anequivalent one for which the ﬁrst row and the ﬁrst column consistentirely of +1’s. Such a Hadamard matrix is called normalized .
Clearly the remaining rows (if any) have as many +1’s as −1’s, i.e.
ifnLnegationslash= 1 thennmust be even. Some small examples are
(1),/parenleftbigg
111−1/parenrightbigg
,
++++
++−−+−+−
+−−+
,
---PAGE BREAK---
200 A Course in Combinatorics
where, in the last example, we have only indicated the sign of the
entry.
Problem 18A. Show that any two Hadamard matrices of order
12 are equivalent.Theorem 18.1. IfHisaHadamardmatrixoforder n,thenn=1,
n=2,o rn≡0( m o d4 ).
Proof: Letn>2. Normalize H. We can permute columns in
such a way that the ﬁrst three rows of Hbecome
++··· ++ ++ ···++ ++ ···++ ++ ···++
++··· ++ ++ ···++−−···−− −−···−−
++··· ++/bracehtipupleft
/bracehtipdownright/bracehtipdownleft/bracehtipupright−−···−−/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright++··· ++/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright−−···−−/bracehtipupleft/bracehtipdownright/bracehtipdownleft/bracehtipupright
acolumns bcolumns ccolumns dcolumns
We havea+b+c+d=nand the three inner products formed
from these rows yield a+b−c−d=0 ,a−b+c−d= 0, and
a−b−c+d= 0. If we add these equations, we ﬁnd n=4a, proving
the theorem. (In a similar way we see that 4b =4c=4d=n.)/square
One of the famous conjectures in the area of combinatorial de-
signs states that a Hadamard matrix of order nexists for every
n≡0 (mod 4). We are still very far from a proof of this conjec-
ture. The smallest nfor which a Hadamard matrix could exist but
no example is known is presently 428. There are very many con-
struction methods for Hadamard matrices, of which we shall treata few. First we deﬁne a second class of matrices, very similar toHadamard matrices.
Aconference matrix Cofordernis ann×nmatrix with 0’s on
the diagonal, +1 or −1 in all other positions and with the property
(18.2) CC
Llatticetop=(n−1)I.
The name conference matrix originates from an application to con-ference telephone circuits. V. Belevitch (1950) studied so-calledideal nondissipative networks consisting of ideal transformers, tobe used to set up a conference telephone network. The theory ledto a necessary condition for the existence of such a network, namelythe existence of a conference matrix of order n, wherenis the num-
ber of terminals of the network. This explains the name of thesematrices.
---PAGE BREAK---
18. Hadamard matrices, Reed–Muller codes 201
Problem 18B. LetCbe a conference matrix of order nLnegationslash=1 .
Show that nis even. Show that by permuting rows and columns,
and multiplying certain rows and columns by −1, we can ﬁnd an
equivalent conference matrix that is symmetric if n≡2 (mod 4),
and antisymmetric if n≡0 (mod 4).
Theorem 18.2. IfCisanantisymmetricconferencematrix,then
I+Cis a Hadamard matrix.
Proof: (I+C)(I+C)Llatticetop=I+C+CLlatticetop+CCLlatticetop=I+(n−1)I=nI.
/square
Theorem 18.3. IfCisasymmetricconferencematrixoforder n,
then
H=/parenleftbigg
I+C−I+C
−I+C−I−C/parenrightbigg
is a Hadamard matrix of order 2n.
Proof: Again calculate HHLlatticetopand the result follows. /square
One of the most common construction methods for several com-
binatorial structures is the so-called recursive method in which a
large object of the required type is made by applying some pro-
cedure to two or more smaller objects of the same type. In thenext theorem we demonstrate such a method for the constructionof Hadamard matrices.
LetAbe anm×nmatrix with entries a
ijandBanother matrix.
The matrix 
a11Ba 12B. . .a 1nB
a21Ba 22B. . .a 2nB
............
a
m1Bam2B. . .a mnB

consisting of mnblocks with the size of Bis called the Kronecker
productA⊗Bof the matrices AandB.
Theorem 18.4. IfHmandHnareHadamardmatricesoforder m
andnrespectively, then Hm⊗Hnis a Hadamard matrix of order
mn.
Proof: By straightforward calculation one sees that
(A⊗B)(C⊗D)=(AC)⊗(BD)
---PAGE BREAK---
202 A Course in Combinatorics
and that
(A⊗B)Llatticetop=ALlatticetop⊗BLlatticetop.
We takeA=C=HmandB=D=Hn. The result follows from
the deﬁnition of a Hadamard matrix and the fact that Im⊗In=Imn.
/square
By repeatedly applying this theorem to H2:=/parenleftBig++
+−/parenrightBig
, we ﬁnd a
sequence of Hadamard matrices that we shall denote by Hn, where
n=2m,m=1,2,... .
We now come to a direct construction method for conference
matrices, and these can then be used with Theorems 18.2 and 18.3
to construct Hadamard matrices. In the following, qis a power of
an odd prime. On the ﬁeld Fq, we deﬁne a function χ(a so-called
character)b y
χ(x): =

0i fx=0 ,
1i fxis a nonzero square,
−1i fxis a nonsquare.
For anyxandyinFq,w eh a v e χ(x)χ(y )=χ(xy ), and since there
are as many nonzero squares as nonsquares we also have
(18.3)/summationdisplay
x∈Fqχ(x)=0.
Now let 0 Lnegationslash=c∈Fq. Then (18.3) implies that
(18.4)/summationdisplay
b∈Fqχ(b)χ(b +c)=−1.
This is seen by ignoring the term with b= 0, which is 0, and then
writingχ(b+c)=χ(b)χ(1 + cb−1); (note that χ(b)2=1i fbLnegationslash= 0).
Ifbruns through all nonzero elements of the ﬁeld, then 1 + cb−1
takes on every value except 1.
Number the elements of Fq:0 =a0,a1,...,aq−1. We deﬁne a q
×qmatrixQby
qij:=χ(ai−aj),0≤i,j <q.
---PAGE BREAK---
18. Hadamard matrices, Reed–Muller codes 203
Note that Qis symmetric if q≡1 (mod 4), and antisymmetric
ifq≡3 (mod 4). As a direct consequence of the elementary
properties of χand of (18.4), we ﬁnd that QQLlatticetop=qI−Jand
QJ=JQ=O. A matrix Cof sizeq+1×q+ 1 is deﬁned by
(18.5) C:=
01 1 ...1
±1... Q
±1
,
where the signs of the terms ±1 are chosen in such a way that
Cis symmetric or antisymmetric. From the properties of Q,i t
now follows that Cis a conference matrix of order q+ 1. This
construction is due to Paley (1933) and the conference matrices of
this type are usually called Paley matrices . For the special case
thatqis a prime, the matrix Qis a circulant. We summarize the
constructions as a theorem.
Theorem 18.5. Ifqisapowerofanoddprime,thenaHadamard
matrix of order q+1exists ifq≡3( m o d4 ), and a Hadamard
matrix of order 2(q+1 )exists ifq≡1( m o d4 ).
++++++++++++
−++− +++−−− +−
−−++− +++−−− +
−+−++− +++−−−
−−+−++− +++−−
−−−+−++− +++−
−−−− +−++− +++
−+−−− +−++− ++
−++−−− +−++− +
−+++−−− +−++−
−−+++−−− +−++
−+−+++−−− +−+
Figure 18.1
---PAGE BREAK---
204 A Course in Combinatorics
++++++ −+++++
+++−−+ +−+−−+
++++−− ++−+−−
+−+++−+−+−+−
+−−+++ +−−+−+
++−−++ ++−−+−
−+++++ −−−−−−
+−+−−+−−−++−
++−+−−−−−− ++
+−+−+−−+−−− +
+−−+−+−++−−−
++−−+−−−++−−
Figure 18.2
Figures 18.1 and 18.2 illustrate Hadamard matrices of order 12
constructed from Paley matrices of orders 11 + 1 and 5 + 1, respec-
tively.
Problem 18C. Show that a Hadamard matrix of order nexists if
n≡0 (mod 4), n≤100, except possibly for n=9 2 .
There was a period of thirty years between Paley’s result and the
discovery of a Hadamard matrix of order 92 by L. D. Baumert, S.
W. Golomb, and M. Hall. The method that they used was devel-oped by Williamson in 1944 but a computer search was necessaryto ﬁnd the actual matrix. Williamson’s method is based on thefollowing observation. Let the matrices A
i,1≤i≤4, of order n,n
odd, be symmetric and assume that they commute with each other.Consider the matrix Hdeﬁned by
(18.6)
A
1A2A3A4
−A2A1−A4A3
−A3A4A1−A2
−A4−A3A2A1
.
We then have
(18.7) HHLlatticetop=I4⊗(A2
1+A22+A23+A24).
---PAGE BREAK---
18. Hadamard matrices, Reed–Muller codes 205
To construct a Hadamard matrix in this way, we have to ﬁnd ma-
tricesAithat satisfy the conditions stated above, have entries ±1,
and furthermore satisfy
(18.8) A2
1+A22+A23+A24=4nIn.
LetUbe the permutation matrix of order ncorresponding to
the permutation (12 ...n), i.e.uij= 1 if and only if j−i≡1
(modn). Then Un=Iand any circulant is a linear combination
of powers of U. If we assume that the matrices Aihave the form
Ai=/summationtextn−1
j=0aijUjwithai0= 1 andaij=ai,n−j, then the matrices
do indeed commute and they are symmetric. From now on, we also
assume that all the aijare±1 and that (18.8) is satisﬁed. A simple
example of a Hadamard matrix constructed in this way is foundby taking n=3,A
1=J, andAi=J−2I,i=2,3,4. We ﬁnd a
Hadamard matrix of order 12; see Fig. 18.3.
+++−++−++−++
+++ +−++−++−+
+++ ++− ++− ++−
+−− +++ +−−−++
−+−+++−+−+−+
−−+ +++−−+ ++−
+−−−++ +++ +−−
−+−+−++++−+−
−−+ ++− +++−−+
+−− +−−−++ +++
−+−−+−+−++++
−−+−−+ ++− +++
Figure 18.3
Example 18.1. Note that our construction implies that Aihas
constant row-sum ai(odd) and by (18.8) we have a2
1+···+a24=4n.
If we wish to use this method to ﬁnd a Hadamard matrix of order
20, we ﬁrst write 20 as a sum of four odd squares: 20 = 9 +9+1+1.
From this we see that two of the matrices Aimust be 2I −Jand
then it is not diﬃcult to see that the other two have as ﬁrst row+−++−, respectively + + −−+.
---PAGE BREAK---
206 A Course in Combinatorics
To analyze the situation a little further, we introduce matrices
WiandPias follows:
(18.9) 2W i:= (A1+···+A4)−2Ai,
(18.10) Ai=2Pi−J.
Our conventions on the coeﬃcients aijimply that if piis deﬁned
bypiJ:=PiJ, thenpiis an odd integer. Furthermore (18.8) and
(18.9) imply that
(18.11) W2
1+W2
2+W2
3+W2
4=4nI.
By substituting (18.10) in (18.8), we ﬁnd
(18.12)4/summationdisplay
i=1P2
i=(4/summationdisplay
i=1pi−n)J+nI.
Suppose the term Uk,kLnegationslash= 0, occurs in αof the matrices Pi. Con-
sidering the equation (18.12) mod 2, we ﬁnd U2kon the left-hand
side with coeﬃcient αand on the right-hand side with coeﬃcient 1.
Soαis odd and this implies that Ukoccurs in exactly oneof the
matricesWi(with coeﬃcient ±2). From Example 18.1 and (18.9),
we see that the constant row-sums wiof the matrices Wisatisfy
w2
1+···+w2
4=4n. These facts reduce the number of possibilities
for matrices Wialso satisfying (18.11) suﬃciently to make a com-
puter search for such matrices feasible. The Aiare then found from
(18.9). We list the ﬁrst rows of the four matrices of order 23 that
produced the ﬁrst Hadamard matrix of order 92:
A1:+ +−−− +−−− +−++− +−−− +−−− +
A2:+−++− ++−−++++++ −−++− ++−
A3: +++−−− ++− +−++− +−++−−− ++
A4: +++− +++−+−−−−−− +−+++−++
Problem 18D. Construct a Hadamard matrix of order 28 using
Williamson’s method.
We look at a diﬀerent problem concerning Hadamard matrices.
If a Hadamard matrix of order nis normalized, then it obviously
---PAGE BREAK---
18. Hadamard matrices, Reed–Muller codes 207
has exactly nmore entries +1 than entries −1. We deﬁne the excess
of a Hadamard matrix to be the sum of all the entries, and then
deﬁneσ(n) as the maximal value of the excess of all Hadamard
matrices of order n. The following bound due to Best (1977) shows
thatσ(n) grows as n3/2.
Theorem 18.6. n22−n/parenleftbign
1
2n/parenrightbig
≤σ(n)≤n√n.
Proof: (a) LetHbe a Hadamard matrix of order n. Letskbe
the sum of the k-th column of H. Letcibe thei-th row of H,
1≤i≤n. We calculate/summationtext
1≤i,j≤nLangbracketleftci,cjLangbracketrightin two ways. By the
deﬁnition of Hadamard matrix this sum is n2. On the other hand
/summationdisplay
1≤i,j≤nn/summationdisplay
k=1cikcjk=n/summationdisplay
k=1s2
k.
From this and the Cauchy-Schwarz inequality we ﬁnd
n/summationdisplay
k=1sk≤(nn/summationdisplay
k=1s2k)1/2=n√n,
soσ(n)≤n√n.
(b) Letxbe any vector in {+1,−1}n. We multiply column jof
Hbyxj,1≤j≤n. Subsequently, multiply those rows that have
more terms −1 than +1 by −1. Call the resulting matrix Hxand
deﬁneσ(Hx): =/summationtextn
i=1|Langbracketleftx,ciLangbracketright|.Clearlyσ(n) is at least equal to the
average value of σ(Hx). So we ﬁnd
σ(n)≥2−n/summationdisplay
x∈{+1,−1}nσ(Hx)=2−n/summationdisplay
xn/summationdisplay
i=1|Langbracketleftx,ciLangbracketright|
=2−nn/summationdisplay
i=1n/summationdisplay
d=0/summationdisplay
x,d(x,c i)=d|n−2d|
=2−nnn/summationdisplay
d=0|n−2d|/parenleftbiggn
d/parenrightbigg
=n22−n/parenleftbiggn
1
2n/parenrightbigg
.
/square
---PAGE BREAK---
208 A Course in Combinatorics
Corollary. 2−1/2n3/2≤σ(n)≤n3/2.
Proof: That the left-hand side of the inequality in Theorem 18.6
is asymptotically equal to 21/2π−1/2n3/2follows from Stirling’s for-
mula. To obtain an inequality that holds for all n, we must replace
the constant by 2−1/2. /square
Example 18.2. Consider a square of size 4 by 4, divided into
16 cells that we number from 1 to 16. A matrix Awith rows ai,
1≤i≤16, is deﬁned by taking aij=−1i fjoccurs in the square
in the same row or column as i, butjLnegationslash=i; otherwise aij=1 . F o r
any two rows of A, there are two positions where they both have
entry−1. It follows that Ais a Hadamard matrix of order 16 with
excess 64, i.e. for this matrix we have equality for the upper bound
in Theorem 18.6.
This Hadamard matrix can also be constructed as follows. Deﬁne
H:=J−2I, a Hadamard matrix of order 4 with maximal excess,
namely 8. Every row of Hhas the same number of terms +1,
namely 3. The matrix H⊗His a Hadamard matrix of order 16,
with 10 terms +1 in each row, and the maximal excess 64. If wetake the Kronecker product of this matrix with H, we again ﬁnd a
Hadamard matrix with constant row-sums and maximal excess, etc.In general, a Hadamard matrix of order 4 u
2, all row-sums equal to
2u, and hence maximal excess, is called a regular Hadamard matrix.
Other constructions of such matrices are known.
One of the very interesting and successful applications of Had-
amard matrices was their use as so-called error-correcting codes .
Many readers will have seen the excellent pictures that were takenof Mars, Saturn and other planets by satellites such as the Mariners,Voyagers, etc. To transmit such a picture to Earth, it is ﬁrst di-vided into very small ( pixels ) and for each such square the degree
of blackness is measured and expressed, say in a scale of 0 to 63.These numbers are expressed in the binary system, i.e. each pixelproduces a string of six 0’s and 1’s (bits). The bits are transmittedto the receiver station on Earth (the Jet Propulsion Laboratoryat Caltech). Due to a number of sources of noise, one of which
is thermal noise from the ampliﬁer, it happens occasionally that asignal that was transmitted as a 0, respectively a 1, is interpreted
---PAGE BREAK---
18. Hadamard matrices, Reed–Muller codes 209
by the receiver as a 1, respectively a 0. If each sextuple correspond-
ing to a pixel is transmitted as such, then the errors made by the
receiver would make the pictures very poor. Since there is only alimited amount of time to transmit the pictures and it is knownhow much energy is available from the solar panels, we know theaverage energy per user bit available to generate signals to be sentto the receiver. From this we can calculate the error probability p
(per bit).
Suppose that for a useful picture, each sextuple may be wrong
with a probability P
Eat most 10−4. To achieve this by simply
transmitting the bits, we need p≈10−4/6 sincePE=1−(1−p)6≈
10−4. Let us ﬁrst assume that the required energy is available
and try to improve the picture by doing the following. Insteadof sending a bit, say 0, we could send ﬁve 0’s and the receivertranslates a received ﬁvetuple into the bit that occurs most. We saythat we are using a code, called the repetition code, with two words
oflength 5, namely 00000 and 11111. The number 1/5 is called
theinformation rate of this code. The power constraint allows us
to calculate how much energy we have available per channel bit.Subsequently, it is possible to calculate the new error rate p
Lprime(per
channel bit). Of course pLprime>pand in our example we in fact have
pLprime=0.035 (nearly 2000 times as large as without coding). The
coding only makes sense if error correction more than makes up forthe loss of energy per bit.
The probability that a transmitted pixel is received correctly now
becomes
[(1−p
Lprime)5+5pLprime(1−pLprime)4+1 0 (pLprime)2(1−pLprime)3]6
and this is ≈0.997. In other words, we have completely spoiled
our picture!
Let us now look at what was actually done in the Mariner 1969
expedition. The 64 possible information strings (corresponding tothe possible degrees of blackness of a pixel) were mapped onto therows of the matrices H
32and−H 32. Since we now have codewords
of length 32 representing information words of length 6, the infor-mation rate is 6/32, nearly the same as for the repetition code.Note that any two of these codewords either diﬀer in all 32 posi-tions or diﬀer in exactly 16 of the positions. It follows that if a
---PAGE BREAK---
210 A Course in Combinatorics
received word contains at most 7 errors, then it resembles the cor-
rect word more than any of the 63 other words. (We have changedour symbols to ±1 instead of 0 and 1.) We say that this code is a 7-
error-correcting code. The new error probability now is p
Lprime≈0.036
(again larger). The probability that a received word is decoded
incorrectly now is
32/summationdisplay
i=8/parenleftbigg32
i/parenrightbigg
(pLprime)i(1−pLprime)32−i
and this is roughly 1 .4·10−5which is an order of magnitude better
thanPE.
In practice, there was not enough energy to transmit good pic-
tures but by using this code, that problem was solved.
What we have seen is one example of a sequence of (low rate)
codes, known as ﬁrst order Reed–Muller codes . Consider once again
the construction of the Hadamard matrices Hn, wheren=2m.I n
Fig. 18.4 we show H8.
In the matrix Hnwe replace each +1 by 0 and each −1b y1 .
Number the rows from 0 to n−1=2m−1. What happens in the
Kronecker product construction when we go from mtom+ 1, i.e.
double the order of the matrix? The new rows (now interpreted asvectors in F
2n
2) have the form (c i,ci) for 0≤i<n and they have
the form ( ci,ci+1) forn≤i<2n, where 1denotes the all-one
vector.
++ ++ ++ ++
+−+−+−+−
++−− ++−−
+−−++−−+
++ ++−−−−
+−+−−+−+
++−−−− ++
+−−+−++−
Figure 18.4
Theorem 18.7. LetRLprime(1,m)denote the set of row vectors in Fn
2
---PAGE BREAK---
18. Hadamard matrices, Reed–Muller codes 211
obtained from Hnas described above. Then RLprime(1,m)is anm-
dimensional subspace of Fn
2.
Proof: Form= 1, the assertion is trivial. We proceed by induc-
tion. Let v1,v2,...,vmbe a basis of RLprime(1,m). Our observation
made above shows that RLprime(1,m + 1) consists of all linear combina-
tions of the vectors ( vi,vi) and the vector ( 0,1). This completes
the proof. /square
We now deﬁne the ﬁrst order Reed–Muller code R(1,m) of length
n=2mand dimension m+ 1 to be the subspace of Fn
2spanned
by the space RLprime(1,m) and the all-one vector of length n. In this
terminology, the code used by Mariner 1969 was R(1,5). From
the properties of Hadamard matrices, we immediately see that any
two codewords in R(1,m) diﬀer in at least1
2nplaces. We say that
the code has minimum distance d=2m−1. Therefore the code can
correct up to 2m−2−1 errors.
We can give the codewords a nice geometric interpretation. Let
us number the points of the space Fm
2by considering a vector as
the binary representation of its number. For example, (0 ,1,1,0,1)
is considered as the point P22inF5
2. Let these representations be
the columns of an m×nmatrix. Let vibe thei-th row of this
matrix, 1 ≤i≤m. Then from Fig. 18.4 and the observations
above, we see that the vectors viare the natural basis for RLprime(1,m).
The basis vector viis the characteristic function of the hyperplane
{(x1,x2,...,xm)∈Fm
2:xi=1}. By taking linear combinations, we
see that the codewords of R(1,m) are exactly all the characteristic
functions of the aﬃne hyperplanes in the vector space and the char-acteristic function of the space itself (for 1) and of the empty set
(for0). Any two aﬃne hyperplanes are either parallel or they meet
in an aﬃne subspace of dimension m−2, in accordance with the
fact that two rows of the Hadamard matrix have the same entriesin exactly half of the positions.
As our deﬁnition of R(1,m) suggests, Reed–Muller codes of higher
order are also deﬁned in the theory of error-correcting codes. Theyalso have a geometric interpretation that we shall not go into here(but see Example 26.4).
Problem 18E. Forn=2
mand 1≤i≤m, we deﬁne the matrix
---PAGE BREAK---
212 A Course in Combinatorics
M(i)
nby
M(i)
n:=I2m−i⊗H2⊗I2i−1.
Prove that
Hn=M(1)
nM(2)
n...M(m)
n.
A received word xis decoded by calculating xHLlatticetop
n. If there are not
too many errors, then all entries of this product will be nearly 0
except one with an absolute value close to n, telling us what the
true message was. A multiplication by ±1 is called an operation.
Compare the number of operations that are necessary for decodingwhenH
nis used and when the representation of Hnas a product
of matrices M(i)
nis used. (This is an example of what is known as
aFast Fourier Transform .)
Problem 18F. Letvi,0≤i≤m, where v0=1, be the basis
ofR(1,m) given above. We consider the subspace R(2,m)o fFn
2,
wheren=2m, spanned by all the vectors
vi·vj:= (vi0vj0,...,vi,n−1vj,n−1).
What is the dimension of this space? Show that any two vectors ofR(2,m) diﬀer in at least
1
4nplaces.
Problem 18G. SupposeMis anm×n(0,1)-matrix so that the
Hamming distance between any two distinct rows is at least d.( I f
Mis the result of stacking a Hadamard matrix Hon top of −H
and changing the symbols to 0’s and 1’s, we have an example withm=2nandd=n/2.)
(1) Count the number of ordered triples ( i,j,k) such that iand
jare (indices of) distinct rows and kis a column where M(i,k)Lnegationslash=
M(j,k) in two ways—one yielding an inequality involving dand
the other involving the column-sums of M. Prove that if 2 d>n ,
then
m≤2d
2d−n.
(This is known as Plotkin’s bound in coding theory.) What condi-
tions ensure equality?
---PAGE BREAK---
18. Hadamard matrices, Reed–Muller codes 213
(2) Suppose d=n/2. Prove that m≤2nand show that equality
implies the existence of a Hadamard matrix of order n.
Problem 18H. LetHbe a Hadamard matrix of order mand
letCbe a symmetric conference matrix of order n. LetPbe the
matrix of size mwith the form/parenleftBigO−I
IO/parenrightBig
where the submatrices have
sizem/2. Prove that ( H⊗C)+(PH⊗I) is a Hadamard matrix
of sizemn.
Problem 18I. Letqbe a prime power ≡1( m o d4 ) .LetCbe the
matrix of (18.5). Choose HandPas in Problem 18H. Prove that
(H⊗C⊗Q)+(PH⊗C⊗Iq)+(H⊗Iq+1⊗Jq)
is a Hadamard matrix of size mq(q+ 1).
Notes.
J. Hadamard (1865–1963) was a leading mathematician around
the turn of the century. His most important work was in the theory
of analytic functions and in mathematical physics. He is best knownfor the proof of the so-called prime number theorem , jointly with
C. J. De La Vall´ ee-Poussin.
R. E. A. C. Paley (1907–1933) died in an avalanche while skiing
at the age of 26. In his short life he produced 26 papers of excellentquality (mostly on Fourier Theory).
A long outstanding conjecture of H. J. Ryser asserts that no
Hadamard matrix of order n>4 can be a circulant.
J. S. Wallis (aka J. Seberry) (1976) proved that for any integer s,
Hadamard matrices of orders 2
tsexist whenever t>2l o g2(s−3).
However, it is still not known whether the set of orders of Hadamardmatrices has ‘positive density’.
For more on error-correcting codes, see Chapter 20.The codes that are now called Reed–Muller codes were (surpris-
ingly?) indeed ﬁrst treated by D. E. Muller (1954) and I. S. Reed(1954).
For a detailed account of the coding and decoding for the Mariner
missions, see E. C. Posner (1968).
---PAGE BREAK---
214 A Course in Combinatorics
References.
L. D. Baumert, S. W. Golomb, and M. Hall, Jr. (1962), Discovery
of a Hadamard matrix of order 92, Bull. Amer. Math. Soc. 68,
237–238.
V. Belevitch (1950), Theory of 2 n-terminal networks with appli-
cations to conference telephony, Electrical Communication 27,
231–244.
M. R. Best (1977), The excess of a Hadamard matrix, Proc. Kon.
Ned. Akad. v. Wetensch. 80, 357–361.
D. E. Muller (1954), Application of Boolean algebra to switching
circuit design and to error detection, IEEE Trans. Computers 3,
6–12.
R. E. A. C. Paley (1933), On orthogonal matrices, J. Math. Phys.
12, 311–320.
E. C. Posner (1968), Combinatorial structures in planetary recon-
naissance, in: Error Correcting Codes (H. B. Mann, ed.), J. Wiley
and Sons.
I. S. Reed (1954), A class of multiple-error-correcting codes and the
decoding scheme, IEEE Trans. Information Theory 4, 38–49.
J. S. Wallis (1976), On the existence of Hadamard matrices, J.
Combinatorial Theory (A)21, 188–195.
J. Williamson (1944), Hadamard’s determinant theorem and the
sum of four squares, Duke Math. J. 11, 65–81.
---PAGE BREAK---
19
Designs
In this chapter we give an introduction to a large and important
area of combinatorial theory which is known as design theory. The
most general object that is studied in this theory is a so-calledincidence structure . This is a triple S=(P,B,I), where:
(1)Pis a set, the elements of which are called points;
(2)Bis a set, the elements of which are called blocks ;
(3)Iis an incidence relation between PandB(i.e.I⊆P×B ).
The elements of Iare called ﬂags.
If (p,B )∈I, then we say that point pand block Bareincident.
We allow two diﬀerent blocks B
1andB2to be incident with the
same subset of points of P. In this case one speaks of ‘repeated
blocks’. If this does not happen, then the design is called a simple
design and we can then consider blocks as subsets of P. In fact,
from now on we shall always do that, taking care to realize thatdiﬀerent blocks are possibly the same subset of P. This allows us
to replace the notation (p,B )∈Ibyp∈B, and we shall often say
that point pis ‘in block B’ instead of incident with B.
It has become customary to denote the cardinality of Pbyvand
the cardinality of Bbyb. So the incidence structure then is a set
ofvpoints and a collection of bnot necessarily distinct subsets of
the point set. The structure obtained by replacing each block byits complement is, of course called the complement of the structure.
(This means that we replace Iby its complement in P×B .)
To obtain an interesting theory, we must impose some regularity
conditions on the structure S. As a ﬁrst example, we mention
incidence structures that have the confusing name ‘ linear spaces ’.
Here the blocks are usually called linesand the regularity conditions
---PAGE BREAK---
216 A Course in Combinatorics
are that every line contains (i.e. is incident with) at least two points
and any two points are on exactly one line. Example 19.6 belowshows a simple but important linear space. The following theoremis due to De Bruijn and Erd˝ os (1948). The elegant proof is due to
Conway.
Theorem 19.1. For a linear space we have b=1orb≥v, and
equality implies that for any two lines there is exactly one point
incident with both.
Proof: Forx∈P, denote by r
xthe number of lines incident with
x, and similarly for B∈B, letkBbe the number of points on B.
Let there be more than one line. If x/∈Lthenrx≥kLbecause
there arekLlines ‘joining’ xto the points on L. Suppose b≤v.
Thenb(v−kL)≥v(b−rx) and hence
1=/summationdisplay
x∈P/summationdisplay
LLnegationslashLownerx1
v(b−rx)≥/summationdisplay
L∈B/summationdisplay
x/∈L1
b(v−kL)=1
and this implies that in all the inequalities, equality must hold.
Therefore v=b, andrx=kLifx/∈L. /square
A trivial example of equality in Theorem 19.1 is a so-called near
pencil , a structure with one line that contains all the points but
one, and all pairs containing that point as lines of size two. Muchmore interesting examples are the projective planes that we shalldeﬁne later in this chapter. These are the only possibilities. SeeProblem 23C. The reader can prove this fact for linear spaces as anexercise.
In the rest of this chapter, we shall be interested in highly regular
incidence structures called ‘t-designs’. Let v,k,t andλbe integers
withv≥k≥t≥0 andλ≥1. At-design onvpoints with
block-size kandindexλis an incidence structure D=(P,B,I)
with:
(i)|P|=v,
(ii)|B|=kfor allB∈B,
(iii) for any set Toftpoints, there are exactly λblocks incident
with all points in T.
So all blocks have the same size and every t-subset of the point set
is contained in the same number of blocks. Two diﬀerent notations
---PAGE BREAK---
19. Designs 217
for such a design are widely used, namely t-(v,k,λ ) design and
Sλ(t,k,v ). We shall use both of them. A Steiner system S(t,k,v )
is at-design with λ= 1, and we suppress the index in the notation.
Most of the early theory of designs originated in statistics, where 2-
designs are used in the design of experiments for statistical analysis.These designs are often called balanced incomplete block designs
(BIBDs). Usually trivial designs are excluded from the theory: adesign with one block that contains all the points or a design thathas all the k-subsets of the point set as blocks is of course a t-design
fort≤k, but is not very interesting.
We give a few examples; more will follow further on.
Example 19.1. Let the nonzero vectors of F
4
2be the points. As
blocks we take all triples {x,y,z}withx+y+z=0.Any pair
x,ywithxLnegationslash=yuniquely determines a third element z, diﬀerent
from both, satisfying this equation. So we have constructed an
S(2,3,15). The blocks are the 2-dimensional subspaces of F4
2with
0deleted.
We construct a second design by taking all the vectors as point
set and deﬁning blocks to be 4-tuples {w,x,y,z}for which w+
x+y+z=0.This deﬁnes an S(3,4,16). Note that if we take the
blocks that contain 0and delete this vector, we ﬁnd the blocks of
the previous design.
Example 19.2. We take the ten edges of a K5as point set. Each
of the three kinds of 4-tuples shown in Fig. 19.1 will be a block.
Figure 19.1
There are 5+10+15 = 30 blocks. No triple (of edges) is contained
in more than one block. Therefore the blocks contain 120 diﬀerent
triples, i.e. all the triples. We have constructed an S(3,4,10).
---PAGE BREAK---
218 A Course in Combinatorics
Example 19.3. LetHbe a normalized Hadamard matrix of order
4k. Delete the ﬁrst row and the ﬁrst column. We now identify
points with rows of this matrix. Each column deﬁnes a subset of
the rows, namely those rows for which there is a + in that column.These subsets are the blocks. From the argument in Theorem 18.1,we see that any pair of points is contained in exactly k−1 blocks and
clearly all blocks have size 2k −1. We have a 2-(4k −1,2k−1,k−1)
design and such a design is called a Hadamard 2-design.
Consider the same matrix Hbut now delete only the ﬁrst row.
Each of the other rows determines two 2 k-subsets of the set of
columns. This partition is unaﬀected if we change the sign of therow. The argument of Theorem 18.1 now shows that for any threecolumns, there are exactly k−1 of the subsets that have three
elements in these columns. So these 2 k-sets are the blocks of a
3-(4k, 2k,k−1) design called a Hadamard 3-design.
Example 19.4. Consider a regular Hadamard matrix of order 4 u
2
(see Example 18.2). If we replace + by 1 and −by 0, we ﬁnd
a (0,1)-matrix with 2u2+uones in every row and column, and
furthermore, any two rows or columns have inner product u2+u.
Let the columns be the characteristic functions of the blocks of adesign on 4u
2points. The properties of the matrix show that this
is a 2-(4u2,2u2+u,u2+u) design. One usually prefers considering
the complement of this design, i.e. a 2-(4 u2,2u2−u,u2−u) design.
Problem 19A. Here are two more examples in the spirit of Ex-
ample 19.2.
(i) Take the edges of K6as points of an incidence structure. The
blocks are to be all sets of three edges that either are the edges ofa perfect matching, or the edges of a triangle. Show that this is anS(2,3,15) and show that it is isomorphic to the design in Example
19.1.
(ii) Take the edges of K
7as points of an incidence structure.
The blocks are to be all sets of ﬁve edges of these three types: (a)‘claws’ with ﬁve edges incident with a common vertex, (b) edge setsof pentagon subgraphs, and (c) ﬁve edges that form a triangle andtwo disjoint edges. Show that this is an S
3(3,5,21).
We now give two elementary theorems on t-designs.
---PAGE BREAK---
19. Designs 219
Theorem 19.2. The number of blocks of an Sλ(t,k,v )is
(19.1) b=λ/parenleftbiggv
t/parenrightbigg
//parenleftbiggk
t/parenrightbigg
.
Proof: Count in two ways the number of pairs ( T,B), whereTis
at-subset of PandBis a block incident with all points of T.W e
ﬁndλ/parenleftbigv
t/parenrightbig
=b/parenleftbigk
t/parenrightbig
. /square
Theorem 19.3. Giveni,0≤i≤t, thenumberofblocksincident
with all the points of an i-subsetIofPis
(19.2) bi=λ/parenleftbiggv−i
t−i/parenrightbigg
//parenleftbiggk−i
t−i/parenrightbigg
.
That is, every Sλ(t,k,v )is also an i-design for i≤t.
Proof: Count in two ways the number of pairs ( T,B), whereT
is at-subset of Pthat contains IandBis a block that is incident
with all the points of T. /square
Corollary. IfDisat-designwithpointset Pandblockset Band
ifIis a subset of Pwith|I|≤t, then the point set P\Iand the
blocks{B\I:I⊆B}form anSλ(t−i,k−i,v−i).This design is
called the derived design DI.
In Example 19.1 we already saw an example of a derived design.
If we take I={0}, the derived design for S(3,4,16) isS(2,3,15).
Problem 19B. Show that if an S(3,6,v) exists, then v≡2o r6
(mod 20).
The number of blocks incident with any point, i.e. b1, is usually
denoted by r(replication number ). Two special cases of Theorem
19.3 are the following relations for the parameters of a 2-design:
(19.3) bk=vr,
(19.4) λ(v−1) =r(k−1).
---PAGE BREAK---
220 A Course in Combinatorics
Theorem 19.4. Let0≤j≤t. The number of blocks of an
Sλ(t,k,v )that are incident with none of the points of a j-subsetJ
ofPis
(19.5) bj=λ/parenleftbiggv−j
k/parenrightbigg
//parenleftbiggv−t
k−t/parenrightbigg
.
Proof: Forx∈P, letBxbe the set of blocks incident with x.W e
use inclusion-exclusion, Theorem 10.1. We ﬁnd that
bj=j/summationdisplay
i=0(−1)i/parenleftbiggj
i/parenrightbigg
bi.
The result follows by substitution of (19.2) and then using (10.5).
It is quicker to observe that bjapparently does not depend on
the particular set Jand then count in two ways the pairs ( J,B),
whereJis aj-subset of PandJ∩B=∅.S o/parenleftbigv
j/parenrightbig
bj=b/parenleftbigv−k
j/parenrightbig
.Then
the result follows from Theorem 19.2. /square
Corollary. Ifi+j≤t,thenthenumberofblocksofan Sλ(t,k,v )
that are incident with all of a set of ipoints and none of a disjoint
set ofjpoints is a constant
(19.6) bj
i=λ/parenleftbigv−i−j
k−i/parenrightbig
/parenleftbigv−t
k−t/parenrightbig.
Proof: The result follows upon application of Theorem 19.4 to
the (t−i)-designDI, whereIis the set of ipoints. /square
Corollary. IfJis aj-subset of P,j≤t, then the point set P\J
and the blocks BwithB∩J=∅form anSµ(t−j,k,v−j)called
theresidual design DJ.
Problem 19C. (i) Prove that an Sλ(t,k,v ) withv≤k+tis trivial.
(ii) Prove that the complement of an Sλ(t,k,v ) withv≥k+tis a
t-design and determine its parameters.
Example 19.5. Consider a Hadamard 3-design 3-(4 k,2k,k−1)
and form the residual with respect to a set with one point. We ﬁnd
---PAGE BREAK---
19. Designs 221
a Hadamard 2-design 2-(4k −1,2k,k), i.e. the complement of the
design of Example 19.3.
An obvious necessary condition for the existence of an Sλ(t,k,v )
is that the numbers biof (19.2) are integers. However, this condition
is not suﬃcient. An S(10,16,72) does not exist, as is demonstrated
by the following theorem due to Tits (1964).
Theorem 19.5. In any nontrivial Steiner system S(t,k,v ),
v≥(t+ 1)(k−t+1 ).
Proof: In a Steiner system, any two distinct blocks have at most
t−1 points in common. Choose a set Soft+1 points not contained
in any block. For each set T⊆Swith|T|=t, there is a unique
blockBTcontaining T. Each such BTis incident with k−tpoints
not inS, and any point not in Sis incident with at most one
such block BTsince two such blocks already have t−1 points of
Sin common. This shows that the union of all blocks BTcontains
(t+1 )+(t+ 1)(k−t) points and the result follows. /square
Given an incidence structure with |P|=vand|B|=b, the
incidence matrix Nis thev×bmatrix with rows indexed by the
elementspofP, columns indexed by the elements BofB, and
with the entry N(p,B)=1i fpis incident with B,N(p,B)=0
otherwise. Note that the entry in row pand column qofNNLlatticetop
is the sum of N(p,B)N(q,B) over all blocks B, and this is the
number of blocks that contain both pandq. Dually, the entry in
rowAand column BofNLlatticetopNis the cardinality of A∩B.
Two designs DandDLprimewith incidence matrices NandNLprimeare
calledisomorphic orequivalent if there are permutation matrices P
andQsuch that NLprime=PNQ.
We shall often identify Nwith the design, i.e. we refer to the
columns as blocks instead of as characteristic functions of blocks.
Now ifNis the incidence matrix of a 2-design, then NNLlatticetophas
the entry reverywhere on the diagonal and entries λin all other
positions, i.e.
(19.7) NNLlatticetop=(r−λ)I+λJ,
whereIandJarev×vmatrices.
---PAGE BREAK---
222 A Course in Combinatorics
Problem 19D. LetNbe an 11 by 11 (0,1)-matrix with the fol-
lowing properties: (i) every row of Nhas six ones; (ii) the inner
product of any two distinct rows of Nis at most 3. Show that N
is the incidence matrix of a 2-(11,6,3) design. Furthermore show
that this design is unique (up to isomorphism).
The following theorem is known as Fisher’s inequality .
Theorem 19.6. For a 2-(v,k,λ )design with bblocks and v>k
we have
b≥v.
Proof: Sincev>k , we have r>λ by (19.4). Since Jhas one
eigenvalue vand its other eigenvalues are 0, the matrix on the right-
hand side of (19.7) has v−1 eigenvalues (r −λ) and one eigenvalue
(r−λ)+λv =rk. So it has determinant rk(r−λ)v−1Lnegationslash= 0 and
henceNhas rankv. This implies that b≥v. /square
From the argument in the preceding proof, we can make a very
important conclusion, given in the next theorem.
Theorem 19.7. If a2-(v,k,λ )design has b=vblocks and vis
even, then k−λmust be a square.
Proof: Sinceb=v, we haver=k.N o wNis av×vmatrix and
by (19.7)
(detN)2=k2(k−λ)v−1.
Since detNis an integer, we are done. /square
Theorem 19.6 was generalized by A. Ya. Petrenjuk (1968) to
b≥/parenleftbigv
2/parenrightbig
for anySλ(4,k,v ) withv≥k+ 2 and ﬁnally generalized to
arbitraryt-designs by Ray-Chaudhuri and Wilson (1975).
Theorem 19.8. For anSλ(t,k,v )witht≥2sandv≥k+s,w e
haveb≥/parenleftbigv
s/parenrightbig
.
Proof: We introduce the higher incidence matrices of thet-design
D=Sλ(t,k,v ). Fori=0,1,2,..., let Nidenote the/parenleftbigv
i/parenrightbig
×bma-
trix with rows indexed by the i-element subsets of points, columns
indexed by the blocks, and with entry 1 in row Yand column B
ifY⊆B, 0 otherwise. For 0 ≤i≤j≤v, we useWijto denote
thei-th incidence matrix of the incidence structure whose blocks
---PAGE BREAK---
19. Designs 223
are all the j-element subsets of a v-set. Thus Wijis a/parenleftbigv
i/parenrightbig
×/parenleftbigv
j/parenrightbig
matrix.
We claim that
NsNLlatticetop
s=s/summationdisplay
i=0bi
2s−iWLlatticetop
isWis.
To see this, note that NsNLlatticetop
shas rows indexed by s-element subsets
Eand columns indexed by s-element subsets Fof the points, and
for givenEandF, the entry in row Eand column FofNsNLlatticetop
sis
the number of blocks that contain both EandF. This number is
b2s−µ, whereµ:=|E∩F|. The entry in row Eand column Fof
WLlatticetop
isWisis the number of i-subsets of the points contained in both
EandF, i.e./parenleftbigµ
i/parenrightbig
. So the (E ,F)-entry on the right-hand side of
the equation is/summationtexts
i=1bi
2s−i/parenleftbigµ
i/parenrightbig
, and from (19.6) it follows that this is
b2s−µ.
The/parenleftbigv
s/parenrightbig
×/parenleftbigv
s/parenrightbig
matricesbi2s−iWLlatticetop
isWisare all positive semideﬁnite,
andbs
sWLlatticetop
ssWss=bssIis positive deﬁnite since bss>0(v≥k+s).
Therefore NsNLlatticetop
sis positive deﬁnite and hence nonsingular. The
rank ofNsNLlatticetop
sis equal to the rank of Ns, i.e.Nshas rank/parenleftbigv
s/parenrightbig
, and
this cannot exceed the number of columns of Ns, which is b./square
If equality holds in the Wilson–Petrenjuk inequality, Theorem
19.8, then the 2 s-design is called tight. The only known examples
withs>1 and v>k +sare the unique Steiner system S(4,7,23)
that we treat in the next chapter, and its complement.
It is useful to give some idea of the history of t-designs. Only
ﬁnitely many Steiner systems S(t,k,v ) witht≥4 are known. The
most famous are the designs S(5,8,24) andS(5,6,12) found by E.
Witt (1938) and the derived 4-designs. These will appear in the
next chapter. R. H. F. Denniston (1976) constructed S(5,6,24),
S(5,7,28),S(5,6,48), andS(5,6,84). W. H. Mills (1978) con-
structed an S(5,6,72). Again, the derived designs are Steiner
systems. M. J. Granell and T. S. Griggs (1994) constructed anS(5,6,108). Since then, no others have been found. In 1972, W. O.
Alltop constructed the ﬁrst inﬁnite sequence of 5-designs withoutrepeated blocks. We remark that it is easy to show that t-designs
with repeated blocks exist for any t, but for a long time many de-
sign theorists believed that nontrivial t-designs without repeated
---PAGE BREAK---
224 A Course in Combinatorics
blocks did not exist for t>6. The ﬁrst simple 6-design was found
by D. W. Leavitt and S. S. Magliveras in 1982, and in 1986 D. L.
Kreher and S. P. Radziszowski found the smallest possible simple6-design, an S
4(6,7,14). The big sensation in this area was the pa-
per by L. Teirlinck (1987) proving that nontrivial simple t-designs
exist for all t. His construction produces designs with tremendously
large parameters and hence the construction of small examples isstill an open problem. For a number of special parameter sets, ithas been shown that the corresponding designs do not exist.
For the remainder of this chapter we shall mainly be interested
in 2-designs. When t= 2, we often omit this parameter in the
‘t-(v,k,λ )’ notation and speak of ( v,k,λ )-designs.
A class of designs of special interest are the 2-designs with b=v.
In this case the incidence matrix Nof the design is a square matrix
and these designs should be called square designs . However, the
confusing name symmetric designs is standard terminology. (Note
thatNisnotnecessarily symmetric.) For a symmetric 2-( v,k,λ )
design (19.4) becomes
λ(v−1) =k(k−1).
Some authors use the name projective design , a name derived from
the fact that a 2-( v,k,1) design with b=vis called a projective
plane (see Example 19.7). Despite the fact that we are not happywith the name, we shall use the terminology symmetric designs for
these designs.
Problem 19E. LetDbe a 2-(v,k,λ ) design with bblocks and r
blocks through every point. Let Bbe any block. Show that the
number of blocks that meet Bis at least
k(r−1)
2/[(k−1)(λ−1 )+(r−1)].
Show that equality holds if and only if any block not disjoint from
Bmeets it in a constant number of points.
Example 19.6. Take as points the elements of Z7and as blocks
all triples Bx:={x,x +1,x+3}withx∈Z7. It is easy to check
that this yields an S(2,3,7). The following Fig. 19.2 is often drawn.
---PAGE BREAK---
19. Designs 225
The lines repesent blocks, but one block must be represented by the
circle.
Figure 19.2
This design is known as the Fano plane. The idea of the construc-
tion will be extended in Chapter 27. It is based on the fact that thesix diﬀerences among the elements of {0,1,3}are exactly all the
nonzero elements of Z
7. If we wish to ﬁnd the block containing say
{1,6}, we observe that 6 −1=1−3 and we therefore take x=5
and ﬁndx+1=6 ,x+ 3 = 1, i.e. the pair is indeed in B5. The
reader should have no diﬃculty ﬁnding an S(2,4,13) in the same
way, using Z13.
A symmetric design with λ= 1 is called a projective plane .I fkis
the size of the blocks, then n=k−1 is called the order of the plane
(why this is done will become clear in Example 19.7). Expressedinn, the parameters of a projective plane of order nare:
v=n
2+n+1,k =n+1,λ =1.
The blocks are usually called lines. The Fano plane is the (unique)
projective plane of order 2.
Example 19.7. Consider the vector space F3
q. This vector space
contains (q3−1)/(q−1) =q2+q+ 1 1-dimensional subspaces and
the same number of 2-dimensional subspaces. We now construct an
incidence structure ( P,B,I), where PandBare these two classes
of subspaces of F3
q. If a 1-dimensional subspace is contained in a
2-dimensional subspace, we say they are incident. It is immediatelyclear that we have thus deﬁned a projective plane of order q, i.e.
a 2-(q
2+q+1,q+1,1) design. This design is usually denoted
---PAGE BREAK---
226 A Course in Combinatorics
byPG(2,q)o rPG 2(q), which stands for projective geometry of
dimension 2 and order q.
The construction deﬁned above can also be applied if we re-
placeFqbyR. We then obtain the classical real projective plane,
where points are the 1-dimensional subspaces and lines are the
2-dimensional subspaces. This geometry contrasts with classicalaﬃne geometry in the fact that no two lines are parallel. Whenspeaking about the designs deﬁned above, we use terminology fromgeometry.
Problem 19F. Find a subset S={s
1,...,s 5}ofZ21such that
the elements of Z21as points and the 21 blocks S+x(x∈Z21)
form a projective plane of order 4. (Hint: there is a solution Sfor
which 2S =S.)
Problem 19G. Let (R,C,S ;L) be a Latin square of order 6. De-
ﬁneP:=R×C. LetBbe the set of blocks
Bij:=
{(x,y )∈R×C:x=iory=jorL(x,y)=L(i,j )}\{ (i,j)}
for (i,j)∈R×C.
(1) Show that this deﬁnes a 2-(36,15,6) design.
(2) Show that a regular Hadamard matrix of order 36 exists.
Problem 19H. LetDbe a 3-(v,k,λ ) design. Suppose that the
derived design of Dwith respect to a point p(i.e. the case i=1i n
the Corollary to Theorem 19.3) is a symmetric design.
(1) Show that λ(v−2 )=(k−1)(k−2).
(2) Show that any two blocks of Dmeet in 0 or λ+ 1 points.
(3) Show that the set of points not on a block Btogether with
the blocks disjoint from Bform a 2-design DB.
(4) Apply Fisher’s inequality to the design DBand deduce that
v=2kor otherwise k=(λ+1)(λ +2) ork=2 (λ+1)(λ +2).
What are the possibilities for the design D? Do we know any
designs with these properties?
Problem 19I. LetObe a subset of the points of a projective
plane of order nsuch that no three points of Oare on one line.
---PAGE BREAK---
19. Designs 227
Show that |O|≤n+1i fnis odd and that |O|≤n +2i fnis even.
A set ofn+ 1 points, no three on a line, is called an oval; a set of
n+ 2 points, no three on a line, is a hyperoval . Two constructions
ofPG2(4) were given in Example 19.7 and Problem 19F. In each
case, construct a hyperoval.
Problem 19J. LetObe a hyperoval (with q+2 points) in PG2(q),
q=2m. Any of the q2−1 pointsp/∈Ohas the property that there
are exactly1
2(q+ 2) secants of Othroughp. Take ﬁve points on O
and split them into
{{p1,p2},{p3,p4},{p5}}.
This can be done in 15 ways. The two pairs determine two secants
that meet in a point p/∈O. The line through pandp5meetsOin
a point, that we call p6. This deﬁnes 15 (not necessarily distinct)
6-tuples of points on O, containing the given ﬁve points. This
deﬁnes an Sλ(5,6,q+ 2), a construction due to D. Jungnickel and
S. A. Vanstone (1987). Show that the points with ‘coordinates’ (asin Example 19.7) (1 ,t,t
2),t∈Fq, with (0,1,0) and (0,0,1) form a
hyperoval OinPG2(q). Show that a suitable choice of p1top5
onOwith the construction explained above yields repeated blocks,
i.e. the 5-design is not simple.
Any 2-(n2,n,1) design is called an aﬃne plane. The points and
lines of the plane (= 2-dimensional vector space) F2
qform an aﬃne
plane of order q. For such a design we use the notation AG2(n)
(2-dimensional aﬃne geometry of order n).
Example 19.8. LetDbe a projective plane of order n.I f w e
delete one line and all the points on that line, we ﬁnd an aﬃneplane of order n.
Problem 19K. LetDbe any aﬃne plane of order n.I fB
1and
B2are two blocks, then we write B1∼B2if the two blocks are
the same or if they have no points in common. Show that ∼is
an equivalence relation. A class of this relation is called a parallel
class. Show that there exists a projective plane of order nsuch that
Dcan be obtained from that plane by the construction of Example
19.8.
---PAGE BREAK---
228 A Course in Combinatorics
We shall now show that if Nis the incidence matrix of a symmet-
ric design D, thenNLlatticetopis also the incidence matrix of a symmetric
designDLlatticetop, called the dualofD.
Theorem 19.9. LetNbe the incidence matrix of a symmetric 2-
(v,k,λ )design. Then NLlatticetopis also the incidence matrix of a design.
Proof: Consider any block Bof the design. For 0 ≤i≤kletai
be the number of blocks ( Lnegationslash=B) that have ipoints in common with
B. Then counting blocks, pairs ( p,BLprime) withp∈B∩BLprimeand triples
(p,q,BLprime) withpLnegationslash=qand{p,q}⊆B∩BLprimewe ﬁnd:
k/summationdisplay
i=0ai=v−1,k/summationdisplay
i=0iai=k(k−1),k/summationdisplay
i=0/parenleftbiggi
2/parenrightbigg
ai=/parenleftbiggk
2/parenrightbigg
(λ−1),
from which we ﬁnd/summationtextk
i=0(i−λ)2ai=0.Hence, any block BLprimeLnegationslash=B
hasλpoints in common with B, i.e.NLlatticetopN=(k−λ)I+λJ./square
Note that in Example 19.7, we did not need to specify whether
the setPwas the 1-dimensional subspaces or the 2-dimensional
subspaces. In the latter situation, we have the dual of the former.
In many cases the designs DandDLlatticetopare not isomorphic.
LetDbe a symmetric 2-( v,k,λ ) design. There are two other
ways to obtain a design from D. These two designs are called the
derived design and residual design of D. This could be somewhat
confusing since we have already introduced that terminology. We
shall always indicate which of the two we mean. Take any block B
ofD. The residual of Dwith respect to BhasP\Bas point set and
as blocks all BLprime\BwithBLprimeLnegationslash=B. I ti sa2 - ( v−k,k−λ,λ) design.
The derived design has Bas point set and as blocks all BLprime∩Bwith
BLprimeLnegationslash=B. I ti sa2 - ( k,λ,λ−1) design. If a design with parameters
v,k,b,r,λ is the residual of a symmetric design, then r=k+λ.
Any 2-design for which this equation holds is called a quasiresidual
design. If such a design is not the residual of a symmetric design,then we say that it is nonembeddable. The assertion of Problem
19K is that every aﬃne plane is embeddable in a projective plane.A theorem due to W. S. Connor (1952), that we shall leave untilChapter 21, states that every quasiresidual design with λ=2i s
embeddable.
---PAGE BREAK---
19. Designs 229
Example 19.9. LetC:=/parenleftbigg010
001100/parenrightbigg
and letEidenot ea3b y3
matrix with ones in column iand zeros elsewhere. Then
N:=
E1II I
E2ICC2
E3IC2C
is the 9 by 12 incidence matrix of AG
2(3). Deﬁne
A:=
111111000000
111000111000111000000111000111111000000111000111000000111111
,B :=
1100
11001100101010101010100110011001
.
Form the 24 by 16 matrix
D:=
AO
NB
NJ−B
.
One easily checks that D
Llatticetopis the 16 by 24 incidence matrix of a 2-
(16,6,3) design. This is a quasiresidual design. However, it cannot
be the residual of a 2-(25,9,3) symmetric design because the innerproduct of row i+ 6 and row i+1 5o fD,1≤i≤9, equals 4 and,
by Theorem 19.9, the inner product of the columns of the incidencematrix of a 2-(25,9,3) design is 3. This shows that nonembeddabledesigns with λ= 3 exist.
The combination of a counting argument and a suitable quadratic
form that we used to prove Theorem 19.9 is widely used in combina-torics. However, sometimes it is easier to use algebraic methods aswe shall demonstrate in the following theorem, due to Ryser. (Thereader can try to prove the theorem by using counting arguments.)
---PAGE BREAK---
230 A Course in Combinatorics
Theorem 19.10. LetD=(P,B,I)beanincidencestructurewith
|P|=|B|=v, block-size k, such that any two blocks meet in λ
points. Then Dis a symmetric 2-design.
Proof: LetNbe the incidence matrix of D. Then
(19.8) NLlatticetopN=(k−λ)I+λJ,
and
(19.9) JN=kJ.
By Theorem 19.9, we are done if we can show that NJ=kJ. From
(19.8) we see that Nis nonsingular and hence (19.9) can be read
asJ=kJN−1. From (19.8) we ﬁnd JNLlatticetopN=(k−λ+λv)Jand
therefore
JNLlatticetop=(k−λ+λv)JN−1=(k−λ+λv)k−1J,
i.e.Nhas constant row-sums. Then these row-sums must be k.
This proves the theorem and yields (k −λ+λv)k−1=kas was to
be expected from (19.3) and (19.4). /square
As a preparation for the best known nonexistence theorem for
designs, we need two results, both due to Lagrange. For the ﬁrst,
consider the matrix Hof (18.6) with n= 1, i.e.Ai=(ai). Deﬁne
y=(y1,y2,y3,y4)b yy:=xH, wherex=(x1,x2,x3,x4). Then
from (18.7) we ﬁnd
(19.10) (a2
1+a22+a23+a24)(x21+x22+x23+x24)=(y2
1+y2
2+y2
3+y2
4).
Using this identity, Lagrange proved that every integer is the sum
of four squares. Clearly the identity shows that it is suﬃcient toprove this for primes. For an elegant proof that a prime is the sumof four squares we refer to Chandrasekharan (1968).
The following nonexistence theorem is known as the Bruck–
Ryser–Chowla theorem.
Theorem 19.11. Ifv,k,λareintegerssuchthat λ(v−1) =k(k−
1), then for the existence of a symmetric 2-(v,k,λ) design it is
necessary that:
(i)ifvis even then k−λis a square;
(ii)ifvisodd,thentheequation z
2=(k−λ)x2+(−1)(v−1)/2λy2
has a solution in integers x,y,z, not all zero.
---PAGE BREAK---
19. Designs 231
Proof: Assertion (i) was proved in Theorem 19.7. So assume that
vis odd. Let Dbe a symmetric 2-( v,k,λ ) design with incidence
matrixN=(nij) and write n:=k−λ. We now introduce vlinear
formsLiin the variables x1,...,xvby
Li:=v/summationdisplay
j=1nijxj, 1≤i≤v.
Then the equation NLlatticetopN=(k−λ)I+λJimplies that
(19.11) L2
1+···+L2v=n(x21+···+x2v)+λ(x 1+···+xv)2.
By Lagrange’s theorem, ncan be written as n=a2
1+···+a24. This
and (19.10) allow us to take four of the variables xjand write
(19.12) n(x2
i+x2i+1+x2i+2+x2i+3)=(y2
i+y2
i+1+y2
i+2+y2
i+3),
where each yjis a linear form in the four variables xi,...,xi+3.
We now ﬁrst assume that v≡1 (mod 4). By applying this to
(19.11), four variables at a time, and introducing wforx1+···+xv,
we reduce (19.11) to
(19.13) L2
1+···+L2v=y2
1+···+y2
v−1+nx2v+λw2.
SinceHin (18.6) is invertible, we can express the variables xjfor
1≤j≤v−1 as linear forms in the corresponding yjand hence
wis a linear form in these variables and xv. Next, we reduce the
number of variables in the following way. If the linear form L1,
expressed in y1,...,yv−1,xv, does not have coeﬃcient +1 for y1,
then we set L1=y1, and if the coeﬃcient is +1, we set L1=−y1,
and in both cases, we subsequently solve this equation for y1as
a linear expression in the remaining variables yjandxv. This is
substituted in the expression w. So (19.11) has been reduced to
L22+···+L2v=y2
2+···+y2
v−1+nx2v+λw2.
We proceed in this way for y2,...,yv−1. In each step, wis replaced
by another linear form in the remaining variables, and hence we
end up with
L2
v=nx2v+λw2,
---PAGE BREAK---
232 A Course in Combinatorics
in which both Lvandware rational multiples of the variable xv.
If we multiply this by the common denominator of the factors, we
ﬁnd an equation
z2=(k−λ)x2+λy2
in integers. This proves the assertion if v≡1 (mod 4). If v≡
3 (mod 4), the same procedure is applied to (19.13) after addingnx
2
v+1to both sides, where xv+1is a new variable. The equation is
then ﬁnally reduced to nx2v+1=y2
v+1+λw2and again we multiply
by a common denominator to ﬁnd an equation of type
(k−λ)x2=z2+λy2
in accordance with assertion (ii). /square
Example 19.10. From Example 19.7, we know that a projective
plane of order nexists for 2 ≤n≤9, except possibly for n=6 .
By Theorem 19.11, a necessary condition for the existence of a
projective plane of order 6 is that the equation z2=6x2−y2has a
nontrivial solution. If such a solution exists, then also one for whichx,y, andzhave no prime factor in common, i.e. zandyare both
odd. Then z
2andy2are both ≡1 (mod 8). Since 6x2(mod 8) is
either 0 or 6, we see that the equation has only the trivial solution(0,0,0). Therefore a projective plane of order 6 does not exist.
If we try the same thing for a plane of order 10, we ﬁnd the
equationz
2=1 0x2−y2, which has the solution x=1 ,y=1 ,
z= 3. In this case Theorem 19.11 tells us nothing. In 1989, Lam
et al. announced that a computer search involving several hundredhours on a Cray 1 had excluded the existence of a projective planeof order 10. This is the only case where the nonexistence of asymmetric 2-design has been shown using something other thanTheorem 19.11.
Corollary. If there exists a projective plane of order n≡1or2
(mod 4), then nis the sum of two integral squares.
Proof: The condition n≡1 or 2 (mod 4) implies that v=n
2+
n+1≡3 (mod 4). Theorem 19.11 asserts that nis the sum of two
rational squares. It is well known that nis the sum of two rational
squares if and only if nis the sum of two integral squares. (This
---PAGE BREAK---
19. Designs 233
follows from the condition that nis the sum of two integral squares
if and only if no prime divisor of the square-free part of nis≡3
(mod 4).) /square
Problem 19L. Show that a symmetric 2-(29,8,2) design does not
exist.
Problem 19M. SupposeMis a rational square matrix of order v
and thatMMLlatticetop=mI. Show that if vis odd, then mis a square.
Show that if v≡2 (mod 4), then mis the sum of two rational
squares.
(Note that one consequence of this latter result is that the exis-
tence of a conference matrix of order n≡2 (mod 4) implies that
n−1 is the sum of two squares.)
A great deal of work has been done on the construction of 2-
designs. We shall only treat a number of examples that will give
some idea of the kind of methods that have been used. The smallestnontrivial pair ( k,λ) to consider is (3, 1). A 2-(v, 3,1) design is
called a Steiner triple system . One uses the notation STS(v) for
such a design. By (19.3) and (19.4), a necessary condition for theexistence of such a design is that v≡1( m o d6 )o r v≡3 (mod 6).
We shall show that this condition is also suﬃcient. This will be doneby direct construction in Examples 19.11 and 19.15. However, it isuseful to see a number of examples of a more complicated approach.The methods that we demonstrate can be used for the constructionof other designs than Steiner triple systems. Furthermore, they canbe used to produce designs with certain subdesigns (see Problem19N) or prescribed automorphism group. The idea of this approachis to ﬁnd direct constructions for small examples and some recursiveconstructions, and subsequently show that, for any vthat satisﬁes
the necessary conditions, an STS(v) can be constructed by the
recursive methods, using the list of known small examples. Weshall see below that this in fact reduces to a (not very diﬃcult)problem in number theory. As stated above, we restrict ourselvesto a number of examples. The reader may wish to try to show thatour examples suﬃce to ﬁnd an STS(v) for all possible values of v,
without using Examples 19.11 and 19.15.
We consider the trivial design with only one block of size 3
---PAGE BREAK---
234 A Course in Combinatorics
asSTS(3). We have already seen constructions of STS(7) =
PG2(2) andSTS(9) =AG2(3). In Example 19.1, we constructed
anSTS(15).
Example 19.11. Letn=2t+ 1. We deﬁne P:=Zn×Z3.As
blocks we take all triples {(x,0),(x,1),(x,2)}withx∈Znand all
triples{(x,i),(y,i),(1
2(x+y),i+1 )}withxLnegationslash=yinZnandi∈Z3.
This simple construction provides an STS(6t+ 3) for every t.
Example 19.12. Letq=6t+ 1 be a prime power and let αbe
a primitive element in Fq, i.e.F∗
qis a cyclic group generated by α.
We deﬁne
(19.14)Bi,ξ:={αi+ξ,α2t+i+ξ,α4t+i+ξ}, 0≤i<t, ξ ∈Fq.
We claim that the elements of Fqas points and the blocks Bi,ξform
anSTS(q). The idea of the proof is the same as in Example 19.6.
Note that α6t=1 ,α3t=−1 and deﬁne sbyαs=(α2t−1).We
consider the six diﬀerences of pairs from B0,0. These are:
α2t−1=αs, −(α2t−1) =αs+3t,
α4t−α2t=αs+2t,−(α4t−α2t)=αs+5t,
α6t−α4t=αs+4t,−(1−α4t)=αs+t.
It follows that for any ηLnegationslash=0i n Fq, there is a unique i,0≤i<t,
such that ηoccurs as the diﬀerence of two elements of Bi,0. Hence
for anyxandyinFq, there is a unique iand a unique ξ∈Fqsuch
that the pair x,yoccurs in the block Bi,ξ. /square
The method of Examples 19.6 and 19.12 is known as the method
of diﬀerences. Example 19.15 will show a more complicated use of
the same idea.
We now know that an STS(v) exists for v=1 3,19,25,31,37,43
and 49 as well as the values mentioned above. This includes allv≡1 (mod 6) less than 50. In fact, we now know at least one
STS(v) for each feasible value of vless than 100, except v=5 5 ,
v= 85,v=9 1 .
---PAGE BREAK---
19. Designs 235
Example 19.13. Let there be an STS(vi) on the point set Vi
(i=1,2). We take V1×V2as a new point set and deﬁne as blocks
all triples: {(x1,y1),(x2,y2),(x3,y3)}for which
(1)x1=x2=x3and{y1,y2,y3}is a block of STS(v2);
(2){x1,x2,x3}is a block of STS(v1) andy1=y2=y3;
(3){x1,x2,x3}is a block of STS(v1) and{y1,y2,y3}is a block
ofSTS(v2).
It is practically obvious that this deﬁnes an STS(v1v2). The reader
should check that we have deﬁned the correct number of blocks.
This construction provides us with an STS(91).
Example 19.14. We show a slightly more complicated construc-
tion. Suppose that we have an STS(v1) on the point set V1=
{1,2,...,v 1}with block set S1, and furthermore suppose that the
blocks that are completely contained in V={s+1,...,v 1}, where
s=v1−v, form an STS(v). LetS2be the set of triples of an
STS(v2) on the point set V2={1,2,...,v 2}.
We consider a new point set
P:=V∪{(x,y):1≤x≤s,1≤y≤v2}.
This set has v+v2(v1−v) points. We introduce a set Bof four
kinds of blocks:
(1) those of the subsystem STS(v);
(2){(a,y ),(b,y),c}withc∈V,{a,b,c}∈S 1andy∈V2;
(3){(a,y ),(b,y),(c,y)}with{a,b,c}a block in S1with no point
inV, andy∈V2;
(4){(x1,y1),(x2,y2),(x3,y3)}, where {y1,y2,y3}is a block in S2
and the integers x1,x2,x3satisfy
x1+x2+x3≡0( m o ds).
Again, one easily checks that any two points of Puniquely deter-
mine a block in B. HencePandBare the points and blocks of a
Steiner triple system on v+v2(v1−v) points. A simple example
is obtained by letting the subsystem be just one block, i.e. v=3 .
Takingv1=7 ,v2= 13, we ﬁnd an STS(55).
We have thus constructed an STS(v) for every feasible value of
vless than 100, except v= 85.
---PAGE BREAK---
236 A Course in Combinatorics
Problem 19N. (a) Show that if an STS(v1) and anSTS(v2) both
exist, then there is an STS(v1v2−v2+ 1). Use this construction to
ﬁnd anSTS(85).
(b) Construct an STS(15) on the set {0,1,..., 14}such that it
contains a Fano plane on {0,1,..., 6}as a subsystem.
Example 19.15. Consider as point set Z2t×Z3∪{∞}. Addition
of elements is coordinatewise with the extra convention ∞+(x,i)=
∞.For notational convenience we sometimes write the second co-
ordinate as an index, i.e. xiinstead of (x,i ). We now deﬁne four
types of ‘ base blocks’:
(1){00,01,02};
(2){∞,00,t1},{∞,01,t2},{∞,02,t0};
(3){00,i1,(−i)1},{01,i2,(−i)2},{02,i0,(−i) 0},i=1,...,t−1;
(4){t0,i1,(1−i)1},{t1,i2,(1−i)2},{t2,i0,(1−i)0},i =1,...,t .
We have 6 t+ 1 base blocks. For a=0,1,...,t−1 we add the
element (a,0) (i.e.a0) to each of the elements of every base block,
thus producing t(6t+1) blocks. We claim that these are the triples
of anSTS(6t+1). It is trivial that the base blocks of type 2 yield a
set of blocks in which every pair of points, one of which is ∞, occurs
exactly once. The cyclic nature of the deﬁnition of the base blocks
shows that it is suﬃcient for us to check that all pairs {a0,b0}with
aLnegationslash=band all pairs {a0,b1}occur in the triples we have deﬁned. If
a<b andb−a=2s, then the pair {a0,b0}occurs in the triple
obtained from {02,s0,(−s) 0}‘translated’ by the element (b −s,0).
Similarly, if b−ais odd, we ﬁnd the required pair by translating a
base block of type 4. Now consider a pair {a0,b1}.I fa=b≤t−1,
we ﬁnd the pair by translating the base block of type 1 by ( a,0).
IfaLnegationslash=banda<t, we have to look for the pair in a translate of a
base block of type 2 or of type 3. We must search for a base blockin which the diﬀerence b−aoccurs asy−xfor two elements y
1,x0.
For type 2, this diﬀerence is tand in the blocks {00,i1,(−i)1}we
ﬁnd the diﬀerences i,1≤i≤t−1, and−i=2t−i,1≤i≤t−1,
indeed every diﬀerence once! Now, the rest of the details can beleft as an exercise.
This example shows that if v=6t+ 1, then an STS(v) exists.
Combined with Example 19.11 we have a construction for everyfeasible value of v.
---PAGE BREAK---
19. Designs 237
We end this chapter with an amusing application of the Fano
plane. At present the idea is not used in practice but the problem
itself has a practical origin, and maybe some day generalizations ofthe following method will be used. Suppose one wishes to store oneof the integers 1 to 7 in a so-called ‘ write-once memory ’. This is a
binary memory, originally ﬁlled with zeros, for which it is possibleto change certain bits to ones but not back again, i.e. the state 1 ispermanent. This happens in practice with paper tape, into whichholes are punched, or compact discs, where a laser creates pits incertain positions. In both cases, we cannot erase what was writtenin the memory. To store the integers 1 to 7, we need a memory ofthree bits. What if one wishes to use the memory four consecutivetimes? The simplest solution is to have a 12-bit memory that ispartitioned into four 3-bit sections, one for each consecutive usage.We assume that the memory is very expensive and we would liketo be able to use a shorter memory for the same purpose. We shallnow show that seven bits suﬃce, a saving of more than 40%.
Figure 19.3
LetP={1,2,..., 7}be the set of points of PG2(2) and let
Ldenote the set of lines. To store one of the integers 1 to 7 in a
memory with positions numbered 1 to 7, we use the following rules.As a general rule: if we wish to store iand the memory is in a state
corresponding to i(from a previous usage), then we do nothing.
Otherwise the rules are:
(1) if the memory is empty, store iby putting a 1 in position i;
(2) to store jwhen the memory is in state i,p u ta1i np osition
k, where{i,j,k}∈L ;
(3) to store iwhen the memory contains two 1’s, not correspond-
ing toi, put in two more 1’s, such that iis one of the four
---PAGE BREAK---
238 A Course in Combinatorics
1’s and the other three form a line in L. No matter what
the two original 1’s were, this is possible (sometimes in two
ways);
(4) if the memory contains four 1’s, we may assume that we are
in the situation of Fig. 19.3. To store 3, we do nothing (bythe general rule); to store one of the missing numbers, weput 1’s in the other two positions; to store 1, 2, or 4, store a 1in the empty position on the line through 3 and the numberwe wish to store.
We leave it as an exercise for the reader to formulate the rulesfor reading the memory. Note that the memory uniquely readsthe integer presently stored in the memory but it cannot see howoften an integer has been stored or what was stored on the previoususage.
Problem 19O. (i) Suppose Ais a family of subsets of an n-set
X, so that any member of Ahas odd cardinality, but such that
any two distinct members of Ameet in an even number of points.
Show that |A| ≤n.
(ii) Suppose members of Ahave even cardinality but any two
intersect in an odd number of points. Show that |A| ≤n+1 . C a n
you ﬁnd examples where equality holds?
Problem 19P. Consider 2-(v,k,λ = 2) designs where v=/parenleftbig
k+1
2/parenrightbig
.
(i) Find an example with k= 3. (You might try ﬁve points on a
circle and one in the middle.)
(ii) LetA1,A2,...,Abbe the blocks and for i=2,3,...,b , let
µi=|Ai∩A1|. Compute
b/summationdisplay
i=2µi,b/summationdisplay
i=2µi(µi−1),b/summationdisplay
i=2(µi−1)(µi−2)
in terms of k. What can you say about the µi’s?
Problem 19Q. AGeneralized Steiner System is an incidence struc-
ture with a point set Pof sizevand a set Bof subsets of P, again
called blocks, where |B|=b, such that every t-subset of Pis in a
unique block. We do notrequire the blocks to have constant size
---PAGE BREAK---
19. Designs 239
but we rule out the trivial case where b= 1. Denote by bt,vthe min-
imal value of bfor a nontrivial Generalized Steiner System. Prove
that fort≥2
bt,v(bt,v−1)≥t/parenleftbiggv
t/parenrightbigg
.
Note that for t= 2, this result is the same as Theorem 19.1. Much
stronger bounds are known but not as easy to derive.
Problem 19R. We shall say that a point in the Fano plane is a
representative of a line if it is incident with that line. How many
SDR’s does the Fano plane have?
Problem 19S. Construct 3-(2k,4,1) designs, for all k≥2.
Problem 19T. We say that a design can be extended if it is a
derived design of a design, called the extended design. Prove that
if a symmetric design can be extended twice, it must be a 2-(21, 5,1)
design.
Problem 19U. Consider the graph Gof Problem 1J. Deﬁne an
incidence structure Iwith as points the vertices of Gand as lines
the sets Γ( x), for vertices x∈G. Show that the properties of G
imply that Iis a projective plane. (Cf. Problem 21Q.)
Problem 19V. We use the hypothesis of, and the notation intro-
duced in the proof of, Theorem 19.8.
(i) Check that WisNs=/parenleftbigk−i
s−i/parenrightbig
Ni.
(ii) Show that the product of any two of WLlatticetop
isWis,i=0,1,...,s ,
is a linear combination of these s+ 1 matrices. So the linear span
Aof these matrices is closed under multiplication.
(iii) Suppose equality holds in Theorem 19.8 so that the matrix
Nsis square. Then NLlatticetop
sM−1Ns=IwhereM:=/summationtexts
i=0bi
2s−iWLlatticetop
isWis.
SinceM∈A, part (ii) implies M−1∈A. Use this to prove that
there is a polynomial f(x) of degree sso thatf(|A∩B|) = 0 for
all distinct blocks A,B. (Hence there are at most s‘intersection
numbers’.) This generalizes Theorem 19.9.
Notes.
The ﬁrst occurrence of a 2-design may be AG2(3) in a paper by
Pl¨ ucker (1839). One usually attributes the introduction of Steiner
---PAGE BREAK---
240 A Course in Combinatorics
systems to Woolhouse (1844); of course notto Steiner! Quite often
they are said to originate with a problem of T. P. Kirkman (1847).
T. P. Kirkman (1806–1895), a self-educated man, was a minister ofthe Church of England. He was an amateur mathematician withmany contributions to the subject. Probably the best known is his15 schoolgirls problem . The problem is to arrange 15 schoolgirls
in parties of three for seven days’ walks such that every two ofthem walk together exactly once. This amounts to constructing anSTS(15) for which the set of triples can be partitioned into seven
‘parallel classes’.
Jakob Steiner (1796–1863) was an important geometer of his
time. He became interested in what we now call Steiner systems in1853 when he studied the conﬁguration of 28 double tangents of aplane quartic curve.
Sir Ronald A. Fisher (1890–1962) is considered to be one of the
most prominent statisticians. Besides important contributions tostatistics (multivariate analysis) and genetics, he is known for hiswork on the application of statistical theory to agriculture and thedesign of experiments. The applications to the design of agricul-tural experiments account for our usage of vfor the number of
points of a design ( varieties ) andrfor the number of blocks through
ap o i n t( replication number ).
Theorem 19.7 is due to M. P. Schutzenberger (1949).
R. A. Fisher was not the only statistician to contribute to the
mathematical theory of designs. In fact, we should probably con-
sider the Indian mathematician R. C. Bose (1901–1987) to be themost important one. Many of the construction methods describedin this chapter (such as the method of diﬀerences) are due to him.
G. Fano (1871–1952), whose name has become attached to the
planePG
2(2), was important in the Italian school of projective
geometry.
Projective planes over ﬁnite ﬁelds were ﬁrst studied by K. G. C.
von Staudt (1798–1867) in his book Geometrie der Lage (1856).
The ﬁrst example of a nonembeddable quasiresidual design was
given by Bhattacharya (1944). It was also a 2-(16,6,3) design. How-ever, Example 19.9 is a much simpler example.
J. L. Lagrange (1736–1813) was born and educated in Italy but
---PAGE BREAK---
19. Designs 241
he is considered a French mathematician (who studied in Berlin).
Besides many important contributions to analysis, he is known forseveral theorems in number theory.
The Bruck–Ryser–Chowla theorem, Theorem 19.11, is so well
known that it is often referred to as just BRC.
The idea of Example 19.15 is due to Skolem (1958). His method
was actually slightly diﬀerent. It has led to the term Skolem se-
quences. These have other applications, e.g. in radioastronomy.Here is the idea. Partition the set {1,2,..., 2n}into pairs {a
i,bi}
such that bi−ai=i,1≤i≤n. This is a Skolem sequence. For
example, {9,10},{2,4},{5,8},{3,7},{1,6}is such a partition for
n= 5. Now form the triples {0,ai+n,bi+n}and consider these as
base blocks (mod 6n +1). Since all the diﬀerences 1, 2,..., 3nand
their negatives occur exactly once, the blocks form an STS(6n+1).
For an interesting application of the Golay code (see Chapter 20)
to write-once memories, see Cohen et al. (1986). They show the
possibility of three successive writings of 11 bits on 23 positions.
References.
W. O. Alltop (1972), An inﬁnite class of 5-designs, J. Combinatorial
Theory (A)12, 390–395.
K. N. Bhattacharya (1944), A new balanced incomplete block de-
sign,Science and Culture 9, 108.
R. H. Bruck and H. J. Ryser (1949), The non-existence of certain
ﬁnite projective planes, Canad. J. Math. 1, 88–93.
N. G. de Bruijn and P. Erd˝ os (1948), On a combinatorial problem,
Proc. Kon. Ned. Akad. v. Wetensch. 51, 1277–1279.
K. Chandrasekharan (1968), Introduction to Analytic Number The-
ory, Springer-Verlag.
S. Chowla and H. J. Ryser (1950), Combinatorial problems, Canad.
J. Math. 2, 93–99.
G. D. Cohen, P. Godlewski, and F. Merkx (1986), Linear binary
codes for write-once memories, IEEE Trans. Information Theory
32, 697–700.
W. S. Connor, Jr. (1952), On the structure of balanced incomplete
block designs, Ann. Math. Stat. bf 23, 57–71; correction ibid.24,
135.
---PAGE BREAK---
242 A Course in Combinatorics
R. H. F. Denniston (1976), Some new 5-designs, Bull. London Math.
Soc.8, 263–267.
G. Fano (1892), Giornale di Matimatiche 30, 114–124.
M. J. Granell and T. S. Griggs (1994), A Steiner system S(5,6,108),
Discrete Mathematics 125, 183–186.
D. Jungnickel and S. A. Vanstone (1987), Hyperfactorizations of
graphs and 5-designs, J. Univ. Kuwait (Sci) 14, 213–223.
T. P. Kirkman (1847), On a problem in combinations, Cambridge
and Dublin Math. J. 2, 191–204.
D. L. Kreher and S. P. Radziszowski (1986), The existence of simple
6-(14,7,4) designs, J. Combinatorial Theory (A)41, 237–243.
C. W. Lam, S. Swiercz, and L. Thiel (1989), The nonexistence of
ﬁnite projective planes of order 10, Canad. J. Math. 41, 1117–
1123.
D. W. Leavitt and S. S. Magliveras (1982), Simple 6-(33,8,36)-
designs from PΓL2(32), pp. 337–352, in: Computational Group
Theory, Proc. Durham 1982 .
W. H. Mills (1978), A new 5-design, Ars Combinatoria 6, 193–195.
A. Ya. Petrenjuk (1968), On Fisher’s inequality for tactical conﬁg-
urations (in Russian), Mat. Zametki 4, 417–425.
D. K. Ray-Chaudhuri and R. M. Wilson (1975), On t-designs, Os-
aka J. Math. 12, 737–744.
H. J. Ryser (1963), Combinatorial Mathematics , Carus Math.
Monograph 14.
M. P. Schutzenberger (1949), A non-existence theorem for an in-
ﬁnite family of symmetrical block designs, Ann. Eugenics 14,
286–287.
Th. Skolem (1958), Some remarks on the triple systems of Steiner,
Math. Scand. 6, 273–280.
J. Steiner (1853), Combinatorische Aufgabe, J. f. d. reine u. angew.
Mathematik 45, 181–182.
L. Teirlinck (1987), Nontrivial t-designs without repeated blocks
exist for all t,Discrete Math. 65, 301–311.
J. Tits (1964), Sur les syst` emes de Steiner associ´ es aux trois ‘grands’
groupes de Mathieu, Rend. Math. e Appl. (5)23, 166–184.
E. Witt (1938), Die 5-fach transitiven Gruppen von Mathieu, Abh.
Math. Sem. Univ. Hamburg 12, 256–264.
---PAGE BREAK---
19. Designs 243
W. S. B. Woolhouse (1844), Prize question 1733, Lady’s and Gen-
tleman’s Diary .
---PAGE BREAK---
20
Codes and designs
We introduce some more terminology from the theory of error-
correcting codes. In the most general sense, a code of length n
is simply a subset C⊆Sn, whereSis a ﬁnite set (the alphabet).
Elements of Care called codewords.A binary code is one with
alphabetS={0,1};aternary code is one with S={0,1,2}.
Thedistanced(x,y) between two words (vectors) xandyinSnis
deﬁned to be the number of positions in which they diﬀer, i.e.
(20.1) d(x,y): =|{i :1≤i≤n, xiLnegationslash=yi}|.
This is indeed a distance function in the usual sense; check that it
satisﬁes the triangle inequality.
The concept of distance has led to the usage of geometric termi-
nology, e.g. the set Br(x): ={y∈Fn
q:d(x,y)≤r}is called the
sphere with radius rand center x, though actually the name ‘ball’
would be better.
Theminimum distance dof the code Cis
(20.2) d:= min{d(x,y):x∈C,y∈C,xLnegationslash=y}.
Much of coding theory is concerned with linear codes. By a q-
ary [n,k ] code, we mean a linear subspace Cof dimension kof the
vector space Fn
q.
Theweightw(x)o fxis deﬁned by
(20.3) w(x): =d(x, 0).
This can be deﬁned whenever 0 is one of the symbols (elements ofthe alphabet), but is especially meaningful for linear codes. When
---PAGE BREAK---
20. Codes and designs 245
Cis linear, the distance between codewords xandyis equal to the
weight of x−y, which is another codeword, and so the minimum
distance of Cis equal to the minimum weight , i.e. the minimum of
the weights of nonzero codewords. We use the notation [ n,k,d]c o d e
for an [n,k] code with minimum distance at least d.I fd=2e+1 ,
thenCis called an e-error-correcting code.
Thecovering radius ρ(C) of the code Cis deﬁned to be the
minimalRsuch that the spheres with radius Rand codewords as
centers cover Sn, i.e.
(20.4) ρ(C): =m a x{min{d(x, c):c∈C}:x∈Sn}.
In Chapter 18, we mentioned the repetition code in {0,1}n, i.e. the
1-dimensional subspace of Fn
2containing only 0and1.I fn=2e+1
then every word has distance ≤eto exactly one codeword. So this
code has covering radius e. The two spheres of radius earound the
two codewords are disjoint and they cover the space.
In general, we call a not necessarily linear code C⊆Snan (e-
error-correcting) perfect code when|C|>1 and when every x∈
Snhas distance ≤etoexactly one codeword. This is equivalent
toChaving minimum distance d=2e+ 1 and covering radius
e. Clearly, perfect codes are combinatorially interesting objects.
However, they are extremely rare.
Theorem 20.1. IfCi sac o d ei nSnwith distance d≥2e+1,
then
(20.5) |C|·e/summationdisplay
i=0/parenleftbiggn
i/parenrightbigg
(q−1)i≤qn.
Proof: The sum on the left-hand side of (20.5) counts the number
of words in a sphere of radius e. /square
The bound given in this theorem is known as the sphere packing
bound or as the Hamming bound. If equality holds, then the code
is perfect.
Problem 20A. Show that if a [23, 12,7] binary code exists, then
this code is perfect.
---PAGE BREAK---
246 A Course in Combinatorics
Problem 20B. By (20.5), a binary code of length 6 and minimum
distance 3 has at most 9 codewords. Show that equality cannot
hold. (However, 8 is possible.)
Two codes are called equivalent if one is obtained from the other
by some permutation of the coordinate positions in Sn. Sometimes
this deﬁnition is extended by also allowing a permutation of theelements of Ssuch as interchanging +1 and −1 whenS=F
3.
Ak×nmatrixGis called a generator matrix of the [n,k]c o d eC
ifCis spanned by the rows of G. Elementary linear algebra shows
thatCis equivalent to a code with a generator matrix G=(IkP),
wherePis somek×n−kmatrix. This is called the reduced echelon
form for a generator.
ThedualC⊥ofCis deﬁned by
(20.6) C⊥:={x∈Fn
q:∀c∈CLangbracketleftx,cLangbracketright=0}.
IfHis a generator matrix for C⊥, then clearly
(20.7) C={x∈Fn
q:xHLlatticetop=0}.
His called a parity check matrix for the code C.I fG=(IkP)i sa
generator matrix, then H=(−PLlatticetopIn−k) is a parity check matrix.
IfC=C⊥, thenCis called a self-dual code .I fC⊆C⊥, thenCis
calledself-orthogonal .
IfCis a linear code in Fn
q, then the extended code Cis deﬁned
by(20.8)
C:={(c1,...,cn,cn+1):(c1,...,cn)∈C, c 1+···+cn+1=0}.
The symbol cn+1is called the parity check symbol .
Example 20.1. Letn=(qk−1)/(q−1). Consider a matrix
Hof sizek×n, with entries in Fq, for which the columns are
pairwise linearly independent. Note that this is the maximal valueofnfor which this is possible. Then His clearly the parity check
matrix of an [ n,n−k] code with minimum distance 3. Such a
code is called a q-aryHamming code.I f cis a codeword, then
---PAGE BREAK---
20. Codes and designs 247
|B1(c)|=1+n(q−1) =qk. Since|C|=qn−k, we see that this code
is perfect (by (20.5)).
Problem 20C. LetHbe the ternary [4,2] Hamming code. Deﬁne
a (nonlinear) ternary code Cof length 9 with codewords
(x0,x1,...,x 4;y1,...,y 4)
by requiring that/summationtext4
i=0xiLnegationslash= 0 and that ( y1−x1,...,y 4−x4)i sa
codeword in H. Show that Chas covering radius 1. (No ternary
code of length 9 with covering radius 1 and fewer than 2 ·36code-
words is known.)
Example 20.2. Consider the binary Hamming code Cof length
n=2k−1. By deﬁnition, the dual code C⊥has as generator matrix
thek×nmatrix that has all possible nonzero vectors of length k
as columns. Therefore, the extension of C⊥is the code RLprime(1,k)o f
Chapter 18. C⊥is usually called the simplexcode of lengthn.W e
remark that the [8,4] extended binary Hamming code is self-dual.Problem 20D. Show that the covering radius of the code R(1,2k)
is 2
2k−1−2k−1. (Hint: use the ±1 representation instead of (0,1)
and work over Qto show that the covering radius is at most this
large. Consider the word zthat is the characteristic function of
{x∈F2k
2:x1x2+···+x2k−1x2k=1}
to show equality.)
We mention one easily proved bound for arbitrary codes, known
as theSingleton bound.
Theorem 20.2. LetCbe any code of length nand minimum
distancedoverFq. Then
|C|≤qn−d+1.
Proof: From each codeword, we delete the last d−1 symbols.
The set of ‘shortened’ words consists of words that are pairwise
diﬀerent! There can be no more than qn−d+1of them. /square
---PAGE BREAK---
248 A Course in Combinatorics
Example 20.3. We give an example that shows a nice connection
with Chapter 19. Let q=2a. LetSbe a hyperoval in PG2(q).
Using the terminology of Example 19.7, the elements of Sare vec-
tors in F3
qwith the property that no three of them are linearly
dependent. We take the elements of Sas the columns of a 3 by
q+ 2 matrix H. If we interpret Has the parity check matrix of
a[q+2,q−1] code over Fq, then this code has minimum distance
at least 4. So by Theorem 20.2, the distance is equal to 4. This
is one of the rare examples of equality in Theorem 20.2. Codes forwhich equality holds in the Singleton bound are called maximum
distance separable codes (MDS codes), another unfortunate name!
There are many open problems concerning these codes.
IfCis aq-ary [n,k ] code, and if A
idenotes the number of code-
words inCwith weight i, then
(20.9) A(z): =n/summationdisplay
i=0Aizi
is called the weight enumerator ofC. Of course, A0= 1 andA(1) =
|C|=qk.
Problem 20E. SupposeCis a binary code, not necessarily linear,
with length 23, minimum distance 7, and |C|=212. Assume 0∈C.
First show that Cis a perfect code. Let the weight enumerator of
Cbe given by (20.9). Count pairs ( x,c) withc∈C,w(x)=4 ,a n d
d(x,c) = 3, and show that A7= 253. Then show that the weight
enumerator of Cis in fact completely determined by the fact that
Cis a perfect code and 0∈C.
The following theorem is one of the most useful in the theory of
error-correcting codes. It is due to F. J. MacWilliams (1963).
Theorem 20.3. LetCbean [n,k]code over Fqwith weight enu-
meratorA(z)and letB(z)be the weight enumerator of C⊥. Then
(20.10) B(z)=q−k( 1+(q−1)z)nA/parenleftbigg1−z
1+(q−1)z/parenrightbigg
.
Proof: We only give the proof for the case q= 2. For other
values ofq, the proof is essentially the same (instead of ( −1)Langbracketleftu,vLangbracketright
used below, one must use χ(Langbracketleftu,vLangbracketright), whereχis a character on Fq).
---PAGE BREAK---
20. Codes and designs 249
Deﬁne
g(u): =/summationdisplay
v∈Fn
2(−1)Langbracketleftu,vLangbracketrightzw(v).
Then
/summationdisplay
u∈Cg(u)=/summationdisplay
u∈C/summationdisplay
v∈Fn
2(−1)Langbracketleftu,vLangbracketrightzw(v)=/summationdisplay
v∈Fn
2zw(v)/summationdisplay
u∈C(−1)Langbracketleftu,vLangbracketright.
Here, ifv∈C⊥, the inner sum is |C|.I fv/∈C⊥, then half of the
terms in the inner sum have value +1, the other half −1. Therefore
(20.11)/summationdisplay
u∈Cg(u)=|C|·B(z).
Now
g(u)=/summationdisplay
(v1,v2,...,vn)∈Fn
2n/productdisplay
i=1((−1)uivizvi)
=n/productdisplay
i=1( 1+(−1)uiz)
=( 1−z)w(u)(1 +z)n−w(u).
The result follows by substituting this in (20.11). /square
Corollary. If we write B(z)=/summationtextn
j=0Bjzj, then for q=2, we ﬁnd
from (20.10):
(20.12) Bj=2−kn/summationdisplay
i=0Aij/summationdisplay
l=0(−1)l/parenleftbiggi
l/parenrightbigg/parenleftbiggn−i
j−l/parenrightbigg
.
These relations, known as the MacWilliams relations , are linearly
independent equations for the coeﬃcients Ai, given the coeﬃcients
Bj.
Many of the known nontrivial 5-designs were found by the follow-
ing elegant application of MacWilliams’ theorem, usually referred
to as the Assmus–Mattson theorem (1969). Again we restrict the
---PAGE BREAK---
250 A Course in Combinatorics
proof to the binary case. For other q, the theorem has an obvious
generalization with nearly the same proof. We identify the posi-
tions of a code of length nwith the set P:={1,2,...,n}.This
allows us to interpret a codeword in a binary code as a subset ofP(i.e. as the characteristic function of a subset). The support of a
codeword is the set of coordinate positions where the codeword isnot zero.
Problem 20F. LetCbe a perfect binary e-error-correcting code
of lengthn. Assume 0 is a symbol and that 0is a codeword. Show
thatPtogether with the supports of codewords of weight d=2e+1
is anS(e+1,2e+1,n).
Theorem 20.4. LetAbe a binary [n,k,d]code and let B:=A
⊥
be the dual code, an [n,n−k]code. Let t<d. Suppose the
number of nonzero weights in B, that are less than or equal to
n−t,is≤d−t. Thenforeachweight w,thesupportsofthewords
of weightwinAform at-design and the supports of the words of
weightwinBform at-design.
Proof: IfCis any code and a t-subsetTofPhas been ﬁxed, then
we denote by CLprimethe code of length n−tobtained by deleting the
coordinates in Tfrom the codewords in C. We denote by C0the
subcode of CLprimeobtained by deleting the coordinates in Tfrom the
codewords in Cthat have zeros at all positions of T.
The proof is in four steps.
(i) LetTbe a subset of Pof sizet. Sincetis less than the
minimum distance of A, the code ALprimehas as many codewords as A,
i.e. has dimension kalso. In fact, ALprimestill has minimum distance
≥d−t. So the dual ( ALprime)⊥has dimension n−k−t. Clearly, B0is
a subcode of (ALprime)⊥. Since the dimension of B0is at least n−k−t,
we must have B0=(ALprime)⊥.
(ii) Let/summationtextαiziand/summationtextβizibe the weight enumerators for ALprimeand
B0, respectively. We claim that these weight enumerators do not
depend on the particular t-subsetT, but only on the numbers t,n,
k, and the weights of words in B.
Let 0<plscript1<plscript2<···<plscriptr≤n−t, wherer≤d−t, be the nonzero
weights≤n−tfor the code B. These are the only possible weights
---PAGE BREAK---
20. Codes and designs 251
forB0. Then (20.12) gives
|B0|αj=/parenleftbiggn−t
j/parenrightbigg
+r/summationdisplay
i=1βplscriptij/summationdisplay
m=0(−1)m/parenleftbiggplscripti
m/parenrightbigg/parenleftbiggn−t−plscripti
j−m/parenrightbigg
.
By hypothesis, the minimum distance of ALprimeis≥r, so we know the
values ofαjforj<r , namelyα0=1 ,α1=···=αr−1=0 . T h u s
we haverlinear equations in runknowns βplscripti. These unknowns
are uniquely determined if the r×rcoeﬃcient matrix Mthat has
(i,j)-entrypj(plscripti) where
pj(x): =j/summationdisplay
m=0(−1)m/parenleftbiggx
m/parenrightbigg/parenleftbiggn−t−x
j−m/parenrightbigg
,
1≤i≤r,0≤j≤r−1, is nonsingular. But pj(x) is a poly-
nomial in xof exact degree j(the coeﬃcient of xjis (−1)j2j/j!),
so elementary column operations reduce Mto the Vandermonde
matrix 
1plscript1plscript2
1···plscriptr−1
1
1plscript2plscript22···plscriptr−1
2............
1plscript
rplscript2
r···plscriptr−1
r
,
which is nonsingular since the plscripti’s are distinct.
Thus the weight enumerator/summationtextβizidoes not depend on the
choice of the subset T. SinceALprimeis the dual of B0,/summationtextαiziis also
independent of T.
(iii) LetEbe the collection of words of weight winB, interpreted
as subsets of P. The number of members of Ethatmiss all coor-
dinates in Tis the number of words of weight winB0, and this is
independent of T. That is, the complement of (P,E)i sat-design.
By Problem 19C, the sets in Ealso form the blocks of a t-design.
This proves the second assertion of the theorem. (Remark: This
might be criticized if w>n−t. But in this case our argument
when applied to tLprime:=n−wshows that either every w-subset is the
support of a codeword, or no w-subset is the support of a codeword;
so the words of weight w, if any, form a trivial t-design.)
---PAGE BREAK---
252 A Course in Combinatorics
(iv) To prove the ﬁrst assertion of the theorem, we proceed by
induction. We start with w=d. LetDbe the collection of words
of weight dinA. The number of sets in Dthat contain a given
t-subsetTofPis equal to the number of words of weight d−tinALprime,
and as we saw above, this number does not depend on the choice
ofT.S oDis at-design. Let w>dand suppose the assertion is
true for all wLprimewithw≥wLprime>d. Now let Ddenote the collection
of words of weight winA. In this case the number of subsets in
Dthat contain a given t-subsetT, is equal to the number of words
of weight w−tinALprimecorresponding to codewords of weight win
A. By (iii), the total number of words of weight w−tinALprimedoes
not depend on the choice of T. By the induction hypothesis and
(19.6), the number of words of weight w−tinALprimecorresponding to
codewords of weight less than winAdoes not depend either on T.
This proves the assertion. /square
Problem 20G. What is the weight enumerator of the dual of the
binary Hamming code of length 2r−1? Derive an expression for
the weight enumerator of the Hamming code itself.
Example 20.4. LetAbe the extended [8 ,4] binary Hamming
code. We know that A=A⊥. In the notation of Theorem 20.4,
we haved= 4. Take t= 3. The conditions of Theorem 20.4 are
satisﬁed. Hence the words of weight 4 form a 3-design, which is of
course the Hadamard 3-(8,4,1) design corresponding to R(1,3).
Example 20.5. After the next example, we shall treat the famous
binary Golay code and show that the corresponding extended codeG
24is a self-dual [24 ,12,8] code with weights 0, 8,12,16 and 24. So
Theorem 20.4 shows that the words of weight 8 in this code forma 5-design. From Problem 20E, we know that there are 759 blocksand then (19.1) shows that λ= 1. This also follows from the fact
that the code has distance 8, so two blocks have at most four pointsin common. This design is the Witt design S(5,8,24) mentioned
in Chapter 19. The words of other weights also yield 5-designs.
Example 20.6. The following 5-designs, and several others, were
found by V. Pless (1972). Consider the 18 by 18 Paley matrix C
given by (18.5). We consider a ternary [36 ,18] codeSym
36with
generator G=(I18C). Such a code is called a symmetry code .
---PAGE BREAK---
20. Codes and designs 253
SinceCis a Paley matrix, we have GGLlatticetop=O, i.e.Sym 36is a self-
dual code. This implies that all weights in the code are divisible
by 3. We claim that all the words in Sym 36have weight at least
12. Observe that since Cis symmetric, the matrix (−CI 18)i sa
parity check matrix for the code, and, because the code is self-dual,this means that that matrix is also a generator matrix for the code.If (a,b), where aandbare vectors in F
18
3, is a codeword, then
(−b,a) is also a codeword. This shows that if there is a codeword
with weight less than 12, there is such a codeword that is a linearcombination of at most four rows of G. These are easily checked by
hand as follows; the reader should do it as an exercise. The fact thatCis a Paley matrix and the argument used in the proof of Theorem
18.1 (and in Problem 18B) show that a linear combination of 1, 2,o r3r o w so f Ghas weight 18, respectively 12, respectively 12 or 15.
It remains to check combinations of four rows. Now use the factthatQin (18.5) is cyclic, which implies that only a few essentially
diﬀerent combinations have to be examined. One can also extendthe array used in the proof of Theorem 18.1 by one row. Bothmethods involve very little work and produce the result that theminimum weight is 12. (Originally this was done by computer.)
We now use the generalization of Theorem 20.4 to ternary codes.
If one considers the words of some ﬁxed weight in Sym
36(the gen-
eralization holds for weights 12 ,15,18, and 21), and if we replace
each word by the set of positions where the nonzero coordinatesoccur, we ﬁnd 5-designs. Since the codewords cand 2cyield the
same set, we only consider this set as one block.
We now come to the most famous of all binary codes: the binary
Golay code G
23. There are very many constructions of this code,
some of them quite elegant and with short proofs of its properties.We show only one of these constructions related to design theory.
We consider the incidence matrix Nof the (unique) 2-(11,6,3)
design; see Problem 19D. We have NN
Llatticetop=3I+3J. Consider N
as a matrix with entries in F2. ThenNNLlatticetop=I+J.SoNhas rank
10 and the only vector xwithxN=0is1. The design properties
imply trivially that any row has weight 6 and that the sum of tworows ofNhas weight 6. We also know that the sum of three or
four rows of Nis not0.
---PAGE BREAK---
254 A Course in Combinatorics
Next, letGbe the 12 by 24 matrix over F2given byG=(I12P),
where
(20.13) P=
01··· 1
1...N
1
.
Every row of Ghas a weight ≡0 (mod 4). Any two rows of Ghave
inner product 0. This implies that the weight of any linear com-
bination of the rows of Gis≡0 (mod 4); prove this by induction.
The observations made about Nthen show that a linear combina-
tion of any number of rows of Ghas weight at least 8. Consider
the code generated by Gand call it G24. Delete any coordinate to
ﬁnd a binary [23 ,12] code with minimum distance at least 7. By
Problem 20A, this code must have minimum distance equal to 7and, furthermore, it is a perfect code ! We denote it by G
23. These
two notations will be justiﬁed below, where we show that G24, the
extended binary Golay code, is unique, from which the uniquenessofG
23can be shown.
Theorem 20.5. IfCisabinarycodeoflength 24,with|C|=212,
minimum distance 8, and if 0∈C, thenCis equivalent to G24.
Proof: (i) The diﬃcult part of the proof is to show that Cmust
be a linear code. To see this, observe that deleting any coordinateproduces a code C
Lprimeof length 23 and distance 7 with |CLprime|=212.
By Problem 20E, the weight enumerator of this perfect code is de-termined: A
0=A23=1 ,A7=A16=2 5 3 ,A8=A15= 506,
A11=A12= 1288. From the fact that this is the case, no mat-
ter which of the 24 positions is deleted from C, it follows that
all codewords in Chave weight 0, 8,12,16, or 24. Furthermore a
change of origin (i.e. adding a ﬁxed codeword to all the codewords)shows that we can also infer that the distance of any two code-words is 0, 8,12,16, or 24. Since all weights and all distances are
≡0 (mod 4), any two codewords have inner product 0. Therefore
the words of Cspan a code that is self-orthogonal. However, such
a code can have at most 2
12words. Therefore, Citself must be a
linear and self-dual code.
---PAGE BREAK---
20. Codes and designs 255
(ii) We form a generator matrix of Cby taking as ﬁrst row any
word of weight 12. So after a permutation of positions, we have:
G=/parenleftbigg
1...10... 0
AB/parenrightbigg
.
We know that any linear combination of the rows of Bmust have
even weight Lnegationslash=0 ,s oBhas rank 11. Therefore the code generated
byBis the [12, 11,2] even-weight code. We conclude that we may
assume that Bis the matrix I11, bordered by a column of 1’s.
Another permutation of columns yields a generator matrix GLprimeof
the form ( I12P), wherePhas the same form as in (20.13). What
do we know about the matrix N? Clearly any row of Nmust have
weight 6. Furthermore, the sum of any two rows of Nmust have
weight at least 6. By Problem 19D, Nis the incidence matrix of
the unique 2-(11,6,3) design, i.e. Cis equivalent to G24. /square
As we saw in Example 20.5, the words of weight 8 in G24form the
blocks of the Witt design D=S(5,8,24). Denote by {0,1,..., 23}
the point set of Dand consider I={21,22,23}. By the Corollary
to Theorem 19.3, DIis anS(2,5,21), i.e. a projective plane of order
4 (which is also known to be unique). The following problem shows
the beautiful combinatorial structure of the design D.
Problem 20H. LetBbe a block of Dwith|B∩I|=αand deﬁne
B∗:=B\I. We saw that if α= 3, then B∗is a line in PG2(4).
Show that
(i)α= 2 implies that B∗is a hyperoval in PG2(4);
(ii)α= 0 implies that B∗is the symmetric diﬀerence of two lines.
(The ambitious reader may wish to show that if α= 1, then
the seven points of B∗and the lines of PG2(4) containing at least
two such points, form a Fano plane. Such a plane is called a Baer
subplane ofPG2(4).)
By counting the hyperovals, pairs of lines, etc., one can show that
each of the geometric conﬁgurations mentioned above is one of thesetsB
∗. In fact, one of the well known constructions of S(5,8,24)
starts with these objects and produces the design by appendingsuitable subsets of I. If one does not use the automorphism group
ofPG
2(4) in the argument, then this construction is a nontrivial
---PAGE BREAK---
256 A Course in Combinatorics
combinatorial problem. (Again: the ambitious reader should try
it.)
Problem 20I. LetF4={0,1,ω,ω}. LetCbe the [6, 3] code over
F4with codewords (a,b,c,f (1),f (ω),f(ω)), where f(x): =ax2+
bx+c.
(i) Show that Chas minimum weight 4 and no words of weight
5.
(ii) LetGbe the binary code with as codewords all 4 by 6 (0,1)-
matricesAwith rows a0,a1,aω,aωsuch that:
(1) every column of Ahas the same parity as its ﬁrst row a0,
(2)a1+ωaω+ωaω∈C.
Show that Gis a [24, 12,8] code, i.e. G=G24.
Problem 20J. As in Example 20.6, we construct a ternary code
Sym 12by using the Paley matrix Cof order 6. Show that Sym 12
is a [12, 6,6] self-dual code. Puncture the code (i.e. delete some
coordinate) to obtain a [11 ,6,5] ternary code G11. Show that this
code is perfect. It is the ternary Golay code .
We have now given several examples of designs constructed by
using a suitable code. We reverse the procedure and study codes
generated by the (characteristic functions of the) blocks of a design.LetNbe the incidence matrix of a projective plane of order n.W e
consider the subspace CofF
v
2, wherev=n2+n+ 1, generated by
the rows of N.I fnis odd,Cis not very interesting. Namely, if we
take the sum of the rows of Nthat have a 1 in a ﬁxed position, the
result is a row witha0i nthat position and 1’s elsewhere. Thesevectors generate the [ v,v−1,2] even-weight code and this must be
C, sinceCobviously has no words of odd weight. If nis even, the
problem becomes more interesting. We restrict ourselves to n≡2
(mod 4).
Theorem 20.6. Ifn≡2( m o d4 ), the rows of the incidence ma-
trixNof a projective plane of order ngenerate a binary code C
with dimension
1
2(n2+n+2 ).
Proof: (i) Sincenis even, the code Cis self-orthogonal because
every line has an odd number of points and any two lines meet in
one point. Therefore dim C≤1
2(n2+n+ 2).
---PAGE BREAK---
20. Codes and designs 257
(ii) Let dim C=rand letk:=n2+n+1−r= dimC⊥. Let
Hbe a parity check matrix for C. Assume that the coordinate
places have been permuted in such a way that Hhas the form
(IkP). DeﬁneA:=/parenleftBigIkP
OIr/parenrightBig
. Interpret the (0,1)-matrices NandA
as matrices over Q. Then
detNALlatticetop= detN=(n+1 )n1
2(n2+n).
Since all entries in the ﬁrst kcolumns of NALlatticetopare even integers,
detNis apparently divisible by 2k.S o1
2(n2+n)≥k, i.e.r≥
1
2(n2+n+ 2).
The result follows from (i) and (ii). /square
The theorem shows that the code Cgenerated by the rows of N
has the property that Cis self-dual. We shall now show an even
more interesting property of this code, namely that one can recover
the plane from the code.
Theorem 20.7. ThecodeCofTheorem 20.6hasminimumweight
n+1andeverycodewordofminimumweightcorrespondstoaline
in the plane of order n.
Proof: As before, we interpret a codeword as a subset of the
plane. So it will be clear what we mean by saying that a point is
on the codeword c. Letcbe a codeword with w(c)=d. Since nis
even, the codewords corresponding to lines in the plane hav ea1a s
parity check symbol in the extended code C. This code is self-dual
and this implies:
(1) ifdis odd then cmeets every line at least once;
(2) ifdis even then every line through a ﬁxed point of cmeets
cin a second point.
In case (2) we immediately see that d>n + 1. In case (1) we ﬁnd:
(n+1 )d≥n2+n+ 1, i.e.d≥n+1 . I fw(c)=n + 1, then there
is a lineLof the plane that meets cin at least 3 points. If some
point ofLis not a point of c, then every line Lnegationslash=Lthrough that
point must meet cby (1). This would imply that d≥n+3 . S oc
must be the line L. /square
Recall that in a projective plane of even order n,ahyperoval is
a set ofn+ 2 points such that no three are on one line.
---PAGE BREAK---
258 A Course in Combinatorics
Theorem 20.8. The codewords of weight n+2in the code Cof
Theorem 20.6 are precisely all the hyperovals of the plane.
Proof: (i) Letv∈Candw(v)=n + 2. Every line meets v
in an even number of points. Let Lbe a line of the plane and
suppose that vandLhave 2apoints in common. Each of the n
linesLnegationslash=Lthrough one of these 2 apoints meets vat least once
more. Therefore 2a +n≤n+ 2, i.e.a=0o ra=1 .
(ii) LetVbe a hyperoval. Let Sbe the set of/parenleftbign+2
2/parenrightbig
secants of V.
Each point not in Vis on1
2(n+ 2) such lines; each point of Vis
onn+ 1 secants. Since n≡2 (mod 4), the sum of the codewords
corresponding to secants is the characteristic function of V. So this
is a codeword. /square
Theorems like the previous two yielded enough information about
the code corresponding to a projective plane of order 10 to make
possible the computer search that we mentioned earlier. The ﬁrstimportant step was due to F. J. MacWilliams, N. J. A. Sloane,and J. G. Thompson (1973) who showed that this code could haveno words of weight 15. Presently, the only known projective planewith order n≡2 (mod 4) is the Fano plane.
Problem 20K. Find a 4×39 matrix of 0’s, 1’s, and −1’s so that (i)
no column is all zero, and no column is ±1 times another column,
and (ii) each row contains 13 of each of 0 ,1,−1.
Generalize to construct rby
1
2(3r−1)−1 matrices with property
(i) and (ii) (with 13 replaced by an appropriate value).
(The matrix above can be used for the following puzzle. Of 39
coins, one is counterfeit and weighs either more or less than theothers. You have access to a balance with two pans; some coinscan be put in one pan and some in the other, and the balance willtell you which subset has greater total weight. You must determinethe counterfeit coin, and whether it is lighter or heavier, using atotal of four weighings.)
Problem 20L. K¨ orner and Simonyi called a code over an alphabet
ofq>2 symbols triﬀerent if the codewords were not only diﬀerent
but for each triple of codewords there is a position where they have
three diﬀerent entries. Deﬁne F(n,q) to be the maximal number
of codewords in a triﬀerent code of length n. Prove that F(n,q)≥
---PAGE BREAK---
20. Codes and designs 259
6−1/2(q/3)n/2. (Hint: Use Theorem 3.6. Consider a random code
withNcodewords. For each 3-subset Sof{1,2,...,n}letASbe the
event that the three codewords with indices in Sare not all diﬀerent
or not triﬀerent. Show that AShas probability (3 q(q−1)+q)n/q3n,
etc.)
Notes.
We have not been concerned with the error-correcting properties
of codes in this chapter. For a systematic treatment of coding
theory we refer to Van Lint (1999). Much more material on therelation between design theory and coding theory can be found inCameron and Van Lint (1991). The best reference book for codingtheory is MacWilliams and Sloane (1977).
For some of the history of the origin of coding theory, we refer to
Thompson (1983). There is some controversy about priority, but itis clear that both R. W. Hamming and M. J. E. Golay contributedto the ‘discovery’ of this fascinating topic in 1947 and 1948. Themonumental paper by C. E. Shannon (1948) really started thingsgoing. It seems that Hamming was irritated by the fact that hiscomputer kept stopping when it detected an error. He correctlydecided that if it could detect errors, it should be able to locatethem and correct them and then get on with the job! Golay pub-lished the two Golay codes by giving their generator matrices butwithout proof of the properties.
E. F. Assmus (1931–1998) died tragically at a meeting on Codes
and Designs in a place he loved: the Mathematisches Forschungsin-stitut in Oberwolfach. A large part of this chapter is based on hismany contributions to the relations between coding theory and de-sign theory (often written in collaboration with H. F. Mattson).
M. J. E. Golay (1902–1989) was a Swiss physicist who worked in
many diﬀerent ﬁelds. He is known for his work on infrared spec-troscopy and the invention of the capillary column but to mathe-maticians mainly for his discovery of the two Golay codes.
For more about MDS codes, we refer to MacWilliams and Sloane
(1977).
F. J. MacWilliams (1917–1990) made many contributions to cod-
ing theory. Of these, the theorem known by her name is the most
---PAGE BREAK---
260 A Course in Combinatorics
important. Her book with N. J. A. Sloane is the most important ref-
erence book on coding theory. As is the case with many importantcoding theorists, she spent most of her career at Bell Laboratories.
As mentioned earlier, there are many constructions of the Golay
codeG
24. Each of them shows that some group of permutations
is contained in the automorphism group of the code. For example,one of the most common constructions displays an automorphismof order 23. Since the code is unique, its full automorphism groupmust contain all these groups as subgroups. In this way, one canprove that this automorphism group is the famous Mathieu group
M
24. This group is of order 24 ·23·22·21·20·16·3 and acts
5-transitively on the 24 coordinate positions of the codewords.
It has been shown that there are no other perfect e-error-correct-
ing codes with e>2 than the ones mentioned in this chapter. For
more on this subject, see Van Lint (1999). Also see Chapter 30.
References.
E. F. Assmus, Jr. and H. F. Mattson, Jr. (1969), New 5-designs, J.
Combinatorial Theory 6, 122–151.
P. J. Cameron and J. H. van Lint (1991), Designs, Graphs, Codes
and their links, London Math. Soc. Student Texts 22, Cambridge
University Press.
J. H. van Lint (1999), Introduction to Coding Theory , Third edition,
Springer-Verlag.
F. J. MacWilliams (1963), A theorem on the distribution of weights
in a systematic code, Bell Syst. Tech. J. 42, 79–94.
F. J. MacWilliams and N. J. A. Sloane (1977), The Theory of Error-
Correcting Codes , North-Holland.
F. J. MacWilliams, N. J. A. Sloane and J. G. Thompson (1973), On
the existence of a projective plane of order 10, J. Combinatorial
Theory (A)14, 66–78.
V. Pless (1972), Symmetry codes over GF(3) and new 5-designs,
J. Combinatorial Theory (A)12, 119–142.
C. E. Shannon (1948), A mathematical theory of communication,
Bell Syst. Tech. J. 27, 379–423 and 623–656.
T. M. Thompson (1983), From Error-Correcting Codes through
Sphere Packings to Simple Groups , Carus Math. Monograph 21.
---PAGE BREAK---
21
Strongly regular graphs
and partial geometries
Astrongly regular graph srg(v,k,λ,µ ) is a graph with vvertices
that is regular of degree kand that has the following properties:
(1) For any two adjacent vertices x,y, there are exactly λver-
tices adjacent to xand toy.
(2) For any two nonadjacent vertices x,y, there are exactly µ
vertices adjacent to xand toy.
A trivial example is a pentagon, an srg(5,2,0,1). Perhaps the
most famous example is the graph of Fig. 1.4, the Petersen graph,
ansrg(10,3,0,1).
Clearly a graph that is the union of mcomplete graphs Kkis an
srg(km,k−1,k−2,0). Sometimes we shall exclude trivial examples
by requiring that a strongly regular graph and its complement areconnected, i.e. we assume
(21.1) 0 <µ<k<v −1.
(We remark that the fact that µ= 0 implies that the graph is a
union of complete graphs is most easily seen from (21.4) below.) It
is not diﬃcult to see that the complement
Gof ansrg(v,k,λ,µ )G
is an
(21.2) srg(v,v−k−1,v−2k+µ−2,v−2k+λ)
and since the parameters are nonnegative, we ﬁnd a simple condi-
tion on the parameters, namely
(21.3) v−2k+µ−2≥0.
---PAGE BREAK---
262 A Course in Combinatorics
Another relation between the parameters is easily found as follows.
Consider any vertex xand partition the other vertices into the set
Γ(x) of vertices joined to xand the set ∆(x ) of vertices not joined
tox. By the deﬁnition of strongly regular graphs, Γ( x) consists of
kvertices, each of which is joined to λvertices of Γ(x ). Each vertex
in ∆(x) is joined to µvertices in Γ(x ). Counting edges with one
end in Γ(x) and one end in ∆( x) in two ways, we ﬁnd
(21.4) k(k−λ−1) =µ(v−k−1).
Problem 21A. Show that a strongly regular graph is extremal
in the following sense. Let Gbe a graph with vvertices, each of
degree at most k. Suppose that any two adjacent vertices, respec-
tively nonadjacent vertices, have at least λ, respectively µ, common
neighbors. Then
k(k−1−λ)≥µ(v−k−1)
and equality implies that Gis strongly regular.
Before going into the fascinating theory of these graphs, we men-
tion several classes of examples.
Example 21.1. Thetriangular graph T(m),m≥4, has as ver-
tices the 2-element subsets of a set of cardinality m; two distinct
vertices are adjacent if and only if they are not disjoint. T(m)i s
ansrg(/parenleftbigm
2/parenrightbig
,2(m−2),m−2,4). The Petersen graph is T(5) (see
Problem 1A).Example 21.2. Thelattice graph L
2(m),m≥2, has as vertex set
S×S, whereSis a set of cardinality m; two distinct vertices are
adjacent if and only if they have a common coordinate. L2(m)i s
ansrg(m2,2(m−1),m−2,2).L2(2) is a quadrangle which is a
trivial example because its complement is not connected.Example 21.3. Letqbe a prime power with q≡1 (mod 4). The
Paley graph P(q) has the elements of F
qas vertices; two vertices
are adjacent if and only if their diﬀerence is a nonzero square in
Fq. That this is an srg(q,1
2(q−1),1
4(q−5),1
4(q−1)) is a direct
---PAGE BREAK---
21. Strongly regular graphs and partial geometries 263
consequence of (18.4), but it is easier to show this using the matrix
Qof (18.5) as we shall see below. Note that P(5) is the pentagon.
Example 21.4. The Clebsch graph has as vertices all subsets of
even cardinality of the set {1,..., 5}; two vertices are joined if and
only if their symmetric diﬀerence has cardinality 4. This is ansrg(16,5,0,2). One can also describe the vertices as the words of
even weight in F
5
2, with an edge if the distance is 4. For any vertex
x, the induced subgraph on ∆( x) is the Petersen graph. See Fig.
21.1 below.
Figure 21.1
Let us deﬁne the adjacency matrix Aof a graph Gwithvvertices
1,...,v to be thev×v(0,1)-matrix with aij=aji= 1 if and only
if the vertices iandjare joined. Clearly Ais symmetric with
zeros on the diagonal. The statement that Gis ansrg(v,k,λ,µ )i s
equivalent to
(21.5) AJ=kJ, A2+(µ−λ)A+(µ−k)I=µJ.
IfQis the matrix occurring in (18.5), then by (18.4) we have Q2=
qI−J, and the adjacency matrix of the graph P(q) deﬁned in
Example 21.3 is A=1
2(Q+J−I). SoAsatisﬁes (21.5) with
k=1
2(q−1),λ=1
4(q−5),µ=1
4(q−1).
We have already seen one connection between strongly regular
graphs and topics treated in earlier chapters. Several more will
---PAGE BREAK---
264 A Course in Combinatorics
follow. The theory of strongly regular graphs shows a completely
diﬀerent aspect of graph theory from what we studied in Chapters1–4 and 8. We now rely heavily on algebraic methods. Nevertheless,
we also wish to show some nice counting arguments that are usedin this theory.
We deﬁne the Bose–Mesner algebra Aof ansrg G to be the 3-
dimensional algebra Aof linear combinations of I,J, andA. That
this is indeed an algebra is a consequence of (21.5). This algebraconsists of symmetric commuting matrices and therefore there isan orthogonal matrix that simultaneously diagonalizes them. Thiscan also be seen in an elementary way from (21.5). In fact, we shallsee in the next theorem that Ahas three distinct eigenspaces in R
v
and each of them is an eigenspace for any element of A.
Theorem 21.1. If there is an srg(v,k,λ,µ ), then the numbers
f:=1
2/braceleftBigg
v−1+(v−1)(µ−λ)−2k/radicalbig
(µ−λ)2+4 (k−µ)/bracerightBigg
and
g:=1
2/braceleftBigg
v−1−(v−1)(µ−λ)−2k/radicalbig
(µ−λ)2+4 (k−µ)/bracerightBigg
are nonnegative integers.
Proof: LetAbe the adjacency matrix of the graph. By (21.5)
the all-one vector j:= (1,1,..., 1)Llatticetopis an eigenvector of A, with
eigenvalue k, and of course it is also an eigenvector of Iand of
J. Application of (21.5) yields a second proof of (21.4). The mul-
tiplicity of this eigenvalue is one because the graph is connected.
Any other eigenvector, say with eigenvalue x, is orthogonal to jand
therefore we ﬁnd from (21.5),
x2+(µ−λ)x+(µ−k)=0.
This equation has two solutions
(21.6) r,s=1
2/braceleftBig
λ−µ±/radicalbig
(λ−µ)2+4 (k−µ)/bracerightBig
---PAGE BREAK---
21. Strongly regular graphs and partial geometries 265
Letfandgbe the multiplicities of randsas eigenvalues of A.
Then we have
1+f +g=vandtr(A)=k +fr+gs=0.
If we solve these two linear equations, we ﬁnd the assertion of the
theorem. /square
Note that the multiplicities can also be expressed as
(21.7) f=−k(s+ 1)(k−s)
(k+rs)(r−s)andg=k(r+ 1)(k−r)
(k+rs)(r−s).
From (21.6) we can draw a further (surprising) conclusion. If
fLnegationslash=g, then the square root in the denominator of the expressions
forfand forgmust be an integer, i.e. ( µ−λ)2+4 (k−µ)i sa
perfect square. It then follows from (21.6) that the eigenvalues r
andsareintegers !
The other case, i.e. when f=g, is usually called the half-case .
We then have an srg(4µ+1,2µ,µ−1,µ). The Paley graphs are
examples of the half-case. In his paper on conference telephony,mentioned in Chapter 18, Belevitch observed that a necessary con-dition for the existence of a conference matrix of order nis that
n−1 is the sum of two squares. See Problem 19M. We note that
the parameters v=2 1 ,k=1 0 ,λ=4 ,µ= 5 satisfy all the neces-
sary conditions for the existence of a strongly regular graph that westated above, but the graph does not exist because, using (18.5), itwould imply the existence of a conference matrix of order 22 andsince 21 is not the sum of two squares, this is impossible.
The condition of Theorem 21.1 is known as the integrality con-
dition. We shall call a parameter set (v,k,λ,µ ) that satisﬁes these
conditions and the earlier necessary conditions, a feasible set.
Problem 21B. Show that if an srg(k
2+1,k,0,1) exists, then
k=1,2,3,7 or 57. (See the notes to Chapter 4.)
We have seen that the adjacency matrix of an srg(v,k,λ,µ ) has
three eigenvalues, one of which is k. There is a partial converse:
IfGis a connected regular graph of degree kwith an adjacency
matrixAwith exactly three distinct eigenvalues, then Gis strongly
regular. This is Problem 31F of Chapter 31.
---PAGE BREAK---
266 A Course in Combinatorics
To obtain some more examples of strongly regular graphs, we
consider another connection with an earlier topic, namely designs.
This idea is due to J.-M. Goethals and J. J. Seidel (1970). A 2-design is called quasisymmetric if the cardinality of the intersection
of two distinct blocks takes only two distinct values, say x>y .W e
introduce a graph, called the block graph of the design; the vertices
are the blocks of the design and two vertices are adjacent if andonly if their intersection has cardinality y.
Theorem 21.2. The block graph of a quasisymmetric design is
strongly regular.
Proof: LetNbe thev×bincidence matrix of the design and
Athe adjacency matrix of its block graph G. We have (using the
parameters v,k,b,r,λof the 2-design):
NN
Llatticetop=(r−λ)I+λJ,
NLlatticetopN=kI+yA+x(J−I−A).
(The ﬁrst equation is (19.7), the second is the deﬁnition of A.)
We know that both NNLlatticetopandNLlatticetopNhave all-one eigenvectors j(of
diﬀerent lengths!) with eigenvalue kr. Also, we know that NNLlatticetop
has only the eigenvalue r−λonj⊥, with multiplicity v−1. Therefore
NLlatticetopNhas this same eigenvalue, with the same multiplicity, and the
eigenvalue 0 with multiplicity b−v. SincexLnegationslash=y,Ais a linear
combination of I,J, andNLlatticetopN. Therefore Ahas eigenvector jand
only two eigenvalues on the space j⊥. They are (r −λ+k+x)/(y−x)
with multiplicity v−1 and (x−k)/(y−x) with multiplicity b−v.
By our observation above, Gis strongly regular. /square
Now that we know that Gis strongly regular, it is easy to calcu-
late the parameters. We do not give the distasteful formulae.
Example 21.5. Consider the S(5,8,24) of Chapter 20. We ﬁx
two points and consider the residual design with respect to these
two points. This is a 3-(22,6,1). From Problem 20F we know thatthe 21 blocks of this design that contain a given point are the linesofPG
2(4) (i.e. after the point is removed) and the 56 blocks that
do not contain that point are hyperovals in this plane. They form a2-(21,6,4) design. From the properties of S(5,8,24) it follows that
---PAGE BREAK---
21. Strongly regular graphs and partial geometries 267
any two of these hyperovals meet in 0 or in 2 points. Therefore,
this derived design is a quasisymmetric design. From Theorem 21.2it follows that the block graph of the design is a (56 ,k,λ,µ ). Here,
k= 10 because there are 45 = (4 −1)·/parenleftbig
6
2/parenrightbig
hyperovals that meet
a given hyperoval in 2 points. From the design properties or from
the conditions on strongly regular graphs, one then easily ﬁnds thatλ=0 ,µ= 2. The graph constructed in this example is known as
theGewirtz graph. Note that if Ais the adjacency matrix of the
Gewirtz graph, then by (21.5) we have (I +A)
2=9I+2J, and
that means that N:=I+Ais the incidence matrix of a 2-(56,11,2)
design (a so-called biplane). So in this case, we also ﬁnd a new
design from the strongly regular graph.
Problem 21C. LetD:= (P,B,I) be the 3-(22,6,1) design men-
tioned above; it is unique. We form a graph with as vertex set
P ∪B ∪{∞} . The vertex ∞is joined to every element of P.A n
element of Pis joined to an element of Bif they are incident. Fi-
nally, two elements of Bare joined if and only if the blocks are
disjoint. Show that this deﬁnes an srg(100, 22,0,6). This graph is
called the Higman-Sims graph .
If at this point we were to make a list of feasible parameter sets
for strongly regular graphs, then the list would contain many setsthat do not correspond to such a graph. We shall prove a few of thetheorems that exclude these sets. Again, the methods are algebraic.As preparation, the reader should try to do the following problemusing purely combinatorial arguments.
Problem 21D. Show that an srg(28,9,0,4) does not exist.
That this graph does not exist is a consequence of the next the-
orem, known as the Krein condition.
Theorem 21.3. LetGbeastronglyregulargraphwithadjacency
matrixA, having eigenvalues k,r, ands. Then
(r+ 1)(k +r+2rs)≤(k+r)(s+1 )
2,
and
(s+ 1)(k +s+2sr)≤(k+s)(r+1 )2.
---PAGE BREAK---
268 A Course in Combinatorics
Proof: LetB:=J−I−A.We know that the matrices of Ahave
three common eigenspaces of dimension 1, f, andg, respectively.
Call these spaces V0,V1, andV2. HereV0is the space spanned by
j, andV1andV2correspond to the eigenvalues randsofA.F o r
i=0,1,2 letEibe the matrix of the projection onto Vi, i.e.Ei
has eigenvalue 1 on Viand 0 on the other two eigenspaces. These
matrices are what is called a basis of minimal idempotents ofA.
We now consider the same set A, but as multiplication we take the
Hadamard product (see Problem 21E). It is obvious that any two
ofI,A, andBhave product O. Any (0,1)-matrix is idempotent for
Hadamard multiplication. So we conclude that Ais closed under
Hadamard multiplication and that the matrices I,A, andBare a
basis of minimal idempotents.
Note that the deﬁnition of Ei(i=0,1,2) implies that
I=E0+E1+E2,A =kE0+rE1+sE2,
and
B=(v−k−1)E 0+(−r−1)E 1+(−s−1)E 2.
From this, we can express the EiinI,A, andB.
Consider the behavior of the matrices Eiunder the Hadamard
product. Since they form a basis of A,w eh a v e
Ei◦Ej=2/summationdisplay
k=0qk
ijEk,
whereqk
ijis the eigenvalue of Ei◦EjonVk. It is a tedious cal-
culation, but the numbers qk
ijcan be expressed in terms of the
parameters of Gusing the relations given above.
At this point we need the result of Problem 21E. The Hadamard
productEi◦Ejis a principal submatrix of the Kronecker product
Ei⊗Ej. This matrix is idempotent, hence its eigenvalues are 0 and
1. By the theorem alluded to in Problem 21E, the eigenvalues qk
ij
have to be between 0 and 1. It turns out (after one has done all thecalculations) that all except two of the inequalities that one ﬁndsin this way are satisﬁed. These two are q
1
11≥0 andq2
22≥0. These
are the two equations of the assertion. /square
---PAGE BREAK---
21. Strongly regular graphs and partial geometries 269
Problem 21E. LetAandBbe two symmetric n×nmatrices
with eigenvalues λ1,...,λn, respectively µ1,...,µn. Determine the
eigenvalues of A⊗B. We deﬁne the Hadamard product A◦Bof
AandBto be the matrix with entries aijbij. Show that A◦Bis
a principal submatrix of A⊗B. What can you conclude about the
eigenvalues of A◦B?
To appreciate the next theorem, the reader should ﬁrst convince
himself that the parameter set (50,21,4,12) is feasible and that it
satisﬁes the Krein conditions. What should one count to showthat the set nevertheless does not correspond to a strongly regulargraph?
Theorem 21.4. Letk,r,sbe the eigenvalues of the adjacency
matrixAof ansrg(v,k,λ,µ )and let the multiplicities be 1,fand
g. Then
v≤1
2f(f+3 )andv≤1
2g(g+3 ).
Proof: LetBbeJ−I−Aand let the matrices Ei(i=0,1,2)
be as in the proof of the previous theorem. Let
E1=αI+βA+γB.
SinceE1is symmetric, there is an orthogonal matrix ( H1K1) such
that
E1=(H1K1)/parenleftbigg
IO
OO/parenrightbigg/parenleftbigg
HLlatticetop
1
KLlatticetop
1/parenrightbigg
=H1HLlatticetop
1.
HereH1is anv×fmatrix with HLlatticetop
1H1=I. We consider the rows
ofH1asvvectors in Rf. It follows that each of these vectors has
lengthα1
2and any two distinct vectors from this set (call it S)h a v e
inner product βorγ. Such a set is called a spherical 2-distance set
because we can interpret Sas a set of points on a sphere with only
two distinct (angular) distances. We must show that the cardinality
ofSis at most1
2f(f+ 3).
We normalize and obtain a set SLprimeofvvectors on the unit sphere
Ωi nRfwith only two inner products, say bandc. For every v∈SLprime
we deﬁne a function fv:Ω→ Rby
fv(x): =(Langbracketleftv,xLangbracketright−b)(Langbracketleftv ,xLangbracketright−c)
(1−b)(1−c).
---PAGE BREAK---
270 A Course in Combinatorics
These functions are polynomials of degree 2 in the coordinates of
x.I fv∈S,w∈S,vLnegationslash=w, thenfv(v)=1a n d fv(w)=0 .
Therefore these functions are linearly independent. The spaces ofhomogeneous linear and quadratic forms on Ω have dimensions f
and
1
2f(f+ 1) respectively; since x2
1+···+x2
f= 1 on Ω, we can
express constants in forms of degree 2 and 1. From the linear
independence of the functions fv, it follows that there can be at
mostf+1
2f(f+1 )=1
2f(f+ 3) of them. /square
This theorem is known as the absolute bound. It was shown by
A. Neumaier (1980) that the absolute bound can be improved to
v≤1
2f(f+ 1) unless q1
11=0
(and similarly for the other inequality).
Before turning to the relation between strongly regular graphs
and certain incidence structures, we show that nice counting argu-ments also play a role in this area.
Theorem 21.5. LetGbe a strongly regular graph with the same
parameters as T(n), i.e.G=srg(/parenleftbig
n
2/parenrightbig
,2(n−2),n−2,4).I fn>8,
thenGis isomorphic to T(n).
Proof: Fix a vertex xand denote by Γ the induced subgraph on
Γ(x). This is a regular graph on 2( n−2) vertices, with degree
n−2. Letyandzbe nonadjacent vertices of Γ and let there be m
vertices in Γ adjacent to both. Since µ= 4 andxis adjacent to y
andz,w eh a v em≤3. In the graph Γ, there are n−2−mvertices
adjacent to ybut not to z, and the same number adjacent only to
z. Hence there are m−2 vertices adjacent to neither of them. So
m≥2. Suppose m= 3. Consider the unique vertex wadjacent
to neither ynorz. Every vertex adjacent to win Γ is adjacent to
yor toz, which implies that n−2≤3 + 3 = 6, a contradiction.
Hencem= 2, and we also see that there are no triangles in the
complement Γ.
We now show that Γ is bipartite. On the contrary, assume there
is a circuit of odd length in this graph. Choose such a circuit
C=(x0,x1,...,xk=x0) withkminimal. From the argument
above we know that kLnegationslash= 3. In the graph Γ, the vertices x0andx1
---PAGE BREAK---
21. Strongly regular graphs and partial geometries 271
are nonadjacent and are both adjacent to x3,x4,...,xk−2. By the
argument above, k≤6 and since kis odd,k= 5. The vertex x0
has degree n−3i nΓ, i.e. it is adjacent to n−5 vertices, besides
x1andx4. These must be nonadjacent in Γ to both x1andx4.
A similar assertion can be made for x2, yielding n−5 vertices
outsideCnonadjacent in Γ to both x1andx3. There are exactly
n−4 vertices outside Cnonadjacent to x1; hence at least n−6
vertices nonadjacent in Γ to both x3andx4. The result of the ﬁrst
paragraph implies that n−6≤1, a contradiction.
The result of the second paragraph means that Γ contains two
disjoint cliques (sets of vertices, any two of which are adjacent) of
sizen−2. Sincexwas arbitrary, we have shown that any vertex
inGlies in two cliques of size n−1 (cliques of this size will be
calledgrand cliques ). The same argument shows that any edge
is in one of these grand cliques. The number of grand cliques is
2/parenleftbign
2/parenrightbig
/(n−1) =n. Since any two grand cliques have at most one
vertex in common, they must have exactly one vertex in common.If we consider grand cliques as ‘points’ and vertices as ‘blocks’, thenwe have just shown that these points and blocks form a 2-( n,2,1)
design, i.e. the trivial design of all pairs from an n-set.Gis the
block graph of this design, i.e. Gis indeed isomorphic to T(n)./square
We remark that the theorem can also be proved, by case analysis,
forn<8 and that for n= 8 there are three other graphs with the
parameters of T(8), known as the Chang graphs.
Problem 21F. LetGbe a strongly regular graph with the same
parameters as L
2(n), i.e.G=srg(n2,2(n−1),n−2,2). Prove that
ifn>4, then Gis isomorphic to L2(n).
R. C. Bose (1963) studied large cliques in more general strongly
regular graphs. This led him to the concept of a partial geometry .
A partial geometry pg(K,R,T ) is an incidence structure of points
and lines with the following properties:
(1) every line has Kpoints and every point is on Rlines;
(2) any two points are incident with at most one line;(3) if point pis not on line L, then there are exactly Tlines
throughpthat meet L.
---PAGE BREAK---
272 A Course in Combinatorics
If two points xandyare on a line, we say that they are collinear
and write x∼y.
Problem 21G. Determine the number of points and lines of a
partial geometry pg(K,R,T ).
By interchanging the roles of points and lines in a pg(K,R,T ),
we ﬁnd the so-called dualpartial geometry, a pg(R,K,T ).
We introduce the point graph of a partial geometry as the graph
with the points of the geometry as vertices, and an edge {x,y}if
and only if x∼y.
Problem 21H. Show that the point graph of a pg(K,R,T )i sa
(possibly trivial) srg(v,k,λ,µ ), with:
v=K/parenleftbigg
1+(K−1)(R−1)
T/parenrightbigg
,k =R(K−1),
λ=(K−2 )+(R−1)(T−1),µ =RT,
r=K−1−T,s =−R.
If a strongly regular graph has parameters such that it could be
the point graph of some partial geometry, then the graph is called
pseudo-geometric , and it is called geometric if it is indeed the point
graph of a partial geometry. The idea of introducing grand cliquesand then showing that the grand cliques and the points form adesign, as used above, was used by Bose to prove the followingtheorem.
Theorem 21.6. If a strongly regular graph is pseudo-geometric,
correspondingto pg(K,R,T ),andif 2K>R (R−1)+T(R+1)(R
2−
2R+2 ), then the graph is geometric.
We do not give a proof here. The ideas of this proof were ex-
tended by A. Neumaier (1979), and, after an improvement by A.
E. Brouwer, his result obtained the following form (known as theclaw bound).
---PAGE BREAK---
21. Strongly regular graphs and partial geometries 273
Theorem 21.7. If, for a strongly regular graph with the usual
parameters, µLnegationslash=s2andµLnegationslash=s(s+1),then 2(r+1)≤s(s+1)(µ +1).
The idea of the proof is to show that if ris large, then the graph
is the point graph of a partial geometry; this is done by counting
arguments. Then the absolute bound and Krein conditions areapplied to the point graph of the dual partial geometry. Theseshow the inequality stating that rcannot be too large.
The parameters (2058, 242,91,20) are feasible and satisfy all the
other necessary conditions stated in this chapter, except the clawbound. So a graph with these parameters does not exist.
Problem 21I. Consider an srg(v,k,λ, 1). Show that the induced
subgraph on Γ( x)i saunion of cliques. Count the number of ( λ+2)-
cliques in the graph. Thus show that both k/(λ+ 1) andvk/{(λ+
1)(λ+2 )}are integers. Apply to the set (209,16,3,1).
The partial geometries can be divided into four classes:
(1) A partial geometry with T=Kis a 2-(v,K,1) design.
(2) A partial geometry with T=R−1 is called a net; dually, if
T=K−1 we speak of a transversal design .
(3) A partial geometry with T= 1 is called a generalized quad-
rangle ; the notation GQ(K−1,R−1) is commonly used for
apg(K,R, 1).
(4) If 1<T<min{K −1,R−1}, then we call the partial
geometry proper.
Example 21.6. Consider the aﬃne plane AG
2(n). From Problem
19K we know that the lines can be divided into equivalence classes
of parallel lines, each containing nlines. Consider all the points of
the plane and take the lines of mparallel classes. Then it is clear
that these form a pg(n,m,m−1), i.e. a net.
Example 21.7. Consider a Latin square of order n. Let the n2
cells be the vertices of a graph; two vertices are joined by an edgeif and only if they are in the same row or in the same column,or if they have the same entry. The graph is regular, with degree3(n−1). If two vertices are joined, we may assume without loss
of generality that they are in the same row (think of the Latinsquare as an OA(n,3)). Then they have n−2 mutual neighbors.
---PAGE BREAK---
274 A Course in Combinatorics
If two vertices are not joined, then they clearly have six common
neighbors. So this is an srg(n2,3(n−1),n−2,6). This is called a
Latin square graph and the notation is L3(n), in accordance with
the notation of Example 21.2. Generalizations will occur in a laterchapter. The graph L
3(n) is geometric, corresponding to a partial
geometrypg(n,3,2), i.e. a net. Of course lines correspond to rows,
columns, and symbols of the square. We shall see in Chapter 22that in fact nets and orthogonal arrays are equivalent concepts.
Example 21.8. A quadrangle satisﬁes the conditions for a partial
geometry. It is a pg(2,2,1) which accounts for the name generalized
quadrangle.
Consider a hyperoval OinPG
2(4). We take as point set the 15
points of the plane that are not on O. Lines will be the secants of
O. Then every line has 3 points, and every point is on 3 lines. In
fact this is a pg(3,3,1), i.e.GQ(2, 2).
Note that the same construction applied to PG2(q) forqeven
yields apg(q−1,1
2(q+2 ),1
2(q−2)).
Example 21.9. ConsiderPG2(q) whereqis even. As in Exam-
ple 19.7, this is an incidence structure whose objects are the 1-
dimensional subspaces and 2-dimensional subspaces of F3
q. Again,
letObe a hyperoval in the projective plane. Let all 1-dimensional
subspaces that are in Oand their cosets in F3
qbe lines; points are
the points of the vector space. Every line has qpoints; every point
is onq+2 lines. The fact that Ois a hyperoval implies that for any
pointpnot on line L, there is a unique line through pthat meets
L. So we have deﬁned a GQ(q−1,q+ 1).
Example 21.10. Consider the subgroup GofZ6
3generated by
the element (1,1,1,1,1,1). For each coset a+G, the sum of the
coordinates of the points is a constant i. We say that the coset is
of typei. LetAibe the set of cosets of Gof typei. We deﬁne a
tripartite graph Γ by joining the coset a+Gto the coset a+b+Gfor
eachbthat has only one nonzero coordinate. Clearly, any element
ofAihas six neighbors in Ai+1and six in Ai+2. We construct
a partial geometry by taking some Aias point set and one of the
other two classes Ajas line set. Incidence corresponds to adjacency.
ThatK=R= 6 is clear. It is an easy exercise to show that T=2 .
---PAGE BREAK---
21. Strongly regular graphs and partial geometries 275
This deﬁnes a pg(6,6,2).
We now give a nice application of Theorem 21.5. We shall prove
the theorem, mentioned in Chapter 19 without proof, which states
that a quasiresidual design with λ= 2 is a residual design. Since
the casesk≤6 require separate treatment, we restrict ourselves to
blocksize>6.
Theorem 21.8. LetDbe a 2-(v,k, 2)design with k> 6and
v=1
2k(k+1 )(soDis quasiresidual). Then Dis a residual of a
symmetric 2-design.
Proof: LetBbe a block and let aidenote the number of blocks
(Lnegationslash=B) that meet Binipoints. Just as in Theorem 19.9 we ﬁnd
/summationdisplay
ai=1
2k(k+3 ),/summationdisplay
iai=k(k+1 ),/summationdisplay
i(i−1)ai=k(k−1).
This implies that/summationtext(i−1)(i−2)ai= 0. Therefore any two distinct
blocks meet in 1 or in 2 points, i.e. the design Dis quasisymmetric.
From Theorem 21.2 we ﬁnd that the block graph GofDis strongly
regular. Calculation of the parameters shows that Ghas the same
parameters as T(k+ 2). So by Theorem 21.5, Gis isomorphic to
T(k+ 2). This means that we can label the blocks of Dwith 2-
subsets of S:={1,2,...,k +2}in such a way that two blocks meet
inipoints whenever their labels meet in 2 −ipoints (i =1,2). We
adjoin the set Sto the point set of D, and we adjoin to each block
its label, a 2-subset of S. Finally, we consider Sas a new block.
This produces the required symmetric design with λ= 2 that has
Das residual with respect to the block S. /square
We list below a table of feasible parameter sets with v<30 and
what we have learned about them in this chapter. The only oneleft as a challenge for the reader is no. 14, i.e. GQ(2, 4) for which
no construction was given. The corresponding graph is known astheSchlaeﬂi graph .
---PAGE BREAK---
276 A Course in Combinatorics
No.vkλµ Example
15201P(5)
29412L2(3)
310301Petersen,T(5)
413623P(13)
515613GQ(2, 2)
616502Clebsch
716622L2(4)
817834P(17)
9211036T(7)
10211045does not exist, conference
1125832L2(5)
12251256L3(5)
13261034STS(13), Theorem 21.2
14271015GQ(2, 4)
1528904does not exist, Thms. 21.3, 21.4
16281264T(8)
17291467P(29)
We give some remarks on directed strongly regular graphs and a
few problems.
The condition on paths of length 2 in the deﬁnition of strongly
regular graphs is best seen by writing (21.5) as follows
(21.5 /H11032)AJ=kJ, A2=kI+λA+µ(J−I−A).
The deﬁnition was generalized to directed graphs by A. Duval (1988).
We consider a directed graph Gwithout loops or multiple edges.
If there is an edge from atob, we write a→b. We allow edges
in both directions, indicated by a↔b. In that case we call (a,b)
an undirected edge. The generalization of (21.5 /H11032) will be the same
with respect to paths of length 2, but we now require that eachvertex has indegree k, outdegree kand that among these edges
there aretundirected edges (producing paths of length 2 from a
vertex to itself). So, Gis called a directed stronly regular graph if
its adjacency matrix Asatisﬁes
(21.8) AJ=JA=kJ, A
2=tI+λA+µ(J−I−A).
---PAGE BREAK---
21. Strongly regular graphs and partial geometries 277
For such a graph on vvertices, the notation dsrg(v;k,t;λ,µ) will
be used.
Example 21.11. LetGbe a graph on six vertices consisting of a
directed triangle 1 →2→3→1, a directed triangle 1Lprime→3Lprime→
2Lprime→1Lprime, and undirected edges ( i,iLprime),i=1,2,3. IfCis the 3×3
circulant matrix with cij= 1 for (i,j)=( 1,2),(2,3),(3,1) and 0
otherwise, then the adjacency matrix AofGis
A=/parenleftbigg
CI
IC2/parenrightbigg
.
One easily checks that Asatisﬁes (21.8) with k=2 ,t=1 ,λ=0 ,
andµ=1 . S oGis adsrg(6; 2,1; 0,1).
Problem 21J. State and prove an analog of Theorem 21.1 for
directed strongly regular graphs.Problem 21K. Exclude strongly regular graphs and graphs with
adjacency matrix J−A. Show that the eigenvalues calculated in
Problem 21J lead to an analog of the “half-case” if ( µ−λ)
2+4 (t−
µ) is not the square of an integer. Prove that in this case, the
adjacency matrix Aof thedsrg is of the type of Qin (18.5).
Problem 21L. Consider the case µ=1 ,λ=0 ,t=k−1. Prove
that only three values of vare possible. Show that in the second
case, an example can be obtained from K3,3by replacing vertices
by directed triangles, and edges by copies of the graph of Example21.11 in a suitable way.
We now give some comments and problems on neighborhoo dr e g -
ular graphs.
In a strongly regular graph Gthe neighborhoods Γ( x) and ∆( x)
ofxinG, respectively in the complement
G, are regular graphs. C.
D. Godsil and B. D. McKay (1979) called any graph that has thisproperty a neighborhood regular graph . It is not diﬃcult to show
that a neighborhood regular graph that is also regular is in fact astrongly regular graph. If Gor
Gis not connected, trivial situations
arise. In the following problems, we assume that Gis neighborhood
regular, not regular, and that GandGare connected.
---PAGE BREAK---
278 A Course in Combinatorics
Problem 21M.
(i) Show that the degree of Γ(x) does not depend on x. Call this
numbera.
(ii) Show that there is a number asuch that for each x, the degree
of∆(x)i sa.
Problem 21N. IfXandYare subsets of the vertex set of G,w e
denote by |XY|the number of edges (x,y )i nGwithx∈Xand
y∈Y. Letx1andx2be two non-adjacent edges in Gwith degree
k1, respectively k2,k1Lnegationslash=k2. Letdi:= deg ∆(x i),i=1,2. Note
thatd1Lnegationslash=d2. Now consider the following subsets of the vertex set
ofG:A:= Γ(x1)∩∆(x 2),B:= Γ(x2)∩∆(x 1),C:= Γ(x1)∩Γ(x2),
andD:= ∆(x 1)∩∆(x 2.
(i) Find relations between the numbers |XY|and|X|, whereX
andYare among B,C,D .
(ii) Deduce that
|DD| =(a+a+1 )d1−d2
1−a|C|+|CC|.
(iii) Prove that d1+d2=a+a+1.
(iv) Show that allthe vertices in Ghave degree k1ork2.
Example 21.12. LetGbe the octagon on vertices 1 to 8 with the
two diagonals (15) and (26). This is a neighborhood regular graph
withk1=2 ,k2=3 ,a=0 ,a=2 ,d1= 1, andd2=2 .
Problem 21O. Given a Steiner triple system Sonnpoints, deﬁne
a graphGwhose vertices are the triples Aof the system and where
A,B∈Aare adjacent when |A∩B|=1 .
(i) Show by elementary means (i.e. do not use Theorem 21.2
or matrix methods) that Gis strongly regular and calculate its
parameters.
(ii) Show that if Cis a clique in Gand|C|>7, thenCis a
subset of the triples that contain a ﬁxed point xfor some point x
ofS.
(iii) Use this to show that if the graphs G1andG2arising from
two Steiner triple systems on n>15 points are isomorphic, then
the two systems are also isomorphic. (We remark that there aremore than 163929929318400 nonisomorphic Steiner triple systems
---PAGE BREAK---
21. Strongly regular graphs and partial geometries 279
on 25 points—see R. M. Wilson (1973/74)—so we have at least
that many nonisomorphic strongly regular graphs on 100 vertices.)
Problem 21P. Show that equality in Problem 4H cannot occur
unlessn=3 .
Problem 21Q. Prove the so-called Friendship Theorem :A t a
party with npeople (n>3) every two persons have exactly one
mutual friend. Then there is a unique person at the party who is
a friend of all the others. Use problem 1J.
Notes.
Strongly regular graphs and partial geometries were introduced
by R. C. Bose in 1963. A much more general concept, namely
that of an association scheme, had been introduced by Bose and
Shimamoto in 1952; see Chapter 30 here and Cameron and VanLint (1991), Ch. 17.
For a survey of construction methods for strongly regular graphs,
see Hubaut (1975) and Brouwer and Van Lint (1982).
The Clebsch graph may be deﬁned by the 16 lines in the Clebsch
quartic surface, a pair of lines being adjacent if and only if theyare skew. Alfred Clebsch (1833–1872) was a mathematician andphysicist who worked in Karlsruhe, Giessen, and G¨ ottingen. He wasone of the founders of the famous journal Mathematische Annalen .
The algebra Awas introduced by R. C. Bose and D. M. Mesner
in 1959.
The reference Goethals and Seidel (1970) contains, besides The-
orem 21.2, many interesting connections between strongly regu-lar graphs and other combinatorial designs. Hadamard matrices,Steiner systems and the Golay code all contribute to the theory.For these connections, again see Cameron and Van Lint (1991).
The Higman-Sims graph is connected to their famous ﬁnite sim-
ple group (see Higman and Sims (1968)).
Theorem 21.3 became known as the Krein condition because a
special case of this theorem was proved by L. L. Scott by applyinga result of M. G. Krein concerning topological groups to a problemon ﬁnite groups. The simple proof given in this chapter is due to D.G. Higman (1975) and P. Delsarte (1973). The case of equality in
---PAGE BREAK---
280 A Course in Combinatorics
the Krein conditions was treated by Delsarte, Goethals and Seidel
(1977) and Cameron, Goethals and Seidel (1978).
The idea of the proof of Theorem 21.4 is due to T. H. Koorn-
winder (1976).
Theorem 21.5 was proved several times: see for example, L. C.
Chang (1959), W. S. Connor (1958), A. J. Hoﬀman (1960). Thethree exceptional graphs for n= 8 are known as the Chang graphs.
For surveys on partial geometries, see Van Lint (1983), De Clerck
and Van Maldeghem (1995), and De Clerck (2000).
Nets were introduced by R. H. Bruck in 1951. Bose’s result on
pseudo-geometric graphs was inspired by Bruck’s work (e.g. theidea of grand cliques).
For all that one would like to know about generalized quadrangles
(and more) we refer to the book Finite Generalized Quadrangles by
S. E. Payne and J. A. Thas (1984).
Only three proper partial geometries with T= 2 are known. The
geometry pg(6,6,2) of Example 21.9 was ﬁrst constructed by Van
Lint and Schrijver (1981); the construction that we described is dueto Cameron and Van Lint (1982). The other known examples areapg(5,18,2) due to Haemers and a pg(8,20,2) found by Mathon
(with the aid of a computer).
A big step in the direction of the proof of the nonexistence of
a projective plane of order 10, mentioned in Chapter 19, was theproof of the nonexistence of pg(6,9,4). This implied (see Example
21.8) that, if the plane existed, it would not have any hyperovals.
References.
R. C. Bose (1963), Strongly regular graphs, partial geometries, and
partially balanced designs, Paciﬁc J. Math. 13, 389–419.
R. C. Bose and D. M. Mesner (1959), On linear associative alge-
bras corresponding to association schemes of partially balanced
designs, Ann. Math. Stat. 30, 21–38.
A. E. Brouwer and J. H. van Lint (1982), Strongly regular graphs
and partial geometries, in: Enumeration and Design (D. M. Jack-
son and S. A. Vanstone, eds.), Academic Press.
R. H. Bruck (1951), Finite nets I, Canad. J. Math. 3, 94–107.
R. H. Bruck (1963), Finite nets II, Paciﬁc J. Math. 13, 421–457.
---PAGE BREAK---
21. Strongly regular graphs and partial geometries 281
P. J. Cameron (1978), Strongly regular graphs, in: Selected Top-
ics in Graph Theory (L. W. Beineke and R. J. Wilson, eds.),
Academic Press.
P. J. Cameron, J.-M. Goethals, and J. J. Seidel (1978), The Krein
condition, spherical designs, Norton algebras and permutation
groups, Proc. Kon. Ned. Akad. v. Wetensch. 81, 196–206.
P. J. Cameron and J. H. van Lint (1991), Designs, Graphs, Codes
and their links, London Math. Soc. Student Texts 22, Cambridge
University Press.
P. J. Cameron and J. H. van Lint (1982), On the partial geometry
pg(6,6,2),J. Combinatorial Theory (A)32, 252–255.
L. C. Chang (1959), The uniqueness and nonuniqueness of trian-
gular association schemes, Sci.RecordPeking Math. 3, 604–613.
F. De Clerck and H. Van Maldeghem (1995), Some classes of rank
2 geometries. In F. Buekenhout (editor) Handbook of Incidence
geometry, Buildings and Foundations , North-Holland.
F. De Clerck (2000), Partial and semipartial geometries: an update,
Combinatorics 2000 (Gaeta, Italy).
W. S. Connor (1958), The uniqueness of the triangular association
scheme, Ann. Math. Stat. 29, 262–266.
P. Delsarte (1973), An algebraic approach to the association
schemes of coding theory, Philips Res. Repts. Suppl. 10.
P. Delsarte, J.-M. Goethals and J. J. Seidel (1977), Spherical codes
and designs, Geometriae Dedicata 6, 363–388.
A. M. Duval (1988), A Directed Graph Version of Strongly Regular
Graphs, J. Combinatorial Theory (A) 47, 71–100.
A. Gewirtz (1969), The uniqueness of g(2,2,10,56),Trans. New
York Acad. Sci. 31, 656–675.
C. D. Godsil and B. D. McKay (1979), Graphs with Regular Neigh-
borhoods, Combinatorial Mathematics VII , 127–140, Springer.
J.-M. Goethals and J. J. Seidel (1970), Strongly regular graphs
derived from combinatorial designs, Canad. J. Math. 22, 597–
614.
D. G. Higman (1975), Invariant relations, coherent conﬁgurations
and generalized polygons, in: Combinatorics (M. Hall, Jr. and J.
H. van Lint, eds.), D. Reidel.
D. G. Higman and C. C. Sims (1968), A simple group of order
---PAGE BREAK---
282 A Course in Combinatorics
44,352,000, Math. Z. 105, 110–113.
A. J. Hoﬀman (1960), On the uniqueness of the triangular associ-
ation scheme, Ann. Math. Stat. 31, 492–497.
X. Hubaut (1975), Strongly regular graphs, Discrete Math. 13, 357–
381.
T. H. Koornwinder (1976), A note on the absolute bound for sys-
tems of lines, Proc. Kon. Ned. Akad. v. Wetensch. 79, 152–153.
J. H. van Lint (1983), Partial geometries, Proc. Int. Congress of
Math., Warsaw.
J. H. van Lint and A. Schrijver (1981), Construction of strongly
regular graphs, two-weight codes and partial geometries by ﬁnite
ﬁelds,Combinatorica 1, 63–73.
J. H. van Lint and J. J. Seidel (1969), Equilateral point sets in
elliptic geometry, Proc. Kon. Ned. Akad. v. Wetensch. 69, 335–
348.
A. Neumaier (1979), Strongly regular graphs with smallest eigen-
value−m,Archiv der Mathematik 33, 392–400.
A. Neumaier (1980), New inequalities for the parameters of an as-
sociation scheme, in: Combinatorics and Graph Theory , Lecture
Notes in Math. 885, Springer-Verlag.
S. E. Payne and J. A. Thas (1984), Finite Generalized Quadrangles ,
Pitman.
R. M. Wilson (1973/74), Nonisomorphic Steiner triple systems,
Math. Z. 135, 303–313.
---PAGE BREAK---
22
Orthogonal Latin squares
Two Latin squares L1:R×C→SandL2:R×C→T(with the
same row and column sets) are said to be orthogonal when for each
ordered pair ( s,t)∈S×T, there is a unique cell ( x,y)∈R×Cso
that
L1(x,y)=s andL2(x,y)=t.
The use of the word ‘orthogonal’ is perhaps unfortunate since it has
other meanings in mathematics, but it has become far too common-place to try to change now.
For example, let
A:=
AKQJ
QJAK
JQKA
KAJQ
,B :=
♠♥♦♣
♣♦♥♠♥♠♣♦♦♣♠♥

Figure 22.1
whereR=C={1,2,3,4},S={A,K,Q,J },T={♠,♥,♦,♣}.
The orthogonality of AandBis evident when the two squares are
superposed and we see that each element of S×Tappears exactly
once.
A♠K♥Q♦J♣
Q♣J♦A♥K♠
J♥Q♠K♣A♦
K♦A♣J♠Q♥

Orthogonality does not depend on the particular symbol set used.
We could replace the playing card suits in our example by any
four symbols in any order, and the resulting square would still be
---PAGE BREAK---
284 A Course in Combinatorics
orthogonal to A. We have used Latin letters for the symbols of A;
if we had used Greek letters for B, it would have been clear why
the superposition of two orthogonal Latin squares is often called a
Græco-Latin square.
The example we have given with playing cards is similar to what
is known as Euler’s 36 oﬃcers problem. According to folklore,
Euler was asked by Catherine the Great (at whose court he was inresidence) to arrange 36 oﬃcers from six diﬀerent regiments andof six diﬀerent ranks (one oﬃcer of each rank from each regiment)i na6b y6 array so that each row and each column contained one
oﬃcer of each rank and one oﬃcer of each regiment. A solutionrequires a pair of orthogonal Latin squares of order 6.
Surprisingly, there is no solution. Whether he was asked by
Catherine or not, Euler did consider the problem in 1779 and con-vinced himself that it was impossible. Euler was capable of monu-mental calculation, but it is not clear that he had really examinedall cases. This was systematically done in 1900 by G. Tarry. Todaya computer can do this easily. A short proof (still involving severalcases to be analyzed) was given by D. R. Stinson (1984).
Euler knew that a pair of orthogonal Latin squares of order n
existed for all odd values of n, and all n≡0 (mod 4); see Theorem
22.3 below. For examples of orthogonal Latin squares of odd ordersn, letGbe any group of order nand deﬁne squares L
1andL2with
row, column, and symbol sets Gby
L1(x,y): =xy, L 2(x,y): =x−1y.
For completely trivial reasons, there is no pair of orthogonal
Latin squares of order 2. Euler asserted that he was of the opin-ion that this impossibility for n=2,6 extended as well to n=
10,14,18,..., i.e. to orders n≡2 (mod 4). This statement was
known as ‘Euler’s conjecture’ for 177 years until it was suddenlyand completely disproved by Bose, Parker, and Shrikhande. We willprove later their theorem that pairs of orthogonal Latin squares ofordersnexist for allnexceptn=2,6.
At various times, a more general question has been raised: can
one ﬁnd sets of many Latin squares, any two of which are orthogo-nal? We will denote by N(n) the largest integer kfor which there
---PAGE BREAK---
22. Orthogonal Latin squares 285
existkLatin squares of order nthat are pairwise orthogonal. For
example, we may add
C:=
0αβγ
α0γβ
βγ 0α
γβα 0

(the addition table of the Klein four-group) to the squares in Fig.
22.1 to obtain three pairwise orthogonal Latin squares of order 4;thusN(4)≥3. We remark that the deﬁnition of orthogonality is
trivial or vacuous for n= 1 or 0, and so N(1) =N(0) =∞.
Here is a construction that proves N(q)≥q−1 for a prime power
q. All row, column, and symbol sets are to be the elements of the
ﬁeldF
q. For each nonzero element ainFq, deﬁneLa(x,y): =ax +y;
theseq−1 squares are pairwise orthogonal. As we all know, the
systems
ax+by=s
cx+dy=t
have unique solutions ( x,y) whenad−bcLnegationslash= 0, so it is easy to tell
when two squares deﬁned by linear equations are orthogonal. Hereare the squares for q=5 :

01234
12340234013401240123
,
01234
23401401231234034012
,

01234
34012123404012323401
,
01234
40123340122340112340
.
Theorem 22.1. Forn≥2,w eh a v e1 ≤N(n)≤n−1.
Proof: We may change all row, column, and symbol sets in a set
ofkpairwise orthogonal Latin squares {L
i}k
i=1to{1,2,...,n}(for
---PAGE BREAK---
286 A Course in Combinatorics
notational convenience), and we might as well rename the symbols
if necessary so that the ﬁrst row of each square is 1, 2,...,n in that
order. Now we consider the elements
L1(2,1),L 2(2,1),. . . ,L k(2,1)
in the second row, ﬁrst column. None of these is 1, since 1 occursalready in the ﬁrst column. They are distinct because if L
i(2,1) =
Lj(2,1) =s, say, then the fact that also Li(1,s)=Lj(1,s)=s
would contradict the orthogonality of LiandLj. The upper bound
follows. /square
In view of our construction from ﬁnite ﬁelds and the simple the-
orem above, we have
(22.1) N(q)=q−1i fqis a prime power.
At this point, we want to show that the concept of pairwise or-
thogonal Latin squares is equivalent to something the reader has
already seen in the previous chapter! The assertion of the theo-rem will be more immediately apparent if we ﬁrst notice that theproperty of being a Latin square can itself be described in terms oforthogonality. For example, a square of order 5 is Latin if and onlyif it is orthogonal to the two squares

00000
11111222223333344444
and
01234
01234012340123401234
.
Theorem 22.2. A set of k pairwise orthogonal Latin squares of
ordernexists if and only if an (n,k+2 )-net exists.
Proof: SupposeL
i:R×C→Si,1≤i≤k, are pairwise orthog-
onal Latin squares. Let P=R×C, the set of n2cells. Roughly
speaking, we take as lines the rows, the columns, and the ‘iso-
symbol’ lines in each square. More formally, let
A1={{(x,b ):b∈C}:x∈R},
---PAGE BREAK---
22. Orthogonal Latin squares 287
A2={{(a,y ):a∈R}:y∈C},
Ai+2={{(x,y ):Li(x,y)=c} :c∈Si},1≤i≤k,
and letB=∪k+2
i=1Ai. That (P,B)i sa n(n,k+ 2)-net follows from
the deﬁnitions of Latin and orthogonal.
Given an ( n,k+2)-net (P ,B), whereB=∪k+2
i=1Aiis the partition
into parallel classes, deﬁne Li:A1×A 2→Ai+2by declaring that
Li(A,B ) is to be the unique line in Ai+2containing the point of
intersection of AandB. As usual we leave to the reader the details
of checking the Latin and orthogonal properties of these squares.
/square
Corollary. N(n)=n−1if and only if there exists a projective
(or aﬃne)plane of order n.
The value of N(n) tells us, in some very imprecise sense, how
close to the existence of a projective plane of order nwe may get.
But we know terribly little about this function. The only value of
nother than prime powers for which N(n) is known is n=6 .
Problem 22A. (i) Consider the complement of the graph of an
(n,n)-net and prove that N(n)≥n−2 implies that N(n)=n−1.
(ii) Use the result of Problem 21F to prove that if n>4, then
N(n)≥n−3 implies that N(n)=n−1.
Theorem 22.3.
(i)N(nm)≥min{N (n),N (m)}.
(ii)Ifn=pe1
1pe2
2···perris the factorization of ninto powers of
primes, then
N(n)≥min
1≤i≤r(pei
i−1).
Proof: Part (ii) follows from part (i) and (22.1), used inductively.
To prove part (i), we ﬁrst deﬁne a Kronecker-like product for
squares in the natural way: Given Li:Ri×Ci→Si,i=1,2,
deﬁne
L1⊗L2:(R1×R2)×(C1×C2)→(S1×S2)
by
(L1⊗L2)((x 1,x2),(y1,y2)) := (L1(x1,y1),L2(x2,y2)).
---PAGE BREAK---
288 A Course in Combinatorics
It is straightforward to verify that if {Ai}k
i=1are pairwise orthogonal
Latin squares of order nand{Bi}ki=1are pairwise orthogonal Latin
squares of order m, then{Ai⊗Bi}ki=1are pairwise orthogonal Latin
squares of order nm. We leave this task to the reader, but advise
you just to read on and not bother. /square
Theorem 22.3 is known as MacNeish’s theorem. MacNeish con-
jectured in 1922 that equality held in Theorem 22.3(ii). This would
imply Euler’s conjecture. But combinatorial problems of this typerarely have such simple answers.
The MacNeish conjecture was disproved ﬁrst for n= 21 when
three Latin squares of order 21 were constructed with the aid ofthe 21 point projective plane of order 4; see Example 22.1 below.This was an example of composition methods, which also provided
the ﬁrst counterexample to Euler’s conjecture (n = 22). The ﬁrst
pair of orthogonal Latin squares of order 10 was found by Parker bywhat might be called diﬀerence methods. We discuss composition
methods ﬁrst; they have proved more powerful for large values ofn.
Bose, Parker and Shrikhande gave many constructions for sets
of orthogonal Latin squares. We choose to describe two basic andelegant ones in terms of quasigroups. Recall that a quasigroup is a
Latin square whose row, column, and symbol sets are the same setX. A quasigroup Lisidempotent whenL(x,x )=x for allx∈X.
For example, if Xis the ﬁnite ﬁeld F
qof orderq, then
La(x,y): =ax +( 1−a)y
deﬁnes an idempotent quasigroup LaifaLnegationslash=0,1. Any two squares
of this form are orthogonal.
Problem 22B. For a prime power q≥4, construct two Latin
squaresA,Sof orderqwith row and column sets equal to Fqso
thatAis orthogonal to its transpose, and to S, which is to be
symmetric. In addition, ensure that Sis idempotent if qis odd
and ‘unipotent’, i.e. has constant diagonal, if qis even.
Suppose we have a linear space, cf. Chapter 19, on a point set X
with line set A. Further suppose that for each line AinA, we havek
pairwise orthogonal idempotent quasigroups LA
1,LA2,...,LA
kon the
---PAGE BREAK---
22. Orthogonal Latin squares 289
setA. Then we can construct kpairwise orthogonal idempotent
quasigroups L1,L2,...,Lkon the entire set Xby declaring, for
eachi=1,2,...,k , thatLi(x,x): =x forx∈X, and for distinct
x,y∈X,Li(x,y): =LA
i(x,y), whereAis the unique line in A
which contains both xandy. It is a simple matter to check that
L1,L2,...,Lkare Latin squares and that they are orthogonal; for
example, given i,j,s andt,sLnegationslash=t, a cell (x,y ) for which
Li(x,y)=s andLj(x,y)=t
exists, and x,ymay be found in that line Bwhich contains sand
t, because of the orthogonality of LBiandLBj.
Theorem 22.4. Foreverylinearspacewithlineset Aonann-set
X,w eh a v e
N(n)≥min
A∈A{N(|A|)−1}.
Proof: Letkbe the indicated minimum. This means we have at
leastk+ 1 pairwise orthogonal quasigroups on each A∈A.W e
will describe how to obtain kpairwise orthogonal idempotent quasi-
groups on each A. ThenN(n)≥kfollows from the construction
above.
In general, let H1,H2,...,Hk+1be pairwise orthogonal quasi-
groups on an m-setB. Pick any b∈B. There will be mcells
(x,y) for which Hk+1(x,y)=b, one in each row and one in each
column. Simultaneously permute the columns, say, of all squares
so that these cells are on the diagonal of the ( k+ 1)-th square.
Orthogonality implies that for each i≤k, allmsymbols occur on
the diagonal of the i-th square. Finally, we permute the symbols
independently in each of the ﬁrst ksquares so that the resulting
squares are idempotent. /square
Theorem 22.5. IfAisthesetoflinesofalinearspaceonan n-set
XandB⊆Ais a set of pairwise disjoint lines, then
N(n)≥min ({N(|A|)−1:A∈ A\B}∪{N (|B|):B∈B}).
Proof: Letkbe the indicated minimum. As we saw in the proof
of the preceding theorem, there exist kpairwise orthogonal idem-
potent quasigroups LA
ion eachAinA\B. If necessary, we add
---PAGE BREAK---
290 A Course in Combinatorics
singleton sets to Bso thatBbecomes a partition of X.W e h a v e
kpairwise orthogonal quasigroups LB
i(not necessarily idempotent)
on eachB∈B. We deﬁne L1,L2,...,Lkon the entire set Xby
declaring, for each i=1,2,...,k , thatLi(x,x): =LBi(x,x) where
Bis the unique member of Bthat contains x, and for distinct x,y,
Li(x,y): =LAi(x,y), whereAis the unique line in A(whether or
not inB) that contains both xandy. The quasigroups Liare or-
thogonal (the easy details are left to the reader) and thus N(n)≥k.
/square
Example 22.1. Letn= 21 and consider the projective plane of
order 4 with 21 lines of size 5. Theorem 22.4 implies that N(21)≥3
and this disproves MacNeish’s conjecture. Delete three noncollinear
points. We have a linear space with 18 points, and lines of sizes 5,4, and 3; the three lines of size 3 are pairwise disjoint. Theorem22.5 implies that N(18)≥2 and this disproves Euler’s conjecture.
Example 22.2. To see how far wrong Euler was, we consider two
more values of n≡2 (mod 4). Delete three noncollinear points
from a projective plane of order 8 to obtain a linear space on 70points with lines of sizes 9, 8, and (pairwise disjoint lines of size) 7.Theorem 22.5 shows N(70)≥6. It is possible to ﬁnd seven points
in the plane constructed from F
8such that no three are collinear
(even 10, see Problem 19I), and deleting these produces a linearspace which can be used in Theorem 22.4 to give us N(66)≥5.
The next construction would be diﬃcult to describe without the
use oftransversal designs . Transversal designs provide a compact
and conceptually convenient language with which to manipulatesets of pairwise orthogonal Latin squares. (They also provide alarge family of linear spaces useful for the construction of othercombinatorial designs or even more orthogonal Latin squares.) ATD(n,k ) can be deﬁned as the dual incidence structure of an ( n,k)-
net, i.e. as an ( n,k,k−1)-partial geometry. So there are nkpoints
andn
2blocks (we will use ‘blocks’ rather than ‘lines’ when dis-
cussing transversal designs). Each point is in nblocks; each block
containskpoints. The points fall into kequivalence classes (called,
confusingly, groups ) of sizenso that two points in the same group
are not contained in a block while two points in diﬀerent groups
---PAGE BREAK---
22. Orthogonal Latin squares 291
belong to exactly one block. In particular, each block contains ex-
actly one point from each group. We need to refer to the groupsso often that we incorporate them into the notation and speak ofa transversal design ( X,G,A) where the three coordinates are the
sets of points, groups, and blocks, respectively. (X, G∪A )i sa
linear space with block-sizes kandn.
Example 22.3. Here is a TD(2,3):
Groups: {a
1,a2},{b1,b2},{c1,c2}
Blocks: {a1,b1,c1},{a1,b2,c2},{a2,b1,c2},{a2,b2,c1}.
In view of Theorem 22.2, the existence of a TD(n,k +2) is equiva-
lent to the existence of kpairwise orthogonal Latin squares. At the
risk of boring some readers, we review the connection by quicklydescribing how to get the squares from a TD( n,k+2 ) : n u m b e r
the groups {G
1,G2,...,Gk+2}and deﬁne Li:G1×G2→Gi+2by
declaringLi(x,y) to be the point of intersection of Gi+2and the
block which contains xandy.
A TD(n,k ) is said to be resolvable when the set Aof blocks
can be partitioned into nparallel classes A1,A2,...,An, i.e. each
Aiis a set of nblocks of size kwhich partition the point set X.
From a TD(n,k )(X,G,A), we can always construct a resolvable
TD(n,k−1) by deleting the npoints of one of the groups G0=
{x1,x1,...,xn}, which removes exactly one point from each block;
for eachi, the blocks which have had xiremoved form a parallel
class on the point set X\G0of the TD(n,k −1). (Conversely, a
resolvable TD(n,k −1) can be extended to a TD( n,k).)
Theorem 22.6. If0≤u≤t, then
N(mt+u)≥min{N (m),N (m+1 ),N(t)−1,N(u)}.
Proof: Letkbe the right-hand side above, plus 2. This means
that transversal designs TD(m,k ), TD(m +1,k), TD(t,k +1), and
TD(u,k ) exist; and to prove the theorem, we must construct a
TD(mt +u,k).
As the construction is rather technical, we warm up by ﬁrst de-
scribing the construction of a TD(mt,k ) from a TD(t,k ) and vari-
ous TD(m,k )’s. This is the degenerate case u= 0 in the theorem.
---PAGE BREAK---
292 A Course in Combinatorics
The construction does not require a TD( m+1,k) or a TD(t,k +1)
and thus it reproves Theorem 22.3(i).
Let (X,G,A) be a TD(t,k ). To each x∈X, associate a set Mxof
mnew elements so that any two sets Mxare disjoint. For S⊆X,
letMS:=∪x∈SMx.
We construct a TD(mt,k ) on the point set MXof sizekmtwith
groups{MG:G∈G} each of size mt; the blocks Bare obtained as
follows. For each A∈A, choose blocks BAso that
(MA,{Mx:x∈A},BA)
is a TD(m,k ), and let B=∪A∈ABA. The veriﬁcation is straight-
forward.
To return to the general case, recall that the existence of a
TD(t,k + 1) implies the existence of a resolvable TD(t,k ). So we
have a TD( t,k)(X,G,A) where Aadmits a partition into parallel
classesA1,A2,...,At. We treat the blocks of the ﬁrst uparallel
classes in one way, and the blocks in B:=∪t
i=u+1Aiin another way.
Let (U,H,C)b eaT D ( u,k). We also require a partition of U
intouk-subsets{K1,K2,...,K u}; each is to consist of exactly one
point from each set H∈H, but these k-subsets are not required to
be blocks in C.
LetG={G1,G2,...,Gk}andH={H1,H2,...,Hk}be number-
ings of the groups. We construct a TD(mt +u,k) with point set
Y:=MX∪Uand groups
J:={MG1∪H1,MG2∪H2,...,M Gk∪Hk}.
The blocks are obtained as follows. For each block B∈Bas before,
let
(MB,{Mx:x∈B},DB)
b eaT D (m,k). For each block A∈CalAi, let
(MA∪Ki,{(MA∩MGj)∪(Ki∩Hj):j=1,2,...,k},DA)
be a TD(m+1,k) in which Kioccurs as a block, and let DLprime
Adenote
the remaining ( m+1 )2−1 blocks. Then we claim that (Y, J,E)i s
the required TD( mt+u,k), where
E:=C∪/parenleftBig/uniondisplay
B∈BDB/parenrightBig
∪/parenleftBig/uniondisplay
A∈A 1∪···∪A uDLprime
A/parenrightBig
.
---PAGE BREAK---
22. Orthogonal Latin squares 293
Veriﬁcation requires consideration of several cases. /square
Example 22.4. Withm= 3 in Theorem 22.6, we see that
(22.2)
N(3t+u)≥2 whenever 0 ≤u≤t,N(t)≥3,andN(u)≥2.
We may take (t,u)=( 5 ,3),(7,1),(7,5),and (9,3) to ﬁnd that
N(n)≥2 forn=1 8,22,26,and 30.
Theorem 22.7. N(n)≥2for allnLnegationslash=2,6.
Proof: We need only consider n≡2 (mod 4). For n=1 0,14,
see Examples 22.6 and 22.7 below. For n=1 8,22,26,and 30, see
Example 22.4 above. We now assume n≥34. One of
n−1,n−3,n−5,n−7,n−9,n−11
is divisible by 3 but not by 9, so we can write n=3t+uwhere
u=1,3,5,7,9, or 11, and tis not divisible by 3. Since nis even,
tis also odd, so N(t)≥4 by Theorem 22.3(ii). A consequence of
n≥34 ist≥11, so 0≤u≤t, and then N(n)≥2 by (22.2). /square
Theorem 22.8. N(n)→∞asn→∞.
Proof: Letxbe a positive integer. We claim that N(n)≥x−1
whenever
(22.3) n≥2/parenleftBigg/productdisplay
p≤xp/parenrightBigg2x+1
,
where the product is extended over all primes p≤x.
Givennsatisfying (22.3), let mbe chosen (Chinese remainder
theorem) so that 0 ≤m≤(/producttext
p≤xp)xand such that for all primes
p≤x,
m≡/braceleftbigg−1 (modpx)i fpdividesn,
0( m o dpx)i fpdoes not divide n.
Then choose an integer t≡1( m o d/producttext
p≤xp) so that
0≤u:=n−mt</parenleftBigg/productdisplay
p≤xp/parenrightBiggx+1
.
The remainder of the proof is provided by Problem 22C below. /square
---PAGE BREAK---
294 A Course in Combinatorics
Problem 22C. Withm,t, anduchosen as above, show that u≤t
and that Theorem 22.3(ii) implies that N(mt+u)≥x−1.
***
We have seen constructions by so-called diﬀerence methods in
Chapter 19. We use this idea to construct Latin squares here. It
is convenient to describe our constructions in terms of orthogonal
arrays .A nOA(n,k)i sak×n2array (or we prefer here to think of
asetofn2column vectors of height ksince the order of the columns
is immaterial) whose entries are taken from a set Sofnsymbols, so
that for any distinct i,j,1≤i,j≤k, and any two symbols s,tfrom
S, there is a unique column whose i-th coordinate is sand whose
j-th coordinate is t. This generalizes the OA(n,3)’s introduced in
Chapter 17.
This is yet another equivalent formulation of orthogonality; the
existence of an OA(n,k + 2) is equivalent to the existence of k
pairwise orthogonal Latin squares. For example, to get the arrayfrom squares L
1,L2,...,Lk, assume without loss of generality that
all row, column, and symbol sets are the same set Sand take all
columns
[i,j,L 1(i,j),L2(i,j),...,L k(i,j)]Llatticetop,i , j∈S.
Readers should immediately be able to write out two orthogonalsquares from the OA(3,4) in Fig. 22.2 (of course, anytwo rows may
be used to ‘coordinatize’ the squares).

xxxyyyzzz
xyzxyzxyzxyzzxyyzxxyzyzxzxy

Figure 22.2
Example 22.5. The following matrix of elements of Z
15was found
with the aid of a computer by Schellenberg, Van Rees, and Vanstone
---PAGE BREAK---
22. Orthogonal Latin squares 295
(1978):
0 0 0 000000000000
0 1 2 3456789 1 0 1 1 1 2 1 3 1 40257 91 24 11 4 1 13 6 81 0 1 3063 1 4 1 071 341 12 8 5 11 290 1 0 611 12 71 23 81 341 49 5

It has the property that for any two rows, the diﬀerences between
the coordinates of those two rows comprise all elements of Z15, each
with multiplicity one. It follows that we obtain an OA(15,5) by
taking all translates of these columns by elements of Z15. Thus three
pairwise orthogonal Latin squares of order 15 can be constructed.But theOA(15,5) is resolvable: the 15 translates of any column
have the property that in each coordinate, all symbols occur once.As with transversal designs, we can add a new row to obtain anOA(15,6) and hence four pairwise orthogonal Latin squares of order
15. It is not known whether N(15)≥5.
The last three rows of the above matrix are what we call below
pairwise orthogonal orthomorphisms of Z
15.
In 1960, Johnson, Dulmage, Mendelsohn and a computer proved
by this method that N(12)≥5, using the group Z2⊕Z2⊕Z3. The
cyclic group of order 12 is of no use; see Theorem 22.9 below.
Example 22.6. We will describe a construction that proves
N(m)≥2⇒N(3m+1 )≥2.
LetGbe an abelian group of order 2 m+1 and let Mbe a system of
representatives for the pairs {i,−i}(iLnegationslash=0 )i nG. That is |M|=m
andG={0}∪M∪−M. For each i∈M, introduce a new symbol
∞iand takeS:=G∪{ ∞i:i∈M}as the symbols set for an
OA(3m+1,4).
Consider the set of all column vectors obtained from



0
000


∪


∞
i
0
i
−i
,
0
∞i
−i
i
,
i
−i
∞i
0
,
−i
i
0
∞i
:i∈M


by translating them by the elements of Gwith the understand-
ing that the ∞’s are ﬁxed, i.e. ∞i+g=∞i. This gives us
---PAGE BREAK---
296 A Course in Combinatorics
(4m+ 1)(2m + 1) columns. Add to these the m2columns of an
OA(m,4) to obtain an OA(3m+1,4).
To be more explicit in the case m= 3, let us use symbols Z7∪
{x,y,z}andM={1,2,3}. We take the seven translates of the
following 13 columns, and adjoin the OA(3,4) from Fig. 22.2:

0x016 y025 z034
00x 610 y520 z43
016x 025 y034 z0
0610x 520 y430 z

Veriﬁcation of the construction requires special consideration of
the symbols x,y,z (which we have used rather than the ∞’s), and
the observation that the diﬀerences between any two of the above
rows (when both coordinates are in Z7) comprise all the elements
ofZ7, each with multiplicity one. The resulting squares are shown
below.
0z1y2x3654
41z2y3x065
x52z3y4106
5x63z4y210
y6x04z5321
6y0x15z432
z0y1x26543
1234560 xyz
2345601 zxy
3456012 yzx


04x5y6z123
z15x6y0234
1z26x0y345
y2z30x1456
2y3z41x560
x3y4z52601
3x4y5z6012
6012345 xyz
5601234 yzx
4560123 zxy

Example 22.7. We will describe an OA(14,4) on the symbols
Z
11∪{x,y,z}. We take the 11 translates by elements of Z11of the
following 17 columns, and adjoin the OA(3,4) from Fig. 22.2:

00641x 140 y260 z890
010640 x140 y260 z89
0410640 x160 y290 z8
06410140 x260 y890 z

Once again, veriﬁcation of the construction requires special consid-
eration of the symbols x,y,z (which we have used rather than the
∞’s), and the observation that the diﬀerences between any two of
---PAGE BREAK---
22. Orthogonal Latin squares 297
the above rows (when both coordinates are in Z11) comprise all the
elements of Z11, each with multiplicity one.
Problem 22D. Show that the existence of kpairwise orthogonal
idempotent quasigroups is equivalent to the existence of a TD( n,k+
2) in which there may be found a parallel class of blocks.
Anorthomorphism of an abelian group Gis a permutation σof
the elements of Gsuch that
xLmapsto→σ(x)−x
is also a permutation of G. The reader can check that the square
L(x,y ): =σ (x)+yis Latin if and only if σis a permutation, and is
orthogonal to the addition table A(x,y ): =x +yofGif and only
ifσis an orthomorphism.
We remark that if there is anyorthogonal mate to A, then there
is an orthomorphism: the cells in the positions where an orthogonal
mate contains a given symbol have the property that there is ex-actly one in each row and column, and so are of the form ( x,τ(x)),
x∈G, for some permutation τ. Since these cells must contain
diﬀerent symbols in A, the mapping σdeﬁned by σ(x): =x+τ(x)
is a permutation. In view of this remark, the following theoremproves that cyclic squares of even order have no orthogonal mates,i.e. there are no Latin squares orthogonal to it.
Theorem 22.9. Ifanabeliangroup Gadmitsanorthomorphism,
then its order is odd or its Sylow 2-subgroup is notcyclic.
Proof: If the Sylow 2-subgroup is cyclic and nontrivial, then there
is exactly one element zofGwith order 2. When we add all
elements of G, each element pairs with its additive inverse except
zand 0; so the sum of all elements of Gisz. But ifσwere an
orthomorphism, then
z=/summationdisplay
x∈G(σ(x)−x)=/summationdisplay
x∈Gσ(x)−/summationdisplay
x∈Gx=z−z=0,
a contradiction to our choice of z. /square
---PAGE BREAK---
298 A Course in Combinatorics
Remarks. IfGis abelian and has odd order, then it has automor-
phisms ﬁxing only the identity (this is true for some abelian groups
of even order also), and these are orthomorphisms. Even if Gis
not abelian, one can deﬁne orthomorphisms (also called complete
mappings) and it remains true that these do not exist if the Sylow 2-subgroup is cyclic and nontrivial—see Hall and Paige (1955), wherecomplete mappings are also shown to exist for solvable groups withtrivial or noncyclic Sylow 2-subgroups.
***
H. B. Mann (1950) observed that a Latin square of order 4 t+1
with a subsquare of order 2 thas no orthogonal mates. Similarly, a
Latin square of order 4 t+2 with a subsquare of order 2 t+1 has no
orthogonal mates. Both these results are corollaries of part (ii) ofthe following theorem, which also proves that none of the pairs oforthogonal squares of orders 12 t+ 10 we constructed in Example
22.6 can be extended to a set of three or more pairwise orthogonalLatin squares. We leave it to the reader to convince himself thatsubsquares correspond to subtransversal designs.
Theorem 22.10. Let(X,G,A)b eaT D (n,k)which contains a
sub-TD(m,k )(Y,H,B)withm<n.(This means Y⊆X,H=
{G∩Y:G∈G}, andB⊆A.)Then
(i)m(k−1)≤n;
(ii)if(X,G,A)is resolvable, then
m
2≥n/ceilingleftbiggmk−n
k−1/ceilingrightbigg
.
Proof: Pick a point x0∈X\Y.S a yx0belongs to G0∈G.F o r
each of the m(k−1) points y∈Y\G0, there is a unique block
Ay∈A with{x0,y}⊆Ay. A block containing two points of Y
must belong to B(and could not contain x0), so these m(k−1)
blocks are distinct. This number cannot exceed the total number
of blocks on x0, which is n.
Suppose that ( X,G,A) is resolvable and that {A1,A2,...,An}is
a partition of Ainto parallel classes. Let sidenote the number of
---PAGE BREAK---
22. Orthogonal Latin squares 299
blocks of Aiwhich are contained in Yand lettidenote the number
of blocks of Aiwhich meet Yin exactly one point. Then
ksi+ti=|Y|=mk andsi+ti≤n,
from which it follows that (k −1)si≥mk−n, or equivalently,
si≥/ceilingleftbiggmk−n
k−1/ceilingrightbigg
.
Part (ii) now follows from m2=|B|=/summationtextn
i=1si. /square
Problem 22E. Prove that N(24)≥3 andN(33)≥3.
Problem 22F. Suppose we have c−1 mutually orthogonal Latin
squares of order kThen we have an OA(k,c+1) which we represent
as follows:

11... 122 ... 2... k k ... k
12... k... A1 Ak−1
12... k
,
where every row of each matrix Aiis a permutation of 1 ,2,...,k .
LetAbe thec×k(k−1) matrix formed by the matrices Ai.U s e
this matrix and the matrix Sof Problem 19U to prove the following
theorem.
Theorem. Ifthereexistsasymmetric (v,k, 1)-design,then N(v)≥
N(k).
Problem 22G. Generalize Theorem 22.6 to the following.
Theorem. If0≤u≤t,0≤v≤t, then
N(mt+u+v)≥
min{N (m),N (m+1 ),N(m+2 ),N(t)−2,N(u),N (v)}.
Problem 22H. Show that N(21)≥4.
Problem 22I. Show that N(51)≥4.
---PAGE BREAK---
300 A Course in Combinatorics
Problem 22J. Suppose that by giving examples one has shown
thatN(n)≥3 fora≤n≤7a+ 3. Show that N(n)≥3 for
7a≤n≤72aand conclude that N(n)≥3 forn≥a.
Notes.
The term ‘mutually orthogonal Latin squares’ rather than ‘pair-
wise orthogonal Latin squares’ and its acronym ‘MOLS’ are in com-
mon usage.
We have already mentioned Euler in the notes to Chapter 1.
Euler’s paper of 1782 was titled ‘A new type of magic square’,because Euler had noticed that special magic squares arise froma pair of orthogonal Latin squares. As an example, change thesymbol sets of AandBin Fig. 22.1 to {4,3,2,1}and{12,8,4,0},
respectively, and add, rather than superpose, to obtain

16 11 6 1
2 5 12 15
91 43 87 4 13 10
.
Each line of this matrix sums to 34. (The Latin property does not
in general imply that the diagonals sum to the ‘magic number’, butour example is a particularly nice square: the diagonals, the fourcorners, and many other sets of four entries sum to 34.)
The authors are aware that ‘ A’ is used in Fig. 22.1 both as the
name of a matrix and an entry in that same matrix. We are justchecking whether readers are on their toes.
Orthogonal Latin squares, often in the form of orthogonal ar-
rays, are of great importance in the statistical theory of design ofexperiments.
MacNeish’s paper of 1922 actually includes a false proof of Euler’s
conjecture.
The connection between orthogonal Latin squares and ﬁnite pro-
jective planes was observed by R. C. Bose (1938).
Many results on orthogonal Latin squares were anticipated by
E. H. Moore (1896), as has been pointed out to the authors by R.D. Baker. Unfortunately, the term Latin square is nowhere to befound in Moore’s paper, so no one noticed his results for a long
---PAGE BREAK---
22. Orthogonal Latin squares 301
time. The results in his paper include special cases of Theorem
22.3 and Theorem 22.4 (albeit in entirely diﬀerent forms) as well asdescriptions of projective planes of prime power order, so he couldhave disproved the MacNeish conjecture had he known of it.
Theorem 22.6 is a special case of a construction of Wilson (1974)
which in turn has been generalized in several ways. See T. Beth,D. Jungnickel, and H. Lenz (1986).
Using methods similar to Problem 22J, the second of the present
authors proved that N(n)≥3 forn≥47. Presently it is known
thatN(n)≥3 forn>10. See Colbourn and Dinitz (1996) for
recent lower bounds on N(n) for various n.
Theorem 22.8 is due to Chowla, Erd˝ os, and Straus (1960). They
proved more: N(n)≥n
1/91for suﬃciently large n. Their work
is number-theoretical and is based on the Bose–Parker–Shrikhandeconstructions. Their result has been improved several times, butthe best result to date is that of T. Beth (1983). This seems farfrom the real truth. It is quite possible that N(n)≥n/10, say, for
all, or for all but ﬁnitely many, values of n, but at the present time
this appears to be incredibly hard to prove.
References.
T. Beth (1983), Eine Bemerkung zur Absch¨ atzung der Anzahl
orthogonaler lateinischer Quadrate mittels Siebverfahren, Abh.
Math. Sem. Hamburg 53, 284–288.
T. Beth, D. Jungnickel, and H. Lenz (1986), Design Theory , Bibli-
ographisches Institut.
R. C. Bose (1938), On the application of the properties of Ga-
lois ﬁelds to the problem of construction of hyper-Graeco-Latinsquares, Sanhkya 3, 323–338.
R. C. Bose, S. S. Shrikhande, and E. T. Parker (1960), Further
results in the construction of mutually orthogonal Latin squaresand the falsity of a conjecture of Euler, Canad. J. Math. 12,
189–203.
S. Chowla, P. Erd˝ os, and E. G. Straus (1960), On the maximal
number of pairwise orthogonal Latin squares of a given order,Canad. J. Math. 12, 204–208.
C. J. Colbourn and J. H. Dinitz, editors (1996), The CRC Handbook
of Combinatorial Designs , CRC Press.
---PAGE BREAK---
302 A Course in Combinatorics
A. L. Dulmage, D. Johnson, and N. S. Mendelsohn (1961), Ortho-
morphisms of groups and orthogonal Latin squares, Canadian J.
Math.13, 356–372.
M. Hall and L. J. Paige (1955), Complete mappings of ﬁnite groups,
Paciﬁc J. Math. 5, 541–549.
H. F. MacNeish (1922), Euler squares, Ann. Math. 23, 221–227.
H. B. Mann (1950), On orthogonal Latin squares, Bull. Amer.
Math. Soc. 50, 249–257.
E. H. Moore (1896), Tactical memoranda I–III, Amer. J. Math. 18,
264-303.
P. J. Schellenberg, G. M. J. Van Rees, and S. A. Vanstone (1978),
Four pairwise orthogonal Latin squares of order 15, Ars Comb.
6, 141–150.
D. R. Stinson (1984), Nonexistence of a Pair of Orthogonal Latin
Squares of Order Six, J.Combinatorial Theory (A)36, 373–376.
R. M. Wilson (1974), Concerning the number of mutually orthog-
onal Latin squares, Discrete Math .9, 181–198.
---PAGE BREAK---
23
Projective and combinatorial
geometries
Acombinatorial geometry is a pair (X,F) whereXis a set of points
and where Fis a family of subsets of Xcalledﬂatssuch that
(1)Fis closed under (pairwise) intersection,
(2) there are no inﬁnite chains in the poset F,
(3)Fcontains the empty set, all singletons {x},x∈X, and the
setXitself,
(4) for every ﬂat E∈F,ELnegationslash=X, the ﬂats that cover EinF
partition the remaining points.
Here,FcoversEinFmeans that E,F∈F,E/subsetornotdbleqlF, but that
E/subsetornotdbleqlG/subsetornotdbleqlFdoes not hold for any G∈F. This latter property
should be familiar to the reader from geometry: the lines that
contain a given point partition the remaining points; the planesthat contain a given line partition the remaining points.
A trivial example of a geometry consists of a ﬁnite set Xandall
subsets of Xas the ﬂats. This is the Boolean algebra onX.
We remark that (1) and (2) imply that Fis closed under arbitrary
intersection.
Example 23.1. Every linear space (as introduced in Chapter 19)
gives us a combinatorial geometry on its point set Xwhen we take
as ﬂats∅, all singletons {{x}:x∈X}, all lines, and Xitself. The
fact that the lines on a given point partition the remaining points
is another way of saying that two points determine a unique line.
Example 23.2. Every Steiner system S(t,k,v ) gives us a com-
binatorial geometry on its point set Xwhen we take as ﬂats all
subsets of cardinality <t, all blocks, and X. To get a geometry by
---PAGE BREAK---
304 A Course in Combinatorics
this construction, it is not necessary that all blocks have the same
size, but only that each t-subset is contained in a unique block
(cf. Problem 19R, where we have called these Generalized SteinerSystems).
Example 23.3. LetVbe ann-dimensional vector space over a
ﬁeldF.B y a n aﬃne subspace ofV, we mean either the empty
set or a coset (or translate) of an (ordinary, i.e. linear) subspace
ofVin the additive group. For example, for a,b∈F, the subset
{(x,y ):y=ax+b}is an aﬃne subspace of F
2. The setVtogether
with all aﬃne subspaces forms a combinatorial geometry called the
aﬃne geometry AGn(F). We write AGn(q) forAGn(Fq); the case
n= 2 was introduced in Chapter 19.
Example 23.4. Theprojective geometry PGn(F), while more fun-
damental than AGn(F), can be a little more awkward to deﬁne.
LetVbe an (n +1)-dimensional vector space Vover a ﬁeld F. The
point setXofPGn(F) is to consist of all the 1-dimensional (linear)
subspaces of V. For example, if Fis the ﬁeld Fqofqelements, then
the number of projective points of PGn(Fq)i s
qn+1−1
q−1=qn+···+q2+q+1.
To each linear subspace WofV, we associate a ﬂat FWconsisting
of all the 1-dimensional subspaces of Vthat are contained in W,
and take Fto be the set of all such ﬂats FW. We write PGn(q) for
PGn(Fq); the case n= 2 was introduced in Chapter 19.
Projective geometries PGn(F) can be deﬁned also for Fadivision
ring(lacking commutativity of multiplication); see Crawley and
Dilworth (1973).
LetYbe any subset of the elements Xof a combinatorial geom-
etry (X,F) and let
E:={F∩Y:F∈F}.
Then (Y, E) is also a combinatorial geometry, the subgeometry on
Y. For example, AGn(F) is a subgeometry of PGn(F). There is
a standard embedding of the point set of AGn(F) into the point
---PAGE BREAK---
23. Projective and combinatorial geometries 305
set ofPGn(F): to each vector xin ann-dimensional vector space
V, associate the 1-dimensional subspace that is the span of ( x,1)
in the (n + 1)-dimensional space V×F. The image consists of all
projective points not contained in the hyperplane V×0.
The set of ﬂats Fof a combinatorial geometry, when ordered by
inclusion, has several important properties.
AlatticeLis a partially ordered set with the property that any
ﬁnite subset S⊆Lhas ameet (orgreatest lower bound), that is an
elementbinLso that
∀a∈S[b≤a] and ∀a∈S[c≤a]⇒c≤b,
as well as a join(orleast upper bound), that is an element binL
so that
∀a∈S[b≥a] and ∀a∈S[c≥a]⇒c≥b.
The meet and join of a two-element set S={x,y}are denoted,
respectively, by x∧yandx∨y. It is easily seen that ∧and∨are
commutative, associative, idempotent binary operations; moreover,
if all two-element subsets have meets and joins, then any ﬁnitesubset has a meet and a join.
The lattices we will consider have the property that there are no
inﬁnite chains. Such a lattice has a (unique) least element (that wedenote by 0
L) because the condition that no inﬁnite chains exist
allows us to ﬁnd a minimal element m, and any minimal element
is minimum since if m/notlessequala, thenm∧awould be less than m.
Similarly, there is a unique largest element 1 L.
For elements aandbof a poset, we say that acoversband write
a⋗bwhena>b but there are no elements cso thata>c>b .
For example when UandWare linear subspaces of a vector space,
U⋗WwhenU⊇Wand dim(U) = dim(W) + 1. Recall that a
chain in a partially ordered set Pis a totally ordered subset of P.
So a ﬁnite chain can be thought of as a sequence a0<a1<···<an.
Apoint of a lattice Lwith miminum element 0 Lis an element that
covers 0 L.
Ageometric lattice is a lattice Lthat has no inﬁnite chains, and
such that
(1)Lisatomic, that is, each element of Lis the join of points
ofL, and
---PAGE BREAK---
306 A Course in Combinatorics
(2)Lissemimodular , that is, if aandbare distinct and both
covercinL, thena∨bcovers both aandb.
Theorem 23.1. The set of ﬂats of a combinatorial geometry, or-
dered by inclusion, is a geometric lattice. Conversely, given a geo-
metric lattice Lwith points X, then (X,{Fy:y∈L})is a combi-
natorial geometry, where
Fy:={x∈X:x≤y}.
Proof: Since the set Fof ﬂats of a combinatorial geometry is
closed under intersection, the poset of ﬂats is an atomic lattice(the meet of two ﬂats is their intersection; the join of two ﬂats isthe intersection of all ﬂats containing both). Suppose that ﬂats F
1
andF2cover a ﬂat Ein a combinatorial geometry. Let xbe a point
inF1\F2. There is a ﬂat G2that covers F2inFand contains the
pointx.G2containsF1since otherwise E/subsetornotdbleqlF1∩G2/subsetornotdbleqlF1. But by
a symmetric argument, there is a ﬂat G1that covers F1and also
containsF1andF2. The join F1∨F2must be contained in both G1
andG2. SinceGicoversFi,F1∨F2=G1=G2.
LetLbe a geometric lattice and deﬁne the ﬂats Fyas subsets
of the point set XofLas in the statement of the theorem. It is
clear that the empty set, any singleton, and Xare ﬂats (when y
is taken to be 0 L, a point of L,o r1L, respectively). Since x≤y
andx≤zif and only if x≤y∧z,w eh a v e Fy∩Fz=Fy∧z;t h u s
F:={Fy:y∈L}is closed under intersection. No point xnot in a
given ﬂatFycan be in two ﬂats that cover Fy, so it remains only to
show that some ﬂat that covers Fycontainsx. We show that Fx∨y
coversFyto complete the proof.
This is equivalent to showing that x∨y⋗yinLwheneverx/notlessequaly
inLandxis a point of L. Choose a maximal chain
0L⋖y1⋖y2⋖···⋖yk=y.
Sincexandy1cover 0 L,x∨y1coversy1. Sincex∨y1andy2cover
y1,x∨y2coversy2(clearlyx∨y1∨y2=x∨y2). Inductively, we
ﬁnd thatx∨ykcoversyk. /square
In some sense, the diﬀerence between geometric lattices and com-
binatorial geometries is the same as that between incidence struc-tures on the one hand and families of subsets of a set on the other.
---PAGE BREAK---
23. Projective and combinatorial geometries 307
Incidence structures and lattices are more abstract and must be
used to avoid confusion in certain cases (e.g. when discussing du-ality or intervals), but we prefer the language and notation of setsand subsets for many arguments.
For example, for elements aandbof a partially ordered set,
theinterval [a,b] is deﬁned as [ a,b]: ={x:a≤x≤b}.A n y
interval in a lattice is again a lattice. The reader should checkthat any interval of a geometric lattice is again a geometric lattice.It would be awkward to state the corresponding fact in terms ofcombinatorial geometries.
In view of Theorem 23.1 (more precisely, the simple correspon-
dences decribed in the proof), it is often convenient (though some-times confusing) to mix the notation and language of combinatorialgeometries and geometric lattices. For example, we can use thesame symbol PG
n(F) to denote the combinatorial geometry and
the corresponding lattice of subspaces of a vector space.
Problem 23A. (i) Any interval of PGn(F) is isomorphic as a poset
toPGm(F) for some m≤n. (ii)PGn(F) is isomorphic to its dual
poset (where order is reversed).Example 23.5. The partition lattices Π
n, whose elements are all
partitions of an n-setX, provide another family of geometric lat-
tices, and hence give us combinatorial geometries. The partitions
are ordered by reﬁnement; Ais a reﬁnement of Bif each block of
Bis the union of blocks of A. So the least element (the ﬁnest par-
tition) is all singletons {{x} :x∈X}and the greatest element is
{X}, consisting of a single block. A moment’s thought shows that
one partition covers another if the former is obtained by coalescingtwo blocks of the latter into one. The points are the partitions thatconsist of a single block of size 2 and n−2 singletons.
For example, Π
4has 15 elements:
{1234}
{123, 4},{124, 3},{134, 2},{234, 1},{12,34},{13,24},{14,23}
{12,3,4},{13,2,4},{14,2,3},{23,1,4},{24,1,3},{34,1,2}
{1,2,3,4}
---PAGE BREAK---
308 A Course in Combinatorics
To simplify the notation, we have written {123, 4}, for example,
for what should be {{1,2,3},{4}}.
Example 23.6. The points of Π nare in one-to-one correspondence
with the edges of Kn. Given any simple graph Gonnvertices, we
obtain a geometric lattice L(G) whose points correspond to the
edge setE(G)o fG as follows. The elements of Lare to be all
those partitions AofV(G) such that the subgraph of Ginduced
by each block of Ais connected. The partitions with this property
are exactly those that are the join (in Π n) of points (in Π n) corre-
sponding to some subset of the edges of G. The lattices L(G) are
sometimes called the lattices of contractions ofG(see Chapter 33).
Fig. 23.1 is an attempt to illustrate the combinatorial geometries
L(K 4) andL(K5).L(K 5), for example, has ten points; the dot in
the ﬁgure labeled 12 represents the point (partition) {12,3,4,5}.
The partitions of the type {123, 4,5}, for example, contain three
points and are represented by line segments; lines with two points
are not shown. (We note that the six point/seven line L(K4) is the
geometry that arises from deleting a point from the Fano conﬁgu-ration.)
Figure 23.1
For a subset Sof the points of a combinatorial geometry, the
closureSis the intersection of all ﬂats containing S. For example,
in a linear space, the closure of a two point set is the line containingthe points. Exercise: show that S⊆
S,A⊆B⇒A⊆B, and
S=S. It will be occasionally convenient to use the symbol for join
in the lattice of ﬂats; note that
E∨F:=E∪F.
---PAGE BREAK---
23. Projective and combinatorial geometries 309
A subsetS⊆Xisindependent when for each x∈S,x/∈S\{x}.
In Example 23.1, three points in a linear space are independent
if and only if they are not contained in a line; no four points areindependent. A set of points in PG
n(F) is independent if and only
if representative vectors are linearly independent. A set of pointsinAG
n(F) is independent if and only if the vectors are aﬃnely
independent. One viewpoint of combinatorial geometries is thatthey represent the study of ‘abstract independence’.
By therank of a combinatorial geometry with point set X,w e
mean the maximum size of an independent subset of X.PG
n(F)
andAGn(F) both have rank n+ 1. We will avoid the word di-
mension, but if we forget and use it, it will mean the rank minus
one. The maximum size of an independent subset of a ﬂat Fis the
rankof that ﬂat. The ﬂats of rank 1 are called points, the ﬂats of
rank 2 are called lines, the ﬂats of rank 3 are called planes. The
ﬂats of rank 1 less than rank( X) are called hyperplanes orcopoints.
Occasionally, we need to use the term coline for a ﬂat for which the
rank equals rank( X)−2.
From any combinatorial geometry (X, F), we obtain a linear
space (X,L) where Lis the set of all lines (ﬂats of rank 2).
In Fig. 23.1, any two points determine a line that may have two
or three points; only the latter are drawn in the ﬁgure. The planesinL(K
5) have either four or six points; the latter contain four
three-point lines.
We collect some simple facts:
Lemma 23.2.
(1)Ifx/∈Abutx∈A∪{y}, theny∈A∪{x}(theexchange
axiom).
(2)IfSisanindependentsetofpointsinageometryand x/∈S,
then{x}∪Sis independent.
(3)IfF=S, thenF=Afor any maximal independent subset
AofS.
Proof:F1:=A∪{x}is the ﬂat that covers E:=Aand contains
x;F2:=A∪{y}is the ﬂat that covers Eand contains y.I fx∈F2,
it must be that F1=F2. This proves (1).
If{x}∪S is not independent, there is some y∈Ssuch that
---PAGE BREAK---
310 A Course in Combinatorics
y∈(S∪{x})\{y}. LetA:=S\{y}. Since Sis independent,
y/∈A. But (1) then implies that x∈A∪{y}, i.e.x∈S. This
proves (2).
SupposeF=Sand thatAis an independent subset of Sthat
is maximal with respect to that property. If S/notsubseteqlA, we could ﬁnd
a larger independent subset of Sby (2). So S⊆Aand since Fis
the smallest ﬂat containing S,F⊆A. This proves (3). /square
Abasis for a ﬂat Fis an independent subset B⊆Fso that
B=F, i.e. any maximal independent subset of F. As an exercise,
the reader should check that we could also have deﬁned a basis of
Fas a minimal spanning set, i.e. a subset BofFso thatB=F
and that is minimal with respect to this property.
Problem 23B. LetGbe a connected simple graph. Show that
the bases of the combinatorial geometry L(G) are exactly the edge
sets of spanning trees in G.
Theorem 23.3. Allbasesofaﬂat Finacombinatorialgeometry
have the same ﬁnite cardinality (called the rankofF). For ﬂats E
andF,
(23.1) rank(E)+rank (F)≥rank(E∩F)+rank (E∨F).
Proof: It should be clear that the condition that there are no
inﬁnite chains of ﬂats forces all independent sets to be ﬁnite.
If it is not true that all bases of Fhave the same cardinality,
choose an ordered pair ( B1,B2) of bases with |B1|>|B2|but so
that|B2\B1|is as small as possible subject to this constraint. Pick
x∈B1\B2. ThenB1\{x}is independent and has a closure which
does not contain Fand hence does not contain B2. Picky∈B2\B1
such that y/∈B1\{x}. Then ( B1\{x})∪{y}is independent by
Lemma 23.2 and is contained in a basis B3forF. Now we have an
ordered pair ( B3,B1) of bases with |B3|>|B2|, butB2\B3is a
proper subset of B2\B1, a contradiction.
To prove the second part of the theorem, ﬁrst note that Lemma
23.2(2) implies that a basis for a ﬂat Ecan be extended to a basis
for any ﬂat ELprimecontaining E.
Now letBbe a basis for E∩F. ExtendBto basesB1andB2for
EandF, respectively. Then any ﬂat containing B1∪B2containsE
---PAGE BREAK---
23. Projective and combinatorial geometries 311
andFand hence E∪F; that is,B1∪B2=E∪Fand soB1∪B2
contains a basis for E∪F. Then
rank(E∪F)≤|B1∪B2|=|B1|+|B2|−|B1∩B2|
= rank(E) + rank(F)−rank(E∩F).
/square
The inequality (23.1) is called the semimodular law .
We remark that the proof of Theorem 23.3 shows that all maxi-
mal independent subsets of any subset S, not necessarily a ﬂat, have
the same cardinality. This is a corollary of the statement for ﬂats,
however, because we can apply Theorem 23.4 to the subgeometryonS.
As an exercise, make sure that you understand the following: Let
EandFbe ﬂats in a geometry with E⊆F. If rank(E) = rank(F),
thenE=F;FcoversEif and only if rank( F) = rank(E)+1 .
For the aﬃne geometries AG
n(q), the number of points on a ﬂat
of rankrisqr. For the projective geometries PGn(q), the number
of points on a ﬂat of rank ris
(23.2)qr+1−1
q−1=qr+···+q2+q+1.
Theorem 23.4. Suppose that every ﬂat of rank iin a combina-
torial geometry on vpoints has exactly kipoints,i=0,1,...,n.
Then the total number of ﬂats of rank ris
(23.3)r−1/productdisplay
i=0(v−ki)
(kr−ki).
Furthermore, the set of points together with the family of rank r
ﬂats is a 2-design.
Proof: Since the ﬂats of rank r+ 1 that contain a ﬂat of rank
rpartition the remaining v−krpoints into sets of size kr+1−kr,
there must be exactly (v −kr)/(kr+1−kr) such ﬂats. The formula
(23.3) now follows by induction on rwhen we count the ordered
pairs (E,F) of rankrand rankr+ 1 ﬂats with E⊆F. Note that
k0= 0 andk1= 1, so that (23.3) is valid for r=1 .
---PAGE BREAK---
312 A Course in Combinatorics
Any two points are contained in a unique rank 2 ﬂat. The above
argument implies that any rank 2 ﬂat is contained in the same
number of rank rﬂats. Hence the rank rﬂats give a 2-design. /square
The numbers of rank rﬂats ofPGn(q) are called Gaussian num-
bers; see Chapter 24. Equations (23.2) and (23.3) imply that the
numbers of points and hyperplanes of PGn(q) are equal (there are
other ways of seeing this) and so we have the following corollary.
Corollary. Thepointsandhyperplanesoftheprojectivegeometry
PGn(q)form a (v,k,λ )-symmetric design with
v=(qn+1−1)/(q−1),
k=(qn−1)/(q−1),
λ=(qn−1−1)/(q−1).
Problem 23C. Show that the incidence structure whose points
are the points of AGr(2) and whose blocks are the planes of AGr(2)
is a Steiner system S(3,4,2r).
The following theorem is due to C. Greene (1970).
Theorem 23.5. The number of hyperplanes in a ﬁnite combina-
torial geometry is at least the number of points.Proof: The proof will be similar to that of Theorem 19.1. First,
we shall show that if a point xis not on a hyperplane H, then
the number r
xof hyperplanes on xis at least the number kHof
points on Hby induction on the rank. The assertion is trivial for
geometries of rank ≤2. By the induction hypothesis, we know
that the number of hyperplanes of the subgeometry on H(i.e. the
number of colines Ccontained in H)i sa tl e a s t kH. But for each
such coline C, we get a hyperplane (the join of Candx)o nx.
Now we repeat from the proof of Theorem 19.1: Let Hdenote
the set of hyperplanes, v:=|X|,b:=|H|. Suppose b≤v. Then
1=/summationdisplay
x∈X/summationdisplay
HLnegationslashLownerx1
v(b−rx)≥/summationdisplay
H∈H/summationdisplay
x/∈H1
b(v−kH)=1,
and this implies that in all the inequalities, equality must hold.
Therefore v=b. /square
---PAGE BREAK---
23. Projective and combinatorial geometries 313
See the remark following Lemma 23.8 below concerning the case
of equality in Theorem 23.5.
In studying PGn(F), the dimension formula
dim(U∩W) + dim(U +W) = dim(U) + dim(W )
for linear subspaces of a vector space plays a crucial role. Equiva-
lently,
(23.4) rank( E∩F) + rank(E∨F) = rank(E) + rank(F)
for ﬂatsEandFofPGn(F). This is a stronger version of the
semimodular law. Indeed, a combinatorial geometry in which (23.4)
holds is said to be modular . In a modular combinatorial geometry,
for example, (23.4) implies that any two lines contained in a planemust meet nontrivially (cf. Theorem 19.1).
Problem 23D. Let (X,B) be the linear space consisting of the
points and lines of a ﬁnite modular combinatorial geometry of rank
3. Show that ( X,B) is either a nearpencil as deﬁned following
Theorem 19.1 or else is a projective plane as deﬁned in Chapter19—that is, show that any two lines have the same cardinalityn+ 1 and that there are exactly n
2+n+ 1 points for some integer
n≥2.
We have introduced the projective geometries PGn(F) and have
deﬁned projective planes in Chapter 19. Here is the general deﬁ-nition: A projective geometry is a modular combinatorial geometry
that isconnected in the sense that the point set cannot be expressed
as the union of two proper ﬂats.
We do not have the space or the time to prove here the following
fundamental result. See Veblen and Young (1907) or Crawley andDilworth (1973) for a proof.
Theorem 23.6. Every projective geometry of rank n≥4is iso-
morphic to PG
n(F)for some division ring F.
Combinatorial geometries of rank ≤2 are without great interest,
but all are modular and, except for the two point line, are projective
geometries. The rank 3 projective geometries are, by Problem 23D,
---PAGE BREAK---
314 A Course in Combinatorics
equivalent to projective planes as introduced in Chapter 19 (the
nearpencils are not connected).
Every modular combinatorial geometry can be put together from
projective geometries. This is the content of the following problem.
Problem 23E.
(i) Let (X 1,F1) and (X2,F2) be modular combinatorial geome-
tries;X1∩X2=∅. Show that ( X1∪X2,{F1∪F2:F1∈F 1,F2∈F 2})
is a modular combinatorial geometry.
(ii) Let (X, F) be a modular combinatorial geometry such that
Xis the union of two ﬂats X1andX2whereX1∩X2=∅. Let
Fi:={F∩Xi:F∈F} ,i=1,2. Show that ( Xi,Fi),i=1,2, is
a modular combinatorial geometry and that F={F1∪F2:F1∈
F1,F2∈F 2}.
Problem 23F. Prove that every ﬂat Fof a combinatorial geome-
try (X,F) has amodular complement , i.e. there exists a ﬂat Esuch
thatE∩F=∅,E∨F=X, and rank( E) + rank(F) = rank(X).
The linear spaces consisting of the points and lines of modular
combinatorial geometries satisfy the following condition known as
thePasch axiom. A line that meets two sides of a triangle also
meets the third. More precisely, suppose A,B,C are distinct lines
anda,b,c distinct points with incidence as in Fig. 23.2. We require
that any line Lthat contains a point other than aorbfrom the
lineCand a point other than aorcfrom the line Balso contains a
point other than borcfrom the line A. See Fig. 23.2. To see that
this holds in a modular geometry, notice that LandAmust both
be contained in the plane P={a,b,c}, and the modular equation
implies that two lines in a plane must meet nontrivially.
Figure 23.2
---PAGE BREAK---
23. Projective and combinatorial geometries 315
Problem 23G. Consider the incidence structure whose points are
thek-dimensional subspaces of a vector space Vand whose lines
are the (k + 1)-dimensional subspaces of V, with incidence being
containment. Show that this incidence structure satisﬁes the Pasch
axiom.
Theorem 23.7. A ﬁnite linear space (X,A)for which the Pasch
axiomholds,consistsofthepointsandlinesofsomemodularcom-
binatorial geometry on X.
Proof: Suppose the Pasch axiom holds. We must construct the
ﬂats of a combinatorial geometry, which we do as follows. We saythat a subset S⊆Xis aﬂatwhen, for any line L,
|L∩S|≥2 implies L⊆S.
LetFdenote the set of all such ﬂats; this includes the empty
set, all singletons, and X, as well as all lines in A. Check that
the deﬁnition implies that the intersection of any number of ﬂatsis again a ﬂat.
Letxbe a point not in a ﬂat S. LetTbe the union of all
lines joining xto the points s∈S. We claim that this simple
construction produces a ﬂat T, and that TcoversS.
To this end, let Lbe a line containing two points t
1,t2ofT.W e
want to show L⊆T.I ft1,t2both belong to one of the lines on x,
thenLis that line and so L⊆T. Otherwise both t1andt2are in
S; thenL⊆T, so assume t1/∈S. Thent1andt2belong to distinct
linesM1andM2onx.S a yMimeetsSinsi,i=1,2, and let N
be the line joining s1ands2. We have N⊆S. The Pasch axiom
guarantees that LmeetsNin some point zofS.
Consider any other point t3∈L. LetM3be the line joining x
andt3. SinceM3meets two sides of the triangle with sides M1,
L, andN(with vertices z,t1, ands1), it must meet the third side
Nin some point s3ofS. ThenM3is one of the lines joining xto
points ofS,s ot 3∈T. We have now proved that Tis a ﬂat.
ThatTcoversSis easy to see: If Uis a ﬂat,S/subsetornotdbleqlU⊆T, pick
y∈U\S. By construction, the line joining xandyis one of the
lines onxthat meets S; that line contains two points of Uand
hence is contained in U. This means x∈U, whenceT⊆U.
---PAGE BREAK---
316 A Course in Combinatorics
Since any point lies in a ﬂat that covers a ﬂat S,(X,F)i sa
combinatorial geometry. (The hypothesis that Xis ﬁnite is only
used here to ensure that there are no inﬁnite chains of ﬂats.)
Letxbe a point on a line Land letHbe any hyperplane. Since
(ifxis not already in H) the join of Handxmust beX,Lmust
be one of the lines on xthat meet H. That is, any line Land
any hyperplane Hmeet nontrivially. This implies modularity by
Lemma 23.8 below. /square
Lemma 23.8. Acombinatorialgeometryismodularifandonlyif
any line and any hyperplane meet nontrivially.
Proof: The modular law (23.4) shows that any rank 2 ﬂat and
any rankn−1 ﬂat in a rank ngeometry meet in a ﬂat of rank ≥1.
For the converse, we use induction on the rank. Assume that
all lines and hyperplanes in a rank ncombinatorial geometry meet
nontrivially. Suppose His a hyperplane and that there exists a line
L⊆Hand a rank n−2 ﬂatC⊆Hthat are disjoint. But then for
any point x/∈H, the hyperplane C∨{x}would be disjoint from
the lineL. So by induction, the subgeometry on any hyperplane H
is modular.
Thus if there is a pair of ﬂats EandFthat provide a coun-
terexample to the modular law (23.4), then E∨Fis equal to the
entire point set X. LetHbe a hyperplane containing Eand let
FLprime:=H∩F. ThenE∨FLprime⊆H. But rank( FLprime)≥rank(F)−1 since
otherwise a modular complement of FLprimeinFwould have rank ≥2
and so would contain a line, one that would be disjoint from H.W e
see thatEandFLprimeprovide a counterexample to (23.4) contained in
H, contradicting the modularity of the subgeometry H. /square
Remark. Suppose the number of hyperplanes of a ﬁnite combi-
natorial geometry ( X,F) is equal to the number of points. Then,
reviewing the proof of Theorem 23.5, rx=kHwhenever x/∈H.I f
we apply Theorem 23.5 to the interval [ {x},X ] in any combinato-
rial geometry, we ﬁnd that rx≥lx, wherelxdenotes the number of
lines containing x(since these lines are the points of the geomet-
ric lattice [{x},X ]). Forx/∈Hwe obviously have lx≥kHsince
the lines {x}∨{y},y∈H, are distinct. In summary, equalit yi n
Theorem 23.5 implies that lx=kHwhenx/∈H. This means that
---PAGE BREAK---
23. Projective and combinatorial geometries 317
every line meets every hyperplane and hence ( X,F) is modular by
Lemma 23.8.
Two triangles {a1,b1,c1}and{a2,b2,c2}are said to be perspective
from a point if there exists a point p(thepoint of perspectivity ) such
that{p,a 1,a2}are collinear, {p,b 1,b2}are collinear, and {p,c 1,c2}
are collinear. Two triangles {a1,b1,c1}and{a2,b2,c2}are said to
beperspective from a line if there exists a line L(thelineoraxis
of perspectivity ) such that {L,A 1,A2}are concurrent, {L,B 1,B2}
are concurrent, and {L,C 1,C2}are concurrent. Here we are using
‘triangle’ to mean three noncollinear points, and Ai,Bi, andCito
denote the ‘sides’ of the triangle opposite ai,bi, andci, respectively.
That is,Ai:={bi,ci},i=1,2, etc.
Figure 23.3
In Fig. 23.3, the triangles are perspective from the point pand
also perspective from the line L. The incidence stucture so illus-
trated, with ten points and ten lines, each line on three points and
each point on three lines, is called the Desargues conﬁguration . The
triangles need not lie in a plane. The right diagram in Fig. 23.1is isomorphic (!) to that in Fig. 23.3 as an incidence structure;the former is easier to imagine as 3-dimensional. It can be viewedin many ways, e.g. as showing that the triangles {25,35,45}and
{12,13,14}are perspective from the point 15 and also perspective
from the line {23,24,34}.
If we choose a basis for the (n +1)-dimensional vector space whose
subspaces comprise PG
n(F), we can describe projective points by
so-called homogeneous coordinates.B y Langbracketleftx0,x1,...,xnLangbracketright, we mean
the 1-dimensional subspace spanned by the vector ( x0,x1,...,xn).
---PAGE BREAK---
318 A Course in Combinatorics
The projective point Langbracketleftx0,x1,...,xnLangbracketrightis the same as Langbracketlefty0,y1,...,ynLangbracketright
if and only if the vector ( y0,y1,...,yn) is a nonzero scalar multiple
of (x 0,x1,...,xn). The hyperplanes may also be described by ho-
mogeneous ( n+1)-tuples: [c 0,c1,...,cn] will denote the hyperplane
consisting of points with homogeneous coordinates Langbracketleftx0,x1,...,xnLangbracketright
so thatc0x0+x1c1+···+xncn=0 .
Theorem 23.9 (Desargues’ theorem). InPGn(F), if two tri-
anglesareperspectivefromapoint,thentheyareperspectivefrom
a line.
Proof: Let triangles {a1,b1,c1}and{a2,b2,c2}be perspective from
a pointp. We are going to assume that no three of p,a1,b1and
c1are collinear so that we do not spend too much time on details.
We will also assume that all points lie in a plane, i.e. we prove the
theorem for PG2(F). The other cases are left for the reader.
We choose a basis for a 3-dimensional vector space so that the
basis vectors x,y,zspan the 1-dimensional subspaces a1,b1, and
c1, respectively. Then the homogeneous coordinates for a1,b1, and
c1areLangbracketleft1,0,0Langbracketright,Langbracketleft0,1,0Langbracketright, andLangbracketleft0,0,1Langbracketright, respectively. Then phas ho-
mogeneous coordinates Langbracketleftα,β,γLangbracketrightwhere all coordinates are nonzero.
We replace the original basis vectors by αx,βyandγz; thena1,
b1, andc1are still represented by Langbracketleft1,0,0Langbracketright,Langbracketleft0,1,0Langbracketright, andLangbracketleft0,0,1Langbracketright,r e -
spectively, while pnow has homogeneous coordinates Langbracketleft1,1,1Langbracketright. This
will simplify our computations.
It follows that a2=Langbracketleftα,1,1Langbracketright,b2=Langbracketleft1,β, 1Langbracketright,c2=Langbracketleft1,1,γLangbracketright, for some
α,β,γ∈F. The line joining a1andb1is [0,0,1]; the line joining
a2andb2is [1−β,1−α,αβ−1] (check that both a2andb2are
on this line). The point on both lines is Langbracketleft1−β,α−1,0Langbracketright. Similarly,
the point of intersection of the lines joining b1andc1with the line
joiningb2andc2is found to be Langbracketleft0,1−α,γ−1Langbracketright, and the point of
intersection of the lines joining c1anda1with the line joining c2and
a2is found to be Langbracketleftβ−1,0,1−γLangbracketright. The three points of intersection
are collinear since their coordinates are linearly dependent.
(If we are careful, the proof should go through also for division
ringsF.) /square
Problem 23H. Prove that the linear space of PGn(F) also satis-
ﬁesPappus’ theorem when Fis a (commutative) ﬁeld, which is as
---PAGE BREAK---
23. Projective and combinatorial geometries 319
follows. Let ai,bi, andcibe collinear points, say on a line Li, for
i=1,2. Suppose L1andL2meet in a point (not one of the six
named points). Then the lines {a1,b2}and{a2,b1}meet in a point
c, the lines {b1,c2}and{b2,c1}meet in a point a, and the lines
{a1,c2}and{a2,c1}meet in a point b; and the three points a,b,c
are collinear.
Figure 23.4
Projective planes in which the statement of Theorem 23.9 is valid
(if two triangles are perspective from a point, then they are per-
spective from a line) are called Desarguesian planes . Projective
planes in which the conclusion of Problem 23H holds are calledPappian planes . We do not have the space or time to prove the
further following fundamental result. See Crawley and Dilworth(1973).
Theorem 23.10.
(1)Aprojectivegeometryofrank3isisomorphicto PG
2(E)for
somedivisionring EifandonlyifitisaDesarguesianplane.
(2)Aprojectivegeometryofrank3isisomorphicto PG2(F)for
some ﬁeld Fif and only if it is a Pappian plane.
A corollary of Theorem 23.10 is that every Pappian plane is De-
sarguesian. For a synthetic (i.e. coordinate-free) proof that Pap-
pus’ theorem implies Desargues’ theorem, see D. Pedoe (1963). Weremark that every ﬁnite division ring is a ﬁeld (Wedderburn’s the-orem), so that every ﬁnite Desarguesian plane is Pappian; see M.Hall, Jr. (1972).
We describe one method of obtaining ﬁnite projective planes that
are not Desarguesian.
---PAGE BREAK---
320 A Course in Combinatorics
LetGbe an abelian group of order n2, and suppose that there
exist subgroups H0,H1,...,Hnof ordernthat partition the nonzero
elements of G, that is such that Hi∩Hj={0}foriLnegationslash=jand,
therefore,
n/uniondisplay
i=0Hi\{0}=G\{0}.
Then, we claim, the incidence structure whose points are the el-
ements of Gand whose lines are all cosets (translates) of all the
subgroups Hiis an aﬃne plane. In general, the intersection of cosets
of two subgroups HandKis either empty or a coset of H∩K,
so lines meet in at most one point. We could now count coveredpairs to show that every two distinct points are contained in a line,but it is just as simple to note that given points x,y∈G, the coset
H
plscript+ycontains both points where Hplscriptis the subgroup containing
the diﬀerence x−y. An aﬃne plane obtained from a group Gand
n+ 1 subgroups in this way is called an aﬃne translation plane.I t
is known that Gmust be elementary abelian for such subgroups to
exist; see J. Andr´ e (1954). The aﬃne plane may be completed to aprojective plane as in Problem 19K; any projective plane obtainedin this way is a translation plane.
Example 23.7. Here is a partition of the nonzero elements of F
4
3
into ten subgroups H0,H1,...,H 9. (We have denoted the elements
as strings, dropping commas and parentheses.)
{0000, 1000, 2000, 0100, 0200, 1100, 2200, 2100, 1200}
{0000, 0010, 0020, 0001, 0002, 0011, 0022, 0021, 0012}
{0000, 1010, 2020, 0101, 0202, 1111, 2222, 2121, 1212}
{0000, 2010, 1020, 0201, 0102, 2211, 1122, 1221, 2112}
{0000, 0110, 0220, 2001, 1002, 2111, 1222, 2221, 1112}
{0000, 0210, 0120, 1001, 2002, 1211, 2122, 1121, 2212}
{0000, 1110, 2220, 2101, 1202, 0211, 0122, 1021, 2012}
{0000, 2210, 1120, 1201, 2102, 0111, 0222, 2021, 1012}
{0000, 2110, 1220, 2201, 1102, 1011, 2022, 0121, 0212}
{0000, 1210, 2120, 1101, 2202, 2011, 1022, 0221, 0112}.
The aﬃne plane corresponding to this ‘spread’ of subgroups is theDesarguesian plane.
---PAGE BREAK---
23. Projective and combinatorial geometries 321
But note that the elements of the ﬁrst four subgroups, for exam-
ple, can be partitioned into subgroups in another way, as indicated
by the columns below.
{0000, {0000, {0000, {0000,
1000, 2000, 0100, 0200, 1100, 2200, 2100, 1200,
0010, 0020, 0001, 0002, 0011, 0022, 0021, 0012,
1010, 2020, 0101, 0202, 1111, 2222, 2121, 1212,
2010, 1020} 0201, 0102} 2211, 1122} 1221, 2112}
The above example is the special case q= 3 of a construction we
now describe. Let Vbe a 2-dimensional vector space over Fq2and
letH0,H1,...,Hq2be the 1-dimensional subspaces over Fq2.I fw e
considerVas a 4-dimensional vector space over Fq, the subspaces
Hiare 2-dimensional over Fq(they form a spread of lines inPG3(q);
see Theorem 24.3). Let Ube any 2-dimensional subspace over Fq
other than one of the Hi’s. ThenUmeets any Hiin{0}or in a
1-dimensional subspace over Fq.S a yUmeetsH0,H1,...,Hqinq
points each and Hq+1,Hq+2,...,Hq2in the zero vector only. Con-
sider the Fq-subspaces αUasαranges over the nonzero elements of
Fq2; since multiplying by the nonzero elements of FqﬁxesU, there
are only (q2−1)/(q−1) distinct such subspaces, say U0,U1,...,Uq.
Theseq+ 1 subspaces Uimeet pairwise only in the zero vector and
their union is H0∪H1∪···∪H q.T h u s
U0,U1,...,Uq,Hq+1,Hq+2,...,Hq2
is another partition of Vinto subgroups of order q2.
We shall not prove here that the projective planes resulting from
this construction are not Desarguesian (for q>2). See Theorem
10.9 in D. R. Hughes and F. C. Piper (1973). The reader can ﬁnd
counterexamples to Desargues’ theorem in Example 23.7 by hand.
We conclude the chapter with proof of an important step in the
diﬃcult proof of Theorem 23.6. We need a preliminary observation.
Proposition 23.11. The subgeometry on any ﬂat of a projective
geometry is again a projective geometry.Proof: That the modular law holds in the subgeometry on a ﬂat
of a modular projective geometry is immediate. We must show that
---PAGE BREAK---
322 A Course in Combinatorics
these subgeometries are connected. To this end, it will suﬃce to
show that if His a hyperplane in a projective geometry with point
setX, then the subgeometry on His connected.
If not,H=E∪FwhereEandFare ﬂats. By (23.4), rank( E)+
rank(F)=n−1 wheren:= rank(X). LetE1,...,EsandF1,...,Ft
be the ﬂats that cover EandF, respectively, that contain points
outside of H; each family partitions the points outside of H. Sup-
pose that both s,t≥2. By (23.4), there exists xi∈Ei∩Fi,i=1,2.
The line {x1,x2}, again by (23.4), meets Hin some point e∈E.
But thenx2, being on the line joining eandx1, must be contained
inE1, a contradiction. Thus one of sortmust be 1, say s= 1, and
thenXis the union of the disjoint ﬂats FandE1, contradicting
the connectivity of the original projective geometry. /square
A corollary of Proposition 23.11 is that every line of a projective
geometry has at least three points (since a two-point line is notconnected). This is used at a critical point in the proof below. Weremark that with the aid of Problem 23D, it is easy to see that alllines in a ﬁnite projective geometry have the same size n+1 .
Theorem 23.12. Desargues’ theorem holds in any projective ge-
ometry of rank ≥4.
Proof: Consider two triangles {a
1,b1,c1}and{a2,b2,c2}that are
perspective from a point x.
We ﬁrst assume that the planes P1andP2spanned by {a1,b1,c1}
and{a2,b2,c2}, respectively, are distinct. Let T:={x,a 1,b1,c1}.
The lines {x,a 1},{x,b 1}, and{x,c 1}contain, respectively, the
pointsa2,b2, andc2,s oP1andP2are contained in T, that evi-
dently has rank 4. So by the modular law, P1andP2must meet in
a lineL. We claim that the two original triangles are perspective
from the line L.
The plane Q:={p,a 1,b1}containsa2andb2and hence contains
both the lines {a1,b1}and{a2,b2}that therefore intersect in a point
q, say. The point qbelongs to both P1andP2, and hence q∈L.
Similarly, the lines {bi,ci},i=1,2, meet in a point on L; and the
lines{ai,ci},i=1,2, meet in a point on L. The two triangles are
thus perspective from L.
Now assume that the two original triangles lie in a plane P.
---PAGE BREAK---
23. Projective and combinatorial geometries 323
Letx1be any point not in Pandx2any other point on the line
containing x1andp. The lines {x1,a1}and{x2,a2}are contained
in the plane {p,x 1,a1}and so meet in a point a∗. Similarly, the
lines{x1,b1}and{x2,b2}meet in a point b∗and the lines {x1,c1}
and{x2,c2}meet in a point c∗. The plane P∗:={a∗,b∗,c∗}andP
are contained in a rank 4 ﬂat and so meet in a line L:=P∩P∗.
The triangles {a1,b1,c1}and{a∗,b∗,c∗}are perspective from the
pointx1and lie in diﬀerent planes, and so are perspective from the
lineL. Similarly, the triangles {a2,b2,c2}and{a∗,b∗,c∗}are per-
spective from x2, and so are perspective from L. The line {a1,b1}
meetsLin the same point as the line {a∗,b∗}; the line {a2,b2}meets
Lin the same point as the line {a∗,b∗}; hence the lines {a1,b1}and
{a2,b2}meet in a point of L. Similarly, the other corresponding
‘sides’ of the two original triangles meet in points of L. In summary,
the original triangles are perspective from the line L. /square
Problem 23I. Determine the number of ﬂats of rank n−kin the
partition lattice Π n.
Problem 23J. For an arbitrary block design (with parameters
v,k,λ,b,r ) we deﬁne a lineto be the intersection of all blocks con-
taining a pair of points x,y. Prove:
(i) Any two points are on a unique line;
(ii) IfLis a line, then 2 ≤|L|≤b−λ
r−λ;
(iii) If a line meets a block in two points, it is contained in the
block.
Notes.
Girard Desargues (1593–1662) was an architect and military engi-
neer who introduced the term involution in his work on perspective.
He worked in Lyons and Paris. The work of Pappus of Alexandria
(ﬂ. 320), the last signiﬁcant Greek geometer, was considerably ear-lier. The mathematical discipline of projective geometry did notdevelop until the 19th century.
Moritz Pasch was originally an algebraist but then became inter-
ested in non-euclidean geometry. He came to Giessen at the age of27 as Privatdozent and stayed there until his death (60 years later).He was Rektor of the university 1893–1894.
---PAGE BREAK---
324 A Course in Combinatorics
An interesting family of combinatorial geometries called transver-
sal geometries arises from bipartite graphs; see Crapo and Rota
(1970). The independent sets of these geometries are those subsetsof one part Xof a bipartition ( X,Y) with the property that they
can be matched into Y.
We have seen that the concept of combinatorial geometries and
geometric lattices are ‘cryptomorphic’, i.e. they are essentially dif-ferent axiom systems for the same structures. Crapo and Rota(1970) give further cryptomorphic versions. For example, ‘ma-troids’ are more-or-less the same thing as combinatorial geometries,though the emphasis of the theory of matroids is diﬀerent.
Some characterizations of the symmetric design consisting of the
points and hyperplanes of a ﬁnite projective space may be foundin Section 2.1 of P. Dembowski (1968).
References.
J. Andr´ e (1954), ¨Uber nicht-Desarguessche Ebenen mit transitiver
Translationgruppe, Math. Zeitschr. 60, 156–186.
L. M. Batten (1986), Combinatorics of Finite Geometries , Cam-
bridge University Press.
H. Crapo and G.-C. Rota (1970), Combinatorial Geometries , MIT
Press.
P. Crawley and R. P. Dilworth (1973), Algebraic Theory of Lattices ,
Prentice-Hall.
P. Dembowski (1968), Finite Geometries , Springer-Verlag.
C. Greene (1970), A rank inequality for ﬁnite geometric lattices, J.
Combinatorial Theory 9, 357–364.
M. Hall, Jr. (1972), The Theory of Groups , 2nd edn., Chelsea.
D. R. Hughes and F. C. Piper (1973), Projective Planes, Springer-
Verlag.
D. Pedoe (1963), An Introduction to Projective Geometry , Macmil-
lan.
O. Veblen and J. W. Young (1907), Projective Geometries (2 vols.),
Ginn Co.
---PAGE BREAK---
24
Gaussian numbers and
q-analogues
There exist many analogies between the partially ordered set of all
subsets of a ﬁnite set and the partially ordered set of all subspacesof a ﬁnite vector space. This is primarily because they are bothexamples of ‘matroid designs’ as deﬁned in the previous chapter.LetV
n(q) denote an n-dimensional vector space over the ﬁeld Fq
ofqelements. We use the term k-subspace as a short form of k-
dimensional subspace.
We begin with some counting. To obtain a maximal chain (i.e.
a chain of size n+ 1 containing one subspace of each possible di-
mension) in the partially ordered set of all subspaces of Vn(q), we
start with the 0-subspace. After we have chosen an i-subspace Ui,
0≤i<n , we can choose an ( i+ 1)-subspace Ui+1that contains
Uiin (qn−qi)/(qi+1−qi) ways since we can take the span of Ui
and any of the ( qn−qi) vectors notinUi—but any ( i+1)-subspace
will arise exactly (qi+1−qi) times in this manner. In summary, the
number of maximal chains of subspaces in Vn(q)i s
M(n,q)=(qn−1)(qn−1−1)(qn−2−1)···(q2−1)(q−1)
(q−1)n.
We may consider M(n,q) as a polynomial in qfor each integer
n. When the indeterminate qis replaced by a prime power, we
have the number of maximal chains in the poset PGn(q). When
qis replaced by 1, we have M(n,1) =n!, which is the number of
maximal chains in the poset of subsets of an n-set.
TheGaussian number/bracketleftbign
k/bracketrightbig
qcan be deﬁned as the number of k-
subspaces of Vn(q). These are called Gaussian coeﬃcients by some
---PAGE BREAK---
326 A Course in Combinatorics
authors to emphasize the analogy with binomial coeﬃcients. To
ﬁnd an expression for/bracketleftbign
k/bracketrightbig
q, we count the number Nof pairs (U,C)
whereUis ak-subspace and Cis a maximal chain that contains
U. Of course, every maximal chain contains exactly one subspace
of dimension k,s oN=M(n,q). On the other hand, we get each
such maximal chain uniquely by appending to a maximal chainin the partially ordered set of all subspaces of U, of which there
areM(k,q), a maximal chain in the partially ordered set of all
subspaces of V
n(q) that contain U; there are M(n−k,q) of these,
since the partially ordered set {W:U⊆W⊆V}is isomorphic to
the partially ordered set of subspaces of the factor space V/U that
has dimension n−k.T h u s
/bracketleftBign
k/bracketrightBig
q=M(n,q)
M(k,q)M(n−k,q)=(qn−1)(qn−1−1)···(qn−k+1−1)
(qk−1)(qk−1−1)···(q−1).
For some purposes, it is better to think of/bracketleftbign
k/bracketrightbig
qas apolynomial
in an indeterminate qrather than as a function of a prime power
q. That the rational function above is in fact a polynomial can
be seen in several ways. For example, it is an easy exercise to seethat a rational function in xwhich is integral for inﬁnitely many
integral values of xmust be a polynomial in x. Perhaps Gaussian
polynomial is a better term than Gaussian number orcoeﬃcient.
As an example,
/bracketleftbigg6
3/bracketrightbigg
q=q9+q8+2q7+3q6+3q5+3q4+3q3+2q2+q+1.
When the indeterminate qis replaced by 1 in/bracketleftbign
k/bracketrightbig
q, we obtain/parenleftbign
k/parenrightbig
. This explains a small part of a tendency for results concerning
ﬁnite vector spaces to reduce to the corresponding results for sets
whenqis replaced by 1. It is also possible to have so-called q-
analoques of results on sets where we try to replace ‘k -subset’ by
‘k-subspace’. Sometimes these statements are true and have proofs
that are similar to the results on sets.
The following is the q-analogue of Sperner’s theorem, Theorem
6.3.
---PAGE BREAK---
24. Gaussian numbers and q-analogues 327
Theorem 24.1. IfAis an antichain in the partially ordered set
of all subspaces of Vn(q), then
|A| ≤/bracketleftbiggn
⌊n/2⌋/bracketrightbigg
q.
Proof: LetAbe an antichain and count the number Nof pairs
(U,C) whereU∈A andCis a maximal chain that contains U.
Every maximal chain contains at most one subspace in A,s oN≤
M(n,q). On the other hand, each k-subspace in Alies in exactly
M(k,q)M(n−k,q) maximal chains C.T h u s
M(n,q)≥N=n/summationdisplay
k=0ckM(k,q)M(n−k,q),
whereckis the number of k-dimensional subspaces belonging to
A. The proof is completed in a manner analogous to the proof of
Theorem 6.3 if we believe that/bracketleftbign
k/bracketrightbig
q≤/bracketleftBig
n
⌊n/2⌋/bracketrightBig
qfor allk, and this is
left to the reader to verify. /square
The following theorem gives a combinatorial interpretation of the
coeﬃcients of the/bracketleftbign
k/bracketrightbig
qas a polynomial in q, and thus proves they
are all positive integers.
Theorem 24.2. Let
/bracketleftBign
k/bracketrightBig
q=k(n−k )/summationdisplay
plscript=0aplscriptqplscript.
Thenthecoeﬃcient aplscriptisthenumberofpartitionsof plscriptwhoseFerrers
diagrams ﬁt in a box of size k×n−k.
Proof: We can work with the vector space Fn
qofn-tuples over
Fq. It is well known that every k-subspace of Fn
qarises uniquely as
the rowspace of a k×nmatrix over Fqthat (i) has rank kand
(ii) is a so-called row-reduced echelon form . This means that the
ﬁrst nonzero entry in each row is a 1, the entries above a leading 1
are 0’s, and the leading 1 in row iis further to the right than the
leading 1 in row i−1,i=2,3,...,k .
---PAGE BREAK---
328 A Course in Combinatorics
Suppose the leading 1 in row ioccurs in column ci,i=1,2,...,k .
Then (n−k+1−c1,n−k+2−c2,...,n−1−ck−1,n−ck) is a non-
increasing sequence of nonnegative numbers and so, when terminal
zeros are dropped, corresponds to a partition of some number intoat mostkparts of size at most n−k. Conversely, such a partition
gives us the positions of leading ones in a class of echelon forms.
For example, there are 20 classes of echelon forms in the case
n=6 ,k= 3; see Fig. 24.1.
/bracketleftbigg
100•••
010•••001•••/bracketrightbigg/bracketleftbigg10• 0••
01• 0••
0001••/bracketrightbigg/bracketleftbigg10••0 •
01••0 •
00001•/bracketrightbigg/bracketleftbigg10•••001•••0000001/bracketrightbigg/bracketleftbigg1•00••
0010••0001••/bracketrightbigg
/bracketleftbigg1•0•0•
001• 0•
00001•/bracketrightbigg/bracketleftbigg1•0••0
001••0000001/bracketrightbigg/bracketleftbigg1••00•
00010•00001•/bracketrightbigg/bracketleftbigg1••0•0
0001• 0
000001/bracketrightbigg/bracketleftbigg1•••00
000010000001/bracketrightbigg
/bracketleftbigg0100••0010••0001••/bracketrightbigg/bracketleftbigg010• 0•
001• 0•
00001•/bracketrightbigg/bracketleftbigg010••0001••0000001/bracketrightbigg/bracketleftbigg01• 00•
00010•00001•/bracketrightbigg/bracketleftbigg01• 0•0
0001• 0
000001/bracketrightbigg
/bracketleftbigg01••00000010000001/bracketrightbigg/bracketleftbigg00100•00010•00001•/bracketrightbigg/bracketleftbigg0010• 0
0001• 0
000001/bracketrightbigg/bracketleftbigg001• 00
000010000001/bracketrightbigg/bracketleftbigg000100000010000001/bracketrightbigg
Figure 24.1
In each matrix of Fig. 24.1, the positions of the dots, when the
intervening columns are deleted and we reﬂect through a verticalaxis, describe the Ferrers diagram of a partition (of some number≤9) that ﬁts ina3b y3b o x . T h e class represented by the last
matrix in the ﬁrst row, for example, contains q
7echelon forms.
In general, the class of echelon forms where the leading 1 in row
ioccurs in column ci,i=1,2,...,k , contains qplscriptmatrices for some
plscriptsince the positions not containing 1’s or required to be 0’s may
be ﬁlled arbitrarily with elements of Fq. To be precise,
plscript=(n−k+1−c1)+··· +(n−1−ck−1)+(n−ck)
because for each i=1,2,...,k , there are n−(k−i)−cipositions
in thei-th row that may be arbitrarily ﬁlled. That is, the class
consists of qplscriptmatrices where the partition into at most kparts of
---PAGE BREAK---
24. Gaussian numbers and q-analogues 329
size at most n−kthat corresponds to the class is in fact a partition
of the number plscript.
Thus when aplscriptisdeﬁned as the number of partitions of plscriptwhose
Ferrers diagrams ﬁt in a box of size k×n−k, we have a polynomial/summationtextk(n−k )
plscript=0aplscriptqplscriptthat agrees with the polynomial/bracketleftbign
k/bracketrightbig
qwhen evaluated
at any prime power q; hence the two polynomials are equal. /square
We remark that when we set q= 1 in the statement of Theorem
24.2, we obtain as a corollary the result that the total number of
partitions whose Ferrers diagram ﬁts in a box of size k×n−kis/parenleftbign
k/parenrightbig
.
Problem 24A. Show this directly.
Next, we derive a recursion (24.1) for the Gaussian numbers.
This provides another way to see that they are polynomials in q
(by induction on n, say). Pick a hyperplane H, i.e. an (n−1)-
subspace, of Vn(q). Somek-subspaces are contained in H(their
number is/bracketleftbign−1
k/bracketrightbig
q) and the rest meet Hi na(k−1)-subspace. Each
of the/bracketleftbign−1
k−1/bracketrightbig
q(k−1)-subspaces in His contained in
/bracketleftbiggn−k+1
1/bracketrightbigg
q=qn−k+1−1
q−1
k-subspaces of V, of which
/bracketleftbiggn−k
1/bracketrightbigg
q=qn−k−1
q−1
are contained in H; this leaves qn−kthat are not contained in H.
Thus
(24.1)/bracketleftBign
k/bracketrightBig
q=/bracketleftbiggn−1
k/bracketrightbigg
q+qn−k/bracketleftbiggn−1
k−1/bracketrightbigg
q.
Problem 24B. Determine the exponents ei(they may be func-
tions ofm,n, andkas well as i) so that the following identity is
valid:
/bracketleftBign+m
k/bracketrightBig
q=k/summationdisplay
i=0qei/bracketleftBign
i/bracketrightBig
q/bracketleftBigm
k−i/bracketrightBig
q.
---PAGE BREAK---
330 A Course in Combinatorics
(One way to solve this involves echelon forms; another uses (24.1).)
The equation of Problem 24B is a q-analoque of the equation
/parenleftbiggn+m
k/parenrightbigg
=k/summationdisplay
i=0/parenleftbiggn
i/parenrightbigg/parenleftbiggm
k−i/parenrightbigg
for binomial coeﬃcients. The q-analogue of inclusion-exclusion ap-
pears in the next chapter; see Theorem 25.2 for an application.
What is the q-analogue of (simple) t-designs? This would be
a family Bofk-subspaces of Vv(q) such that each t-subspace is
contained in exactly λmembers of B. No nontrivial examples of
such ‘q -Sλ(t,k,v )’s’ were known with t≥2 until 1986 when S.
Thomas described a family with
q=2,λ =7,t=2,k=3,v≡±1( m o d 6 ) .
The caset=λ= 1 is already nontrivial for vector spaces. For
sets, anS(1,k,v ) is a partition of a v-set intok-subsets, and this
exists if and only if kdividesv.
Theorem 24.3. Thereexistsafamilyof k-subspacesof Vv(q)such
that every 1-subspace is contained in exactly one member of the
family (aso-called spreadofk-subspaces )ifandonlyif kdividesv.
Proof: In other words, we are interested in families of k-subspaces
such that any two of them intersect in the 0-subspace but such that
their union is the entire v-dimensional vector space.
The number of k-subspaces that we require is the total number
of nonzero vectors divided by the number of nonzero vectors in ak-subspace, and this is ( q
v−1)/(qk−1). This is an integer if and
only ifkdividesv.
Supposev=kmwheremis an integer. As a v-dimensional
vector space over Fq,w et a k ea nm-dimensional vector space V
overFqk. LetBbe the family of 1-subspaces of Vas a vector space
overFqk. (So there are qk(m−1)+qk(m−2)+···+qk+ 1 of these and
each contains qkvectors.) Now think of Vas a vector space over
Fq, a subﬁeld of Fqk; the members of Barek-dimensional subspaces
overFqand provide the required partition. /square
---PAGE BREAK---
24. Gaussian numbers and q-analogues 331
Problem 24C. LetBbe a spread of k-subspaces in Vv(q). LetA
consist of all cosets of all members of B. Show that Ais the block
set of anS(2,qk,qv) on the set of points Vv(q). (The case v=2k
is particularly interesting because we obtain aﬃne planes of order
qk. Planes obtained from spreads are called translation planes.)
Problem 24D. Prove that
n/summationdisplay
k=0(qn−1)...(qn−k+1−1)q(k
2)/bracketleftBign
k/bracketrightBig
q=qn2.
The Erd˝ os-Ko-Rado Theorem (see Theorem 6.4) can be formu-
lated in two (equivalent) ways. In one formulation, the bound for
mis/parenleftbign−1
k−1/parenrightbig
and in the other it isk
n·/parenleftbign
k/parenrightbig
, where/parenleftbign
k/parenrightbig
counts the total
number of k-subsets of the n-set.
Now consider a possible q-analogue. Start with a collection A:=
{A1,A2,...,Am}ofmdistinctk-dimensional subspaces of the n-
dimensional vectorspace V(n,q) over Fqsuch that any two of the
Aiintersect in a subspace of dimension ≥1. Then one can either
conjecture that if k≤1
2n
m≤/bracketleftbigg
n−1
k−1/bracketrightbigg
qorm≤k
n·/bracketleftbigg
n
k/bracketrightbigg
q.
In this case, the bounds diﬀer. The ﬁrst one is stronger than the
second one. For a proof of the ﬁrst bound see W. N. Hsieh (1975).This result was strengthened by P. Frankl and R. M. Wilson (1986).The second bound can be proved by generalizing the proof of The-orem 6.4 which is the next problem.
Problem 24E. Consider the situation described above. Let π:=
(x
1,x2,...,xn) run through the set Bnofallordered bases of V(n,q).
We place πon a circle. If a sequence of kconsecutive vectors xi
(on the circle) is a basis for Aj,w es a yA j∈π.
(i) Show that for a ﬁxed π,w eh a v e|A∩ π|≤k.
(ii) For a ﬁxed Aj, count the number of bases π∈Bnsuch that
Aj∈π.
(iii) Prove that
m≤k
n·/bracketleftbigg
n
k/bracketrightbigg
q.
---PAGE BREAK---
332 A Course in Combinatorics
Notes.
It has been suggested that one should use the notation nq.for
M(n,q) (which is to be pronounced ‘nq -torial’). Then we have
/bracketleftBign
k/bracketrightBig
q=nq.
kq.(n−k)q..
Also note
lim
q→1nq.=n1.(that is,n!).
We do not know who ﬁrst proposed this.
Theq-analogue of Ramsey’s theorem was a long outstanding
problem until it was solved by R. L. Graham, K. Leeb, and B.
L. Rothschild in 1972.
Carl Friedrich Gauss (1777–1855) was possibly the greatest math-
ematician (scientist) of all time. He made extremely importantcontributions to number theory. He was the ﬁrst to study proper-ties of the expressions that are now called Gaussian polynomials orGaussian numbers.
References.
P. Frankl and R. M. Wilson (1986), The Erd˝ os-Ko-Rado theorem
for vector spaces, J. Combinatorial Theory (A)43, 228–236.
R. L. Graham, K. Leeb, B. L. Rothschild (1972), Ramsey’s theorem
for a class of categories, Adv. Math. 8, 417–433.
R. L. Graham, B. L. Rothschild, and J. Spencer (1980), Ramsey
Theory , Wiley.
W. N. Hsieh (1975), Intersection theorems for systems of ﬁnite
vector spaces, Discrete Math .12, 1–16.
S. Thomas (1986), Designs over ﬁnite ﬁelds, Geometriae Dedicata
24, 237–242.
---PAGE BREAK---
25
Lattices and M¨ obius inversion
One of the techniques belonging to the foundations of combinatorics
is the principle of M¨ obius inversion over partially ordered sets. Thiscan be thought of as a generalization of inclusion-exclusion as wellas an extension of the inversion with the classical M¨ obius functionof number theory, which was discussed in Chapter 10.
LetPbe a ﬁnite partially ordered set. We will consider matrices
αwhose rows and columns are indexed by the elements of P, that
is mappings from P×Pto the rationals or complex numbers. The
incidence algebra A(P) consists of all matrices αsuch thatα(x,y)=
0 unlessx≤yinP. By the deﬁnition of matrix multiplication,
(αβ)(x,y )=/summationdisplay
z∈Pα(x,z)β(z,y).
Ifα,β∈A(P), then the above sum need be extended over only
thosezin the interval [x,y ]: ={x≤z≤y}. It is easily seen that
A(P) is closed under multiplication, as well as addition and scalar
multiplication.
An element of A(P) that will play an important role in the fol-
lowing theory is ζ(thezeta function ofP) which is deﬁned by
ζ(x,y)=/braceleftbigg1i fx≤yinP,
0 otherwise.
We claim that ζis invertible and that its inverse, which is called
theM¨ obius function ofPand is denoted by µ, is integral and lies
inA(P).
This is simple to verify. The equation µζ=I(the identity)
---PAGE BREAK---
334 A Course in Combinatorics
requires that
(25.1)/summationdisplay
x≤z≤yµ(x,z )=/braceleftbigg1i fx=y,
0 otherwise ,
and this can be ensured by simply deﬁningµinductively, by declar-
ingµ(x,x ): =1 ,µ(x,y): =0i fx/notlessequaly, and
(25.2) µ(x,y): =−/summationdisplay
x≤z<yµ(x,z) forx<y inP.
For example, when P={1,2,3,4,6,12}, the lattice of all (positive)
divisors of the integer 12,
ζ=
111111
010111001011000101000011000001
,µ
=
1−1−10 1 0
01 0 −1−11
00 1 0 −10
00 0 1 0 −1
00 0 0 1 −1
0 00001
.
The top row of µwas computed as follows:
µ(1,1 )=+ 1,
µ(1,2) =−µ(1, 1) =−1,
µ(1,3) =−µ(1, 1) =−1,
µ(1,4) =−µ(1, 1)−µ(1,2 )=0,
µ(1,6) =−µ(1, 1)−µ(1,2)−µ(1,3 )=+ 1,
µ(1,12) =−µ(1, 1)−µ(1,2)−µ(1,3)−µ(1,4)−µ(1,6 )=0.
We remark that a somewhat diﬀerent equation concerning µre-
sults if we consider instead the relation ζµ=I:
(25.3)/summationdisplay
x≤z≤yµ(z,y )=/braceleftbigg1i fx=y,
0 otherwise.
Another much more complicated way of looking at the matter
of the invertibility of ζis as follows. We ﬁrst remark that a ﬁnite
---PAGE BREAK---
25. Lattices and M¨ obius inversion 335
partial order can always be ‘dominated’ by a total order; that is,
there exists an indexing P={x1,x2,...,xn}such that xi≤xjin
Pimplies that i≤j. (Proof: Let xbe any maximal element of P,
indexP\{x} by induction, and put xat the end.) With respect to
such an indexing of P, the matrices in A(P) are upper triangular.
The zeta function has 1’s on the diagonal and so has determinant 1and hence an integral inverse by Cramer’s formula. Then ζ
−1=µ
lies in A(P) because the inverse of any matrix (or element of a
ﬁnite–dimensional commutative algebra) is a polynomial in thatmatrix (or element).
The equation (25.2) implies that µ(x,y)=−1i fx⋖y. Also note
thatµ(x,y )=k−1 if the interval [ x,y]i sak -point line, i.e. the
interval consists of x,y, andkpairwise noncomparable elements
z
1,...,zk, each with x⋖zi⋖y.
In the following theorem, we list the values of the M¨ obius function
of some common partially ordered sets. The proof of Theorem 25.1will not be given until the end of the chapter because we wish totalk about the implications of M¨ obius inversion ﬁrst. Clever and/orindustrious readers will be able to prove some parts of Theorem25.1 with the recursion (25.2) and simple induction arguments, butwe prefer to wait until we have Weisner’s theorem, Theorem 25.3,available. We do not prove part (v) here—see the notes.
Theorem 25.1. (i)For the lattice of all subsets of an n-setX,
µ(A,B )=/braceleftbigg(−1)
|B|−|A|ifA⊆B,
0otherwise.
(ii)For the lattice of all (positive) divisors of an integer n,
µ(a,b)=/braceleftbigg(−1)rifb
ais the product of r distinct primes,
0otherwise, i.e. if a/notbarborb
ais not squarefree.
(That is,µ(a,b)=µ(b
a)where the latter µis the classical function
of a single variable in (10.8).)
(iii)Forthelatticeofallsubspacesofaﬁnite-dimensionalvector
spaceVover the ﬁeld Fqofqelements,
µ(U,W )=/braceleftBigg
(−1)kq(k
2)ifU⊆Wanddim(W )−dim(U )=k,
0ifU/notsubseteqlW.
---PAGE BREAK---
336 A Course in Combinatorics
(iv)For the lattice Πnof all partitions of an n-setX,
µ(A,B)=(−1)|A|−|B|/productdisplay
B∈B(nB−1)!
for elements AandBofΠnwithALprecedesequalB, wherenBdenotes the
number of blocks of Athat are contained in a block BofB.
(v)For the lattice of faces of a convex polytope,
µ(A,B )=/braceleftbigg(−1)dim(B )−dim(A)ifA⊆B,
0 otherwise.
We now state the principle of M¨ obius inversion . Let P be a ﬁnite
partially ordered set and µits M¨ obius function. Let f,g,h :P→R
(or into any additive group) be functions such that the relations
g(x)=/summationdisplay
a:a≤xf(a) and h(x)=/summationdisplay
b:b≥xf(b)
hold for all x∈P. Then, for all x∈P,
(25.4) f(x)=/summationdisplay
a:a≤xµ(a,x)g(a),
and
(25.5) f(x)=/summationdisplay
b:b≥xµ(x,b)h(b).
These are readily veriﬁed by direct substitution. For example, the
right-hand side of (25.4) is
/summationdisplay
a:a≤xµ(a,x )/parenleftBigg/summationdisplay
b:b≤af(b)/parenrightBigg
=/summationdisplay
b:b≤xf(b)/parenleftBigg/summationdisplay
a:b≤a≤xµ(a,x )/parenrightBigg
.
But the inner sum on the right is zero by (25.3) unless b=x, so only
the termf(x) survives. Or, in matrix notation (when we regard
---PAGE BREAK---
25. Lattices and M¨ obius inversion 337
f,g, andhas row or column vectors—whichever is appropriate—
whose coordinates are indexed by P), the relations assumed for g
andhare equivalent to g=ζf,s of=µg, andh=fζ,s of=hµ.
When the principle of M¨ obius inversion is applied to the lattice of
subsets of a set X, we recover inclusion-exclusion. Let (A i:i∈I)
be a ﬁnite family of subsets of a ﬁnite set X.F o rJ⊆I, letf(J)
equal the number of elements of Xthat belong to exactly the sets
Ajwithj∈Jand to no others. (Think of the size of one of the
regions in a Venn diagram of the sets.) Let g(J) equal the number
of elements in ∩j∈JAj. Theng(J)=/summationtext
K:J⊆Kf(K), so M¨ obius
inversion gives
f(J)=/summationdisplay
K:J⊆K(−1)|K\J|g(K).
In the case J=∅, the above can be written
|X−/uniondisplay
i∈IAi|=/summationdisplay
K⊆I(−1)|K||/intersectiondisplay
j∈KAj|,
which is a cryptic way of stating inclusion-exclusion.
When the principle of M¨ obius inversion is applied to the lattice of
(positive) divisors of an integer n, we recover the classical number-
theoretic M¨ obius inversion. If fandgsatisfy
g(m)=/summationdisplay
k|mf(k) for all mdividingn,
then M¨ obius inversion gives
f(m)=/summationdisplay
k|mµ(k,m)g(k) for all mdividingn,
and this, in view of Theorem 25.1(ii), is equivalent to Theorem
10.4.
We give a q-analogue of Example 10.2, where we used inclusion-
exclusion to ﬁnd the expression/summationtextm
k=0(−1)m−k/parenleftbigm
k/parenrightbig
knfor the number
of surjections from an n-set to an m-set.
---PAGE BREAK---
338 A Course in Combinatorics
Theorem 25.2. The number of surjective linear transformations
from ann-dimensional vector space to an m-dimensional vector
spaceVoverFqis
m/summationdisplay
k=0(−1)m−k/bracketleftBigm
k/bracketrightBig
qqnk+(m−k
2).
Proof: For a subspace U⊆V, letf(U) denote the number of
linear transformations whose image is U. Letg(U) denote the
number of linear transformations whose image is contained in U.
Clearly,
g(U)=/summationdisplay
W:W⊆Uf(W)
andg(U)i sqnrif dim(U)=r.B yM ¨ obius inversion on the lattice
of subspaces of V,
f(U)=/summationdisplay
W:W⊆Uµ(W,U )qndim(W).
TakeU=Vand use Theorem 25.1(iii) to produce the stated result.
/square
Corollary. The number of n×mmatrices over the ﬁeld Fqthat
have rank ris
/bracketleftBigm
r/bracketrightBig
qr/summationdisplay
k=0(−1)r−k/bracketleftBigr
k/bracketrightBig
qqnk+(r−k
2).
We note that the number of injective linear transformations has
a relatively simple form. If we ﬁx a basis for an n-dimensional
vector space and consider injections into an m-dimensional vector
space, the image of the i-th basis vector must be chosen as one of
the (qm−qi−1) vectors not in the span of the images of the previous
basis vectors. In summary, there are (qm−1)(qm−q)···(qm−qn−1)
injective linear transformations. Since Theorem 25.2 with m=n
also gives an expression for this number, we have proved an identity.
---PAGE BREAK---
25. Lattices and M¨ obius inversion 339
Problem 25A. (i) Use M¨ obius inversion to derive an expression
for the number of k-subspaces that meet trivially a given r-subspace
of ann-dimensional vector space over Fq. This should give a q-
analogue to Eq. (10.5). (ii) For the special case when r+k=n,
show, from another point of view, that there are exactly qrksuch
subspaces by consideration of r×nmatrices over Fqof the form
(IM ), whereIis an identity of order r.
Problem 25B. Use M¨ obius inversion to derive an expression for
the number of nonsingular linear mappings of an n-dimensional
vector space over Fqto itself that ﬁx no vectors other than 0, i.e.
that do not have 1 as an eigenvalue. (These will be orthomorphisms
of the additive group; see the Remarks following Theorem 22.9.)
***
The partially ordered sets mentioned in the statement of Theo-
rem 25.1 are all lattices. The following useful theorem was foundby L. Weisner (1935).
Theorem 25.3. LetµbetheM¨ obiusfunctionofaﬁnitelattice L
and leta∈Lwitha>0
L. Then
/summationdisplay
x:x∨a=1Lµ(0L,x)=0.
Proof: Fixaand consider
S:=/summationdisplay
x,y∈Lµ(0,x)ζ(x,y)ζ(a,y)µ(y,1) =/summationdisplay
x∈L/summationdisplay
y≥x,
y≥aµ(0,x )µ(y,1).
Now on the one hand,
S=/summationdisplay
xµ(0,x )/summationdisplay
y≥x
y≥aµ(y,1);
buty≥aandy≥xif and only if y≥x∨a,and the inner sum is
/summationdisplay
y≥x∨aµ(y,1) =/braceleftbigg1i fx∨a=1,
0i fx∨a<1.
---PAGE BREAK---
340 A Course in Combinatorics
ThusSis the sum in the statement of the theorem. On the other
hand,
S=/summationdisplay
y≥aµ(y,1)/summationdisplay
0≤x≤yµ(0,x ),
and the inner sum is always 0 since y>0. /square
Corollary. For elements x,yof a geometric lattice Lwithx≤y,
µ(x,y )has sign (−1)rank(y)−rank(x)and, in particular, is never 0.
Proof: We show that µ(0L,1L) has sign (−1)rank(L)by induction
on the rank of L. Pick a point p∈L. By semimodularity, a∨p=1L
if and only if a=1Lorais a copoint not on p; so Weisner’s theorem,
Theorem 25.3, gives
(25.6) µ(0L,1L)=−/summationdisplay
h:h⋖1 L,h/notgreaterequalpµ(0L,h).
Since all terms on the right-hand side have sign ( −1)rank(L)−1by the
induction hypothesis, the proof is complete. /square
The number of proper colorings χG(x) of a graph Gwithxcolors
can be found by M¨ obius inversion on the lattice L(G) introduced
in Chapter 23, although this is not necessarily a very practical
method. Recall that the elements of L(G) are the partitions Aof
the vertex set of G, all of whose blocks induce connected subgraphs
ofG.F o rAinL(G), letg(A) denote the number of mappings
from the vertex set of Ginto a set of xcolors (i.e. colorings) so
that all vertices in each blo ck ofAreceive the same color. Clearly,
g(A)=x|A|. Letf(A) denote the number of mappings that are
constant on each block of A, but such that the endpoints of edges
joining distinct blocks of Areceive diﬀerent colors. Given a coloring
‘counted by’ g(A), a moment’s thought shows that there is a unique
coarser partition Bso that the coloring is ‘counted by’ f(B) (one
must coalesce two blocks of Aof the same color if an edge joins
them). Thus, g(A)=/summationtext
BLfollowsequalAf(B), so M¨ obius inversion gives
f(A)=/summationdisplay
BLfollowsequalAµ(A,B)g(B).
---PAGE BREAK---
25. Lattices and M¨ obius inversion 341
The number of proper colorings is fevaluated on 0 L(G)(the parti-
tion into singletons), and this is
χG(x)=/summationdisplay
Bµ(0L(G),B)x|B|=n/summationdisplay
k=1
/summationdisplay
|B|=kµ(0L(G),B)x
k.
The polynomial χG(x) is called the chromatic polynomial of the
graph. The corollary above leads directly to the following state-
ment.
Theorem 25.4. Thenumberofpropercoloringsofagraph Gonn
vertices in xcolors is given by a monic polynomial χG(x)of degree
nwhose coeﬃcients alternate in sign.
Problem 25C. LetGbe a simple graph with nvertices and m
edges. Show that the coeﬃcient of xn−1inχG(x)i s−m, and that
the coeﬃcient of xn−2ism(m−1)/2 minus the number of triangles
inG.
T. Dowling and R. M. Wilson (1975) proved the following the-
orem and its corollary, the latter being a generalization of the in-
equality of Theorem 19.1 on linear spaces.
Theorem 25.5. IfLis a ﬁnite lattice so that µ(x,1L)Lnegationslash=0for all
x∈L, then there exists a permutation πof the elements of Lso
thatx∨π(x)=1 Lfor allx∈L.
Proof: Before we begin the proof, we remark that an example
of a lattice that does not satisfy our hypothesis is a chain with
more than two elements. And, of course, there is no permutationπwith the property stated above. On the other hand, the lattice
of all subsets of an n-set admits a unique permutation with the
property above, namely the permutation that takes each subset toits complement.
All matrices here will have rows and columns indexed by L. Let
η(x,y): =/braceleftbigg1i fx∨y=1
L,
0 otherwise.
---PAGE BREAK---
342 A Course in Combinatorics
Letδ1be the diagonal matrix with δ1(x,x): =µ (x,1L). Then
ζδ1ζLlatticetop=ηbecause
ζδ1ζLlatticetop(x,y)=/summationdisplay
a,bζ(x,a)δ1(a,b)ζ(y,b)
=/summationdisplay
a:a≥x anda≥yδ1(a,a)
=/summationdisplay
a:a≥x∨yµ(a,1L)
and the last sum is, by (25.1), 1 if x∨y=1L, and 0 otherwise.
Under our hypothesis that µ(x,1L)Lnegationslash= 0, the matrix δ1is nonsin-
gular. Since ζis nonsingular too, we conclude that ηis also. Hence
some term in its determinant expansion does not vanish, and this
implies the conclusion of the theorem. /square
Corollary. In a ﬁnite geometric lattice of rank n, the number of
elementsofrank ≥n−kisatleastthenumberofelementsofrank
≤k,0≤k≤n.
Proof: Consider a permutation πas in Theorem 25.5 (which ap-
plies because of the Corollary to Theorem 25.3). The semimodularlaw
rank(x) + rank( π(x))≥rank(x∨π(x)) + rank( x∧π(x))≥n
implies that the image of an element of rank ≤kis one of rank
≥n−k. /square
We give a similar matrix proof of a theorem of T. Dowling (1977)
oncomplementing permutations below.
Theorem 25.6. IfLis a ﬁnite lattice such that µ(x,1
L)Lnegationslash=0and
µ(0L,x)Lnegationslash=0for allx∈L, then there exists a permutation πof the
elements of Lso that
x∨π(x)=1Landx∧π(x)=0L
for allx∈L.
Proof: Letδ1be as in the proof of the previous theorem and let
δ0be the diagonal matrix with δ0(x,x): =µ(0L,x). Now consider
---PAGE BREAK---
25. Lattices and M¨ obius inversion 343
κ:=ζδ1ζLlatticetopδ0ζ. Our hypotheses imply that κis nonsingular. We
claim that κ(x,y ) = 0 unless xandyare complements. Then any
permutation corresponding to a nonvanishing term in the determi-
nant expansion of κwill be a complementing permutation.
To establish our claim, ﬁrst note that κ=ηδ0ζ,s o
κ(x,y )=/summationdisplay
z:z∨x=1L,z≤yµ(0L,z).
If this sum is not zero, then there exists some zwithz∨x=1L
andz≤y, which implies that y∨x=1L. By duality, ηLprime=ζLlatticetopδ0ζ,
where
ηLprime(x,y): =/braceleftbigg1i fx∧y=0L,
0 otherwise.
Now note that κ=ζδ1ηLprimeand, similarly, κ(x,y )Lnegationslash= 0 will imply that
x∧y=0L. /square
Finally, we give the proof we promised at the beginning of the
chapter.
Proof of Theorem 25.1: (i) Since the interval [A,B ] is isomor-
phic to the lattice of subsets of B\A, it suﬃces to show µ(∅,C )=
(−1)|C|. We use the equation (25.6) and proceed by induction on
|C|. Letpb eap o i n to f C. There is only one copoint not on p,
namely the complement of {p}. So (25.6) implies that
µ(∅,C)=−µ(∅,C \{p})=−(−1)(|C|−1)=(−1)|C|.
(ii) Again, it will suﬃce to calculate µ(1,m ), and we use induc-
tion onm. Letpbe a prime divisor of m. Weisner’s theorem
asserts
µ(1,m)=−/summationdisplay
lcm(a,p)=m,a<mµ(0,a).
Ifp2dividesm, then the sum on the right is empty, and thus
µ(1,m )=0 . I f p2does not divide m, then there is one term,
namely when a=m/p.
---PAGE BREAK---
344 A Course in Combinatorics
(iii) It will suﬃce to show that µ(0,V )=(−1)kq(k
2)forVof
dimension k. We proceed by induction on k. LetPb ea1 -
dimensional subspace of V. By Weisner’s theorem,
µ(0,V )=−/summationdisplay
U:U∨P=V,ULnegationslash=Vµ(0,U ).
By the induction hypothesis, each term µ(0,U) in the above sum
is equal to (−1)k−1q(k−1
2). The only subspaces Uother than Vsuch
thatU∨P=Vare thoseUof dimension k−1 that do not contain
P; their number is
/bracketleftbiggk
1/bracketrightbigg
q−/bracketleftbiggk−1
1/bracketrightbigg
q=qk−1.
This completes the proof of part (iii).
(iv) Consider two partitions AandBwithALprecedesequalB .S a yBhask
blocks that, when numbered, are the unions of n1,n2,...,nkblocks
ofA, respectively. Then the interval [ A,B] is isomorphic to the
direct product of partition lattices
Πn1×Πn2×···×Π nk,
since a partition CwithALprecedesequalCLprecedesequalB is speciﬁed by a partition of the
niblocks of Athat lie in the i-th block of B, for eachi=1,2,...,k .
We now mention the fact that the M¨ obius function µP×Qof the
direct product P×Qof two partially ordered sets is the (Kronecker
or tensor) product of the M¨ obius functions µPandµQofPandQ;
that is,
µP×Q((a1,b1),(a2,b2)) =µP(a1,a2)µQ(b1,b2).
(We leave the reader to think about this; just check that deﬁning
µP×Qas above produces an inverse of ζP×Q.) Thusµ(A,B)i st h e
product of µ(0Πni,1Πni) fori=1,2,...,k .
We now show that µ(0Πn,1Πn)=(−1)n−1(n−1)! by induction
onn. LetPb eap o i n to fΠ n, i.e. a partition of an n-set into a 2-set
---PAGE BREAK---
25. Lattices and M¨ obius inversion 345
{x,y}andn−2 singletons. The partitions Aso thatP∨A =1Πn
are the 2n−2partitions with two blocks that separate xandy; there
are/parenleftbign−2
i/parenrightbig
such partitions where the block containing xhas sizei+1
and the block containing yhas sizen−1−i. From (25.6) and the
induction hypothesis,
µ(0Πn,1Πn)=−n−2/summationdisplay
i=0/parenleftbiggn−2
i/parenrightbigg
(−1)i(i)!(−1)n−2−i(n−2−i)!
=(−1)n−1(n−1)!.
/square
Problem 25D. Thedualof Weisner’s theorem (derived by apply-
ing Theorem 25.3 to the dual lattice) asserts
/summationdisplay
x:x∧a=0 Lµ(x,1L) = 0 for all a∈Lwitha<1L.
Takeato be a partition with one block of size n−1 and one of size
1 (in the partition lattice) and use the above to give a somewhat
diﬀerent proof of µ(0Πn,1Πn)=(−1)n−1(n−1)!.
We use M¨ obius inversion over the lattice of partitions to get an
expression for the number of connected labeled simple graphs onnvertices. Let Xbe ann-set. To each graph Gwith vertex set
X, there corresponds the partition C
GofXwhose blocks are the
vertex sets of the connected components of G. We let g(B) denote
the number of simple graphs GwithV(G)=X andCG=B.W e
letf(B) denote the number of simple graphs GwithV(G)=X
and where CGis a reﬁnement of B. Clearly,
f(B)=/summationdisplay
ALprecedesequalBg(A).
We are interested in g(1Πn), where 1 Πnis the partition with one
block. But what is easy to calculate is f(B); we get a graph counted
byf(B) by arbitrarily choosing a simple graph on each block of B,
so ifBhaskiblocks of size i, then
f(B)=2k2(2
2)2k3(32)···2kn(n
2).
---PAGE BREAK---
346 A Course in Combinatorics
By M¨ obius inversion,
g(B)=/summationdisplay
ALprecedesequalBµ(A,B)f(A).
Specializing to B=1Πn, we have
(25.7) g(1Πn)=/summationdisplay
Aµ(A,1Πn)f(A).
Recall that the number of partitions of Xof type (k1,k2,...,kn)i s
n!
(1!)k1k1!(2!)k2k2!···(n!)knkn!;
cf. (13.3). And using Theorem 25.1(iv), we ﬁnd the number of
connected labeled graphs on nvertices to be
/summationdisplay
(−1)k1+k2+···+kn−1n!(k1+···+kn−1)!
(1!)k1k1!···(n!)knkn!2k2(2
2)+k3(32)+···+kn(n
2)
where the summation is extended over all partitions ( k1,k2,...,kn)
of the integer n, that is all nonnegative n-tuples with 1k 1+2k2+
···+nkn=n.
We do not mean to imply that this is a particularly nice answer
to our original question. Indeed, it is a summation over a large
collection of objects, whose number exceeds e√nfor largen. But it
is a natural illustration of M¨ obius inversion and does greatly reduce
the problem. For n= 5, we have
partition of 5 number of Af(A)µ(A,1Π5)
5 1 1024 1
41 5 64 −1
32 10 16 −1
311 10 8 2
221 15 4 2
2111 10 2 −6
11111 1 1 24
---PAGE BREAK---
25. Lattices and M¨ obius inversion 347
from which table and (25.7) we see that 728 out of the 1024 simple
labeled graphs on 5 vertices are connected.
***
We give an application of M¨ obius inversion to coding theory.
Recall the deﬁnition of MDS codes given in Example 20.3. Let C
be such a code, i. e. an [ n,k,d]c o d eo v e rF qwithd=n−k+1 .
If we consider a set of dpositions and then look at the subcode
ofCwith zeros in all other positions, this subcode has dimension
≥k−(n−d) = 1. Since this subcode has minimum distance d,i t
must have dimension exactly 1 by Theorem 20.2. It follows that forn≥d
Lprime>d, specifying a set of dLprimepositions and requiring codewords
to be zero in all other positions, will deﬁne a subcode of Cwith
dimension dLprime−d+1. We use this in the proof below. We shall show
that the weight enumerator of an MDS code is determined by itsparameters.
Theorem 25.7. LetCbe an [n,k]code over F
qwith distance
d=n−k+1. Then the weight enumerator of Cis1+/summationtextn
i=dAizi,
where
Ai=/parenleftbiggn
i/parenrightbigg
(q−1)i−d/summationdisplay
j=0(−1)j/parenleftbiggi−1
j/parenrightbigg
qi−j−d,i =d,d+1,...,n.
Proof: LetRbe a subset of N:={0,1,...,n}. Deﬁne f(R)t o
be the number of codewords ( c0,c1,...,cn−1) for which {i:ciLnegationslash=
0}=R. For a subset SofN, we deﬁne g(S): =/summationtext
R⊆Sf(R). As
remarked above, we have
g(S)=/braceleftbigg1, if|S|≤d−1,
q|S|−d+1,ifn≥|S|≥d.
The deﬁnition of fimplies that Ai=/summationtext
R⊆N,|R|=if(R). We now
---PAGE BREAK---
348 A Course in Combinatorics
apply M¨ obius inversion with Theorem 25.1 (i). We ﬁnd
Ai=/summationdisplay
R⊆N,|R|=i/summationdisplay
S⊆Rµ(S,R )g(S)
=/parenleftbiggn
i/parenrightbigg

d−1/summationdisplay
j=o/parenleftbiggi
j/parenrightbigg
(−1)i−j+i/summationdisplay
j=d/parenleftbiggi
j/parenrightbigg
(−1)i−jqj−d+1


=/parenleftbiggn
i/parenrightbiggi/summationdisplay
j=d/parenleftbiggi
j/parenrightbigg
(−1)i−j(qj−d+1−1).
The result follows if we replace jbyi−jand then use/parenleftbigi
j/parenrightbig
=/parenleftbigi−1
j−1/parenrightbig
+/parenleftbigi−1
j/parenrightbig
. /square
Theorem 25.7 implies rather severe restrictions on the alphabet
size of an MDS code.
Corollary. If there exists an MDS code CoverFqwith length n
and dimension k, then
/braceleftbigg(i)q≥n−k+1ork≤1,
(ii)q≥k+1ord=n−k+1≤2.
Proof: (i) Letd=n−k+ 1. From Theorem 25.7 we ﬁnd for
d<n that
0≤Ad+1=/parenleftbiggn
d+1/parenrightbigg
(q−1)(q−d).
(ii) LetG:= (IkP) be the generator matrix of C. SinceChas
minimum weight d, every set of d−1=n−kcolumns of the parity
check matrix H:= (−PLlatticetopIn−k) is linearly independent. Hence every
square submatrix of His nonsingular. So, no codeword of C⊥has
n−kzeros, i.e. C⊥is also MDS. Apply the result of (i) to C⊥./square
Problem 25E. LetPbe a partially ordered set. Remember that
ifx<y , then a sequence x=x0<x 1<···<xk=yis called a
chain of lengthkfromxtoy. Letck(x,y) denote the number of
such chains (so c1(x,y) = 1). Prove that
µ(x,y )=/summationdisplay
k≥1(−1)kck(x,y).
---PAGE BREAK---
25. Lattices and M¨ obius inversion 349
Problem 25F. We consider the lattice of subspaces of the vector
spaceV:=Fn
q. LetSbe another vector space over Fq. Deﬁne for
a subspace U:
f(U) := the number of linear maps from VtoSwith kernel U,
g(U) := the number of linear maps from VtoUwith kernel ⊇U.
(i) Determine g(U) and then apply M¨ obius inversion to
g(U)=/summationdisplay
W:W⊇Uf(W).
(ii) Show that
f({0})=n/summationdisplay
k=0/bracketleftbigg
n
k/bracketrightbigg
q(−1)kq(k
2)|S|n−k.
(iii) Prove the polynomial identity
n−1/productdisplay
k=0(x−qk)=n/summationdisplay
k=0(−1)k/bracketleftbigg
n
k/bracketrightbigg
qq(k
2)xn−k.
Notes.
The expression of the chromatic polynomial of a graph in terms
of the M¨ obius function of L(G) is due to G.-C. Rota (1964).
Theorem 25.1 (v) is essentially Euler’s formula for polytopes:
f0−f1+f2−f3+···+(−1)nfn=0,
wherefiis the number of faces of rank i, or dimension i−1(f0=
fn= 1). See B. Gr¨ unbaum (1967). Also see R. Stanley (1986),
where posets with the property that µ(x,y )=(−1)dwhenever the
ranks ofxandydiﬀer bydare called Eulerian posets.
References.
T. Dowling (1977), A note on complementing permutations, J.
Combinatorial Theory (B)23, 223–226.
---PAGE BREAK---
350 A Course in Combinatorics
T. Dowling and R. M. Wilson (1975), Whitney number inequalities
for geometric lattices, Proc. Amer. Math. Soc. 47, 504–512.
B. Gr¨ unbaum (1967), ConvexPolytopes , J. Wiley (Interscience).
G.-C. Rota (1964), On the foundations of combinatorial theory
I. Theory of M¨ obius functions, Z. Wahrscheinlichkeitstheorie 2,
340–368.
R. P. Stanley (1986), Enumerative Combinatorics , Vol. 1, Wads-
worth.
L. Weisner (1935), Abstract theory of inversion of ﬁnite series,
Trans. Amer. Math. Soc. 38, 474–484.
---PAGE BREAK---
26
Combinatorial designs and
projective geometries
Geometries over ﬁnite ﬁelds are a rich source of combinatorial de-
signs and related combinatorial conﬁgurations. We begin with twotopics (arcs and subplanes) that we choose to mention only in pro-jective planes before going on to discuss quadrics and other conﬁg-urations in general projective spaces.
An (m,k)-arc in a projective plane is a set of mpoints, no k+1 of
which are collinear. We were concerned with ( m,2)-arcs in Problem
19I.
LetAbe an (m,k )-arc in a projective plane of order nand letx
b eap o i n ti n A. Then+ 1 lines on xeach contain at most k−1
other points of A,s o
m≤1+(n+ 1)(k−1).
An (m,k )-arcAis called perfect when equality holds above. Any
line that contains a point of a perfect ( m,k)-arc evidently contains
exactlykpoints of the arc; that is,
|L∩A|=0o rk
for any line L. Clearly, the nonempty intersections of lines with a
perfect (m,k )-arc provide the blocks of a Steiner system S(2,k,m ).
A single point is a perfect (1,1)-arc. The set of n
2points not on
a ﬁxed line of a projective plane of order nis a perfect (n2,n)-arc
and the corresponding Steiner system is an aﬃne plane of order n.
The hyperovals in Problem 19I are perfect ( q+2,2)-arcs. The cor-
responding designs are trivial. But these have ‘dual’ arcs where thecorresponding Steiner systems are interesting—see Problem 26A.
---PAGE BREAK---
352 A Course in Combinatorics
The construction of perfect ( m,k)-arcs in Desarguesian planes
of even order given in part (2) of the following theorem is due to
R. H. F. Denniston (1969). No examples of perfect ( m,k)-arcs,
1<k<n , in projective planes of odd orders nare known at this
time.
Theorem 26.1.
(1)If there exists a perfect (m,k)-arc in a projective plane of
ordern, thenkdividesn.
(2)Ifqis a power of 2andkdividesq, then there exists a
perfect (m,k)-arc inPG2(q).
Proof: Letxbe a point not in a perfect ( m,k)-arcAin a pro-
jective plane of order n. The lines on xpartition the remaining
points, but each line on xcontains exactly 0 or kpoints ofA.S o
kmust divide m=1+(n+ 1)(k−1). It follows that kdividesn.
Now letqbe a power of 2 and ka divisor of q. Letf(x,y)=
αx2+βxy+γy2be any irreducible quadratic over Fq, and letH
be any subgroup of the additive group of Fqwith order k. In the
aﬃne plane AG(2,q ), let
A:={(x,y ):f(x,y)∈H}.
We claim that any (aﬃne) line meets Ain 0 orkpoints. When the
aﬃne plane is embedded in a PG2(q),Awill be a perfect (m,k )-arc.
Consider a line L={(x,y ):y =mx+b}withbandmboth
nonzero. (We leave consideration of lines of the forms {(x,y ):y=
mx}and{(x,y ):x=c}to the reader.)
The intersection L∩Ais the set of points (x,mx +b), where
αx2+βx(mx+b)+γ (mx+b)2∈H, or
F(x)∈H, whereF(x): =(α+βm+γm2)x2+βbx+γb2.
We are working over a ﬁeld of characteristic 2, so
xLmapsto→(α+βm+γm2)x2+βbx
is a linear mapping; it has kernel of order 2 since the irreducibility
off(x,y) ensures that both βand the coeﬃcient of x2are nonzero.
---PAGE BREAK---
26. Designs and projective geometries 353
The image KFof this mapping is thus a subgroup of order q/2o f
the additive group of Fq. The image of Fis a coset of KF, but since
F(x) is never 0 (again by the irreducibility of f(x,y)), the image
ofFis the complement Fq\KF. In summary,
|{x:F(x)=a}| =/braceleftbigg2i fx/∈KF,
0i fx∈KF.
Thus|L∩A|=2|H∩(Fq\KF)|. The subgroup His either contained
inKF, in which case L∩A=∅, or intersects KFin a subgroup of
orderk/2, in which case |L∩A|=k. /square
As a corollary of this theorem (with n=2m+1,k=2m), we
obtain Steiner systems
S(2,2m,22m+1−2m).
Steiner systems S(2,k,v ) are in many ways most interesting when v
is close to k2, as is the case for aﬃne and projective planes (Fisher’s
inequality, Theorem 19.6, shows v≥k2−k+ 1). These examples
havev<2k2, which is still impressive.
Problem 26A. LetAbe a perfect (m,k )-arc in a projective plane
Pof ordern,1≤k≤n. LetA∗be the set of lines that do not
meetA. Show that A∗is a perfect (m∗,[n/k])-arc in the dual plane
P∗, and calculate m∗in terms of m,k,n .
Problem 26B. Aparallel class in a Steiner system S(2,k,m )i s
a setAofm/k blocks so that each point is incident with exactly
one block in A.A nS(2,k,m )i sresolvable when the blocks can be
partitioned into parallel classes (cf. Problem 19K).
LetAbe a perfect (m,k )-arc in a projective plane Pof order
n. Explain why the Steiner system S(2,k,m ) whose blocks are the
nontrivial intersections of lines with Ais resolvable.
Asubplane Sof a projective plane Pis a substructure of Pthat
is a projective plane in its own right. Recall that a substructure of
an incidence structure ( P,B,I) is an incidence structure (P 0,B0,I0)
whereP0⊆P,B0⊆B, andI0=I∩(P0×B 0). Note that given
an automorphism (or collineation )αof a projective plane P, the
---PAGE BREAK---
354 A Course in Combinatorics
substructure Sconsisting of the points of Pﬁxed byαand the lines
ofPﬁxed byαhas the property that two points of Sare incident
with a unique line of S, and two lines of Sare incident with a unique
point ofS.I fScontains four points, no three collinear, then Sis
a subplane; but it may be a nearpencil or have one or no lines.
Example 26.1. LetV:=F3
qn. The points and lines of PG2(qn) are
the 1-dimensional and 2-dimensional Fqn-subspaces of V. Deﬁne a
substructure SofPG2(qn) whose points and lines are those 1- and
2-dimensional Fqn-subspaces of Vthat admit bases consisting of
vectors whose entries are in the subﬁeld Fq. ThenSis a subplane.
A line of Sis incident with qn+1 points in PG2(qn), but only q+1
of those are points of S.
Theorem 26.2. Ifaprojectiveplane Poforderncontainsasub-
planeSof orderm<n, then either
(i)n=m2,o r
(ii)n≥m2+m.
Proof: LetLbe a line of the subplane Sandxa point on Lin
Pbut not in S. Thenother lines on xcan contain at most one
point of S(since a line MinPcontaining at least two points of
Swould necessarily belong to the subplane, and then the point x
in common to MandLwould also belong to the subplane). The
lineLcontainsm+ 1 points of S, which has a total of m2+m+1
points, each of which is on some line through x,s om2≤n.
Equality will imply that every line of Pwill meet S(evidently
in one orm+ 1 points) since if there were a line Ndisjoint from
S, andxwere taken as the point of intersection of LandN, each
of them2points of Snot onLwould belong to one of n−1 lines.
Now assume m2<n, so that there does exist a line Nincident
with no points of S. Each of the m2+m+ 1 lines of Scontains
one point of Nand no two such lines can contain the same point,
som2+m+1≤n+1 . /square
Problem 26C. Show that if PG2(F) contains the Fano conﬁgu-
rationPG2(2), then Fhas characteristic 2. Suggestion: Without
loss of generality, four points of the Fano conﬁguration are Langbracketleft1,0,0Langbracketright,
Langbracketleft0,1,0Langbracketright,Langbracketleft0,0,1Langbracketright, andLangbracketleft1,1,1Langbracketright. Calculate the homogeneous coordi-
nates of the other three points (that must lie on a line).
---PAGE BREAK---
26. Designs and projective geometries 355
Problem 26D. Ablocking set in a projective plane is a set Sof
points that contains no line but such that every line meets Sin at
least one point. Show that a blocking set in a projective plane of
orderncontains at least n+√n+1 points, and that equality holds
if and only if Sis the set of points of a Baer subplane.
We illustrate a ‘polynomial method’ with the proof of the follow-
ing theorem on a type of aﬃne blocking sets, due to Brouwer andSchrijver (1978).
Theorem 26.3. IfVis a subset of AG(k,q )that meets all the
hyperplanes, then
|V|≥k(q−1 )+1.
Proof: LetAbe the blocking set. Without loss of generality
0∈A. LetB:=A\{0}. Then Bintersects all hyperplanes that do
not contain 0. These are deﬁned by equations w
1x1+···+wkxk=1 ,
wherewruns through all non-zero vectors. Therefore
F(x1,x2,...,xk): =/productdisplay
b∈B(b1x1+b2x2+···+bkxk−1)
is identically 0 on the space except in 0.
It is easily shown by induction that a polynomial that is identi-
cally 0 on the space must be in the ideal generated by the polyno-
mialsxq
i−xi,i=1,...,k . WriteF(x)a s
F(x1,...,xk)=k/summationdisplay
i=1Fi(x1,...,xk)(xqi−xi)+G(x 1,...,xk),
where the highest degree of xiinGis at most q−1. For each i,
the polynomial xiFx1,...,xk) is identically 0, so this is also true
forxiG(x 1,...,xk). Therefore Gis divisible by Π( xq−1
i−1). Since
F(0)Lnegationslash= 0, alsoG(0)Lnegationslash= 0 and therefore Ghas degree k(q−1). So,
the degree of F, which is |B|, must be at least k(q−1). /square
Aquadratic form in indeterminates x1,x2,...,xnover a ﬁeld F
is a homogeneous polynomial of degree 2 in those indeterminates,
i.e.
(26.1) f(x)=f (x1,x2,...,xn)=n/summationdisplay
i,j=1cijxixj
---PAGE BREAK---
356 A Course in Combinatorics
where the coeﬃcients cijare in F. The same quadratic form is
deﬁned by more than one matrix C=(cij) of coeﬃcients, since it
is only the diagonal entries and the sums cij+cjithat are impor-
tant. We could require that cij= 0 fori>j and then quadratic
forms inx1,x2,...,xnare in one-to-one correspondence with upper
triangular n×nmatricesCoverF.
Aquadric inPGn(F) is a set of projective points
Q=Q(f): ={LangbracketleftxLangbracketright :f(x)=0}
wherefis a quadratic form in n+ 1 indeterminates. We must
choose a basis and identify the vectors with ( n+ 1)-tuples over F
in order to make this deﬁnition.
Two quadratic forms fandgareprojectively equivalent when
gcan be obtained from fby an ‘invertible linear substitution’,
or in matrix notation, g(x)=f (xA) for some nonsingular n×n
matrixAoverF.S o i ffis given by a matrix Cas in (26.1), i.e.
f(x)=xC xLlatticetop, thengis given by the matrix ACALlatticetop. For example,
for any positive integer n,nx2
1+nx22+nx23+nx24is projectively
equivalent to x21+x22+x23+x24over the rationals; see equation
(19.12).
We remark that the matrix notation does not lend itself well to
changes of the names or number of the indeterminates, which we
wish to allow. For example, replacing x1in a quadratic form f
byy1+y2, wherey1andy2are new indeterminates, produces a
projectively equivalent form.
Therank of a quadratic form is the least number of indeter-
minates that occur (with nonzero coeﬃcients) in any projectivelyequivalent quadratic form. For example, ( x
1+···+xn)2has rank
1. Projectively equivalent quadratic forms have the same rank.A quadratic form in rindeterminates is said to be nondegenerate
when it has rank r.
Example 26.2. Consider quadratic forms in two indeterminates
f(x,y)=ax
2+bxy+cy2.
The form has rank 0 if and only if a=b=c= 0. The corresponding
quadric contains all points of PG1(F) (the projective line). If not
---PAGE BREAK---
26. Designs and projective geometries 357
zero, it will have rank 1 if and only if it is a scalar multiple of the
square of a linear form dx+ey, which is the case if and only if the
discriminant b2−4acis 0. The corresponding quadric in PG1(F)
will then consist of a single point. A rank 2 quadratic form intwo indeterminates is either irreducible or can be factored into twodistinct linear forms. In the ﬁrst case, the corresponding quadricinPG
1(F) will be empty, and in the second case, the corresponding
quadric in PG1(F) will consist of two points.
It is clear that an irreducible quadratic form of rank 2 is not pro-
jectively equivalent to a reducible quadratic form, since the latterhas zeros in Fand the former does not. A reducible quadratic form
is projectively equivalen tt ox
1x2.
Problem 26E. Show that over a ﬁeld Fof odd characteristic, a
quadratic form fas in (26.1) is degenerate if and only the sym-
metric matrix C+CLlatticetopis singular. For a ﬁeld Fof characteristic
2, show that fis degenerate if and only if C+CLlatticetopis singular and
x(C+CLlatticetop) = 0 for some xwithf(x)=0 .
It is important to understand that the intersection of a quadric
with a ﬂat UofPGn(F) is a quadric in that ﬂat. For example,
suppose that Uis a projective line PG1(F) and that fis a quadratic
form inx0,x1,...,xn. The homogeneous coordinates of points of
UareLangbracketleftya+zbLangbracketrightwherea=(a0,a1,...,an) andb=(b0,b1,...,bn)
are linearly independent vectors. These points are in one-to-onecorrespondence with the homogeneous coordinates Langbracketleft(y,z)Langbracketrightof points
ofPG
1(F). Sayf=/summationtext
0≤i≤j≤ncijxixj. Then
g(y,z): =/summationdisplay
1≤i≤j≤ncij(yai+zbi)(yaj+zbj)
is a quadratic form in yandzand deﬁnes a quadric in PG1(F).
The quadratic form gmay be degenerate even if fis not. In view
of Example 26.2, we see that a line is either contained fully in aquadricQ, or meets Qin 0, 1, or 2 points.
Lemma 26.4. Anyquadraticform fofrankn≥3isprojectively
equivalent to
(26.2) x
1x2+g(x3,...,xn)
---PAGE BREAK---
358 A Course in Combinatorics
for some quadratic form g(x3,...,xn).
Proof: First assume qis odd. It is easy to see that a quadratic
formfis projectively equivalent to some/summationtext
1≤i≤j≤ncijxixjwhere
c11Lnegationslash= 0. Lety:=x1+1
2c11(c12x2+···+c1nxn). Thenf=c11y2+
g(x2,...,xn). Inductively, if the rank of fis at least 3, we ﬁnd that
fis projectively equivalent to
h(x)=ax2
1+bx22+cx23+gLprime(x4,...,xn)
witha,b,c all nonzero. The three scalars can be changed by any
nonzero square factor and a projectively equivalent quadratic form
results; some pair must diﬀer by a square factor, so we can assumethatb=c,s a y .
We claim that there exist s,t∈F
qso thats2+t2=−b−1a.
One way to see this is to consider the addition table of Fq, which
is a Latin square. The number of squares in Fq, including 0, is
(q+1 )/2. The element −b−1a(or any other) occurs ( q−1)/2
times in the (q −1)/2 columns of the Latin square indexed by the
nonsquares, and ( q−1)/2 times in the (q −1)/2 rows indexed by
the nonsquares; so −b−1amust occur at least once in the submatrix
with rows and columns indexed by the squares. With sandtso
chosen,his projectively equivalent to
ax2
1+b(sx 2+tx3)2+b(tx 2−sx3)2+gLprime(x4,...,xn)
=ax21−ax22−ax23+gLprime(x4,...,xn)
=(ax1+ax2)(x1−x2)−ax23+gLprime(x4,...,xn),
and the latter is clearly projectively equivalent to (26.2).
The caseqeven is a little more tedious; see the proof of Theorem
5.1.7 in J. W. P. Hirschfeld (1979). /square
Theorem 26.5.
(i)Anyquadraticform fofoddrank nisprojectivelyequivalent
to
(26.3) f0(x): =x 1x2+···+xn−2xn−1+cx2
n
for some scalar c.
---PAGE BREAK---
26. Designs and projective geometries 359
(ii)Anyquadraticform fofevenrank nisprojectivelyequivalent
to either
(26.4) f1(x): =x 1x2+···+xn−3xn−2+xn−1xn
or(26.5) f
2(x): =x 1x2+···+xn−3xn−2+p(xn−1,xn)
wherep(xn−1,xn)is an irreducible quadratic form in two indeter-
minates.
Proof: This follows from Lemma 26.3 and induction. /square
Quadratic forms (and the corresponding quadrics) of odd rank
are called parabolic . Quadratic forms of even rank projectively
equivalent to (26.4) are called hyperbolic , and those equivalent to
(26.5) are called elliptic . Any two hyperbolic quadratic forms of a
given rank are projectively equivalent to (26.4) and hence to each
other. It is also true that all parabolic quadratic forms of a giveneven rank are projectively equivalent, i.e. we may take c=1i n
(26.3), and that all elliptic quadratic forms of a given rank are pro-jectively equivalent. See J. W. P. Hirschfeld (1979) for this andmore on canonical forms. That hyperbolic and elliptic quadraticforms are not projectively equivalent is a consequence of the fol-lowing theorem.
Theorem 26.6. Anondegeneratequadric QinPG
n(q)hascardi-
nality


qn−1
q−1ifnis even, i.e. Qis parabolic,
(q(n+1) /2−1)(q(n−1) /2+1)
q−1ifnis odd and Qis hyperbolic,
(q(n+1) /2+1)(q(n−1) /2−1)
q−1ifnis odd and Qis elliptic.
Proof: In general, if
f(x1,...,xr)=x 1x2+g(x3,...,xr)
and there are Nvectors (x 3,...,xr) such that g(x3,...,xr)=0 ,
then there are (2q −1)N+(q−1)(qr−2−N) vectors (x 1,...,xr)
---PAGE BREAK---
360 A Course in Combinatorics
such that f(x1,...,xr) = 0. This allows us to verify by induction
the following formulae for the number of zeros in Fr
qof a rank r
quadratic form finrindeterminates as the following:


qr−1ifris odd, i.e. fis parabolic,
qr−1+qr/2−qr/2−1ifris even and fis hyperbolic,
qr−1−qr/2+qr/2−1ifris even and fis elliptic.
Of course, the number of projective points in PGn(q) on the cor-
responding quadrics is found from the above numbers by replacing
rbyn+ 1, subtracting 1 (the zero vector) and then dividing by
q−1. /square
Theorem 26.7. LetQbe a nondegenerate quadric in PGn(q).
The maximum projective dimension of a ﬂat FwithF⊆Qis


n/2−1ifnis even, i.e. Qis parabolic,
(n−1)/2ifnis odd and Qis hyperbolic,
(n−3)/2ifnis odd and Qis elliptic.
Proof: Letfbe a nondegenerate quadratic form in rindetermi-
nates. The statement of the theorem is equivalent to the statement
that the maximum dimension of a subspace UofFr
qsuch that f
vanishes on Uis


(r−1)/2i fris odd, i.e. fis parabolic,
r/2i f ris even and fis hyperbolic,
r/2−1i fris even and fis elliptic.
First note that if f=f0in (26.3), then f(x) = 0 for any
x∈span(e 2,e4,...,er−1), where e1,e2,...,eris the standard ba-
sis for Fr
q.I ff=f1in (26.4), then f(x) = 0 for any x∈
span(e2,e4,...,er). Iff=f2in (26.5), then f(x) = 0 for any x∈
span(e2,e4,...,er−2). These subspaces have dimensions ( r−1)/2,
r/2, andr/2−1, respectively.
It remains to show that fcannot vanish on any subspace of
larger dimension in any of these cases. We will use Theorem 26.5
and induction. The cases r= 1 andr= 2 are trivial. Suppose
---PAGE BREAK---
26. Designs and projective geometries 361
f(x1,...,xr)=x 1x2+g(x3,...,xr) and that f(x) = 0 for all x
in some subspace U⊆Fr
qof dimension k. To complete the proof,
we will show that there exists a subspace ULprime⊆Fr−2
qof dimension
≥k−1 so thatg(y) = 0 for all y∈ULprime.
Clearly,g(y) = 0 for all yin
U0:={(x3,...,xr):( 0,0,x3,...,xr)∈U}.
We are done if dim( U0)≥k−1, so assume dim( U0)=k−2. Then
there exist vectors
(1,0,a3,...,ar) and (0 ,1,b3,...,br)
inU. Then (1, 1,a3+b3,...,ar+br)∈Usog(a3+b3,...,ar+br)=
−1. The form gevidently vanishes on all vectors in
span((a3,...,ar)) +U0and span(( b3,...,br)) +U0.
One of these subspaces must have dimension >k−2 because other-
wise (a3+b3,...,ar+br)∈U0, which contradicts g(a3+b3,...,ar+
br)=−1. /square
Example 26.3. Letfbe a quadratic form in three indeterminates
and consider the quadric Q(f) in the projective plane PG2(q). Iff
is nondegenerate, there are q+ 1 projective points on Q(f). As we
remarked above, any line LofPG2(q) meetsQ(f) in a quadric in
L, which in this case consists of 0, 1, or 2 points since Q(f) cannot
containLby Theorem 26.7. So Q(f) is a set of q+ 1 points, no
three of which are collinear, i.e. an oval. See Problem 19I.
Iffhas rank 0, Q(f) is all of PG2(q). Iffhas rank 1, Q(f)
consists of the points of a line in PG2(q). Iffhas rank 2, there
are two cases. If fis reducible, say fis projectively equivalent to
xy, thenQ(f) consists of the points on the union of two lines of
PG2(q); iffis irreducible, then Q(f) is a single point in PG2(q).
Example 26.4. The ﬁrst order Reed-Muller codes were intro-
duced in Chapter 18. Here is one way to introduce the entire
family: Let V=Fm
2. We consider vectors of length 2mwhose coor-
dinates are indexed by elements of V; for concreteness, write V=
---PAGE BREAK---
362 A Course in Combinatorics
{v0,v1,...,v2m−1}. Thek-th order Reed-Muller code RM(k,m)i s
deﬁned to consist of all vectors (of length 2m)
(f(v0),f(v1),...,f (v2m−1))
wherefranges over all polynomials in x1,...,xmof degree at most
k.
Since a linear form xi1+···+xikgives the same function as the
quadratic form x2
i1+···+x2i
koverF2, the words in the second order
codeRM(2,m) are given by binary quadratic forms f(x1,...,xn)
and their ‘complements’ f(x1,...,xn)+1. Theorems 26.4 and 26.5
are useful for determining the weights that occur for codewords in
RM(2,m).
We must consider degenerate forms also; e.g. x1x2+x3x4corre-
sponds to a codeword of weight 24 in RM(2,6). It will be found
that the weights of codewords in RM(2,6) are 0, 16, 24, 28, 32, 36,
40, 48, and 64.
Problem 26F. Letf(x): =x 1x2+···+x2m−1x2m. Thenfdeter-
mines a coset CofRM(1,2m)i nRM(2,2m) consisting of words
corresponding to f(x)+a(x), where a(x) ranges over the 22m+1
aﬃne functions (linear plus possibly a constant term) in 2 mvari-
ables. Show that in Chalf of the words have weight 22m−1+2m−1
and half have weight 22m−1−2m−1.
Example 26.5. LetQ3be a nondegenerate elliptic quadric in pro-
jective 3-space PG3(q). By Theorem 26.6, |Q3|=q2+ 1. By Theo-
rem 26.7,Q3contains no lines. Any plane PmeetsQ3in a quadric
in that plane; in view of Example 26.3, every plane must meet Q3
in either an oval in that plane or a single point. Any three points of
Q3are contained in a unique plane, so it follows that the nontriv-
ial intersections of planes with Q3provide the blocks of a Steiner
system
S(3,q+1,q2+1 ).
In general, a set of q2+ 1 points, no three collinear, in PG3(q)i s
called an ovoid and anS(3,n+1,n2+ 1) is called a M¨ obius plane
or aninversive plane .
Example 26.6. LetQ4be a nondegenerate quadric in projective
4-spacePG4(q). By Theorem 26.6, |Q4|=q3+q2+q+ 1. Let
---PAGE BREAK---
26. Designs and projective geometries 363
Qbe the incidence structure whose points are the elements of Q4
and whose blocks are the lines of PG4(q) fully contained in Q4.
Each point of Qis on exactly q+ 1 blocks of Q(see Problem 26F).
Given a point xand a block LofQ, the intersection of the plane
P:={x}∨L withQ4is a quadric Q2inPthat contains, obviously,
a line and a point oﬀ that line. From Example 26.3, Q2must consist
of the points on two (intersecting) lines. This implies that Qis a
partial geometry pg(r,k,t ), as deﬁned in Chapter 21, where
r=q+1,k=q+1,t=1.
Example 26.7. LetQ5be a nondegenerate elliptic quadric in
PG5(q). By Theorem 26.6, |Q5|=(q+ 1)(q3+ 1). By Theo-
rem 26.7, Q5contains no planes. Let Qbe the incidence structure
whose points are the elements of Q5and whose blocks are the lines
ofPG5(q) fully contained in Q5. By Problem 26F, each point of Q
is onq2+ 1 lines of Q. By an argument similar to that of Example
26.6,Qis a partial geometry pg(r,k,t ) where
r=q2+1,k=q+1,t=1.
Partial geometries with t= 1 are called generalized quadrangles.
See L. M. Batten (1986) for further results and references.
Problem 26G. Letfbe a nondegenerate quadratic form in n
indeterminates given by a matrix C=(cij)o v e rF qas in (26.1).
LetQ=Q(f) be the corresponding quadric in PGn−1(Fq). Let
p=LangbracketleftxLangbracketrightbe one of the points on Q. Let
Tp:={LangbracketleftyLangbracketright:x(C+CLlatticetop)yLlatticetop=0}.
ThenTpis a hyperplane in PGn−1(Fq) by Problem 26E. Show that
Tp∩Qconsists exactly of pand the union of any lines on pthat are
contained in Q. Further show that if Wis any hyperplane of Tp
not containing p, thenQLprime:=W∩Qis a nondegenerate quadric in
W(=PGn−3(Fq)) and that QLprimeis parabolic, hyperbolic, or elliptic
according to whether Qis parabolic, hyperbolic, or elliptic. We
see, in particular, that the number of lines on pthat lie entirely in
Qis equal to |QLprime|.
---PAGE BREAK---
364 A Course in Combinatorics
Ahermitian form in indeterminates x1,...,xnoverFq2is an ex-
pression of the form
(26.6) h(x)=h(x 1,...,xn)=n/summationdisplay
i,j=1cijxixq
j,
where the coeﬃcients cijare from Fq2and where cji=cq
ij.I n
particular, the diagonal coeﬃcients cii, being ﬁxed by the Frobenius
automorphism xLmapsto→xq, lie in Fq.
Two hermitian forms fandgoverFq2areprojectively equivalent
whengcan be obtained from fby an invertible linear substitution,
or, in matrix notation, g(x)=f (xA) for some nonsingular n×n
matrixAoverFq2.S o i ffis deﬁned by a matrix Cas in (26.6),
i.e.f(x)=xC xLlatticetop, thengis deﬁned by the matrix ACA∗, whereA∗
is theconjugate transpose ofA;i fA=(aij), thenA∗:= (aqji).
Therank of a hermitian form is the least number of indeter-
minates that occur (with nonzero coeﬃcients) in any projectively
equivalent hermitian form.
Ahermitian variety inPGn(q2) is a set of projective points
H=H(f): ={LangbracketleftxLangbracketright :f(x)=0}
wherefis a hermitian form in n+ 1 indeterminates. We must
choose a basis and identify the vectors with (n + 1)-tuples over Fq2
in order to make this deﬁnition. It can be seen that the intersectionof a hermitian variety in PG
n(q2) with a ﬂat is a hermitian variety
in that ﬂat.
Theorem 26.8. Ahermitianformofrank nisprojectivelyequiv-
alent to
(26.7) xq+1
1+xq+1
2+···+xq+1
n.
Proof: It is not hard to see that any nonzero hermitian form is
projectively equivalent to has in (26.6) where c11Lnegationslash= 0; we leave
this to the reader. Let y:=c11x1+c12x2+···+c1nxn. Then
h=c−1
11yyq+g(x2,...,xn) wheregis a hermitian form in x2,...,xn.
Sincec11∈Fq, there exists a∈Fq2such that aq+1=c−111and then
h=zq+1+g(x2,...,xn), wherez=ay.
The theorem follows from this step and induction. /square
---PAGE BREAK---
26. Designs and projective geometries 365
Theorem 26.9. Thenumberofpointsonanondegeneratehermi-
tian variety HinPGn(q2)is
(qn+1+(−1)n)(qn−(−1)n)
q2−1.
Proof: For each nonzero a∈Fq, there are q+ 1 values of x∈Fq2
such that xq+1=a.I f
f(x1,...,xn)=xq+1
1+g(x2,...,xn)
and there are Nvectors (x 2,...,xn) such that g(x2,...,xn)=0 ,
then there are N+(q+1)(q2(n−1)−N) vectors (x 1,...,xn) such that
f(x1,...,xn) = 0. Inductively, there are q2n−1+(−1)n(qn−qn−1)
vectors in Fn
q2that are zeros of (26.7) and the theorem follows. /square
Example 26.8. Consider hermitian varieties in the projective line
PG1(q2). If a hermitian form fin two indeterminates has rank 0,
then the variety H(f) contains all q2+ 1 points; if fhas rank 1,
H(f) consists of one point; if fhas rank 2, H(f) contains q+1
points. It follows that if His a hermitian variety in PGn(q2) for
anyn, then lines of PGn(q2) meetHin 1,q+1 ,o rq2+ 1 points.
Now consider a nondegenerate hermitian variety H2in the pro-
jective plane PG2(q2). It hasq3+ 1 points by Theorem 26.9. Any
lineLmeetsH2in a hermitian variety L∩H2in that line. As an
exercise, the reader should check that no lines are contained in H2,
so|L∩H2|=1o rq+ 1. It follows that the nontrivial intersections
of lines of PG2(q2) withH2provide the blocks of a Steiner system
S(2,q+1,q3+1 )
on the point set H2.
Designs with these parameters are called unitals . Further analy-
sis shows that the designs constructed above are resolvable; see R.
C. Bose (1959).
We conclude this chapter with a construction of higher dimen-
sional analogues of the Steiner systems S(3,q+1,q2+1) of Example
26.5; those constructed below have been called circle geometries .
---PAGE BREAK---
366 A Course in Combinatorics
Theorem 26.10. Ifqisapowerofaprimeand napositiveinteger,
then there exists a Steiner system S(3,q+1,qn+1 ).
Proof: LetVbe a 2-dimensional vector space over Fqnand letX
be the set of 1-dimensional subspaces of VoverFqn(i.e. theqn+1
points ofPG1(qn), the projective line of order qn).
Now think of Va sa2n-dimensional vector space over Fq. The
blocks of our Steiner system will come from the 2-dimensional sub-
spacesUoverFqofVthat are not contained in any member of X.
For every such subspace U, let
BU:={P∈X:P∩ULnegationslash={0}}.
Note that each P∈BUmeetsUin a 1-dimensional subspace over
Fq(that contains q−1o ft h eq2−1 nonzero vectors of U), so
|BU|=q+1 . I fW=λUfor some nonzero scalar λ∈Fqn, then
BU=BW; we take only the distinct sets BUas blocks.
Consider three distinct points Pi∈X,i=1,2,3. SayPiis the
Fqn-span of a vector xi,i=1,2,3. These three vectors are linearly
dependent over Fqn,s a y
x3=αx1+βx2
withα,β∈Fqn. But then it is clear that U:= span Fq{αx1,βx2}
meetsP1,P2, andP3all nontrivially. Suppose some 2-dimensional
subspaceWoverFqmeets each of the Pinontrivially, say Wcon-
tainsγixiwith 0Lnegationslash=γi∈Fqn,i=1,2,3. Then these vectors are
linearly dependent over Fq,s a y
γ3x3=aγ1x1+bγ2x2
wherea,b∈Fq. Sincex1andx2are linearly independent over Fqn,
we haveγ3α=aγ1andγ3β=bγ2. It follows that γ3U=W, and
we see that three distinct points are contained in a unique block.
/square
Problem 26H. Letαbe a collineation of a projective plane P.
(i) Show that if αﬁxesallpoints on a line land two points not
onl, thenαﬁxesPpointwise.
---PAGE BREAK---
26. Designs and projective geometries 367
(ii) Ifαﬁxesallpoints on a line l, then there is a point Psuch
thatαﬁxesPand every line through P.
(Such an automorphism of Pis called a central collineation .)
Problem 26I. In Chapter 23 we saw that AG(3,q ) is a subgeom-
etry ofPG(3,q), where the missing part is a projective plane P,
sometimes called the plane at inﬁnity forAG(3,q ). Letq=2m
and letObe a hyperoval in P. We deﬁne an incidence structure
Iwith as points the points of AG(3,q ) and as lines those lines of
AG(3,q ) that meet Pi nap o int ofO. Show that Iis a generalized
quadrangle.
Problem 26J. Consider a hyperoval OinPG(2,4). Deﬁne a
graphGwith as vertices the points of the plane not on Oand
edges (x,y) if the line through xandymeetsO. Prove:
(i) Every edge is in a unique triangle.
(ii) For every triangle ( x,y,z ) all other vertices are joined to
exactly one of x,y,z .
(iii)Gis a generalized quadrangle.
Problem 26K. Consider an arbitrary symmetric ( v,k,λ )-design.
Deﬁne an arcto be a set Sof points, no three on a block. A block
is called a tangent ofSif it meets Sin one point. Find an upper
bound on |S|depending on whether Shas a tangent or not.
Problem 26L. Anovalin a symmetric design is an arc that meets
the bound in Problem 26J. Consider a symmetric design with pa-
rameters (4λ −1,2λ,λ). Show that the ovals of this design are the
lines of size 3 of the complementary design.
Notes.
The term ‘maximal (m,k )-arc’ is often used in the literature for
what we have called ‘perfect (m,k )-arcs’, but this is too much of
an abuse of the word ‘maximal’ for us to tolerate.
The combinatorial properties of quadrics and hermitian varieties
are discussed in more detail in D. K. Ray-Chaudhuri (1962) and R.
C. Bose and I. M. Chakravarti (1966).
The polynomial method illustrated in the proof of Theorem 26.3
has further uses. E.g. A. Blokhuis (1994) proved that a nontrivial
---PAGE BREAK---
368 A Course in Combinatorics
blocking set in PG(2,p) has at least (3p +1)/2 points, a conjecture
of J. di Paola. The idea is to note that the blocking set Smust have
a tangent, which without loss of generality is the line at inﬁnity. Let
the other points be (a i,bi) in the aﬃne plane with i=1,...,p +k.
A one page complicated study of the polynomial
F(t,u)=p+k/productdisplay
i=1(t+ai+ubi)
shows that k≥p+1
2.
References.L. M. Batten (1986), Combinatorics of Finite Geometries ,C a m -
bridge University Press.
A. Blokhuis (1994), On the size of a blocking set in PG(2,p),Com-
binatorica 14(1994), 111–114.
R. C. Bose (1959), On the application of ﬁnite projective geom-
etry for deriving a certain series of balanced Kirkman arrange-ments,Golden Jubilee Commemoration Volume (1958–59) , Cal-
cutta Math. Soc., pp. 341–354.
R. C. Bose and I. M. Chakravarti (1966), Hermitian varieties in
a ﬁnite projective space PG(N,q
2),Canad. J. Math 18, 1161–
1182.
A. E. Brouwer and A. Schrijver, The blocking number of an aﬃne
space,J. Combinatorial Theory (A)24(1978), 251–253.
P. Dembowski (1968), Finite Geometries , Springer-Verlag.
R. H. F. Denniston (1969), Some maximal arcs in ﬁnite projective
planes,J. Combinatorial Theory 6, 317–319.
J. W. P. Hirschfeld (1979), Projective Geometries over Finite Fields ,
Clerendon Press.
D. K. Ray-Chaudhuri (1962), Some results on quadrics in ﬁnite
projective geometry based on Galois ﬁelds, Canad. J. Math. 14,
129–138.
---PAGE BREAK---
27
Diﬀerence sets and
automorphisms
A class of symmetric designs arises from diﬀerence sets (deﬁned be-
low) in abelian groups. One such design appeared in Example 19.6.
The group reappears in the automorphism group of the design.
In a simple incidence structure, we may identify the blocks with
sets of points, i.e. the block set Ais a family of subsets of the point
setX.A nautomorphism of a symmetric design (X, A), or any
simple incidence structure, is a permutation αofXthat takes A
toA, i.e. for A⊆X,A∈Aif and only if α(A)∈A. We begin
with a theorem on automorphisms of symmetric designs in general.
Theorem 27.1. LetS=(X,A)be a symmetric (v,k,λ )-design
andαan automorphism of S. Then the number of points ﬁxed by
αis equal to the number of blocks ﬁxed by α.
Proof: LetNbe the incidence matrix of S. Deﬁne a permutation
matrixPwhose rows and columns are indexed by the points and
where
P(x,y): =/braceleftbigg1i fα(x)=y,
0 otherwise.
Deﬁne a permutation matrix Qwhose rows and columns are in-
dexed by the blocks and where
Q(A,B ): =/braceleftbigg1i fα(A)=B,
0 otherwise.
Note that the trace of Pis equal to the number of ﬁxed points, and
the trace of Qis equal to the number of ﬁxed blocks of α.
---PAGE BREAK---
370 A Course in Combinatorics
N o ww eh a v e
PNQLlatticetop(x,A)=/summationdisplay
y∈X,B∈AP(x,y)N(y,B)Q(A,B )
=N(α(x),α (A)) =N(x,A).
That is,PNQLlatticetop=N. Equivalently, P=NQN−1.T h u sPand
Q, being similar matrices, have the same trace and the theorem is
proved. /square
Corollary. Thetypeofthecycledecompositionof αonthepoint
setXis the same as the type of the cycle decomposition of αon
the block set A.
Proof: By Theorem 27.1, αihas the same number of ﬁxed points
as ﬁxed blocks, for each i=1,2,....
Suppose a permutation βhascicycles of length ion some set
S,i=1,2,...,|S|. Letfjdenote the number of ﬁxed points of βj.
Then
fj=/summationdisplay
i|jici,
and by M¨ obius inversion, Theorem 10.4,
jcj=/summationdisplay
i|jµ(j
i)fi.
The point is that the numbers of cycles of each length (i.e. the typeofβ) are determined completely by the numbers of ﬁxed points of
the powers of β. /square
Corollary. IfΓis a group of automorphisms of a symmetric de-
sign,thenthenumberoforbitsof Γonthepointset Xisthesame
as the number of orbits of Γon the block set A. In particular, Γis
transitive on the points if and only if Γis transitive on the blocks.
Proof: By Burnside’s lemma, Theorem 10.5, the number of orbits
of a group Γ of permutations of a set Sis determined exactly by
the multiset (f (α):α∈Γ) wheref(α) is the number of elements
ofSﬁxed byα. /square
---PAGE BREAK---
27. Diﬀerence sets and automorphisms 371
Before introducing diﬀerence sets, we digress to give one theo-
rem on orbits of automorphism groups of arbitrary 2-designs. This
has been called Block’s Lemma ; see Block (1967). This provides
another proof of the above corollary, as the dual of a symmetricdesign is also a 2-design according to Theorem 19.9.
Theorem 27.2. IfΓis a group of automorphisms of a 2-(v,k,λ )
design with v>k, then the number of orbits of Γon the point set
Xis less than or equal to the number of orbits of Γon the block
setA.
Proof: LetX
1,X2,...,Xsbe the orbits of Γ on Xand letA1,A2,
...,Atbe the orbits of Γ on A. Deﬁne two s×tmatricesC,D
as follows. C(i,j) is to be the number of points x∈Xithat are
incident with a ﬁxed block A∈Aj(this number is the same for any
blockAinAj).D(i,j) is to be the number of blocks A∈Ajthat
are incident with a ﬁxed point x∈Xi(this number is the same for
any point xinXi).
Consider the s×smatrix product CDLlatticetop.CDLlatticetop(i,plscript) is the sum
overjof the number of ordered pairs ( x,A)∈Xi×Ajwherexis
incident with AandAis incident with a ﬁxed point yinXplscript.S o
CDLlatticetop(i,plscript)=λ|Xi|ifiLnegationslash=plscript, andCDLlatticetop(i,i)=(r−λ)+λ|Xi|; that
is,
CDLlatticetop=(r−λ)I+λdiag(|X1|,|X2|,...,|Xs|)J.
This is similar to the matrix equation (19.7). Since v>k ,w eh a v e
r>λ and the matrix on the right can be seen to be nonsingular
in several ways, e.g. by calculating its determinant. It follows that
the rank of C(andD)i ss, and this cannot be greater than the
numbertof columns. /square
***
LetGbe an abelian group of order v.A(v,k,λ )-diﬀerence set in
Gis ak-subsetD⊆Gsuch that each nonzero g∈Goccurs exactly
λtimes in the multiset (x −y:x,y∈D) of diﬀerences from D.
More formally, we are requiring that the number of ordered pairs(x,y) withx,y∈Dandx−y=gisλwhengLnegationslash= 0 and this number
iskforg= 0. Evidently, λ(v−1) =k(k−1).
---PAGE BREAK---
372 A Course in Combinatorics
Example 27.1. Examples of diﬀerence sets include:
(7,3,1){1,2,4}inZ7
(13,4,1){0,1,3,9}inZ13
(11,5,2){1,3,9,5,4}inZ11
(16,6,2){10,20,30,01,02,03}inZ4×Z4
(16,6,2){0000, 0001, 0010, 0100, 1000, 1111} inZ2×Z2×Z2×Z2
A diﬀerence set is nontrivial when 1<k<v−1. A diﬀerence
set withλ= 1 is sometimes called planar orsimple .
LetGbe an abelian group of order v.F o rS⊆G,g∈G,w e
denote by S+gthetranslate,o r shift,
S+g:={x+g:x∈S}
ofSbyg. LetDbe ak-subset of G, andx,y∈G. In general, we
claim that the number of shifts D+gthat contain both xandyis
equal to the number of times d:=x−yoccurs as a diﬀerence within
D. This is because gLmapsto→(x−g,y−g) is a one-to-one correspondence
between the set {g∈G:{x,y}⊆D +g}and the set of ordered
pairs (a,b) of elements of Dsuch that a−b=x−y. (The reader
may check that this common number is also equal to the cardinality
of the intersection ( D+x)∩(D+y).)
In particular, ( G,{D+g:g∈G}) is a symmetric ( v,k,λ )-design
if and only if Dis a (v,k,λ )-diﬀerence set.
Problem 27A. A(v,k,λ )-quotient set in an arbitrary group Gof
orderv(written multiplicatively) is a k-subsetD⊆Gsuch that
any one of the following conditions holds:
(1) Each nonidentity element g∈Goccurs exactly λtimes in
the list (xy−1:x,y∈D) of ‘right’ quotients from D.
(2) Each nonidentity element g∈Goccurs exactly λtimes in
the list (x−1y:x,y∈D) of ‘left’ quotients from D.
(3)|D∩(Dg)|=λfor each nonidentity g∈G.
(4)|D∩(gD)|=λfor each nonidentity g∈G.
(5) (G,{Dg:g∈G}) is a symmetric ( v,k,λ )-design.
(6) (G,{gD:g∈G}) is a symmetric ( v,k,λ )-design.
Show that the above six conditions are equivalent.
Theorem 27.3. LetGbe a group of order v. The existence of a
(v,k,λ )-quotient set in Gis equivalent to the existence of a sym-
---PAGE BREAK---
27. Diﬀerence sets and automorphisms 373
metric (v,k,λ )-design that admits a group ˆGof automorphisms
that is isomorphic to Gand regular, i.e. sharply transitive, on the
points of the design.
Proof: LetDb ea(v,k,λ )-quotient set in G. Then (G, {gD:g∈
G}) is a symmetric ( v,k,λ )-design. For g∈G, deﬁne a permuta-
tion ˆgofGby ˆg(x)=gx . Then each ˆ gis in fact an automorphism
of (G,{gD:g∈G}) and the group ˆG={ˆg:g∈G}of automor-
phisms is clearly isomorphic to Gand regular on the points.
Conversely, let Gbe given and let ( X,A) be a symmetric (v,k,λ )-
design with regular group ˆGof automorphisms of ( X,A) that is
isomorphic to G. It will be suﬃcient to exhibit a ( v,k,λ )-quotient
set in ˆG.
Fix a point x0∈Xand a block A0∈A. Let
D:={σ∈ˆG:σ(x0)∈A0}.
We claim that Dis a (v,k,λ )-quotient set in ˆG. Since ˆGis regular
and|A0|=k, we have |D|=k. Letαbe a nonidentity element of
ˆG. ThenαD={ασ:σ(x0)∈A0}={τ:τ(x0)∈α(A0)},s o
D∩(αD)={τ :τ(x0)∈A0∩α(A0)}.
Now since ˆGis regular, αhas no ﬁxed points and hence, by Theorem
27.1, ﬁxes no blocks. Thus the block α(A0) is distinct from A0,s o
|A0∩α(A0)|=λ, and by regularity, |D∩(αD)|=λ. This holds for
all nonidentity elements αand establishes our claim. /square
In particular, the existence of a cyclic (v,k,λ )-diﬀerence set, i.e.
a diﬀerence set in Zv, is equivalent to the existence of a symmet-
ric (v,k,λ )-design that admits a cyclic automorphism, i.e. an au-
tomorphism with cycle decomposition on the points—or blocks—
consisting of one cycle of length v.
We now restrict our attention to diﬀerence sets in abelian groups.
Ideally, we would like to describe and classify all diﬀerence sets—toﬁnd out which groups have diﬀerence sets, how many there are, etc.This we shall do for various small parameter triples, but in generalthe existence problem alone is already extremely diﬃcult.
---PAGE BREAK---
374 A Course in Combinatorics
Observe that D⊆Gi sa(v,k,λ )-diﬀerence set if and only if
G\Dis a (v,v−k,v−2k+λ)-diﬀerence set. Thus we may conﬁne
our attention to the case k<1
2v.
Also note that Dis a diﬀerence set if and only if every translate
ofDis a diﬀerence set.
In the case that (v,k ) = 1, it happens that we can choose a
natural representative from the class of all translates; this can be a
help in classiﬁcation and will be useful in the next chapter. Call asubset of an abelian group Gnormalized in the case that the sum
of its elements is zero.
Proposition 27.4. LetDbeak-subset of an abelian group Gof
orderv.I f(v,k)=1, thenDhas a unique normalized translate.
Proof: Lethbe the sum of the elements of D. Then the sum of
the elements of a translate D+gish+kg. Since (v,k) = 1, there
is a unique group element gwithh+kg=0 . /square
The reader is invited to verify to his or her satisfaction that
the normalized diﬀerence sets with parameters ( v,k,λ )=( 7,3,1),
(13,4,1), (11, 5,2), (21, 5,1) are, respectively:
{1,2,4},{3,5,6}inZ
7;
{0,1,3,9},{0,2,5,6},{0,4,10,12},{0,7,8,11}inZ13;
{1,3,4,5,9},{2,6,7,8,10}inZ11;
{7,14,3,6,12},{7,14,9,15,18}inZ21.
(This will be easy after Theorem 28.3—see Example 28.2.) Of
course, for (v,k ) = 1, the total number of diﬀerence sets is vtimes
the number of normalized diﬀerence sets, e.g. there are 52 diﬀerencesets with parameters (13 ,4,1) inZ
13.
A ﬁnal preliminary observation is that if αis any automorphism
of the group G, then a subset D⊆Gis a diﬀerence set if and only
ifα(D) is a diﬀerence set. Thus from a given diﬀerence set we can
obtain others by taking translates and by means of the symmetriesofG. We say that diﬀerence sets D
1,D2inGareequivalent when
there exists α∈Aut(G) andg∈Gsuch that D2=α(D1)+g.
(Check that this is an equivalence relation.) The normalized dif-ference sets shown above are, for each parameter triple, equivalent;
---PAGE BREAK---
27. Diﬀerence sets and automorphisms 375
indeed, each can be obtained from the others by multiplication by
some integer relatively prime to the order of the respective group.
Problem 27B. Show that all (16 ,6,2)-diﬀerence sets in Z2×Z2×
Z2×Z2are equivalent.
Problem 27C. Recall from Example 19.4 that symmetric designs
with parameters v=4t2,k=2t2−t,λ=t2−tare related to regular
Hadamard matrices. Let AandBbe, respectively, (4 x2,2x2−
x,x2−x)- and (4 y2,2y2−y,y2−y)-diﬀerence sets in groups Gand
H(admitxory= 1). Show that
D:= (A×(H\B))∪((G\A)×B)
is a (4z2,2z2−z,z2−z)-diﬀerence set in G×Hwherez=2xy.
(Thus ifGis the direct product of mgroups of order 4, then there
is a (4m,2·4m−1−2m−1,4m−1−2m−1)-diﬀerence set in G.)
We describe several known families of diﬀerence sets. The known
constructions all seem to involve ﬁnite ﬁelds and/or vector spaces.
The ﬁrst of these examples is essentially contained in Chapter 18on Hadamard matrices in the discussion of Paley matrices, but itis worth stating explicitly. Diﬀerence sets with parameters
(v,k,λ )=( 4n−1,2n−1,n−1)
are often called Hadamard diﬀerence sets.
Theorem 27.5 (Paley, Todd). Letq=4n−1beaprimepower.
Thentheset Dofnonzerosquaresin F
qisa(4n−1,2n−1,n−1)-
diﬀerence set in the additive group of Fq.
Proof: Clearly,|D|=2n−1.
SinceDis invariant under multiplication by elements of the set
Sof nonzero squares, the multiset Mof diﬀerences from Dalso has
this property. Also, Mis obviously invariant under multiplication
by−1. Since q≡3 (mod 4), −1/∈Sand every nonzero element of
Fqis either in Sor of the form −sfor somes∈S. In summary, M
is invariant under multiplication by all nonzero elements of Fq, and
soDis a (4n−1,2n−1,λ)-diﬀerence set for some λ. The relation
λ(v−1) =k(k−1) forcesλ=n−1. /square
---PAGE BREAK---
376 A Course in Combinatorics
We obtain diﬀerence sets {1,2,4}inZ7,{1,3,4,5,9}inZ11, and
{1,4,5,6,7,9,11,16,17}inZ19from Theorem 27.5. The (27, 13,6)-
diﬀerence set later in the series will be in the elementary abelian
group of order 27, notZ27.
Problem 27D. Show that the Paley–Todd diﬀerence sets are nor-
malized if q>3.
Stanton and Sprott (1958) found another family of Hadamard
diﬀerence sets.
Theorem 27.6. Ifqandq+2are both odd prime powers, then
with4n−1: =q (q+2),thereexistsa (4n−1,2n−1,n−1)-diﬀerence
set in the additive group of the ring R:=Fq×Fq+2.
Proof: LetU:={(a,b)∈R:aLnegationslash=0,bLnegationslash=0}be the group of
invertible elements of R. LetVbe the subgroup of Uconsisting of
those pairs ( a,b) such that both aandbare squares in the respective
ﬁeldsFqandFq+2or bothaandbare nonsquares. Check that V
is an index 2 subgroup of U, and also that (−1, −1)/∈V.P u t
T:=Fq×{0}. We claim that D:=T∪Vis a diﬀerence set as
required. We do have |D|=q+1
2(q−1)(q+1 )=2n−1.
SinceDis invariant under multiplication by elements of V, the
multiset of diﬀerences from Dalso has this property as well as the
property that it is invariant under multiplication by ( −1,−1). So
the multiset of diﬀerences from Dis invariant under multiplication
by elements of all of U. Thus every element of Uoccurs as a
diﬀerence the same number of times, say λ1. Every element (x, 0)
ofRwithxLnegationslash= 0 will occur, say, λ2times; and every element (0 ,y)
ofRwithyLnegationslash= 0 will occur, say, λ3times as a diﬀerence from D.
Of course, we have
(27.1) k(k−1 )=(q−1)(q+1 )λ1+(q−1)λ2+(q+1 )λ3.
It is easy to evaluate λ2andλ3. Diﬀerences of the form (x, 0),
xLnegationslash= 0 (there are q−1 elements of this form) arise q(q−1) times
fromT, never as a diﬀerence between an element of TandV, and
(q+1)· (1
2(q−1))(1
2(q−1)−1) times as diﬀerences of two elements
ofV;t h u s
(q−1)λ2=q(q−1 )+(q+1 )· (1
2(q−1))(1
2(q−1)−1)
---PAGE BREAK---
27. Diﬀerence sets and automorphisms 377
from which we conclude λ2=1
4(q+ 3)(q−1). In a similar manner
(Problem 27E), the reader will ﬁnd that λ3=1
4(q+3)(q−1). Then
(27.1) implies that λ1=1
4(q+ 3)(q−1) also. /square
Problem 27E. With the notation as in the proof of Theorem 27.6
prove that λ3=1
4(q+ 3)(q−1).
In the case that qandq+ 2 are both primes (twin primes),
Theorem 27.6 yields cyclic diﬀerence sets. For if s,tare relatively
prime integers, Zs×ZtandZstare isomorphic as additive groups—
and also as rings. An isomorphism Zst→Zs×Ztis provided by
x(modst)Lmapsto→(x(mods),x (modt)) . We obtain the (15 ,7,3)-
diﬀerence set {0,5,10,1,2,4,8}inZ15.
Problem 27F. List the elements of a cyclic (35 ,17,8)-diﬀerence
set.
As a special case of Singer’s theorem, Theorem 27.7, we will
obtain another family of Hadamard diﬀerence sets: cyclic diﬀerence
sets with
v=2t−1,k =2t−1−1,λ =2t−2−1.
Recall from Chapter 23 that the points and the hyperplanes of
PG(n,q) form a symmetric design with
(27.2) v=qn+1−1
q−1,k=qn−1
q−1,λ =qn−1−1
q−1.
Theorem 27.7. For any prime power qand positive integer n,
thereisadiﬀerenceset Dwithparametersasin (27.2)inthecyclic
group of order vso that the resulting symmetric design is isomor-
phic to the points and hyperplanes of PG(n,q).
Proof: In view of Theorem 27.3, we need only show that there
exists an automorphism of PG(n,q) that permutes the points in a
single cycle of length v, or equivalently so that the powers of the au-
tomorphism act transitively on the projective points. The points ofPG(n,q) are the 1-dimensional subspaces of an ( n+1)-dimensional
vector space VoverF
q. Any nonsingular linear transformation T
---PAGE BREAK---
378 A Course in Combinatorics
fromVto itself will take subspaces to subspaces of the same di-
mension and thus gives us an automorphism of PG(n,q).
As an (n + 1)-dimensional vector space over Fq, we choose V:=
Fqn+1as a vector space over its subﬁeld Fq. Letωbe a primitive
element of Fqn+1and consider the linear transformation T:xLmapsto→ωx
ofVoverFq. It is clear that Tis nonsingular and that its powers are
transitive on the projective points (even on the nonzero vectors!).
/square
The diﬀerence sets constructed in the proof of Theorem 27.7
above are called Singer diﬀerence sets—see Singer (1938). We give
a more concrete discussion and an example. Let ωbe a primitive
element of Fqn+1and deﬁne v:= (qn+1−1)/(q−1). The cyclic
multiplicative group LangbracketleftωLangbracketrightofFqn+1has a unique subgroup of order
q−1, namely,
LangbracketleftωvLangbracketright={ω0=1,ωv,ω2v,...,ω(q−2)v}.
But the multiplicative group of the subﬁeld Fqhas order q−1, so
we conclude Fq={0,ω0,ωv,ω2v,...,ω(q−2)v}.
Now two ‘vectors’ ωiandωjinFqn+1, considered as a vector space
overFq, represent the same 1-dimensional subspace of Fqn+1if and
only ifωi=αωjfor some 0 Lnegationslash=α∈Fq, that is, if and only if i≡j
(modv). Thus we have a one-to-one correspondence between the
setXof 1-dimensional subspaces (projective points) and the group
Zvof residue classes modulo v:
0↔x0={0,ω0,ωv,ω2v,...,ω(q−2)v}
1↔x1={0,ω1,ωv+1,ω2v+1,...,ω(q−2)v+1}
...
i↔xi={0,ωi,ωv+i,ω2v+i,...,ω(q−2)v+i}
...
v−1↔x
v−1={0,ωv−1,ω2v−1,ω3v−1,...,ω(q−1)v−1}.
The mapxiLmapsto→xi+1(subscripts modulo v) is an automorphism of
the projective space. To obtain a diﬀerence set, let Ube anyn-
dimensional subspace of Fqn+1and letD:={i∈Zv:xi∈U}.A
normalized diﬀerence set is obtained if Uis taken to be the subspace
of elements with trace zero (the trace from Fqn+1toFq).
---PAGE BREAK---
27. Diﬀerence sets and automorphisms 379
Example 27.2. Considern=2 ,q= 5. We construct a (31 ,6,1)-
diﬀerence set. A zero ωof the polynomial y3+y2+ 2 (coeﬃcients
inF5) is a primitive element of F53and 1,ω,ω2furnish a basis for
F53as a vector space over F5. The 124 nonzero elements of F53fall
into 31 cosets modulo the subgroup Langbracketleftω31Langbracketright={3,4,2,1}=F5\{0},
each coset being the nonzero elements of a 1-dimensional subspace.
Let us take U:= span{1,ω }as our 2-dimensional subspace. Rep-
resentatives of the projective points on Uare 1,ω,ω+1 ,ω+2 ,
ω+3 ,ω+ 4 and, after some computation,
1=ω0
ω=ω1
ω+1=ω29
ω+2=ω99
ω+3=ω80
ω+4=ω84.
The resulting Singer diﬀerence set is
{0,1,29,6,18,22} inZ31.
Problem 27G. Find a (57 ,8,1)-diﬀerence set in Z57. (Some will
probably not want to do this by hand.)
Considern=3 ,q= 2. Here the points of PG(3,2) are in one-to-
one correspondence with the nonzero elements of F24that in turn
are in one-to-one correspondence with the residues modulo 15. Itmay be instructive to write out all lines and planes of this smallestprojective 3-space so that the cyclic automorphism is clear.
A zeroωofy
4+y+1 (coeﬃcients in F2) is a primitive element of
F24andω3,ω2,ω,1 from a basis for F24overF2. Any element of F24
can be written uniquely as a3ω3+a2ω2+a1ω+a0that we abbreviate
asa3a2a1a0below. We have ω4+ω+1=0 ,o r ω4= 0011. We ﬁrst
construct a table of vector representations of powers of ω.
---PAGE BREAK---
380 A Course in Combinatorics
F24
ω0=0 0 0 1 ω5= 0110 ω10= 0111
ω1=0 0 1 0 ω6= 1100 ω11= 1110
ω2=0 1 0 0 ω7= 1011 ω12= 1111
ω3=1 0 0 0 ω8= 0101 ω13= 1101
ω4=0 0 1 1 ω9= 1010 ω14= 1001
PG(3,2)
Lines Planes
{0,5,10}{ 0,1,4}{ 0,2,8}{ 1,2,4,8,0,5,10 }
{1,6,11}{ 1,2,5}{ 1,3,9}{ 2,3,5,9,1,6,11 }
{2,7,12}{ 2,3,6}{ 2,4,10}{ 3,4,6,10,2,7,12 }
{3,8,13}{ 3,4,7}{ 3,5,11}{ 4,5,7,11,3,8,13 }
{4,9,14}{ 4,5,8}{ 4,6,12}{ 5,6,8,12,4,9,14 }
{5,6,9}{ 5,7,13}{ 6,7,9,13,5,10,0 }
{6,7,10}{ 6,8,14}{ 7,8,10,14,6,11,1 }
{7,8,11}{ 7,9,0}{ 8,9,11,0,7,12,2 }
{8,9,12}{ 8,10,1}{ 9,10,12,1,8,13,3 }
{9,10,13}{ 9,11,2}{ 10,11,13,2,9,14,4 }
{10,11,14}{ 10,12,3}{ 11,12,14,3,10,0,5 }
{11,12,0}{ 11,13,4}{ 12,13,0,4,11,1,6 }
{12,13,1}{ 12,14,5}{ 13,14,1,5,12,2,7 }
{13,14,2}{ 13,0,6}{ 14,0,2,6,13,3,8 }
{14,0,3}{ 14,1,7}{ 0,1,3,7,14,4,9 }
Note that for q= 2, the Singer diﬀerence sets have Hadamard
parameters. We obtain (31 ,15,7)-diﬀerence sets both from The-
orem 27.5 and Theorem 27.7. These two diﬀerence sets are not
equivalent—and not even isomorphic. (Two diﬀerence sets are iso-
morphic when the corresponding symmetric designs are isomorphic.
Equivalent diﬀerence sets are surely isomorphic, but the converseis not true.) The diﬀerence set Dof quadratic residues modulo 31
has the property that
D∩(D+1 )∩ (D+3 )={5,8,10,19}.
---PAGE BREAK---
27. Diﬀerence sets and automorphisms 381
The design (Z 31,{D+g:g∈Z31}) cannot be isomorphic to the
points and hyperplanes of PG(4,2) since the intersection of ﬂats is
again a ﬂat and PG(4,2) has no ﬂats with precisely four points.
Gordon, Mills, and Welch (1962) have shown that the construc-
tion of Singer’s theorem can be modiﬁed in some cases to produce
many nonequivalent diﬀerence sets with the same parameters.
Problem 27H. LetDbe an (n2+n+1,n+1,1)-diﬀerence set
in an abelian group G. Show that −Dis anovalin the associated
projective plane.Problem 27I. LetG={0,a
0,a1,...,aq}be any group of order
q+2, where qis a power of a prime. Let Vbe a 2-dimensional vector
space over Fqand letU0,U1,...Uqbe its 1-dimensional subspaces.
Show that
D:=q/uniondisplay
i=0{ai}×Ui
is a diﬀerence set in G×V. For example, we obtain a (45,12,3)-
diﬀerence set.
Notes.
The idea of group diﬀerence sets, as a generalization of cyclic
diﬀerence sets, is due to R. H. Bruck (1955).
Problem 27I is a result of McFarland (1973).
Theorem 27.2 holds also for arbirary 2-designs, simple or not. Of
course, one must deﬁne an automporphism of an arbitrary incidencestructures S=(P,B,I). Perhaps the most precise deﬁnition is as
an ordered pair ( α,β), whereαis a permutation of P,βis a permu-
tation of B, and such that ( x,A)∈Iif and only if ( α(x),β (A))∈I.
The automporphisms form a group under coordinate-wise composi-tion. The permutations αthat occur as ﬁrst coordinates of a group
Γ of automorphisms form a group Γ
1of permutations of the points;
the permutations βthat occur as second coordinates of a group Γ
of automorphisms form a group Γ 2of permutations of the blocks.
By the orbits of Γ on the points, respectively blocks, we mean theorbits of Γ
1, respectively Γ 2.
---PAGE BREAK---
382 A Course in Combinatorics
References.
R. E. Block (1967), On the orbits of collineation groups, Math Z.
96, 33–49.
R. H. Bruck (1955), Diﬀerence sets in a ﬁnite group, Trans. Amer.
Math. Soc. 78, 464–481.
B. Gordon, W. H. Mills, and L. R. Welch (1962), Some new diﬀer-
ence sets, Canad. J. Math. 14, 614–625.
R. L. McFarland (1973), A family of diﬀerence sets in non-cyclic
groups, J. Combinatorial Theory (A)15, 1–10.
J. Singer (1938), A theorem in ﬁnite projective geometry and some
applications to number theorey, Trans. Amer. Math. Soc. 43,
377–385.
R. G. Stanton and D. A. Sprott (1958), A family of diﬀerence sets,
Canad. J. Math. 10, 73–77.
---PAGE BREAK---
28
Diﬀerence sets and the
group ring
The group ring provides a natural and convenient setting for the
study of diﬀerence sets. The existence of a diﬀerence set will beseen to be equivalent to the existence of a solution to a certainalgebraic equation in a group ring. We shall use the group ringto derive the celebrated Multiplier Theorem of M. Hall, Jr. as wellas number-theoretic criteria on the parameters of a diﬀerence setwhich are stronger than the Bruck-Ryser-Chowla theorem.
LetRbe a ring (commutative with one) and Ga ﬁnite abelian
group (written additively). The elements of the group ring R[G]
are all formal sums
A=/summationdisplay
g∈Gagxg,
whereag∈Rfor eachg∈G. (Here the symbol xis just a place
holder. The important thing is that we have an element agofR
for each element gofG, i.e. the elements of the group ring are in
one-to-one correspondence with mappings G→R.)
We deﬁne addition and scalar multiplication in the obvious way:
/summationdisplay
g∈Gagxg+/summationdisplay
g∈Gbgxg:=/summationdisplay
g∈G(ag+bg)xg,
c/summationdisplay
g∈Gagxg:=/summationdisplay
g∈G(cag)xg.
Multiplication in R[G] is deﬁned by
/summationdisplay
g∈Gagxg/summationdisplay
g∈Gbgxg:=/summationdisplay
g∈G
/summationdisplay
h+h/prime=gahbh/primex
g.
---PAGE BREAK---
384 A Course in Combinatorics
With these deﬁnitions, R[G] is a commutative, associative R-
algebra. The notation we have chosen is appropriate for abelian
groups and emphasizes an analogy with polynomials. Note thatwhenGis the additive group of the residues modulo v, then the
group ring R[Z
v] consists of all sums/summationtextv−1
i=0rixi(exponents modulo
v) and is isomorphic to the factor ring R[x]/(xv−1) of the polyno-
mial ringR[x].In general, we shall even take to denoting elements
of arbitrary group rings R[G]a sA(x),B (x),... when convenient.
The element x0∈R[G] is the multiplicative identity in R[G] and
we denote x0by 1.
We shall be concerned almost exclusively with the group rings
Z[G] over the integers. For a subset A⊆G,we deﬁneA(x)∈Z[G]
by
A(x)=/summationdisplay
g∈Axg.
In particular, G(x)=/summationtext
g∈Gxg.F o rA, B⊆G,
A(x)B (x)=/summationdisplay
g∈Gcgxg,
wherecgis the number of times goccurs in the multiset
(h+hLprime:h∈A,hLprime∈B)
of sums of elements of AandB.
ForA(x)=/summationtext
g∈Gagxg∈Z[G], we write
A(x−1): =/summationdisplay
g∈Gagx−g.
So for ak-subsetDof a group Gof orderv,Dis a (v,k,λ )-diﬀerence
set inGif and only if the equation
D(x)D(x−1)=n +λG(x)
holds in the group ring Z[G], where n:=k−λ.
An important homomorphism from Z[G]t oZ is given by
A(x)Lmapsto→A(1) :=/summationdisplay
g∈Gag∈Z.
---PAGE BREAK---
28. Diﬀerence sets and the group ring 385
Proposition 28.1. Letv,k,λbe positive integers such that
λ(v−1) =k(k−1)
and letGbe an abelian group of order v. The existence of a
(v,k,λ )-diﬀerence set in Gis equivalent to the existence of an ele-
mentA(x)∈Z[G]satisfying the equation
(28.1) A(x)A(x−1)=n +λG(x),
wheren:=k−λ.
Proof: We have already pointed out that for a subset DofG,
D(x) satisﬁes (28.1) if and only if Di sa(v,k,λ )-diﬀerence set. It
remains to show that if there is a solution A(x) to (28.1), then we
can ﬁnd a solution B(x)=/summationtext
g∈Gbgxgwhere the coeﬃcients bgare
0’s and 1’s.
Assume that A(x) satisﬁes (28.1) and apply the homomorphism
‘xLmapsto→1’ from Z[G]→Z. We ﬁnd
(A(1))2=n+λv=k2,
soA(1) =kor−k.N o w i f A(x) satisﬁes (28.1), then so does
B(x)=−A(x ),so we may assume A(1) =/summationtextag=k.
The coeﬃcient of 1 = x0inA(x)A(x−1)i sk =/summationtext
g∈Ga2
g.T h u s/summationtext
g∈Gag(ag−1) = 0. But a(a−1) is strictly positive unless the
integerai s0o r1 . /square
For any integer t,gLmapsto→tgis a homomorphism of the group Ginto
itself and induces a ring homomorphism Z[G]→Z[G], namely
A(x)=/summationdisplay
g∈GagxgLmapsto→A(xt): =/summationdisplay
g∈Gagxtg.
ForA, B∈Z[G] andn∈Z,w es a yA≡B(modn) whenA−B=
nCfor someC∈Z[G]. Here is an easy lemma we will use often.
Lemma 28.2. Letpbe a prime and A∈Z[G].Then
(A(x))p≡A(xp)( m o dp).
---PAGE BREAK---
386 A Course in Combinatorics
Proof: We proceed by induction on the number of nonzero co-
eﬃcients of A(x). The lemma holds for A(x)=0.Now ifA(x)=
cxg+B(x) where Bp(x)≡B(xp)( m o dp),then
Ap(x)=(cxg+B(x))p≡(cxg)p+Bp(x)
=cpxpg+Bp(x)≡cxpg+B(xp)=A(xp),
where the congruences are modulo p. /square
LetGbe an abelian group and Da diﬀerence set in G.A n
automorphism αofGis said to be a multiplier ofDif and only if
the diﬀerence set α(D) is in fact a translate of D, i.e. if and only
ifα(D)=D +gfor someg∈G. For example, the automorphism
xLmapsto→3xofZ13is a multiplier of the (13, 4,1)-diﬀerence set {0,2,3,7}
since{0,6,9,8}={0,2,3,7}+6 .
Iftis an integer relatively prime to the order of G, thenxLmapsto→tx
is an automorphism of Gsince the maps xLmapsto→t1xandxLmapsto→t2x
coincide if and only if t1≡t2(modv∗) wherev∗is the exponent
ofG, i.e. the least common multiple of the orders of the elements
ofG.I fxLmapsto→txis a multiplier of a diﬀerence set DinG,w es a y
thattis anumerical multiplier orHall multiplier ofD.I ti sa tﬁ r s t
surprising that many diﬀerence sets (e.g. all known cyclic diﬀerence
sets) must necessarily have a nontrivial numerical multiplier.
Problem 28A. Letq=pt,pprime. Show that pis a multiplier
of the Singer diﬀerence sets described in the previous chapter.
Observe that an automorphism αofGis a multiplier of a dif-
ference set DinGif and only if in the group ring Z[G],D(xα)=
xg·D(x) for some g∈G.
Theorem 28.3 (Multiplier Theorem, ﬁrst version). LetD
bea(v,k,λ )-diﬀerence set in an abelian group Gof orderv.Le tp
beaprime, p|n,(p,v)=1,p>λ. Thenpisanumericalmultiplier
ofD.
It will be convenient to isolate part of the proof as a lemma.
Lemma 28.4. Letαbe an automorphism of Gand letDbe a
(v,k,λ )-diﬀerence set in G. Consider
S(x): =D (xα)D(x−1)−λG(x).
---PAGE BREAK---
28. Diﬀerence sets and the group ring 387
Thenαis a multiplier of Dif and only if S(x)has nonnegative
coeﬃcients.
Proof: We begin by remarking that if αis a multiplier, then we
haveD(xα)=xg·D(x) for some g∈G, and then
D(xα)D(x−1)=xg·D(x)D(x−1)=xg(n+λG(x)) =nxg+λG(x).
So in this case, S(x), as deﬁned above, is equal to nxgfor some
g∈G. In particular, it has nonnegative coeﬃcients. Note that,
conversely, if D(xα)D(x−1)=nxg+λG(x), we can multiply this by
D(x)t oﬁ n d
D(xα)·(n+λG(x)) = nxg·D(x)+λD (x)G(x ),
nD(xα)+λkG(x)=nxg·D(x)+λkG(x).
SoD(xα)=xg·D(x) andαis a multiplier.
Now ‘xLmapsto→xα’ is an automorphism of Z[G], soD(xα)D(x−α)=
n+λG(x), i.e.α(D) is also a diﬀerence set, and
S(x)S(x−1)={D (xα)D(x−1)−λG(x)}{D (x−α)D(x)−λG(x)}
={n+λG(x)}2−2λk2G(x)+λ2vG(x)
=n2+2λ(n+λv−k2)G(x)=n2.
Suppose that S(x)=/summationtext
g∈Gsgxgwith nonnegative coeﬃcients sg.
Ifsg>0 andsh>0 forg,h∈G, then the coeﬃcient of xg−h
inS(x)S(x−1), =n2, is at least sgsh, i.e. strictly positive, and so
xg−h=x0, i.e.g=h.SoS(x) can have only one positive coeﬃcient,
sayS(x)=s gxg.The equation S(x)S(x−1)=n2forcessg=nand
we have shown S(x)=nxg. As noted above, we may conclude that
αis a multiplier. /square
Proof of Theorem 28.3: LetS(x):=D(xp)D(x−1)−λG(x).
By Lemma 28.4, it will suﬃce to show that S(x) has nonnegative
coeﬃcients. By Lemma 28.2,
D(xp)D(x−1)≡Dp(x)D(x−1)≡Dp−1(x)D(x)D(x−1)
≡Dp−1(x)·(n+λG(x))≡nDp−1(x)+λkp−1G(x)
≡λG(x)( m o d p),
---PAGE BREAK---
388 A Course in Combinatorics
sincepdividesnandλkp−1≡λp≡λ(modp). Thus the co-
eﬃcients of D(xp)D(x−1), which are clearly nonnegative, are all
congruent to λmodulop. Sincep>λ , it must be that the coeﬃ-
cients ofD(xp)D(x−1) are greater than or equal to λ, i.e.S(x) has
nonnegative coeﬃcients. /square
Problem 28B. Find an element S(x)i nZ[Z 7] with the property
thatS(x)S(x−1) = 4, but with S(x)Lnegationslash=±2xg.
Note that the hypothesis p>λ was essential for our proof. Yet in
everyknown diﬀerence set, every prime divisor of n(not dividing
v) is a multiplier. It may be, then, that the hypothesis p>λ
is unnecessary and by now the question of whether this is so has
acquired the status of a classical unsolved problem. There have alsobeen several generalizations of the original Multiplier Theorem, allof which would be trivial if we could eliminate the condition p>λ ,
and we state such a generalization below after ﬁrst giving someapplications of the current version.
Corollary. Forλ=1, every prime divisor of n, and hence every
divisor, is a multiplier of every (n
2+n+1,n+1,1)-diﬀerence set.
Example 28.1. We claim that there are no (n2+n+1,n+1,1)-
diﬀerence sets with n≡0 (mod 6). Let Dbe such a hypothetical
diﬀerence set, and without loss of generality, assume Dis normal-
ized so that it is ﬁxed by all multipliers. Both 2 and 3 would be
multipliers. Then for x∈D,2xand 3xalso are in D. Then the
diﬀerence xoccurs twice, once as 2 x−x, and once as 3x −2x;
these are diﬀerent occurrences as long as 3 xLnegationslash=2x, i.e.xLnegationslash= 0. This
contradicts λ=1 .
Problem 28C. Show that there are no ( n2+n+1,n+1,1)-
diﬀerence sets with ndivisible by any of 10, 14, 15, 21, 22, 26, 34,
35.
It has been possible to prove, with the Multiplier Theorem and
other techniques, that no planar diﬀerence sets exist for n≤3600
unlessnis a prime power. But the conjecture that nmust be a
prime power remains open.
Example 28.2. Consider a normalized (21 ,5,1)-diﬀerence set D
inZ21. By the Multiplier Theorem, 2 is a multiplier and hence
---PAGE BREAK---
28. Diﬀerence sets and the group ring 389
2D=D.T h u sDmust be the union of the cycles of xLmapsto→2xon
Z21. These are
{0},{1,2,4,8,16,11},{3,6,12},{5,10,20,19,17,13},
{7,14}, and{9,18,15}.
ButDhas 5 elements, so ifthere is such a diﬀerence set, Dmust be
{7,14,3,6,12}or{7,14,9,18,15}. It turns out that both of these
arediﬀerence sets. One consists of the negatives of the other, so
the 42 diﬀerence sets with these parameters are all equivalent.
Problem 28D. Find all normalized diﬀerence sets with parame-
ters (7, 3,1), (11,5,2), (13, 4,1), (19, 9,4), (31, 10,3), and (37 ,9,2).
(Note: no diﬀerence sets exist for one of the parameter triples.)
We give two more easy lemmas on the group ring at this point.
Lemma 28.5. LetGbeanabeliangroupoforder vandpaprime,
p/notbarv.Le tA∈Z[G]andsuppose Am≡0( m o dp)forsomepositive
integerm. ThenA≡0( m o dp).
Proof: Choose a power q=peofpsuch that q≥mandq≡1
(modv).Then surely Aq(x)≡0( m o dp).But by Lemma
28.2,Aq(x)≡A(xq)( m o dp),soA(xq)≡0( m o dp).Sinceq≡1
(modv),q g=gfor everyg∈GandA(x)=A(xq). /square
Note that xg·G(x)=G(x)i n Z[G]. It follows that
A(x)G(x)=A(1)G(x).
Forn∈ZandA, B∈Z[G], we sayA≡B(modn,G) when A−B
is an element of the ideal in Z[G] generated by nandG=G(x), or
equivalently, when
A−B=nC+mG
for someC∈Z[G].
Lemma 28.6. LetGbeanabeliangroupoforder vandpaprime,
p/notbarv.IfA∈Z[G]and
Am≡0( m o dp,G)
for some positive integer m, thenA≡0( m o dp,G).
Proof: Chooseq=pewithq≡1( m o dv) andq≥m.Then
Aq(x)≡0( m o dp,G) and Aq(x)≡A(xq)=A(x)( m o d p). /square
---PAGE BREAK---
390 A Course in Combinatorics
Theorem 28.7 (Multiplier Theorem, second version). Let
Dbea(v,k,λ )-diﬀerencesetinanabeliangroup Gofexponent v∗.
Lettbe an integer, (t,v)=1, and suppose we can ﬁnd a divisor
mofn:=k−λsuch that m>λand for every prime divisor p
ofm, there is an integer ffor which pf≡t(modv∗).Thentis a
numerical multiplier of D.
Proof: The proof will use Lemmas 28.2, 28.4, 28.5 and the fol-
lowing observation:
LetDb ea(v,k,λ )-diﬀerence set in G,αan automorphism of G,
and putS(x): =D(xα)D(x−1)−λG(x). Assume that αhas order
e, so that αe= identity. Then, we assert, in the group ring Z[G],
S(x)S(xα)S(xα2)···S(xαe−1)=ne.
To see this, note that for any integer i,w eh a v e
D(xαi)D(x−αi)=n +λG(x)≡n(modG)
and
S(xαi)=D (xαi+1)D(x−αi)−λG(x)
≡D(xαi+1)D(x−αi)( m o dG).
Then
S(x)S(xα)s(xα2)···S(xαe−1)
≡{D(xα)D(x−1)}{D(xα2)D(x−α)}···{D(x)D(x−αe−1)}
≡{D(x)D(x−1)}{D(xα)D(x−α)}···{D(xαe−1)D(x−αe−1)}
≡ne(modG).
ThusS(x)S(xα)···S(xαe−1)=ne+plscriptG(x) for some integer plscript. But
S(1) = (D(1))2−λG(1) =k2−λv=n; so applying the homomor-
phismxLmapsto→1, we ﬁnd ne=ne+plscriptv, and hence plscript=0 .
To continue with the proof, let S(x): =D (xt)D(x−1)−λG(x).
By Lemma 28.4, to show tis a multiplier, it will be suﬃcien tt o
prove that S(x) has nonnegative coeﬃcients. Each coeﬃcient of
---PAGE BREAK---
28. Diﬀerence sets and the group ring 391
S(x)i sa tl e a s t−λ in value and since m>λ , the nonnegativity
of the coeﬃcients will follow if we can establish that S(x)≡0
(modm).To establish this, it will suﬃce to show that S(x)≡0
(modpi) whenever pis prime and pidividesm. This we do below.
Letebe the order of tmodulov∗, so thatte≡1( m o dv∗). As
shown above,
S(x)S(xt)S(xt2)···S(xte−1)=ne.
Letpbe a prime divisor of mand letfbe such that pf≡t
(modv∗). Then
S(x)S(xpf)S(xp2f)···S(xpf(e−1))=ne.
Letpibe the highest power of pdividingnand letpjbe the
highest power of pdividing (all coeﬃcients of) S(x), soS(x)=
pjT(x) where T(x)Lnegationslash≡0( m o d p). Then
pjT(x)pjT(xpf)···pjT(xpf(e−1))=ne,
from which it follows that pjdividesn(soj≤i) and
T(x)T(xpf)···T(xpf(e−1))=(n
pj)e.
Suppose that j<i, so that (n
pj)eis divisible by p. Then
0≡T(x)T(xpf)···T(xpf(e−1))
≡T(x)Tpf(x)···T(x)Tpf(e−1)(x)
≡(T(x))1+pf+···+pf(e−1)(modp).
But then, by Lemma 28.5, T(x)≡0( m o dp), contradicting the
choice ofj.T h u si=j. /square
Corollary. Ifn=pe,pprime, (p,v)=1, thenpis a numerical
multiplier of every (v,k,λ )-diﬀerence set.
Proof: A diﬀerence set Dand its complement G\Dhave the
same multipliers. Thus we may assume that k<1
2vand hence
n>λ . In Theorem 28.7, take m=n,t=p. /square
---PAGE BREAK---
392 A Course in Combinatorics
Example 28.3. Consider a hypothetical (25,9,3)-diﬀerence set.
Taket= 2 and m= 6 in the above theorem. Since 33≡2
(mod 25), we may conclude that 2 is a multiplier.
Problem 28E. Find all normalized diﬀerence sets with parame-
ters (15, 7,3), (25, 9,3), (39, 19,9), (43, 15,5), and (61 ,16,4). De-
termine, for each parameter set, whether these normalized diﬀer-
ence sets are equivalent. (Note: diﬀerence sets do not exist for mostparameter sets.)
Problem 28F. LetDbe a nontrivial ( v,k,λ )-diﬀerence set. Prove
that if−1 is a multiplier of D, thenvis even.
Problem 28G. Find a (36,15,6)-diﬀerence set in Z
6×Z6with−1
as a multiplier.
***
SupposeDi sa(v,k,λ)-diﬀerence set in an abelian group Gof
even order v. By Theorem 19.11(i), we know that nis a square.
But in the case of diﬀerence sets, we can say whatnis the square
of! LetAbe any subgroup of Gof index 2. Say Dcontainsa
elements of Aandbelements of B:=G\A. Since every element
ofBoccursλtimes as a diﬀerence from D, and only diﬀerences of
one element in Aand one in Blie inB,2ab=1
2λv. From this and
a+b=k, we ﬁnd that (a −b)2=n.
Now suppose vis divisible by 3, let Abe a subgroup of Gof
index 3, and let BandCbe the cosets of AinG.S a yDcontainsa
elements of A,belements of B, andcelements of C. The number
of diﬀerences from Dwhich lie in B,s a y ,i sba +cb+ac, which on
the other hand must be1
3λv. From this and a+b+c=k, we can
check that 4n =(b+c−2a)2+3 (b−c)2. Now it is not true that
every integer can be written as the sum of a square and three times
another square, so this condition rules out the existence of certaindiﬀerence sets. For example, there are no (39, 19,9)-diﬀerence sets,
even though there are symmetric designs with these parameters,because 4n= 40 cannot be written as above.
We generalize the above necessary conditions on the parameters
of diﬀerence sets by considering homomorphisms of the group ring.
---PAGE BREAK---
28. Diﬀerence sets and the group ring 393
Ifαis a homomorphism G→H, thenαinduces a ring homomor-
phism Z[G]→Z[H]:
A(x)=/summationdisplay
agxgLmapsto→A(xα): =/summationdisplay
agxα(g)∈Z[H].
Theorem 28.8. LetDbe a (v,k,λ )-diﬀerence set in an abelian
groupG.Le tu>1be a divisor of v.I fpis a prime divisor of n
and
pf≡−1( m o du)
forsomeinteger f, thenpdoesnotdividethesquarefreepartof n.
Proof: We prove something stronger. Let α:G→Hbe a homo-
morphism onto a group Hof orderuand exponent u∗, say. Suppose
pis prime and pf≡−1( m o du∗) for some f. We will show that n
is exactly divisible by an even power p2jofpand that for this j,
D(xα)≡0( m o dpj,H)i nZ[H].
In other words, all the coeﬃcients of D(xα), which are the numbers
of elements of Dbelonging to the various cosets of the kernel of α,
are congruent to each other modulo pj.
Letpibe the highest power of pwhich divides n. Our hypothesis
pf≡−1( m o du∗) means that D(x−α)=D (xpfα)i nZ[H] (where
we will do our calculations), so we have
(28.2)D(xα)D(xpfα)=
D(xα)D(x−α)=n +λv
uH(x)≡0( m o dpi,H).
Letpjbe the highest power of pso thatD(xα)≡0( m o dpj,H);
sayD(xα)≡pjA(x)( m o dH). The reader may check that (28.2)
implies that 2j ≤iand that if 2 j<i , thenA(x)A(xpf)≡0
(modp,H). But then Lemmas 28.2 and 28.6 imply in turn that
A(x)1+pf≡0( m o dp,H) and then A(x)≡0( m o dp,H).This
contradicts the choice of j,s o2j=i. /square
Consequences of Theorem 28.8 are: if vis divisible by 3, then
all prime divisors of the squarefree part of nare congruent to 0
or 1 (modulo 3); if vis divisible by 5, then all prime divisors of
the squarefree part of nare congruent to 0 or 1 (modulo 5); if v
is divisible by 7, then all prime divisors of the squarefree part of n
are congruent to 0, 1, 2, or 4 (modulo 7).
---PAGE BREAK---
394 A Course in Combinatorics
Example 28.4. We give an application of the stronger claim given
in the proof of Theorem 28.8. Consider a hypothetical (154 ,18,2)-
diﬀerence set DinG. Letα:G→Hbe a homomorphism onto a
groupHof orderu:= 11. Take p:= 2. Since 25≡−1 (mod 11),
we conclude that D(xα)≡0( m o d4,H). This means the 11 co-
eﬃcients of D(xα) are all congruent to some integer hmodulo 4;
since the 11 coeﬃcients sum to 18, his 2. But then the coeﬃcients
would sum to at least 22 and this contradiction shows that no such
diﬀerence sets exist.
Problem 28H. LetDb ea(q4+q2+1,q2+1,1)-diﬀerence set in an
abelian group G. Letα:G→Hbe a homomorphism onto a group
Hof orderu:=q2−q+1. Show that any coset of the kernel of αis
the point set of a Baer subplane of the projective plane of order q2
arising from D. For example, the 21 points of the projective plane
of order 4 are partitioned into three Fano conﬁgurations.Problem 28I. LetDbe a (q
3+q2+q+1,q2+q+1,q+1)-diﬀerence
set in an abelian group G. Letα:G→Hbe a homomorphism
onto a group Hof orderu:=q+ 1. Show that the translates of D
meet the cosets of the kernel of αinq+ 1 points or a single point.
Show further that if the symmetric design arising from Dconsists
of the points and planes of PG3(q), then the cosets are ovoids (see
Example 26.5).
Notes.
The celebrated Multiplier Theorem was ﬁrst proved in the case
of cyclic planar diﬀerence sets in Hall (1947). It was generalized to
λ>1 by Hall and Ryser (1951) and since then has been extendedin many ways—see e.g. Mann (1965), Baumert (1971), and Lander(1983). Algebraic number theory and characters of abelian groupsoften play a role in the proofs of these results, but we have chosenhere to give proofs of Theorem 28.7 and 28.8 using only the groupring.
Marshall Hall (1910–1990) did fundamental work in group theory
and coding theory as well as on combinatorial designs. He hasbeen a tremendous inﬂuence on many mathematicians, includingthe authors.
---PAGE BREAK---
28. Diﬀerence sets and the group ring 395
Theorem 28.8 is due to K. Yamamoto (1963).
References.
L. D. Baumert (1971), Cyclic Diﬀerence Sets , Lecture Notes in
Math.182, Springer-Verlag.
M. Hall (1947), Cyclic projective planes, Duke J. Math. 14, 1079–
1090.
M. Hall and H. J. Ryser (1951), Cyclic incidence matrices, Canad.
J. Math. 3, 495–502.
E. S. Lander (1983), Symmetric Designs: An Algebraic Approach ,
London Math. Soc. Lecture Note Series 74, Cambridge Univer-
sity Press.
H. B. Mann (1965), Addition Theorems , Wiley.
K. Yamamoto (1963), Decomposition ﬁelds of diﬀerence sets, Pa-
ciﬁc J. Math. 13, 337–352.
---PAGE BREAK---
29
Codes and symmetricdesigns
In this chapter, we elaborate on some of the material introduced in
Chapter 20. We saw in that chapter that the rows of the incidencematrix of a projective plane of order n≡2 (mod 4) span a binary
code which, when extended, is self-dual. It was observed by H. A.Wilbrink (1985) and others that that result can be used to showthat planar diﬀerence sets do not exist for values of n>2 with
n≡2 (mod 4); see Theorem 29.7.
One can consider the code spanned by the rows of the incidence
matrix over other prime ﬁelds F
pas well. With essentially the same
proof as that of Theorem 20.6, we have the following theorem.
Theorem 29.1. Ifpdividesn:=k−λ,thenthe Fp-spanCofthe
rows of the incidence matrix Nof a symmetric (v,k,λ )-design has
dimension at most (v+1 )/2overFp.I f(p,k)=1andp2does not
dividen,thenthedimensionofthis p-arycodeisexactly (v+1)/2.
Problem 29A. Prove Theorem 29.1.
It is not possible, in general, to extend the code Cto get a code
of lengthv+ 1 that is self-orthogonal with respect to the standard
dot product on Fv
p. But let us consider other ‘scalar products’ for
odd primes p.
To a nonsingular m×mmatrixBover a ﬁeld F, we may associate
the scalar product (or bilinear form)
Langbracketleftx,yLangbracketright:=xByLlatticetop
forx,y∈Fm. For a subspace CofFm, let
CB:={x:Langbracketleftx,yLangbracketright= 0 for all y∈C}.
---PAGE BREAK---
29. Codes and symmetric designs 397
ThenCandCBhave complementary dimensions and ( CB)B=
C. We say that Cistotally isotropic whenC⊆CB; this is the
appropriate terminology for this generalization of self-orthogonal.
We have use for the following theorem of Witt, and we include aproof here as it is essentially a rephrasing of part of Theorem 26.6.
Theorem 29.2. Given a symmetric nonsingular matrix Bover a
ﬁeldFofoddcharacteristic,thereexistsatotallyisotropicsubspace
of dimension m/2inF
mif and only if (−1)m/2det(B )is a square
inF.
Proof: A totally isotropic subspace of dimension m/2 is, when
considered as a set of projective points in PG(m−1,2), a ﬂat of
projective dimension (m/2) −1 that is contained completely in the
quadricQdeﬁned by the nondegenerate quadratic form
f(x)=xB xLlatticetop.
By Theorem 26.6, such a subspace exists if and only if Qis hyper-
bolic. It remains only to verify that Qis hyperbolic if and only if
(−1)m/2det(B ) is a square in F.
Iff1is a form projectively equivalent to f, thenf1(x)=xB 1xLlatticetop
whereB1=UBULlatticetopfor some nonsingular matrix U. Of course,
(−1)m/2det(B ) is a square if and only if ( −1)m/2det(B 1) is a square.
IfQis hyperbolic, then fis equivalent to f1=x1x2+···+xm−1xm
andB1is block diagonal with m/2 matrices
W=1
2/parenleftbigg
01
10/parenrightbigg
on the diagonal. Then ( −1)m/2det(B 1)=1/2m, which is a square.
IfQis elliptic, then fis equivalent to f1=x1x2+···+xm−3xm−2+
p(xm−1,xm) wherep(x,y )=ax2+2bxy+cy2is an irreducible
quadratic form over F, and here B1is block diagonal with ( m/2)−1
matricesWand one matrix
/parenleftbigg
ab
bc/parenrightbigg
on the diagonal. Then ( −1)m/2det(B 1)=(b2−ac)/2m−2, and this
is a nonsquare in Fsincepis irreducible. /square
---PAGE BREAK---
398 A Course in Combinatorics
It will be convenient to retain the term self-dual for a totally
isotropic subspace of dimension equal to half its length. E. S. Lan-
der (1983) has shown how to associate a family ofp-ary codes of
lengthv+ 1 and a scalar product to a symmetric design in such a
way that one of the codes is self-dual when nis exactly divisible
by an odd power of p. Theorem 29.2 then gives us a condition on
the parameters of the symmetric design. It turns out that theseconditions are already consequences of the Bruck–Ryser–Chowlatheorem, Theorem 19.11. In some sense, then, these self-dual codesprovide a ‘combinatorial interpretation’ of part of the BRC theo-rem. In any case, these codes carry information about the designand have further applications in the theory of symmetric designs—see Lander (1983).
Theorem 29.3. Supposethereexistsasymmetric (v,k,λ )-design
wherenis exactly divisible by an odd power of a prime p. Write
n=p
fn0(fodd)andλ=pbλ0with (n0,p)=(λ0,p)=1. Then
there exists a self-dual p-ary code of length v+1with respect to
the scalar product corresponding to
B=/braceleftbiggdiag(1,1,..., 1,−λ0)ifbis even,
diag(1,1,..., 1,n0λ0)ifbis odd.
Hence from Theorem 29.2,
/braceleftbigg−(−1)(v+1)/2λ0is a square (modp)ifbis even,
(−1)(v+1)/2n0λ0is a square (modp)ifbis odd.
Towards the proof of Theorem 29.3, we ﬁrst prove two proposi-
tions.
Given any integral m×mmatrixA, we may consider the Z-
moduleM(A) consisting of all integral linear combinations of its
rows; that is,
M(A): ={yA:y∈Zm}.
Fix a prime pand for any positive integer ideﬁne modules
Mi:={x∈Zm:pix∈M(A)},
Ni:={y∈Zm:AyLlatticetop≡0( m o dpi+1)}.
---PAGE BREAK---
29. Codes and symmetric designs 399
We haveM0=M(A),Mi⊆Mi+1andNi⊇Ni+1for alli. Let
(29.1) Ci:=Mi(modp),D i:=Ni(modp).
That is, read all the integer vectors in MiorNimodulopto obtain
CiorDi. Then each CiandDiis a subspace of the vector space
Fm
p, i.e. ap-ary linear code . Clearly,
C0⊆C1⊆C2⊆... andD0⊇D1⊇D2....
Proposition 29.4. We have
C⊥
i=Di
for all nonnegative integers i.
Proof: Letxandybe integral vectors such that x(modp)∈Ci
andy(modp)∈Di. This means
pi(x+pa)=zA andA(y+pb)Llatticetop≡0( m o dpi+1)
for some integral vectors a,b, andz. Then
pi(x+pa)·(y+pb)Llatticetop=zA(y +pb)Llatticetop≡0( m o dpi+1)
which implies that x·yLlatticetop=0o v e r Fp.
We complete the proof by showing that CiandDihave dimen-
sions which add to m. There exist unimodular matrices Eand
F(integral matrices with integral inverses) such that S:=EAF
is diagonal with integral diagonal entries d1,d2,...,dmwhich suc-
cessively divide one another: d1|d2|...|dm.(Sis theSmith normal
form ofAand thedi’s are the invariant factors. ) The reader should
verify that the modules MiandNiareequivalent to
MLprime
i:={x:pix∈M(S)}and
NLprime
i:={y:SyLlatticetop≡0( m o dpi+1)},
respectively, in the sense that either can be obtained from the other
by application of a unimodular transformation. Hence the dimen-sions over F
pofMiandMLprime
iare equal, as well as the dimensions of
NiandNLprime
i.
---PAGE BREAK---
400 A Course in Combinatorics
Supposepi+1does not divide d1,...,dtbut thatpi+1does divide
dt+1,...,dm. Theny∈NLprime
iimplies that the ﬁrst tcoordinates of y
are divisible by p; any vector ywith 0’s in the ﬁrst tcoordinates
is inNLprime
i.T h u sNLprime
i(modp) is the span of the last m−tstandard
basis vectors and has dimension m−t. Also,x∈MLprime
iimplies that
the lastd−tcoordinates of xare divisible by pand a little more
thought shows that MLprime
i(modp) is the span of the ﬁrst tstandard
basis vectors and has dimension t. /square
Proposition 29.5. LetA,B, andUbem×mintegral matrices
with
(29.2) ABALlatticetop=nU,
and where UandBare nonsingular modulo a prime p. Write
n=pen0where (p,n 0)=1. Deﬁne the sequence Ciofp-ary codes
fromAas in (29.1). Then Ce=Fm
pand
CB
i=Ce−i−1fori=0,1,...,e−1.
Inparticular,if eisodd,then C1
2(e−1)isaself-dual p-arycodewith
respect to the scalar product given by BonFm
p.
Proof: Letxandybe integral vectors such that x(modp)∈Ci
andy(modp)∈Ce−i−1. This means
pi(x+pa1)=z 1Aandpe−i−1(y+pa2)=z 2A
for some integral vectors z1,z2,a1, anda2. Then
pe−1Langbracketleftx,yLangbracketright=pe−1xByLlatticetop≡z1ABALlatticetopz2Llatticetop≡0( m o dpe)
in view of (29.2). Thus Langbracketleftx,yLangbracketright=0i n Fpand we see Ce−i−1⊆CB
i.
Now letx∈CB
i. This means xB∈C⊥
i, which is Diby Propo-
sition 29.4, and so for some integral vector xLprimewhich reduces to x
when read modulo p,
xLprimeBALlatticetop≡0( m o dpi+1).
---PAGE BREAK---
29. Codes and symmetric designs 401
From (29.2), A·BALlatticetopU−1=nI, and since a matrix commutes with
its inverse,
(29.3) BALlatticetopU−1·A=nI.
SinceUis nonsingular modulo p,dU−1is integral for some dprime
top, e.g.d:= det(U ). We multiply (29.3) on the left by dxLprimeto get
xLprimeBALlatticetop(dU−1)A=pedn0xLprime,
and then
zA=pe−i−1dn0xLprime
wherez:=1
pi+1xLprimeBALlatticetop(dU−1) is integral. This means pe−i−1dn0xLprime
is inMe−i−1and hence x∈Ce−i−1.
The assertion that Ce=Fm
pis left as an easy problem. /square
Problem 29B. Prove that Ce=Fm
p.
Proof of Theorem 29.3: LetNbe the incidence matrix of a
symmetric ( v,k,λ )-design and let pbe a prime. Assume λ=p2aλ0
where (λ 0,p) = 1 and a≥0; we will explain later what to do when
λis exactly divisible by an odd power of p. Let
(29.4)
A:=
pa
N...
pa
paλ0···paλ0k
,B :=
10...
1
0 −λ0
.
The reader should verify, using the properties of Nand the relation
λ(v−1) =k(k−1), thatABALlatticetop=nB.
In the case λis exactly divisible by an even power of p, we apply
Proposition 29.5 with the matrices AandBas in (29.4), and where
U:=B.
Ifλis exactly divisible by an odd power of p, we apply the above
case to the complement of the given symmetric design, which is a
symmetric ( v,v−k,λLprime)-design where λLprime=v−2k+λ.S a yλLprime=pcλLprime
0
where (λLprime0,p)=1 . F r o m λλLprime=n(n−1), it follows that cis odd
and that
λ0λLprime
0=n0(n−1)≡−n0(modp).
---PAGE BREAK---
402 A Course in Combinatorics
We have replaced what would be −λLprime
0in the conclusion by λ0n0,
which is allowed since they diﬀer by a square factor modulo p,i n
order to express the result in terms of the original parameters. /square
The following theorem is a consequence of Problem 19M, but we
give a proof similar to that of Theorem 29.3.
Theorem 29.6. Ifthereexistsaconferencematrixoforder n≡2
(mod 4), then no prime p≡3( m o d4 ) can divide the square-free
part ofn−1.
Proof: A conference matrix of order nis, in particular, an integral
matrixAsuch that AALlatticetop=(n−1)In. By Proposition 29.5 with
A=U=I, there exists a self-dual p-ary code (self-dual with
respect to the standard inner product) of length nfor every prime
divisorpof the square-free part of n−1. Theorem 29.2 then implies
that every such prime is ≡1 (mod 4). /square
***
Whenpis a prime not dividing the order vof an abelian group
G, the group ring Fp[G]i sasemi-simple algebra over Fp=Zp. This
means that there exist no nonzero nilpotents, i.e. nonzero elements
asucham= 0 for some positive integer m. The nonexistence
of nonzero nilpotents is proved in Lemma 28.5. By Wedderburn’stheorem, every ﬁnite-dimensional commutative semi-simple algebrawith identity Aover a ﬁeld Fis isomorphic to the direct product
of ﬁelds, each an extension of F. It follows that each ideal IofA
is principal and is generated by an idempotent e, i.e. an element e
withe
2=e. See any advanced text on algebra for proofs.
We do not need all of this information, but here are some facts
about principal ideals which are generated by idempotents that wewill need. These make good exercises.
First, ifI=Langbracketlefte
1Langbracketrightand also I=Langbracketlefte2Langbracketright, where both e1ande2are
idempotent, then e1=e2. Suppose I1=Langbracketlefte1LangbracketrightandI2=Langbracketlefte2Langbracketright, where
e1ande2are idempotent. Then
I1∩I2=Langbracketlefte1e2LangbracketrightandI1+I2=Langbracketlefte1+e2−e1e2Langbracketright.
Note that e1e2ande1+e2−e1e2are again idempotents.
---PAGE BREAK---
29. Codes and symmetric designs 403
Theorem 29.7. LetDbean (n2+n+1,n+1,1)-diﬀerencesetin
an abelian group Gof orderv:=n2+n+1.I fn≡0( m o d2 ) but
nLnegationslash≡0 (mod 4), then n=2.I fn≡0( m o d3 ) butnLnegationslash≡0( m o d9 ),
thenn=3.
Proof: LetDb ea(n2+n+1,n+1,1)-diﬀerence set in an abelian
groupGand letpbe a prime divisor of n. By Theorem 28.3, pis
a multiplier of Dand we will assume from now on that Dis ﬁxed
byp. We work in the Fp-algebra Fp[G].
LetI1be the ideal in Fp[G] generated by D(x) andI2the ideal
generated byD(x−1).
We haveD(xp)=D (x), butDp(x)=D (xp) by Lemma 28.2, so
Dp(x)=D (x)i n Fp[G]. Then Dp−1(x) is idempotent and will also
generate I1. Similarly, Dp−1(x−1) is an idempotent generator for
I2. So the idempotent generator of I1∩I2is
Dp−1(x)Dp−1(x−1)=(n+G(x))p−1=G(x),
and the idempotent generator of I1+I2is
Dp−1(x)+Dp−1(x−1)−G(x).
We now wish to consider the dimensions of I1andI2overFp.
In general, the rank of a principal ideal generated by A(x)i st h e
rank of the v×vmatrix whose rows are the coeﬃcients of xgA(x),
g∈G. This matrix is the incidence matrix of a symmetric (n2+
n+1,n+1,1)-design when A(x)=D (x)o rD (x−1). If we now
assume that p2does not divide n, then by Theorem 29.1, I1andI2
have dimension (v +1 )/2. The intersection I1∩I2has dimension
1, so their sum must have dimension v. The idempotent generator
of the whole group ring, as an ideal in itself, is 1; so we conclude
that
(29.5) Dp−1(x)+Dp−1(x−1)−G(x)=1 i n Fp[G].
We are only able to exploit the above equation when p= 2 or 3.
Whenp= 2, (29.5) asserts D(x)+D (x−1)≡1+G(x)( m o d2 )i n
Z[G]. The number of odd coeﬃcients of 1 + G(x)i sv −1=n2+n,
---PAGE BREAK---
404 A Course in Combinatorics
but the number of odd coeﬃcients of D(x)+D (x−1) cannot exceed
2(n+ 1); it follows that n≤2.
Whenp= 3, (29.5) asserts D2(x)+D2(x−1)≡1+G(x)( m o d3 )
inZ[G]. We claim that the nonzero coeﬃcients of D2(x) and
D2(x−1) consist of n+ 1 coeﬃcients that are 1’s and/parenleftbign+1
2/parenrightbig
coef-
ﬁcients that are 2’s. If Cis any planar diﬀerence set, there will
be a term x2ginC2(x) for each g∈Cand a term 2xg+hfor each
unordered pair {g,h}⊆C ; note that λ= 1 implies, e.g., that
g1+h1Lnegationslash=g2+h2unless{g1,h1}={g2,h2}. The sum of two such
group ring elements cannot have more than/parenleftbign+1
2/parenrightbig
+2 (n+ 1) coef-
ﬁcients that are ≡1 (mod 3), but 1 + G(x) hasn2+ncoeﬃcients
that are = 1; it follows that n≤4. /square
Problem 29C. SupposeDis a diﬀerence set with n≡2( m o d4 )
and that 2 is a multiplier of D. What are the parameters of D,a s
functions of n?
Notes.
Some of the material preceding the proof of Theorem 29.3 is more
elegant when p-adic numbers are introduced as in Lander (1983),
but we have chosen to present the material without them.
References.
D. Jungnickel and K. Vedder (1984), On the geometry of planar
diﬀerence sets, European J. Combinatorics 5, 143–148.
E. S. Lander (1983), Symmetric Designs: An Algebraic Approach ,
London Math. Soc. Lecture Note Series 74, Cambridge Univer-
sity Press.
V. Pless (1986), Cyclic projective planes and binary extended cyclic
self-dual codes, J. Combinatorial Theory (A)43, 331–333.
H. A. Wilbrink (1985), A note on planar diﬀerence sets, J. Combi-
natorial Theory (A)38, 94–95.
---PAGE BREAK---
30
Association schemes
Given two k-subsetsA,B of ann-set,n≥2k, there are k+1
possible relations between them: they may be equal, they may
intersect in k−1 elements, they may intersect in k−2 elements,
..., or they may be disjoint.
Given two words ( k-tuples)a,b∈Ak, whereAis an ‘alphabet’ of
size at least 2, there are k+1 possible relations between them: they
may be equal, they may agree in k−1 coordinates, they may agree
ink−2 coordinates, ..., or they may disagree in all coordinates.
These instances of a set together with a list of mutually exclu-
sive and exhaustive binary relations are examples of association
schemes, which we deﬁne shortly. Association schemes provide oneof the foundations of combinatorics and so we include this chaptereven though it will be diﬃcult reading. They have been implicit inmany of the previous chapters; we have explicitly discussed 2-classassociation schemes, as they are equivalent to the strongly regulargraphs discussed in Chapter 21. This chapter elaborates on someof the material of Chapter 21 but has diﬀerent goals.
Association schemes arose ﬁrst in the statistical theory of design
of experiments, but the work of Ph. Delsarte (1973) has shown howthey serve to unify many aspects of our subject. In particular, cer-tain results of coding theory and the theory of t-designs—which
were originally discovered independently—are now seen to be ‘for-mally dual’ aspects of the same ideas in association schemes. Forexample, Fisher’s inequality and its generalization, Theorem 19.8,is formally dual to the sphere packing bound, Theorem 21.1. Weuse the machinery of association schemes in this chapter to giveproofs of Lloyd’s theorem on perfect codes and its formal dual theo-rem for tight designs and orthogonal arrays. Delsarte’s inequalities,
---PAGE BREAK---
406 A Course in Combinatorics
Theorem 30.3, on the distribution vector of a subset of an associ-
ation scheme provide a ‘linear programming bound’ on the size ofcodes and are also of interest in extremal set theory.
By abinary relation on a set X, we mean a subset of X×X.A
k-class association scheme , sometimes we say just scheme, on a set
Xofpoints consists of k+ 1 nonempty symmetric binary relations
R
0,R1,...,RkonXwhich partition X×X, where R0={(x,x ):
x∈X}is the identity relation, and such that for some nonnegative
integerspplscript
ij,0≤plscript,i,j≤k, the following system of axioms holds:
given any (x,y )∈Rplscript, there are exactly pplscriptijelementsz∈Xsuch
that (x,z)∈Riand (z,y)∈Rj.W es a yx,y∈Xarei-th associates
when (x,y )∈Ri.
The numbers pplscriptij,0≤plscript,i,j≤k, are the parameters of the
scheme. That p0iiexists means that there is a constant number
ofi-th associates of any element of X, which is usually denoted by
ni. We have
(30.1) p0
ii=niandp0ij= 0 foriLnegationslash=j
and
n0=1,n 0+n1+···+nk=N.
whereN:=|X|. The numbers n0,n1,...,nkare called the degrees
of the scheme.
Example 30.1. The Johnson schemes J(v,k). The points of the
schemeJ(v,k) are the/parenleftbigv
k/parenrightbig
k-subsets of a v-setS.T w ok-subsets
A,B are declared to be i-th associates when |A∩B|=k−i.T h u s
0-th associates are equal. The parameters pplscript
ijexist ‘by symmetry’
and may be expressed as sums of products of binomial coeﬃcients,
but we will not bother to write these out in general.
The scheme J(6,3), for example, is a 3-class scheme with 20
points. The reader should check that n1=n2=9 ,n3= 1. A few
of the other parameters are p1
11=4 ,p211=4 ,p311=0 .
Example 30.2. The Hamming schemes H(n,q). The points of
H(n,q) are the qnwords of length nover an alphabet of size q.
Twon-tuplesx,yare declared to be i-th associates when they dis-
agree in exactly icoordinates. Thus 0-th associates are equal. The
---PAGE BREAK---
30. Association schemes 407
parameters pplscript
ijexist ‘by symmetry’ and may be expressed as sums
of products of binomial coeﬃcients and powers of q−1, but we will
not bother to write these out in general.
The scheme H(5,3), for example, is a 5-class scheme with 125
points. The reader should check that n1=5·2,n2=1 0·4, etc.
Each of the relations Rimay be thought of as the adjacency rela-
tion of a graph Gion the vertex set X. (A scheme is a special kind
of partition of the edges—or coloring of the edges—of a complete
graph.) It should be clear that if we start with a 2-class scheme,thenG
1is a strongly regular graph with degree n1,λ=p1
11, and
µ=p211. In fact, any strongly regular graph gives rise to a 2-
class association scheme when we declare that two distinct vertices
are 1st associates when they are adjacent in Gand 2nd associates
if not adjacent; the other parameters exist, i.e. are constant, andcan be computed from the parameters of the graph. For example,p
1
12=k−λ−1.
Adistance regular graph is a graph Gsuch that the number of
vertices at distance itoxand distance jtoydepends only on the
distanceplscriptbetween the vertices xandy, not on the particular ver-
tices. That is, deﬁning two vertices to be i-th associates if and only
if their distance in Gisiproduces an association scheme (where the
number of classes will be the diameter of the graph). See Brouwer,
Cohen, and Neumaier (1989). Schemes which arise in this way arecalledmetric . The schemes mentioned in Examples 30.1 and 30.2
above are metric, as are those in Examples 30.3 and 30.4 below.
It is important to know that the parameters p
plscript
ijexist; it is not so
important to know their exact values. This is lucky because there is
often no convenient expression for these parameters. In the schemeJ(v,k), for example, a triple sum of binomial coeﬃcients seems to
be required for the general p
plscript
ij. In the examples we have just given,
we know that the pplscriptij’s exist because of ‘symmetry’. More precisely,
in each case there exists a group Gof permutations of Xso that two
ordered pairs of points ( x1,y1) and (x2,y2) are in the same relation
Riif and only if there exists σ∈Gsuch that σ(x1)=x 2and
σ(y1)=y 2.That is, the relations R0,R1,...,Rkare theorbits ofG
onX×X(withR0the trivial orbit of all ( x,x),x∈X). In Example
30.1,Gis the symmetric group Svacting on all k-subsets of a v-set;
---PAGE BREAK---
408 A Course in Combinatorics
we can ﬁnd a permutation which takes an ordered pair of k-subsets
to another if and only if the size of the intersection of each pair is
the same. In Example 30.2, Gis the wreath product of SqwithSn
(that is, we allow any permutation of the ncoordinates followed by
independent permutations of the qsymbols in each coordinate); we
can ﬁnd such a transformation which takes an ordered pair of n-
tuples to another if and only if the pairs agree in the same numberof coordinates.
In general, if Gis a transitive group of permutations on a set X
such that the orbits of GonX×Xare symmetric, they may be
taken as the relations of an association scheme on X. Our next
three examples also arise in this way.
Example 30.3. This is the q-analogue of the Johnson scheme:
Take thek-subspaces of a v-spaceVoverF
qas points. Two k-
subspaces A,B are declared to be i-th associates when dim( A∩
B)=k−i.
Example 30.4. Take thek×mmatrices overFqas the points,
wherek≤m, say. Two matrices A,B are declared to be i-th
associates when the rank of A−Bisk−i.
To put this example into the framework above, we let Xbe the
set of allk×mmatrices and we may take Gto be the set of all
permutations XLmapsto→UXW +CasUranges over the nonsingular
k×knatrices,Wover the nonsingular m×mmatrices, and C
over thek×mmatrices. If (A,B ) and (ALprime,BLprime) are pairs of k×
mmatrices such that the ranks of A−BandALprime−BLprimeare equal,
thenU(A−B)W=ALprime−BLprimefor some nonsingular UandW, and
thenXLmapsto→UXW +(BLprime−UBW ) will map the ﬁrst pair onto the
second.Example 30.5. Thecyclotomic schemes are obtained as follows.
Letqbe a prime power and ka divisor of q−1. LetC
1be
the subgroup of the multiplicative group of Fqof indexk, and let
C1,C2,...,Ckbe the cosets of C1. The points of the scheme are to
be the elements of Fq, and two points x,yare declared to be i-th
associates when x−y∈Ci(and 0-th associates when x−y= 0).
In order to have a scheme with the above deﬁnition, we require
−1∈C1so that the relations will be symmetric, i.e. 2k must di-
---PAGE BREAK---
30. Association schemes 409
videq−1i fqis odd. Cf. Example 21.3 which is the case k=2 .
We introduce the association matrices A0,A1,...,Ak(also called
theadjacency matrices ) of an association scheme. These matrices
are square with both rows and columns indexed by the elements of
the point set Xof a scheme. For i=0,1,...,k , we deﬁne
Ai(x,y)=/braceleftbigg1i f (x,y)∈Ri,
0 otherwise .
The matrices Aiare symmetric (0 ,1)-matrices and
A0=I, A 0+A1+···+Ak=J
whereJis the all-one matrix of size N×N. We denote by A
the linear span over the reals of A0,A1,...,Ak. These matrices
are linearly independent since each contains at least one 1; and aposition in which A
ihas a 1 contains a 0 in every other association
matrix. The axioms of an association scheme are exactly what isrequired to ensure that Ais closed under matrix multiplication. To
see this, it suﬃces to show that the product of any two of the basismatrices is in Aand, in fact, we have
(30.2) A
iAj=k/summationdisplay
plscript=0pplscript
ijAplscript
becauseAiAj(x,y) is the number of zsuch that Ai(x,z) = 1 and
Aj(z,y) = 1, and this number is pplscript
ijwhereplscriptis such that Aplscript(x,y)=
1.
The algebra Ais called the Bose–Mesner algebra of the scheme;
this algebra was introduced for strongly regular graphs in Chapter
21. We note at this point that not only is Aclosed under normal
matrix multiplication, but it is also closed under Hadamard mul-
tiplication as introduced in Problem 21E. The Hadamard product
A◦Bof two matrices is the matrix obtained by coordinate-wise
multiplication:
(A◦B)(x,y ): =A(x,y )B(x,y).
---PAGE BREAK---
410 A Course in Combinatorics
As an algebra with respect to Hadamard multiplication, Ais
almost trivial. We have
Ai◦Aj=/braceleftbiggAiifi=j,
OifiLnegationslash=j
(that is,A0,A1,...,Akareorthogonal idempotents), and the sum of
theAi’s isJ, the identity with respect to Hadamard multiplication.
So Hadamard multiplication is extremely simple when matrices in
Aare expressed with respect to the basis A0,A1,...,AkofA.
However, a well known result of matrix theory (an extension
of the spectral theorem which says that a symmetric real matrixhas an orthogonal basis of eigenvectors) asserts that a commuta-
tivealgebra of real symmetric matrices has a basis of orthogonal
idempotents with respect to ordinary matrixmultiplic ation which
sum to the identity. More geometrically, there exists an orthogonaldecomposition
R
X=V0⊕V1⊕···⊕V k
of the Euclidean space RX, the space of all vectors whose coordi-
nates are indexed by the elements of Xwith the standard inner
product, such that the orthogonal projections E0,E1,...,Ekfrom
RXonto the subspaces V0,V1,...,Vk, respectively, are a basis for
A.W eh a v e
EiEj=/braceleftbiggEiifi=j,
OifiLnegationslash=j,
and
E0+E1+···+Ek=I.
Of course, when matrices are expressed with respect to the basisE
0,E1,...,Ek, ordinary multiplication is also extremely simple.
The subspaces V0,V1,...,Vkare called the eigenspaces of the
scheme: in a linear combination M=/summationtextk
i=0λiEi, each vector in
Viis an eigenvector of value λiforM. There is no natural number-
ing of the eigenspaces in general with one exception: since J∈A,
andJhas the vector jof all 1’s as an eigenvector of value Nand all
vectors orthogonal to jas eigenvectors of value 0, it must be that
one of the eigenspaces consists of scalar multiples of jalone—we
shall always assume that this is V0. Then the orthogonal projection
---PAGE BREAK---
30. Association schemes 411
ontoV0(which has jas an eigenvector of value 1 and all vectors
orthogonal to jas eigenvectors of value 0) is
E0=1
NJ.
We letmidenote the dimension of Vi. Then
m0=1,m 0+m1+···+mk=N.
Note that miis the trace of Eisince the eigenvalues of Eiare 1
(with multiplicity equal to the dimension of Vi) and 0. The numbers
m0,m1,...,mkare called the multiplicities of the scheme.
Example 30.6. We can explicitly describe the eigenspaces of the
Hamming scheme H(n,2). The points of this scheme are the binary
n-tuples (or words) aofFn
2.
For eacha∈Fn
2, deﬁne a vector vawith coordinates indexed by
the point set by
va(b): =(−1)Langbracketlefta,bLangbracketright.
These vectors are orthogonal and are the rows of a Hadamard ma-
trix; see Fig. 30.1 and Chapter 18. We claim that Vimay be taken
to be the span of all vectors vaasaranges over the words of weight
i,i=0,1,...,n .
We check that each vais an eigenvector of all association matrices
Aj. Letahave weight plscript. Then
(vaAj)(b)=/summationdisplay
cva(c)Aj(c,b)
=/summationdisplay
c:d(b,c)=j(−1)Langbracketlefta,cLangbracketright=(−1)Langbracketlefta,bLangbracketright/summationdisplay
c:d(b,c)=j(−1)Langbracketlefta,b+cLangbracketright
=va(b)/summationdisplay
u:wt(u)=j(−1)Langbracketlefta,uLangbracketright=va(b)n/summationdisplay
i=0(−1)i/parenleftbiggplscript
i/parenrightbigg/parenleftbiggn−plscript
j−i/parenrightbigg
.
This calculation shows, with Eithe matrix of the orthogonal
projection onto Vi, that
Aj=n/summationdisplay
plscript=0/parenleftBiggn/summationdisplay
i=0(−1)i/parenleftbiggplscript
i/parenrightbigg/parenleftbiggn−plscript
j−i/parenrightbigg/parenrightBigg
Eplscript
---PAGE BREAK---
412 A Course in Combinatorics
since the two sides give the same result when premultiplied by any
va.S oA⊆span{E 0,...,En}. Equality holds because both spaces
have dimension n+1 .
The eigenvalues of the schemes H(n,q) for general qare given in
Theorem 30.1 below.
Figure 30.1
For example, if we order the words of length n=3a s
000,100,010,001,011,101,110,111,
then the eigenspaces V0,V1,V2,V3of the cube (= A1ofH(3,2))
shown at the right of Fig. 30.1 are spanned respectively by the ﬁrstrow, the next three rows, the next three rows, and the last row ofthe Hadamard matrix at the left of Fig. 30.1.
Example 30.7. We now describe the eigenspaces of the Johnson
schemeJ(v,k). We omit the proofs; see Delsarte (1973) or Wilson
(1984b).
The point set of this scheme is the set Xofk-subsetsSof av-set
X. For each subset T⊆Xof size≤k, lete
Tbe the vector of
length/parenleftbigv
k/parenrightbig
inRXwhere
eT(S): =/braceleftbigg1i fT⊆S,
0 otherwise.
LetUibe the span of {eT:T⊆X,|T|=i}fori=0,1,...,k .W e
claim that U0⊆U1⊆···⊆Uk=RXand thatUihas dimension/parenleftbigv
i/parenrightbig
. LetV0:=U0(the constant vectors) and for i>0, letVibe the
orthogonal complement of Ui−1inUi, i.e.
Vi:=Ui∩U⊥
i−1.
---PAGE BREAK---
30. Association schemes 413
It is clear that V0,V1,...,Vkare orthogonal and sum to RX. It can
be shown that each vector in Viis an eigenvector of Ajof value
Pj(i) as displayed in Theorem 30.1(i) below.
Since we have two bases of the vector space A, we may consider
the transformation matrices between them, which are called the
eigenmatrices of the scheme. Deﬁne P(theﬁrsteigenmatrix) and
Q(thesecond eigenmatrix) as the k+1×k+1 matrices with rows
and columns indexed by 0 ,1,...,k such that
(A0,A1,...,Ak)=(E0,E1,...,Ek)P
and
N(E0,E1,...,Ek)=(A0,A1,...,Ak)Q.
We writePplscript(i) for the ( i,plscript) entry of P, and similarly, we let Qplscript(i)
be the (i,plscript ) entry of Q, so that
(30.3) Aplscript=Pplscript(0)E 0+Pplscript(1)E 1+···+Pplscript(k)Ek,
and
(30.4) NEplscript=Qplscript(0)A 0+Qplscript(1)A 1+···+Qplscript(k)Ak.
Of course, we have
Q=NP−1,P =NQ−1.
Theplscript-th column of Pconsists of the eigenvalues of Aplscript.
While it is not so important to know the parameters pplscript
ijof a
scheme, it is important for applications to know the eigenmatrices
PandQ. See Bannai and Ito (1984) or Delsarte (1973) for proofs of
the following theorem and the determination of the eigenmatricesof other schemes.
Theorem 30.1. (i)For the Johnson scheme J(v,k), the degrees
aren
plscript=/parenleftbigk
plscript/parenrightbig/parenleftbigv−k
plscript/parenrightbig
and the multiplicities are mplscript=/parenleftbigv
plscript/parenrightbig
−/parenleftbigv
plscript−1/parenrightbig
,plscript=
0,1,...,k. The entries of the ﬁrst eigenmatrix are Pplscript(i)where
Pplscript(x)=plscript/summationdisplay
α=0(−1)plscript−α/parenleftbiggk−α
plscript−α/parenrightbigg/parenleftbiggk−x
α/parenrightbigg/parenleftbiggv−k+α−x
α/parenrightbigg
.
---PAGE BREAK---
414 A Course in Combinatorics
(ii)FortheHammingscheme H(n,q),thedegreesandmultiplic-
ities arenplscript=mplscript=/parenleftbign
plscript/parenrightbig
(q−1)plscript,plscript=0,1,...,n. The entries of the
ﬁrst eigenmatrix are Pplscript(i)where
Pplscript(x)=plscript/summationdisplay
α=0(−q)α(q−1)plscript−α/parenleftbiggn−α
plscript−α/parenrightbigg/parenleftbiggx
α/parenrightbigg
.
Problem 30A. Calculate the eigenmatrix PofJ(8,3) in the fol-
lowing way. First calculate A1A2as a linear combination of A0,A1,
A2, andA3, and then ﬁll in the missing line in the following table:
A0
1=A0,
A1
1= A1,
A2
1=1 5A0+6A1+4A2,
A3
1= ,
A4
1= 1245A 0+1 0 3 6A1+ 888A 2+7 2 0A3.
From this table, it is only mildly tedious to derive the minimal
polynomial of A1. Find the eigenvalues of A1. Now express A2and
A3as polynomials in A1, and so ﬁnd their eigenvalues. Find the
multiplicities. Check your work by verifying the orthogonality rela-tions of Theorem 30.2 or just calculating the values from Theorem30.1(i).
Problem 30B. Show how to calculate all the parameters p
plscript
ijof
a scheme given the eigenmatrix P. That is, prove that they are
uniquely determined byP.
Problem 30C. TheLatin square graphs aresrg(v,k,λ,µ )’s where
for some integers nandr,
v=n2,k=r(n−1),λ =(n−2)+(r−1)(r−2),µ =r(r−1).
These were introduced in Example 21.7 for r= 3. Find the eigen-
matricesPandQfor the 2-class schemes corresponding to these
graphs.
The so-called negative Latin square graphs are strongly regular
graphssrg(v,k,λ,µ ) whose parameters are obtained from the above
---PAGE BREAK---
30. Association schemes 415
by replacing nby−nandrby−r.S ov=(−n)2,k=(−r)(−n−1),
etc. (It is strange that this should yield parameters satisfying
(21.4), but it does.) Find the eigenmatrices PandQfor the corre-
sponding 2-class schemes.
Theorem 30.2. Theeigenmatricesofaschemesatisfytheorthog-
onality relations
PLlatticetop
10···0
0m1 0
.........
00···mk
P=N
10···0
0n1 0
.........
00···nk

and
QLlatticetop
10···0
0n1 0
.........
00···nk
Q=N
10···0
0m1 0
.........
00···mk
.
Proof: The vector space Acan be equipped with an inner product
in a more-or-less natural way: We deﬁne LangbracketleftA,BLangbracketrightto be the sum of
the entries of the Hadamard product A◦B. Check that this is the
same as the trace of the matrix product ABLlatticetop(which is the same
as tr(AB ) whenBis symmetric, of course).
With respect to this inner product, the basis A0,A1,...,Akis an
orthogonal basis (but not orthonormal); we have LangbracketleftAi,AiLangbracketright=Nni.
ButE0,E1,...,Ekis also an orthogonal basis since EiEj= 0 for
iLnegationslash=j;w eh a v e LangbracketleftEi,EiLangbracketright= tr(Ei)=m i. The derivation of the
theorem from this is now elementary linear algebra.
Consider the ﬁrst relation. The entry in the ( α,β) position on
the right is
LangbracketleftAα,AβLangbracketright=Langbracketleft/summationdisplay
iPα(i)Ei,/summationdisplay
jPβ(j)EjLangbracketright
=/summationdisplay
i,jPα(i)Pβ(j)LangbracketleftEi,EjLangbracketright=/summationdisplay
imiPα(i)Pβ(i),
and this last expression is the entry in the (α,β ) position on the
left. The second relation is derived similarly. /square
---PAGE BREAK---
416 A Course in Combinatorics
Another way to express the content of the above theorem is
Q=
10···0
0n1 0
.........
00···nk
−1
PLlatticetop
10···0
0m1 0
.........
00···mk
.
Equivalently,
(30.5) mjPi(j)=niQj(i)
for alli,j=0,1,...,k .
With Theorems 30.1 and 30.2, we can ﬁnd the second eigenmatrix
Qfor the schemes J(v,k) andH(n,q). It is somewhat surprising
thatP=QforH(n,q); the reader should check this.
Problem 30D. Explain why the zeroth row and column of Pand
Qare as indicated below.
(30.6) P=
1n1... nk
1...
1
,Q =
1m1... m k
1...
1
.
Delsarte (1973) observed that the columns of the second eigenma-
trixQprovide a system of linear constraints, which we will call Del-
sarte’s inequalities , on, what he calls, the ‘inner distribution vector’
of a nonempty subset Yof the point set Xof an association scheme.
We deﬁne the distribution vector ofYto bea=(a0,a1,...,ak)
where
ai:=1
|Y||(Y×Y)∩Ri|;
that is,aiis the average number of i-th associates y∈Yof an
elementx∈Y. We have
a0=1,a 0+a1+···+ak=|Y|.
For many interesting subsets Y, the number of i-th associates
y∈Yof an element x∈Yis constant, i.e. it does not depend on
whichxinYis chosen. For example, this is true if Cis alinear
---PAGE BREAK---
30.Association schemes 417
code inH(n,q) in which case the distribution vector coincides with
what we called the weight enumerator of Cin Chapter 21, and
also for other beautiful conﬁgurations which have been discussed
in previous chapters and whose distribution vectors we list below.Here Hamming(7) is the Hamming code of length 7, ‘Golay’ is shortfor ‘Golay code’, ‘X’ means ‘extended’, and a ‘*’ denotes ‘dual code’.
Object Scheme Distribution vectorS(2,3,7) J(7,3) (1,0,6,0)
S
2(2,5,11)J(11,5) (1,0,0,10,0,0)
S2(3,6,12)J(12,6) (1,0,0,20,0,0,1)
S(5,6,12) J(12,6) (1,0,45,40,45,0,1)
S(4,7,23) J(23,7) (1,0,0,0,140,0,112,0)
S(5,8,24) J(24,8) (1,0,0,0,280,0,448,0,30)
Hamming(7) H(7,2) (1,0,0,7,7,0,0,1)
X-Hamming(7) H(8,2) (1,0,0,0,14,0,0,0,1)
Binary Golay H(23,2) (1,0,0,0,0,0,0,253,506,0,0,1288, ...)
X-Binary Golay H(24,2) (1,0,0,0,0,0,0,0,759,0,0,0,2576,0, ...)
Ternary Golay H(11,3) (1,0,0,0,0,132,132,0,330,110,0,24)
*-Ternary Golay H(11,3) (1,0,0,0,0,0,132,0,0,110,0,0)
Theorem 30.3. The distribution vector aof a nonempty subset
of an association scheme satisﬁes
aQ≥0
where0is the row vector of k+1zeros.
Proof: Letφ∈RXbe the characteristic vector of Y. That is,
φ(x)=/braceleftbigg1i fx∈Y,
0i fx/∈Y.
Then
ai=1
|Y|φAiφLlatticetop.
SinceEplscriptis idempotent and symmetric,
0≤LbardblφEplscriptLbardbl2=(φEplscript)(φEplscript)Llatticetop=φEplscriptφLlatticetop
=1
Nφ/parenleftBiggk/summationdisplay
i=0Qplscript(i)Ai/parenrightBigg
φLlatticetop=|Y|
Nk/summationdisplay
i=0Qplscript(i)ai.
/square
---PAGE BREAK---
418 A Course in Combinatorics
We note for further reference that the plscript-th inequality holds with
equality if and only if the projection φEplscriptis the zero vector. The
zeroth inequality is trivial since the zeroth coordinate of aQisa0+
a1+···+ak, which of course is nonnegative.
Example 30.8. ForJ(8,3), Delsarte’s inequalities when fractions
are cleared are
1 5+7a1−a2−9a3≥0,
3 0+2a1−5a2+9a3≥0,
10−2a1+a2−a3≥0.
These can be viewed as necessary conditions for the existence of a
familyFof 3-subsets of an 8-set with a given distribution vector
(1,a 1,a2,a3).
We can ask what they imply about |F|when we assume some of
theai’s are zero. For example, assume a3= 0 (no two members of
Fare disjoint). The maximum value of 1 + a1+a2(=|F|) subject
to these inequalities is 21; this is a linear programming problem.We already knew |F| ≤ 21 because of the Erd˝ os-Ko-Rado theorem,
Theorem 6.4. Theorem 30.3 implies Theorem 6.4; see the notes.
Theorem 30.3 leads to a linear programming bound on the car-
dinalities of codes. For the Hamming scheme H(n,q), given an
integerd, we may consider the linear programming problem
“maximize 1 + a
d+ad+1+···+ansubject to ai≥0 and
(1,0,..., 0,ad,ad+1,...,an)Q≥0”
whereQis then+1b yn+ 1 second eigenmatrix of the scheme. If
lpbdenotes the maximum value of 1 + ad+ad+1+···+anunder
these conditions and Cis anyq-ary code of length nwith minimum
distance at least d, then|C|≤lpb since the distribution vector a
ofCsatisﬁes the conditions and the coordinates sum to |C|.
We mention that for the Hamming schemes, if ais the distri-
bution vector of a linear codeC, then1
|C|aQis the distribution
vector of the dual code C⊥. To see this, just compare the formulae
in MacWilliams’ theorem, Theorem 20.3, with those in Theorem30.1(ii). This certainly explains why aQ≥0for the distribution
---PAGE BREAK---
30. Association schemes 419
vectoraof a linear code, but we have proved above that it holds
even ifCis not linear.
ndSPB LPB a0a1a2a3a4a5a6a7a8a9a10a11a12a13a14a15
11 3 170.7 170.7 1 0 0 18.3 36.7 29.3 29.3 36.7 18.3 0 0 1
11 5 30.6 24 1 0 0 0 01 1 1 10 0001
11 7 8.8 4 1 0 0 0000210 0 0
12 3 315.1 292.6 1 0 0 20 45 48 56 65.1 40.7 11.4 3.4 1.7 0.1
12 5 51.9 40 1 0 0 0 0 15 17.5 0 0 5 1.5 0 0
12 7 13.7 5.3 1 0 0 0 0 0 0 2.7 1.7 0 00 0
13 3 585.1 512 1 0 0 2 25 57 29 6 116 87 40 16 6 1 0
13 5 89.0 64 100 0 0 1 82 4 4 31 04 00 0
13 7 21.7 8 1 0 0 0000430 0 00 0
14 31092.31024 1 0 0 28 77 112 168 232 203 112 56 28 7 0 0
14 5 154.6 128 100 0 0 2 8 4 2 8 72 8 1 40 0 0 0
14 7 34.9 16 1 0 0 0000870 0 0 0 0 0
15 3 2048 2048 1 0 0 35 105 168 280 435 435 280 168 105 35 0 0 1
15 5 270.8 256 100 0 0 4 2 7 0 1 5 1 5 7 0 4 2 0 0 0 0 1
15 7 56.9 32 1 0 0 0000 1 5 1 5 0 0 0 0 0 0 1
Figure 30.2
It is diﬃcult to extract useful information in general from the
linear programming bound (LPB), but it can be shown that it is al-
ways at least as good as the sphere packing bound (SPB), Theorem21.1; see Delsarte (1973). For small values of the parameters, onecan use the simplex algorithm and expicitly evaluate this bound.We have done so for some values of nanddin the case of binary
codes and display the results in the table of Fig. 30.2. The tablegives a nonnegative vector (1 ,0,..., 0,a
d,ad+1,...,an) whose sum
is maximum subject to aQ≥0. It is a good exercise for the reader
to try to decide whether codes meeting the LPB as in the tableactually exist. We mention that several can be obtained from aninteresting binary code of length 16 called the Nordstrom-Robinsoncode, which has 256 codewords and minimum distance 6. It is notlinear. See problems 30I and 30J.
There appears to be a kind of ‘duality’ between the two bases of,
and between ordinary and Hadamard multiplication on, the Bose–
---PAGE BREAK---
420 A Course in Combinatorics
Mesner algebra. It sometimes happens that there exists a second
association scheme so that the Ei’s of the latter under Hadamard
multiplication act like the Ai’s of the former under ordinary multi-
plication (apart from a scalar factor), and vice versa. Two schemesare said to be formally dual when the ﬁrst eigenmatrix Pof one is
equal to the second eigenmatrix Qof the other (cf. Problem 30E
below). Many examples of pairs of formally dual strongly regulargraphs are known. The Hamming scheme, as mentioned above, isformally dual to itself. The Johnson scheme usually has no formaldual, because in general the Krein parameters deﬁned below arenot integers.
TheKrein parameters of an association scheme are the ( k+1 )
3
numbersqplscript
ijdeﬁned by
(30.7) NEi◦Ej=k/summationdisplay
plscript=0qplscript
ijEplscript.
If the scheme has a formal dual, these are the parameters pplscript
ijfor
that formally dual scheme and hence are nonnegative integers. We
always have
qplscript
ij≥0,for all 0≤i,j,plscript≤k,
because the qplscript
ij’s are eigenvalues of the Hadamard product of two
positive semideﬁnite matrices and are hence nonnegative; cf. Prob-lem 21E. In principle, the Krein parameters are functions of theoriginal parameters p
plscript
ij(see Problem 30E) and their nonnegativity
can be viewed as a necessary condition for the existence of a scheme
with given parameters; we did this for strongly regular graphs inTheorem 21.3.
Problem 30E. Show how to calculate all the parameters q
plscript
ijof
a scheme given the eigenmatrix Q. That is, prove that they are
uniquely determined by Q.
We need to know later that
(30.8) q0
ii=miandq0
ij= 0 foriLnegationslash=j.
This follows from (30.7) when we consider the sum of all entries of
the matrices on both sides; the sum of the entries of the left-hand
---PAGE BREAK---
30. Association schemes 421
side isNtimes
LangbracketleftEi,EjLangbracketright=/braceleftbiggmiifi=j,
0 otherwise.
For some applications to codes and designs, we need to know
more about a scheme. However, here is one interesting result we
can prove for general schemes before we specialize.
Given ak-class scheme and a subset Kof{1,2,...,k}, a subset
Yof the point set is called a K-clique when for every pair of distinct
elementsx,y∈Y,xandyarej-th associates for some j∈K. The
subsetYis aK-coclique when no pair of elements x,y∈Yare
j-th associates for any j∈K.I fGis the graph whose adjacency
matrix is/summationtext
j∈KAj, then cliques in Gare the same as K-cliques
in the scheme, and cocliques (independent sets of vertices) are thesame asK-cocliques in the scheme.
Theorem 30.4. LetA⊆XbeaK-cocliqueand B⊆XaK-clique
inak-classassociationschemeonaset XwhereK⊆{1,2,...,k}.
Then
|A||B|≤N.
Proof: Leta=(a
0,a1,...,ak) be the distribution vector of A
and letb=(b0,b1,...,bk) be the distribution vector of B. Take
the inverse of the ﬁrst equation of Theorem 30.2, premultiply by a
and postmultiply by bLlatticetopto get
(30.9) aQ
10···0
0m1 0
.........
00···mk
−1
(bQ)Llatticetop=Na
10···0
0n1 0
.........
00···nk
−1
bLlatticetop.
By Theorem 30.3, both aQandbQare nonnegative vectors. Their
zeroth coordinates are |A|and|B|, respectively, so the scalar on
the left of (30.9) is at least |A||B|. Our hypothesis implies that
aibi= 0 fori>0, so the scalar on the right of (30.9) is N. /square
An example of equality in Theorem 30.4 in J(v,k) occurs when
there exists an S(t,k,v ). TakeK={1,2,...,k−t}. Then the
block set of the S(t,k,v )i saK -coclique. The set of all k-subsets
containing a ﬁxed t-subset is a K-clique. An example of equality
---PAGE BREAK---
422 A Course in Combinatorics
in Theorem 30.4 in H(n,q) occurs when there exists a perfect e-
error-correcting code C. TakeK={1,2,..., 2e}. Then Cis a
K-coclique. A sphere of radius eabout a ﬁxed word is a K-clique.
Problem 30F. Find an example of a regular graph G, a clique A,
and a coclique Bsuch that |A||B|>|G|.
Problem 30G. Prove that if Ais a clique and Ba coclique in a
graphGwhich admits a transitive group of automorphisms, then
|A||B|≤|G|.
We now deﬁne polynomial schemes , of which there are two types.
An association scheme (with a particular numbering A1,A2,...,Ak
of its association matrices) is said to be P-polynomial whenAi
is a polynomial of degree iinA1fori=0,1,2,...,k . An asso-
ciation scheme (with a particular numbering E1,E2,...,Ekof its
idempotents) is said to be Q-polynomial whenEiis a Hadamard
polynomial of degree iinE1fori=0,1,2,...,k (we mean that
there is a polynomial of degree iso thatEiresults by applying the
polynomial element-wise to, i.e. to each entry of,E1).
Problem 30H. Prove that an association scheme is P-polynomial
if and only if it is a metric scheme.
TheQ-polynomial schemes are also called cometric , but there
seems to no simple geometric interpretation of cometric. We use
the terms metric and cometric rather than P- andQ-polynomial.
It can be seen that the Hamming and Johnson schemes are co-
metric; see Delsarte (1973).
We deﬁne a d-code in a metric scheme to be a subset S⊆X
whose characteristic vector φsatisﬁes
φAiφLlatticetop= 0 fori=1,2,...,d−1.
We deﬁne a t-design in a cometric scheme to be a subset S⊆X
whose characteristic vector φsatisﬁes
φEiφLlatticetop= 0 fori=1,2,...,t.
The combinatorial signiﬁcance of d-codes is straightforward: S
is ad-code if and only if no two distinct elements of Sarei-th
---PAGE BREAK---
30. Association schemes 423
associates for i<d . So in the Hamming scheme, Sis a (2e + 1)-
code if and only if it is e-error correcting, i.e. has minimum distance
at least 2e + 1. The combinatorial signiﬁcance of t-designs is not
so clear and can only be understood with more knowledge of the
particular scheme. Note that Sis at-design if and only if the ﬁrst
tnontrivial inequalities on the distribution vector of Sin Theorem
30.3 hold with equality, i.e. that φEi=0fori=1,...,t .
The following theorem explains that designs in the Johnson and
Hamming schemes correspond to the classical concepts of t-designs
and orthogonal arrays, respectively. An orthogonal array of index
λand strength ton a setAofqsymbols is a subset C⊆Anof
λqtwords so that for every choice of tof thencoordinates, each
possiblet-tuple of elements of Aoccurs exactly λtimes in those t
coordinates among the members of C.
Theorem 30.5.
(i)AfamilySofk-subsetsofa v-setisat-designwhenconsidered
asasubsetof J(v,k)ifandonlyifitisthesetofblocksofa t-design
in the classical sense.
(ii)AfamilySofn-tuplesfromanalphabet Aofqelementsisa
t-design when considered as a subset of H(n,q)if and only if it is
the set of columns of an orthogonal array of strength t.
Partial proof: We will show that the deﬁnition of t-design in
the schemes implies that the family Sis a classical t-design or
orthogonal array and leave the converses of both parts (i) and (ii)for the reader.
LetSbe at-design in J(v,k) in the sense of association schemes
andφits characteristic vector. In Example 30.7, we saw that E
0+
E1+···+Etis the orthogonal projection onto the space spanned
byeTasTranges over the t-subsets of the v-set. The number of
members of Scontaining a t-subsetTis
φeLlatticetop
T=φ(E 0+E1+···+Et)eLlatticetopT=φE0eLlatticetopT.
SinceE0is a scalar multiple of the all-one matrix J, this number
is independent of the particular t-subsetT.
LetSbe at-design in H(n,q) in the sense of association schemes
andφits characteristic vector. In Example 30.6, we described the
---PAGE BREAK---
424 A Course in Combinatorics
eigenspaces for q= 2, and we prove the theorem only in this case.
A complete proof may be found in Delsarte (1973).
With the notation of Example 30.6,
Langbracketleftφ,vaLangbracketright=/summationdisplay
b∈S(−1)Langbracketlefta,bLangbracketright,
soSis at-design if and only if
/summationdisplay
b∈S(−1)Langbracketlefta,bLangbracketright= 0 for all nonzero aof weight ≤t.
For example, when ais taken of weight 1, the above equation
implies that in any given coordinate position, half the members of
Shave entry 0 and half have entry 1. When ais taken of weight
2, e.g. as (1, 1,0,0,..., 0), the equation implies that the number of
members of Sthat begin with 00 or 11 is equal to the number that
begin with 10 or 01; it follows from this and the previous sentencethat exactly 1/4 of the n-tuples in Sbegin with each of 00, 10, 01,
11.
In general, consider a t-subsetT⊆{1,2,...,n}of coordinate
positions. For each subset IofT, letλ
Idenote the number of
a∈Swith entry 1 in coordinates of Iand entry 0 in coordinates of
T\I. For each subset IofT, letaJdenote the binary n-tuple with
1’s in coordinates of Jand 0’s in the remaining n−|J|coordinates.
We have 2tlinear equations, one for each J⊆T:
/summationdisplay
|I∩J|≡0 (mod 2)λI−/summationdisplay
|I∩J|≡1 (mod 2)λI=/braceleftbigg|S|ifJ=∅
0 otherwise.
ClearlyλI=|S|/2tfor allI⊆Tis a solution of this system. But
the coeﬃcient matrix of this system is a Hadamard matrix of order2
t(see Chapter 18) and in particular is nonsingular, so the solution
is unique. Thus Sis an orthogonal array of strength t. /square
The next two theorems are ‘formal duals’. That is, their proofs
are similar but the roles of the bases of Ai’s andEi’s are inter-
changed, as is the role of ordinary and Hadamard multiplicationof matrices. For the Hamming schemes, Theorem 30.6(i) reduces
---PAGE BREAK---
30. Association schemes 425
to the sphere packing bound, Theorem 21.1, and part (iii) gives a
very strong condition, due to S. P. Lloyd (1957), for equality to hold(perfect codes–see Chapter 20). For the Johnson schemes, Theorem30.7(i) reduces to Theorem 19.8, and part (iii) gives a very strongcondition, due to Ray-Chaudhuri and Wilson (1975), for equalityto hold (tight designs–see Chapter 19).
Theorem 30.6. LetCbea(2e+1)-codeina k-classmetricasso-
ciation scheme on a set X.Le tφ∈R
Xbe the characteristic vector
ofC.
(i)Wehave
|C|≤N/(1 +n1+n2+···+ne).
(ii)There are at least eindicesi∈{1,2,...,k}such that
φEiφLlatticetopLnegationslash=0.
(iii)Equality holds in (i) if and only if equality holds in (ii), in
which case the eindicesisuch that φEiφLlatticetopLnegationslash=0are exactly those
integersifor which
e/summationdisplay
plscript=0Pplscript(i)=0.
Proof: Letφbe the characteristic vector of a (2e +1)-codeCand
consider the expression
α:=φ(c0A0+c1A1+···+ceAe)2φLlatticetop
wherec0,c1,...,ceare scalars. We shall evaluate αin two ways.
Introduce
f(i): =c0P0(i)+c 1P1(i)+··· +cePe(i)
as a function of the cj’s. By (30.3), c0A0+c1A1+···+ceAe=/summationtextk
i=0f(i)Eiso
α=/parenleftBiggk/summationdisplay
i=0f(i)φEi/parenrightBigg/parenleftBiggk/summationdisplay
i=0f(i)φEi/parenrightBiggLlatticetop
=k/summationdisplay
i=0f(i)2φEiφLlatticetop.
---PAGE BREAK---
426 A Course in Combinatorics
On the other hand, Aiis a polynomial of degree iinA1,s o(A0+
A1+···+Ae)2is a polynomial of degree 2 einA1and hence a
linear combination of A0,A1,...,A 2e. Our hypothesis implies that
φAiφLlatticetop= 0 fori=1,2,..., 2e. Thus to evaluate α, we need only
the coeﬃcient of A0when (A 0+A1+···+Ae)2is written as a linear
combination of A0,A1,...,A 2e; by (30.2) and (30.1),
α=/parenleftBigge/summationdisplay
i,j=0cicjp0
ij/parenrightBigg
φA0φLlatticetop=/parenleftBigge/summationdisplay
i=0c2ini/parenrightBigg
|C|.
Note that by (30.6), f(0) =c0n0+c1n1+···+cene.W e n o w
combine the two values for α, remembering that E0=1
NJso that
φE0φLlatticetop=1
N|C|2, to obtain
(30.10) (c20+c21n1+···+c2ene)|C|=k/summationdisplay
i=0f(i)2φEiφLlatticetop
≥1
N(c0+c1n1+···+cene)2|C|2.
Everything will follow from (30.10). Part (i) follows when we
take allci:= 1.
To prove part (ii), suppose for contradiction that there are fewer
thaneindicesi≥1 such that φEiφLlatticetopLnegationslash= 0. By elementary linear
algebra, there exist scalars c0,...,ce, not all zero, such that f(i)=0
fori= 0 and all isuch that φEiφLlatticetopLnegationslash= 0. But then (30.10) gives
|C|/summationtexte
i=0nic2
i= 0, a contradiction.
Assume equality holds in (i). Then (30.10), with all ci’s equal
to 1, shows that f(i)=/summationtexte
plscript=0Pplscript(i) = 0 for the eor more values of
ifor which φEiφLlatticetopLnegationslash= 0. We claim that f(i) = 0 cannot hold for
more than evalues ofi. This is because f(0),f (1),...,f (k) are the
eigenvalues of A0+A1+···+Ae, which is a polynomial of degree
einA1; that is,f(0),...,f (k) arise from evaluating a polynomial
of degreeeon the eigenvalues P1(0),...,P 1(k)o fA 1. (The matrix
A1hask+ 1 distinct eigenvalues since it generates an algebra of
dimension k+1.) Our claim follows from the fact that a polynomial
of degreeehas at most ezeros. So (ii) holds with equality and (iii)
is proved in this case.
---PAGE BREAK---
30. Association schemes 427
Finally, assume equality holds in (ii). Choose scalars c0,...,ce
so thatf(i) = 0 for all isuch that φEiφLlatticetopLnegationslash= 0 and such that
f(0) = 1. Then (30.10) yields |C|=N(c2
0+c21n1+···+c2
ene). The
Cauchy-Schwartz inequality shows that
1=/parenleftBigge/summationdisplay
i=0cini/parenrightBigg2
≤/parenleftBigge/summationdisplay
i=0c2
ini/parenrightBigg/parenleftBigge/summationdisplay
i=0ni/parenrightBigg
so|C|≥N/ (1 +n1+n2+···+ne). Thus equality holds in (i). /square
Corollary (Lloyd’s theorem). Ifaperfect e-error-correctingcode
of lengthnover an alphabet of size qexits, then
Le(x): =e/summationdisplay
i=0(−1)i/parenleftbiggn−x
e−i/parenrightbigg/parenleftbiggx−1
i/parenrightbigg
(q−1)e−i
hasedistinct integral zeros.
Proof: This is just Theorem 30.6(iii) stated for the Hamming
scheme. The sum/summationtexte
plscript=0Pplscript(x) wherePplscript(x) is as in Theorem 30.1(ii)
simpliﬁes to Le(x) as stated above. /square
Example 30.9. We show that there are no nontrivial perfect 2-
error-correcting binary codes. If such a code has length n>2, then
its cardinality is 2n/(1+n+/parenleftbign
2/parenrightbig
), so 1+n+/parenleftbign
2/parenrightbig
=2rfor some integer
r. (Thatnhas this property is unusual—but it may happen, e.g.
forn= 90.) From Theorem 30.1(ii), for H(n,2),
P0(x)+P 1(x)+P 2(x)=2x2−2(n+1 )x+1+n+/parenleftbiggn
2/parenrightbigg
and Theorem 30.6(iii) then asserts that
x2−(n+1 )x+2r−1=0
has two integral roots x1andx2. We must have x1=2aandx2=2b
for positive integers aandbwherea+b=r−1 and 2a+2b=n+1.
Then it may be easily veriﬁed that
(2a+1+2b+1−1)2=2a+b+4−7.
---PAGE BREAK---
428 A Course in Combinatorics
Ifaandbare both ≥2, then the left-hand side is ≡1 (mod 16)
while the right-hand side is ≡9 (mod 16), a contradiction. The
reader may consider other cases and will ﬁnd that the only possi-
bility is{a,b}={1,2}in which case n=5 .
Theorem 30.7. LetDbe a2s-design in a k-class cometric asso-
ciation scheme on a set X.Le tφ∈RXbe the characteristic vector
ofD.
(i)We have
|D|≥1+m 1+m2+···+ms.
(ii)There are at least sindicesi∈{1,2,...,k}such that
φAiφLlatticetopLnegationslash=0.
(iii)Equality holds in (i) if and only if equality holds in (ii), in
which case the sindicesisuch that φAiφLlatticetopLnegationslash=0are exactly those
integersifor which
s/summationdisplay
plscript=0Qplscript(i)=0.
Proof: Letφbe the characteristic vector of a 2s-design Dand
consider the expression
β:=φ(c0E0+c1E1+···+csEs)◦(c0E0+c1E1+···+csEs)φLlatticetop
wherec0,c1,...,csare scalars. We shall evaluate βin two ways.
Introduce
g(i): =1
N(c0Q0(i)+c 1Q1(i)+··· +csQs(i))
as a function of the ci’s. By (30.4), c0E0+c1E1+···+csEs=/summationtextk
i=0g(i)Aiso
β=/parenleftBiggk/summationdisplay
i=0g(i)φAi/parenrightBigg
◦/parenleftBiggk/summationdisplay
i=0g(i)φAi/parenrightBiggLlatticetop
=k/summationdisplay
i=0g(i)2φAiφLlatticetop.
---PAGE BREAK---
30. Association schemes 429
On the other hand, Eiis a Hadamard polynomial of degree iin
E1, so the Hadamard square of E0+E1+···+Esis a Hadamard
polynomial of degree 2 sinE1and hence a linear combination of
E0,E1,...,E 2s. Our hypothesis implies that φEiφLlatticetop= 0 fori=
1,2,..., 2s. Thus to evaluate β, we need only the coeﬃcient of E0
when the Hadamard square of E0+E1+···+Esis written as a
linear combination of E0,E1,...,E 2s; by (30.7) and (30.8),
β=/parenleftBigg
1
Ns/summationdisplay
i,j=0cicjq0
ij/parenrightBigg
φE0φLlatticetop=1
N2/parenleftBiggs/summationdisplay
i=0c2
imi/parenrightBigg
|C|2.
Note that by (30.6), g(0) =1
N(c0m0+c1m1+···+csms). We
now combine the two values for βto obtain
(30.11)1
N2(c20+c21m1+···+c2sms)|C|2=k/summationdisplay
i=0g(i)2φAiφLlatticetop
≥1
N(c0+c1m1+···+csms)2|C|.
Everything will follow from (30.11) in a manner similar to that
of the proof of Theorem 30.6. /square
Problem 30I. Consider the extended Golay code G24. For no-
tational convenience, arrange the coordinates so that the word
c=( 1,...,1,0...,0) with 1’s in the ﬁrst eight positions, and 0’s
elsewhere, is a codeword.
(i) Use counting arguments to show that G24contains 30 words
of weight 8 that have no 1’s in the ﬁrst eight positions (so: distance16 toc). Then show that all the words in G
24that have no 1’s in
the ﬁrst eight positions form a subcode that is essentially R(1,4).
(ii) LetAbe the set of 16-tuples (a 9,a10,...,a 24) obtained by
dropping the ﬁrst eight coordinates from words a=(a1,a2,...,a 24)
inG24such that the weight of ( a1,a2,...,a 7)i s≤ 1. Show that A
is a code of length 16 with 256 codewords and minimum distance6.
(iii) UseAto construct some examples of codes where equality
holds in Figure 30.2.
---PAGE BREAK---
430 A Course in Combinatorics
Problem 30J. Show that a binary linear code with parameters
[13,6,5] does not exist. (And hence there are no binary linear
codes with parameters [16, 8,6] either.)
Problem 30K. Theodd graph has as vertices the k-subsets of a
(2k+ 1)-set, joined by an edge if they are disjoint. (For k= 2 this
is the Petersen graph.)
(i) Show that this graph is distance regular.
(ii) Show that if k= 3, the vertices ‘corresponding to’ the Fano
plane form a perfect code in the graph.
Problem 30L. Find all examples of perfect 3-codes in the Johnson
schemeJ(v,3). (All the examples are trivial.)
Notes.
Association schemes were introduced by statisticians at the same
time as partially balanced designs . An incidence structure is par-
tially balanced with respect to an association scheme on its points
when each pair of i-th associates occurs in a constant number λi
of blocks. Examples include the partial geometries of Chapter 21.
Partially balanced designs were introduced to get around Fisher’sinequality b≥v, or equivalently r≥k, which need not hold for
them. Replications cost money (r stands for ‘replication number’)
or take time, so for practical reasons, one wants rsmall.
To do the analysis of an experiment for which a certain design
(incidence structure) has been used, it is necessary to do calcula-tions with NN
LlatticetopwhereNis the incidence matrix; these calculations
are vastly simpliﬁed for partially balanced designs because in an m-
class scheme
NNLlatticetop=λ0A0+λ1A1+···+λmAm
lies in the small-dimensional Bose–Mesner algebra even though thesize of the matrices may be very much more than the dimensionm+1 .
Delsarte’s inequalities imply the general Erd˝ os-Ko-Rado theo-
rem: Ifn≥(t+ 1)(k−t+ 1) and Fis a family of k-subsets of an
n-set so that any two of members of Fmeet in at least tpoints,
then|F| ≤/parenleftbig
n−t
k−t/parenrightbig
. See Wilson (1984a).
---PAGE BREAK---
30. Association schemes 431
See Van Lint (1999) for more on the nonexistence of perfect
codes.
References.
E. Bannai and T. Ito (1984), Association Schemes, Benjamin/
Cummings.
A. E. Brouwer, A. M. Cohen, and A. Neumaier (1989), Distance
Regular Graphs , Springer-Verlag.
Ph. Delsarte (1973), An Algebraic Approach to the Association
Schemes of Coding Theory , Philips Res. Rep. Suppl. 10.
Ph. Delsarte (1975), The association schemes of coding theory, in:
Combinatorics (Proc. Nijenrode Conf.), M. Hall, Jr. and J. H.
van Lint, eds., D. Reidel.
J. H. van Lint (1999), Introduction to Coding Theory , Third edition,
Springer-Verlag.
S. P. Lloyd (1957), Binary block coding, Bell System Tech. J. 36,
517–535.
D. K. Ray-Chaudhuri and R. M. Wilson (1975), On t-designs, Os-
aka J. Math. 12, 737–744.
R. M. Wilson (1984a), The exact bound in the Erd˝ os-Ko-Rado
theorem, Combinatorica 4, 247–257.
R. M. Wilson (1984b), On the theory of t-designs, pp. 19–50 in:
Enumeration and Design (Proceedings of the Waterloo Silver
Jubilee Conference), D. M. Jackson and S. A. Vanstone, eds.,Academic Press.
---PAGE BREAK---
31
(More) algebraictec hniques
in graph theory
We have used linear algebraic techniques on the adjacency matrices
of graphs in Chapter 9, and extensively in Chapter 21. We collecthere several other elegant applications. Also see Chapter 36.
Atournament is an orientation of a complete graph; that is, a
directed graph such that for any two distinct vertices xandy, there
is either an edge from xtoy, or an edge from ytox, but not both.
Tournaments were introduced brieﬂy in Problem 3D. The adjacency
matrix of a digraph ha sa1i np osition (x,y ) when there is an edge
fromxtoy, and 0 otherwise.
Lemma 31.1. The rank of the adjacency matrix Aof a tourna-
ment onnvertices is either norn−1.
Proof: The deﬁnition of tournament ensures that A+A
Llatticetop=J−I,
where all matrices are n×n. Suppose the rank of Ais at most
n−2. Then there exists a nonzero row vector xsuch that both
xA= 0 and xJ= 0. We then compute
0=x(A +ALlatticetop)xLlatticetop=x(J−I)xLlatticetop=−xxLlatticetop<0,
which contradicts the existence of x. /square
The following theorem is due to R. L. Graham and H. O. Pollak.
Their original proof applied Sylvester’s law, which they had alsoused for their proof of Theorem 9.1.
Theorem 31.2. Suppose that the complete graph K
ncan be ex-
pressed as the union of kedge-disjoint subgraphs H1,H2,...,Hk
where each Hiis a complete bipartite graph. Then k≥n−1.
---PAGE BREAK---
31. (More) algebraic techniques in graph theory 433
Proof: Orient each complete bipartite subgraph Hiby directing
all edges from one of the two color classes to the other. This pro-
duces a tournament on nvertices whose adjacency matrix Ais the
sum of the kadjacency matrices Aiof the digraphs Hi(augmented
ton×nmatrices by including all vertices). The adjacency ma-
trix of such a complete directed bipartite subgraph, after a suitablerenumbering of the vertices, has the block form

OJO
OOOOOO

and in particular has rank 1. This implies that the rank of Ais at
mostk, and Lemma 31.1 completes the proof. /square
This brings to mind the De Bruijn–Erd˝ os theorem, Theorem 19.1,
which asserts, in a quite diﬀerent terminology, and which was given
a quite diﬀerent proof, that if K
nis the union of kedge-disjoint
complete subgraphs, then k≥n. But no proof of Theorem 31.2 is
known which does not use linear algebra.
As a real symmetric matrix, the adjacency matrix A=A(G)o f
a ﬁnite graph Ghas an orthogonal basis of eigenvectors. (Eigen-
vectors corresponding to diﬀerent eigenvalues are necessarily or-thogonal.) By the ‘eigenvalues of G’ we mean the eigenvalues of
A(G). Here is a short table of the spectra, i.e. the complete lists ofeigenvalues, of several graphs:
graph spectrum
K5 4,−1,−1,−1,−1
K3,3 3,0,0,0,0,−3
Cube 3,1,1,1,−1,−1,−1,−3
Pentagon 2,1
2(−1+√
5),1
2(−1+√
5),
1
2(−1−√
5),1
2(−1−√
5)
Petersen graph 3,1,1,1,1,1,−2,−2,−2,−2
L2(3) 4,1,1,1,1,−2,−2,−2,−2
Heawood graph 3,√
2,√
2,√
2,√
2,√
2,√
2,
−√
2,−√
2,−√
2,−√
2,−√
2,−√
2,−3
---PAGE BREAK---
434 A Course in Combinatorics
(The Heawood graph is the ‘bipartite incidence graph’ of the
Fano conﬁguration, with seven vertices representing the points and
seven others representing the lines. It appears again in Chapter35.)
Nonisomorphic graphs may have the same spectra. For example,
we mentioned in Chapter 21 that there exist four nonisomorphicstrongly regular graphs with the parameters of T(8); cf. Theorem
21.5.
Problem 31A. Show that it is not possible to ﬁnd three edge-
disjoint copies of the Petersen graph in K
10. Hint: if A1,A2, and
A3are the adjacency matrices of three edge-disjoint Petersen sub-
graphs ofK10, then all three matrices have the same spectrum, all
have the all-one vector jas an eigenvector, and A1+A2+A3=J−I.
LetSbe a symmetric matrix. The expression xSxLlatticetop/xxLlatticetop, forxLnegationslash=
0, is called a Raleigh quotient. Let e1,e2,...,enbe an orthonormal
basis of eigenvectors with corresponding eigenvalues
λ1≥λ2≥···≥λn.
If we write xin this basis, say x=a1e1+···+anen, then
(31.1)xSxLlatticetop
xxLlatticetop=λ1a2
1+λ2a22+···+λna2
n
a2
1+a22+···+a2n.
In particular, for any nonzero x,
λ1≥xSxLlatticetop
xxLlatticetop≥λn.
While most graphs we will consider are simple, we remark that
there is nothing to prevent the consideration of adjacency matrices
of multigraphs below (where the entry in row xand column yis
the number of edges joining xandy), or the adjacency matrices
of ‘weighted’ graphs (where the entry in row xand column yis a
‘weight’ associated to the edge joining xandy).
It is at ﬁrst surprising that the spectrum of a graph has anything
at all to do with the more geometric or combinatorial properties ofthe graph. One of the ﬁrst connections observed was the followingtheorem of A. J. Hoﬀman. A coclique ,o ra n independent set of
vertices, in a graph Gis a set of vertices no two of which are
adjacent.
---PAGE BREAK---
31. (More) algebraic techniques in graph theory 435
Theorem 31.3. LetGbe a graph on nvertices which is regular
of degree dand letλminbe the least eigenvalue of G,s oλminis
negative. Then for any coclique SinG,
|S|≤−nλ min
d−λmin.
Proof: LetAbe the adjacency matrix of Gandλ:=λmin. Then
A−λIis positive semideﬁnite, i.e. all eigenvalues are nonnegative;
note that the eigenvectors of A−λIare the same as those of A.
One of the eigenvectors is j:= (1,1,..., 1), and we have
j(A−λI)=(d−λ)j.
Then with
M:=A−λI−d−λ
nJ,
we will have jM= 0. Every other eigenvector eofAmay be
taken to be orthogonal to j,s oeJ= 0, and is seen also to be an
eigenvector of Mwith nonnegative eigenvalue. That is, Mis also
positive semideﬁnite.
Now letφbe the characteristic vector of a coclique Sconsisting
ofmvertices of G, i.e.φ(x)i s1i fx∈Sand 0 otherwise. Then
φAφLlatticetop= 0 and we have
0≤φMφLlatticetop=−λφφLlatticetop−d−λ
nφJφLlatticetop=−λm−d−λ
nm2.
The stated inequality follows. /square
There are extensions and variations on Theorem 31.3 for nonreg-
ular graphs—see Haemers (1979).
Problem 31B. Apply Theorem 31.3 to the complement of a sim-
ple regular graph Gto obtain an upper bound on the size of a clique
inGin terms of the spectrum. Find several examples where your
bound is met.Problem 31C. Theline graph L=L(G) of a simple graph G
was introduced in Chapter 17. For example, L
2(m) as deﬁned in
Chapter 21 is the line graph of Km,m,T(m) is the line graph of Km,
---PAGE BREAK---
436 A Course in Combinatorics
and the line graph of a pentagon is a pentagon. (i) Show that the
Petersen graph is notthe line graph of any graph. (ii) Prove that
ifGhas more edges than vertices, then the minimum eigenvalue
of the line graph L(G)i s−2. (Suggestion: let Nbe the incidence
matrix of Gand consider NLlatticetopN.)
L. Lov´ asz (1979) observed that the bound on the size of a coclique
in Theorem 31.3 is also a bound on what is called the Shannoncapacity of a graph. This is a concept that arose in informationtheory. Suppose a set of ‘letters’ is to be used for transmittingmessages. Some pairs of letters are assumed to be ‘confusable’ or‘confoundable’. We say two potential messages (words or stringsofnof these letters) are confoundable when in each coordinate the
letters are either identical or confoundable. We desire a set of wordsno two of which are confoundable.
To state this in more graph-theoretic terminology, we introduce
the graph Gwhose vertices are the letters and where two vertices
are adjacent if and only if the letters are confoundable. Thus a setof letters, no two of which are confoundable, is exactly a coclique inthis graph. The strong product G⊗Hof simple graphs GandHis
the simple graph deﬁned by V(G⊗H): =V (G)×V(H) and where
distinct vertices (x
1,y1) and (x2,y2) are adjacent in G⊗Hwhenx1
andx2are equal or adjacent, and y1andy2are equal or adjacent.
The vertices of Gn:=G⊗G⊗···⊗G(nfactors) correspond to
words of length n, and two are adjacent in Gnjust when the words
are confoundable. Thus we are interested in the size of a largestcoclique in G
n.
Theindependence number α(G) of a graph Gis the largest car-
dinality of a coclique in G. The Shannon capacity of a graph G
is
Θ(G) := lim
n→∞(α(Gn))1/n= sup
n(α(Gn))1/n.
That the limit exists and is equal to the supremum follows from theobservation that the product of cocliques in GandHis a coclique
inG⊗H, and thus that α(G
k+m)≥α(Gk)α(Gm). (See Fekete’s
lemma in Chapter 11.)
Example 31.1. The problem of evaluating the Shannon capacity
of such simple graphs as the pentagon P5was open for many years
---PAGE BREAK---
31. (More) algebraic techniques in graph theory 437
before the relevance of algebraic techniques was noticed by Lov´ asz.
It is easy to ﬁnd 2nwords of length n, no two of which are con-
foundable, e.g. all words of 1s and 3s. This shows Θ(P 5)≥2. This
is not so good: we get only four words of length 2 this way, whenit is not hard to ﬁnd a set of ﬁve:
(1,1),(2,3),(3,5),(4,2),(5,4).
For even values of n, we can take the product of n/2 copies of the
above ﬁve words to get (√
5)npairwise nonconfoundable words of
lengthn; this shows Θ(P 5)≥√
5. Can we do better, perhaps for
very large values of n? No, as we shall see after Theorem 31.6,
Θ(P 5)≤√
5.
Here is the approach of Lov´ asz (1979). First, observe that with
the deﬁnition of Kronecker product of Chapter 18, we have, forvectorsx,y∈R
n,v,w∈Rn,
(31.2) (x◦v)(y◦w)Llatticetop=Langbracketleftx,yLangbracketrightLangbracketleftv,wLangbracketright.
LetGbe a graph. For simplicity we shall always assume that its
vertices are 1 ,2,...,n .A northonormal representation ofGis a
system (v1,...,vn) of unit vectors in a Euclidean space such that
ifiandjare nonadjacent vertices, then viandvjare orthogo-
nal. Clearly, every graph has an orthonormal representation, forexample by pairwise orthogonal vectors.
Lemma 31.4. Let(u
1,...,un)and(v1,...,vm)be orthonormal
representations of GandHrespectively. Then the vectors ui◦vj
form an orthonormal representation of G⊗H.
Proof.: This is a consequence of (31.2). /square
Deﬁne the value of an orthonormal representation ( u1,...,un)t o
be
min
cmax
1≤i≤n1
Langbracketleftc,uiLangbracketright2,
wherecranges over all unit vectors. The vector cyielding the min-
imum is called the handle of the representation. Let θ(G) denote
the minimum value over all repesentations of G. It is easy to see
that this minimum is attained. A representation with value θ(G)
is called optimal .
---PAGE BREAK---
438 A Course in Combinatorics
Lemma 31.5. θ(G⊗H)≤θ(G)θ(H).
Proof: Let (u 1,...,un) and (v1,...,vm) be optimal orthonormal
representations of GandH, with handles candd, respectively.
Then, by (31.2), c◦dis a unit vector, and again by (31.2),
θ(G⊗H)≤max
i,j1
Langbracketleftc◦d,ui◦vjLangbracketright2
=m a x
i,j1
Langbracketleftc,uiLangbracketright2·1
Langbracketleftd,vjLangbracketright2
=θ(G)θ(H).
(One can prove that equality holds in this lemma.) /square
Theorem 31.6. Θ(G)≤θ(G).
Proof: We ﬁrst show that α(G)≤θ(G).Let (u 1,...,un)b ea n
optimal orthonormal representation of Gwith handle c. Suppose
that{1,2,...,k}is a maximum independent set in Gand hence
u1,...,ukare pairwise orthogonal. Therefore
1=||c||2≥k/summationdisplay
i=1Langbracketleftc,uiLangbracketright2≥α(G)/θ (G).
From this and Lemma 31.5 we ﬁnd that α(Gn)≤θ(Gn)≤θ(G)n.
/square
Example 31.1, continued. We can now show that Θ(C 5)=√
5
by an elegant idea from Lov´ asz (1979). Consider an umbrella whose
handle and ﬁveribs have unit length. If we open such an umbrella,
we will pass a point where the angles between nonadjacent ribs areallπ/2. If we call the handle cand the ribs u
1tou5, all oriented
away from their common point, then u1,...,u5is an orthonormal
representation of C5inR3. It is an easy calculation to show that
Langbracketleftc,uiLangbracketright=5−1/4. Theorem 31.6 and the deﬁnition of θ(C5) then yield
the result.
The result also follows form the corollary below.
Corollary. LetGbe a graph on nvertices which is regular of
degreedand letλminbe the least eigenvalue of G. Then
Θ(G)≤−nλ min
d−λmin.
---PAGE BREAK---
31. (More) algebraic techniques in graph theory 439
Proof: LetAbe the adjacency matrix of G. In the proof of
Theorem 31.3, we saw that with λ:=λmin,M:=A−λI−d−λ
nJ
was positive semideﬁnite (and singular). Thus M=BBLlatticetopfor some
real matrix Bof rank<n. Let the rows of Bbex1,...,xn;w e
have
Langbracketleftxi,xiLangbracketright=−λ−d−λ
n,Langbracketleftxi,xjLangbracketright=−d−λ
n,
the latter when i,jare not adjacent. Let cbe any unit vector
orthogonal to the rows xiofBand deﬁne
vi:=1√
−λxi+1/radicalbig
−λn/(d−λ)c.
Check that v1,...,vnis an orthogonal representation of G. Finally
note that for any i,
1
Langbracketleftc,viLangbracketright2=−λn
d−λ.
The result follows from Theorem 31.6. /square
Next, we give two applications of ‘interlacing’ of eigenvalues.
Lemma 31.8. LetAbeasymmetricmatrixoforder nwitheigen-
values
λ1≥λ2≥···≥λn.
SupposeNisanm×nrealmatrixsuchthat NNLlatticetop=Im,som≤n.
LetB:=NANLlatticetop, and let
µ1≥µ2≥···≥µm
be the eigenvalues of B. Then the eigenvalues of Binterlace those
ofA, in the sense that
λi≥µi≥λn−m+i
fori=1,2,...,m.
Proof: Lete1,...,enbe an orthonormal basis of eigenvectors of
Acorresponding to λ1,...,λn, and let f1,...,fmbe an orthonormal
basis of eigenvectors of Bcorresponding to µ1,...,µm.
---PAGE BREAK---
440 A Course in Combinatorics
Fixiand consider U:= span{f1,...,fi}. By (31.1),
xBxLlatticetop
xxLlatticetop≥µi
for every nonzero x∈U. LetW:={xN :x∈U}. ThenWis an
i-dimensional subspace and
(31.3)yAyLlatticetop
yyLlatticetop≥µi
for every y∈W. Choose yLnegationslash=0i nW∩span{ei,ei+1,...,en}.
Then in addition to (31.3), we have
yAyLlatticetop
yyLlatticetop≤λi
from (31.1) and this proves λi≥µi.
A similar argument with U:= span{fi,...,fm}will prove that
µi≥λn−m+i . /square
The term interlacing seems most natural in the case m=n−1
where
λ1≥µ1≥λ2≥µ2≥λ3≥···≥λn−1≥µn−1≥λn.
An important special case of Lemma 31.8 occurs when the rows
ofNaremdistinct ‘standard basis’ vectors of length n, i.e. with a
single 1 in each row. In this case the matrix Bis just an m×m
principal submatrix of A. The following observation is due to D.
M. Cvetkovi´ c.
Theorem 31.9. Thesizeofacocliqueinagraph Gcannotexceed
the number of nonnegative eigenvalues, or the number of nonposi-
tive eigenvalues, of G.
Proof: IfGhas a coclique of size m, then the adjacency matrix A
has anm×mprincipal submatrix of all zeros. If the eigenvalues
ofAareλ1≥λ2≥· · ·≥λn, then by interlacing, λm≥0 and
0≥λn−m+1 ,s oAhas at least meigenvalues which are ≥0 and at
leastmwhich are ≤0. /square
The next theorem is a result of A. J. Hoﬀman on the chromatic
number of a graph. We remark that for regular graphs, this wouldfollow from Theorem 31.3.
---PAGE BREAK---
31. (More) algebraic techniques in graph theory 441
Theorem 31.10. Letλ1≥···≥λnbe the eigenvalues of a graph
G. Then
χ(G)≥1+λ 1/(−λn).
Proof: SupposeGcan be properly colored with mcolors. The
color classes induce a partition of the adjacency matrix
A=
A11···A1m......
A
m1···Amm
,
whereAijis the submatrix consiting of the rows indexed by the
vertices of color iand columns indexed by the vertices of color j.
Each of the diagonal blocks Aiiis a square zero matrix.
Letebe an eigenvector of Acorresponding to the maximum
eigenvalue λ1and write e=(e1,...,em) whereeihas coordinates
indexed by the vertices of color i. Let
N:=
1
Lbardble1Lbardble1 00 ···
01
Lbardble2Lbardble2 0···
001
Lbardble3Lbardble3···
.........···

(anm×nmatrix) and let B:=NAN
Llatticetop. By Lemma 31.8, the
eigenvalues µ1,...,µmofBinterlace those of Aand hence are be-
tweenλ1andλn. On the other hand, we have constructed Bso
thatλ1isan eigenvalue since
(Lbardble1Lbardbl,...,LbardblemLbardbl)B=eANLlatticetop=λ1eNLlatticetop=λ1(Lbardble1Lbardbl,...,LbardblemLbardbl).
Finally note that the diagonal entries of Bare zeros, so
0 = trace(B )=µ 1+···+µm≥λ1+(m−1)λn.
This proves the theorem. (But perhaps we should have said that if
some of the eiare zero, those rows should not be included in N.)
/square
---PAGE BREAK---
442 A Course in Combinatorics
Problem 31D. Show that for any ﬁnite graph G,χ(G)≤1+λ 1
whereλ1is the largest eigenvalue of G. Hint: consider the degrees
of an induced subgraph of Gthat is minimal with respect to having
the same chromatic number as G.
In addition to being symmetric, the adjacency matrix of a graph
is also a nonnegative matrix. There is a useful theory of such matri-
ces, at the center of which is the Perron–Frobenius theorem, The-
orem 31.11 below. A complete proof may be found in Gantmacher(1959).
A square matrix Awith rows and columns indexed by a set X,
say, is called irreducible when it is notpossible to ﬁnd a proper
subsetSofXso thatA(x,y ) = 0 whenever x∈Sandy∈X\S.
Equivalently, Ais not irreducible if and only if it is possible to apply
a simultaneous row and column permutation to obtain a matrix ofthe form/parenleftbigg
BO
CD/parenrightbigg
whereBandDare square and of order at least 1. It should be clear
that ifAis the incidence matrix of a graph, then it is irreducible
if and only if the graph is connected.
Problem 31E. LetDbe a ﬁnite digraph. Let Athe adjacency
matrix ofD, or any matrix with rows and columns indexed by the
vertices of Dand where A(x,y ) = 0 if there are no edges directed
fromxtoyandA(x,y )>0 if there are such edges. (i) Show that
A
k(x,y)>0 if and only if there is a directed walk of length kfrom
xtoyinD. (ii) Show that Ais irreducible if and only if Dis
strongly connected, that is, if and only if for any two vertices of D,
there is a directed path from xtoy.
Theorem 31.11 (Perron–Frobenius). LetAbe an irreducible
n×nnonnegative matrix. There is, up to scalar multiples, a
unique eigenvector a=(a1,...,an)all of whose coordinates aiare
nonnegative. The coordinates of this vector aare, in fact, strictly
positive. Thecorrespondingeigenvalue λ(whichiscalledthe dom-
inant eigenvalue ofA)has algebraic multiplicity 1and has the
property that λ≥|µ|for any eigenvalue µofA.
---PAGE BREAK---
31. (More) algebraic techniques in graph theory 443
Partial proof: We omit the proof of the existence of a nonnega-
tive eigenvector, but show how irreducibility is used and give much
of the rest of the proof.
We will show that any nonnegative eigenvector aofA, corre-
sponding to eigenvalue λ, say, is positive in all coordinates. Con-
siderAas the matrix of a strongly connected digraph as in Problem
31E. Since there is a directed path from any vertex to any other oflength≤n−1,
I+A+A
2+···+An−1>O.
Here and below, an inequality for matrices or vectors is understoodto hold in all coordinates. Since a≥0butaLnegationslash=0,
0<a(I+A+A
2+···+An−1)=( 1+λ+···+λn−1)a,
and so0<a.
Next we show the eigenvalue λhas geometric multiplicity 1, i.e.
that the corresponding eigenspace has dimension 1. Let aLprimebe any
eigenvector corresponding to eigenvalue λ, with coordinates that
are positive, negative, or zero. If we add or subtract small scalarmultiples of a
Lprimefroma, we obtain other positive or nonnegative
eigenvectors a−caLprimecorresponding to eigenvalue λ. We can choose
cso thata+caLprime≥0, but so that at least one coordinate iszero. This
contradicts the result of the previous paragraph unless a−caLprime=0.
We omit the proof that λhas algebraic multiplicity 1, i.e. is a simple
zero of the characteristic polynomial.
Letabe the positive eigenvector for A, with eigenvalue λ. Letb
be the positive eigenvector of ALlatticetop;s a yAbLlatticetop=νbLlatticetop. Then
λabLlatticetop=(aA)bLlatticetop=a(AbLlatticetop)=νabLlatticetop.
This is a contradiction unless ν=λ,s oAbLlatticetop=λbLlatticetop. Suppose uis
an eigenvector of Athat is not a scalar multiple of a,s a yuA=µu
withµLnegationslash=λ. Then
λubLlatticetop=u(AbLlatticetop)=(uA)bLlatticetop=µubLlatticetop.
---PAGE BREAK---
444 A Course in Combinatorics
which implies ubLlatticetop= 0. So any other eigenvector ucannot have
nonnegative coordinates. Now let ˆu:= (|u 1|,...,|un|) and check
thatˆuA≥|µ|ˆufollows easily from A≥O. Then
λˆubLlatticetop=ˆu(AbLlatticetop)=(ˆuA)bLlatticetop≥|µ|ˆubLlatticetop,
from which we have λ≥|µ|. /square
Theorem 31.12. Letλbethedominanteigenvalueofaconnected
graphG. ThenGisbipartiteifandonlyif −λisalsoaneigenvalue
ofG.
Proof: First suppose Gis bipartite. Then the adjacency matrix
AofGis, after renumbering the vertices if necessary so that the
color classes consist of the ﬁrst kand lastn−k, of the form
A=/parenleftbigg
OB
BLlatticetopO/parenrightbigg
whereBisk×n−k. Letebe an eigenvector corresponding to
an eigenvalue µand write e=(e1,e2) where e1consists of the
ﬁrstkcoordinates. It may be checked that (e 1,−e2) is then an
eigenvector of eigenvalue −µ.S o i f Gis bipartite (connected or
not), its spectrum is in fact symmetric about 0.
Now suppose λis the dominant eigenvalue of a connected graph
Gand that −λis also an eigenvalue. Let e=(e1,−e2)b ea n
eigenvector of unit length corresponding to −λ, where we have
numbered the vertices so that e1ande2both have all nonnegative
coordinates. Partition the adjacency matrix Aaccordingly:
A=/parenleftbigg
BC
DE/parenrightbigg
.
Then
−λ=eAeLlatticetop=e1BeLlatticetop
1+e2EeLlatticetop2−e1CeLlatticetop2−e2DeLlatticetop1,
and hence
(31.4) (e1,e2)A(e 1,e2)Llatticetop≥λ
---PAGE BREAK---
31. (More) algebraic techniques in graph theory 445
with equality if and only if
(31.5) e1BeLlatticetop
1=e2EeLlatticetop2=0.
The equation (31.1) and the fact that λis the dominant eigenvalue
imply that equality must hold in (31.4) and that ( e1,e2) is an eigen-
vector corresponding to eigenvalue λ. Then Theorem 31.11 implies
that all coordinates of ( e1,e2) are positive. Finally, (31.5) shows
thatB=E=Oand this means that Gis bipartite. /square
Theorem 31.13. LetGbe a ﬁnite graph and Aits adjacency
matrix. There exists a polynomial f(x)such that f(A)=Jif and
only ifGis connected and regular.
Proof: Supposef(A)=J for some polynomial f(x). Then, since
polynomials in a given matrix commute, AJ=JA. The entry in
rowxand column yofAJis degG(x); the entry in that position of
JAis degG(y). HenceGis regular.
Iff(A)=J , then, in particular, for any xandy, we must have
Ak(x,y)Lnegationslash= 0 for some k. The entry in row xand column yofAk
is the number of walks of length kfromxtoyinG. Hence Gis
connected.
Now suppose Gis connected and regular of degree d. Thenjis an
eigenvector of Acorresponding to eigenvalue d. By Theorem 31.11,
the eigenvalue dhas multiplicity one. For any symmetric matrix M,
the matrix of the orthogonal projection onto any of its eigenspaces
is a polynomial in M; explicitly, if ( x−µ1)(x−µ2)···(x−µk)i s
the minimal polynomial of M, then it is an exercise to show that
1
(µ1−µ2)···(µ1−µk)(M−µ2I)···(M−µkI)
is the orthogonal projection onto the eigenspace {a:aM=µ1a}.
Since the orthogonal projection onto the span of jis1
vJ, this matrix
is a polynomial in A. /square
Isomorphic graphs will have the same eigenvalues, but, as we
mentioned earlier, the converse is not true: nonisomorphic graphsmay have the same spectra (multisets of eigenvalues). See Problem21O. But we may have a partial converse, in particular for ‘circulantgraphs’ with a prime number of vertices.
---PAGE BREAK---
446 A Course in Combinatorics
LetGbe an abelian group, written additively. For S⊆G, the
Cayley graph Γ(G,S ) has vertex set G, and there is an edge directed
fromxtoyin Γ(G,S ) if and only if y−x∈S. Cayley graphs have
arisen numerous times in the preceding chapters. A Cayley graph
may be thought of as an undirected graph when −S=S, and will
have no loops when 0 Lnegationslash∈S.Acirculant graph is a Cayley graph
Γ(G,S ) whereGis cyclic.
(Cayley graphs can also be deﬁned for nonabelian groups. But
we consider only the abelian case below.)
AG-matrix is a square matrix Awhose rows and columns are
indexed by the elements of Gand where for some vector of objects
(ag:g∈G),A(i,j )=aj−i.Acirculant matrix (or simply a
circulant )i saG-matrix where Gis cyclic. In general, the adjacency
matrix of a Cayley graph based on Gis aG-matrix.
We remark that G-matrices over a ring Rare closed under mul-
tiplication and the algebra of such matrices is isomorphic to thegroup ring R[G] as in Chapter 28.
Proposition 31.14. Letωbeaprimitive nthrootofunityinsome
ﬁeldFandUthematrixwithrowsandcolumnsindexedby Z
nwith
U(i,j)=ωij.Le tAbe a circulant based on elements (ai:i∈Zn)
ofF. ThenUAU−1is the diagonal matrix with diagonal entries
λj:=n−1/summationdisplay
i=0aiωji,j =0,1,...,n−1.
That is, the eigenvalues of Aareλ0,λ1,...,λn−1(and the corre-
sponding eigenvectors are the rows of U).
Problem 31F. (i) Prove Proposition 31.14. (ii) For those familiar
with the characters of an abelian group: Show that the eigenvaluesof a rational G-matrix Aareλ
χ=/summationtext
g∈Gagχ(g), asχranges over
the characters of G. Cf. Example 30.6.
The following is from Elspas and Turner (1970).
Theorem 31.15. LetAandBbe rational circulant matrices of
prime order p>2, based on vectors (ai:i∈Zp)and(bi:i∈Zp),
respectively. If AandBhave the same spectrum, then for some
---PAGE BREAK---
31. (More) algebraic techniques in graph theory 447
tLnegationslash=0inZp,ai=btifor alli∈Zp, where the subscripts are read
modulop.
Proof: Letωbe a complex primitive pth root of unity. Then, in
view of Proposition 31.14, α:=/summationtextn−1
i=0aiωiis an eigenvalue of Aand
so is one of the eigenvalues of B, and so
n−1/summationdisplay
i=0aiωi=n−1/summationdisplay
i=0biωsi
for somes.
First, assume sLnegationslash= 0, and choose tso thatst≡1( m o dp). Then
p−1/summationdisplay
i=0(ai−bti)ωi=0.
But as the minimal polynomial of ωover the rationals is 1+ x+x2+
···+xp−1, we may conclude that for some constant c,ai−bti=cfor
alli. The traces of AandB, which must be equal, are, respectively,
pa0andpb0. Hencea0=b0, and then c=0 .
Ifs= 0, then αis rational and
(a0−α)+a 1ω+···+ap−1ωp−1=0.
We may concude that all coeﬃcients above are equal to some con-
stantc; this means A=αI+cJ.
We repeat the argument with the roles of AandBinterchanged,
and we ﬁnd that either the statement of the theorem holds or thatB=βI+dJfor some rational numbers βandd.
The eigenvalues of aI+bJarea+pbof multiplicity 1 and a+b
of multiplicity p−1. IfA=αI+cJandB=βI+dJhave the
same spectra and p>2, it follows that A=Band the theorem
holds for any t. /square
We remark that for p= 2, the statement of the theorem is not
valid, since e.g. the circulants
/parenleftbigg
1111/parenrightbigg
and/parenleftbigg
1−1
−11/parenrightbigg
have the same spectrum {2,0}. However, it is valid if AandBare
both nonnegative.
---PAGE BREAK---
448 A Course in Combinatorics
Corollary. Circulant graphs of prime order are isomorphic if and
only if they (their adjacency matrices) have the same eigenvalues.
Proof: We have asserted before that isomorphic graphs have the
same spectra.
Suppose the circulant graphs Γ( Zp,S) and Γ( Zp,T), for some
S,T⊆Zp,pprime, have adjacency matrices AandBwith the
same spectra. Here Ais the circulant based on ( ai:i∈Zp) where
ai=1i fi∈Sandai= 0 otherwise; similarly, and Bis based on
(bi:i∈Zp) wherebi=1i fi∈Tandbi= 0 otherwise. Theorem
31.15 says (for p= 2, we need the remark) ai=btifor sometLnegationslash=0 .
Then the permutation φ:iLmapsto→tiofZpis an isomorphism of Γ( Zp,S)
onto Γ(Z p,T) because
i→jin Γ(Zp,S)⇐⇒i−j∈S
⇐⇒t(i−j)∈T⇐⇒ti→tjin Γ(Zp,T),
wherex→ymeans there is an edge directed from xtoy. /square
Corollary. GivenS,T⊆Zp, the circulant graphs Γ(Zp,S)and
Γ(Zp,T)are isomorphic if and only if T=tSfor some ‘multiplier’
tLnegationslash=0inZp.
Proof: If Γ(Zp,S) and Γ( Zp,T) are isomorphic, then they have
the same spectra, and as in the proof of the preceding corollary, we
haveai=btifor sometLnegationslash= 0, which means T=tS.
Conversely, if T=tS, then as we saw above, φ:iLmapsto→tiofZpis
an isomorphism. /square
It had been conjectured that the corollary above holds when p
is replaced by any integer n, and the condition tLnegationslash= 0 replaced
by (t,n) = 1, but counterexamples exist for n=8,9 and other
values. In fact, the corollary with preplaced by nholds exactly
whennis square-free or 4 times an odd square-free number. See
M. Muzychuk (1997).
Problem 31G. Prove that the vertices of any ﬁnite simple graph
may be colored red and blue so that each red vertex is adjacent to an
even number of red vertices, and each blue vertex is adjacent to anodd number of red vertices. First prove the lemma: if S=(a
ij)i sa
---PAGE BREAK---
31. (More) algebraic techniques in graph theory 449
symmetric (0 ,1)-matrix, then the diagonal a=(a11,a22,...,ann),
considered as a column-vector, is in the span of the columns of S
over the ﬁeld F2.
Problem 31H. LetGbe a connected regular graph with exactly
three distinct eigenvalues. Show that Gis strongly regular.
Problem 31I. LetGbe a nontrivial strongly regular graph and
forx∈V(G), let ∆(x) denote the subgraph induced by the vertices
nonadjacent to x. Prove that ∆( x) is connected by (1) explaining
whyk−µwould be an eigenvalue of Gif ∆(x) were not connected,
and (2) showing by calculation that k−µis not an eigenvalue of G.
Problem 31J. Suppose the Petersen graph Pis the union of span-
ning subgraphs H,K, that are regular of degrees 1 and 2, respec-
tively. Let Abe the adjacency matrix of PandB,Cthe adjacency
matrices of HandK, so thatA=B+C.
Show that there exists a vector uthat is an eigenvector of Acorre-
sponding to eigenvalue 1 and also an eigenvector of Bcorresponding
to eigenvalue −1 (and hence an eigenvector of Ccorresponding to
eigenvalue 2). Next, explain why Kcannot be a connected graph.
(This shows that Pis not Hamiltonian.)
Problem 31K. LetGbe a directed graph on nvertices without
multiple edges. We allow edges a→bandb→ato occur simul-
taneously in which case we call {a,b} an undirected edge. Suppose
that for any two vertices a,bthere is exactly one walk of length 3
fromatobifaLnegationslash=band no such walk if a=b.I fAis the adjacency
matrix of G, then this property is expressed by the equation
(31.6) A3=J−I.
(i) Prove that Gis regular;
(ii) Ifcis the valency of G, show that n=c3+1 ;
(iii) Prove that Ghas exactly1
2(c2+c) undirected edges;
(iv) Construct an example of such a graph if n=9 .
Notes.
Theorem 31.3 was never published by Hoﬀman, one of the ﬁrst
‘algebraic graph theorists’, but caught the fancy of many of those
who heard of it, and has become a classic.
---PAGE BREAK---
450 A Course in Combinatorics
Problem 31D is a result of H. Wilf. Problem 31A is an unpub-
lished result of A. J. Schwenk.
References.
N. Biggs (1974), Algebraic Graph Theory , Cambridge University
Press.
D. M. Cvetkovi´ c, M. Doob, and H. Sachs (1979), Spectra of Graphs,
a Monograph, V. E. B. Deutscher Verlag der Wissenschaften.
B. Elspas and J. Turner (1970), Graphs with circulant adjacency
matrices, J. Combinatorial Theory 9, 297–307.
F. R. Gantmacher (1959), The Theory of Matrices , Chelsea.
W. Haemers (1979), Eigenvalue Techniques in Design and Graph
Theory , Mathematisch Centrum, Amsterdam.
L. Lov´ asz (1979), On the Shannon capacity of a graph, IEEE Trans.
Information Theory 25, 1–7.
M. Muzychuk (1997), On Adam’s conjecture for circulant graphs,
Discrete Math. 176, 285–298.
---PAGE BREAK---
32
Graph connectivity
Fork≥2, a graph Gis said to be k-vertexconnected, or simply k-
connected, when |V(G)|≥k +1 and the removal of any k−1 vertices
(and any incident edges) from Gdoes not result in a disconnected
graph. We use 1-connected as a synonym for connected.
If a graph Gwith at least k+ 1 vertices is not k-connected and
the deletion of a set Sofk−1 vertices disconnects it, there is
a partition of V(G)\Sinto nonempty sets X,Y with no edges
crossing (one end in X, one inY). LetHandKbe the subgraphs
induced by X∪SandY∪S, except that edges with both ends in
Sare to be put in one and only one of HorK. Then we obtain
edge-disjoint subgraphs HandKwhose union is Gand such that
|V(H)∩V(K)|=k−1. Conversely, if such subgraphs HandKexist
and each contains at least one more vertex than their intersection,
thenGis notk-connected.
A graph is said to be nonseparable when it is 2-connected and has
no loops, or when it is a bond-graph (with two vertices and any pos-itive number of edges joining them, including the link-graph withone such edge), a loop-graph (one edge joining a single vertex toitself), or a vertex-graph. All polygons, for example, are nonsepa-rable; path-graphs or other trees with at least two edges are not.
(We do not want loops, if there are other edges, because while
the deletion of the incident vertex may not disconnect the graph ina combinatorial sense, it does in a topological sense. With anothertype of 2-connectivity, that of Tutte, we would not need to prohibitloops, or allow the small graphs, explicitly; see Problem 32D.)
Here is a small observation about the ‘structure’ of nonseparable
graphs.
---PAGE BREAK---
452 A Course in Combinatorics
Lemma 32.1. LetGbe a ﬁnite nonseparable graph with at least
two edges and Ha maximal proper nonseparable subgraph of G.
ThenGis the union of Hand a path-graph Pthat joins distinct
vertices of Hand has none of its internal vertices in H.
The path in the statement of the lemma may be called a ‘handle’.
Figure 32.1 is suggestive.
HP
Figure 32.1
Proof: It may be that V(H)=V (G). In this case, let ebe an
edge inGbut notHand letPbe the link-graph consisting of e
and its ends. Since adding etoHproduces a nonseparable graph
andHis maximal among the proper nonseparable subgraphs, the
union ofHandPisG.
IfV(H)Lnegationslash=V(G), the connectivity of Gimplies that there exists
an edgeewith one end x∈V(H) and the other y/∈V(H). By the
connectivity of G−x, there exists a simple path that does not pass
throughx, joiningyto some other vertex wofH.I fzis the ﬁrst
vertex ofHon this path (as we proceed from ytow), the edge e
and the initial part of this path provide a path-graph Pjoiningx
tozthat has no edge terms in Hand no vertex terms in Hother
than its ends. Then H∪Pis a nonseparable graph larger than H,
and so is equal to G. /square
As a consequence of the lemma, given a ﬁnite nonseparable graph
Gwith at least two edges, there is a sequence of nonseparable
subgraphs
H0⊆H1⊆H2⊆···⊆Hk=G
whereH0is a link-graph and where each Hi+1is the union of Hi
and a handle.
Asubdivision of a graph Gis, informally, a graph Hobtained
by inserting extra vertices into some edges. More precisely, we
---PAGE BREAK---
32. Graph connectivity 453
can replace the edges of Gby (ﬁnite) path-graphs whose internal
vertices are ‘new’, i.e. not vertices of the original G; and we allow
the replacing of loops by polygons. Two graphs are said to be
homeomorphic if they are isomorphic to subdivisions of the same
graph. Subdivision of a nonseparable graph (other than the link-graph) preserves nonseparability.
Problem 32A. Let us deﬁne the rankof a connected graph Gas
|E(G)|−|V(G)|+ 1. (In Chapter 34, we will see that this is the
dimension of what is called there the cycle space of G.) When we
add a handle to a nonseparable graph, the rank goes up by one.
Connected graphs of rank 0 are trees. The nonseparable graphsof rank 1 are the polygons. The nonseparable graphs of rank 2are theθ-graphs, homeomorphic to the letter θ, i.e. subdivisions of
the bond-graph with three edges, since that is all that can arise byadding a handle to a polygon. Describe all nonseparable graphs ofrank 3 as subdivisions of four graphs.
It is clear that if Gis not nonseparable and H,K are edge-disjoint
subgraphs with at most one vertex in common, whose union is G,
then an edge of Hand an edge of Kcannot be contained together
in any polygon of G.
Theorem 32.2. Any two edges in a nonseparable graph Gare
contained in the edge set of a polygon subgraph.
Proof: We assert that given distinct vertices x,yand an edge e
of a nonseparable graph G, there exists a path from xtoywhich
traversese.S oi fx,yare the ends of another edge e
Lprime, we obtain a
polygon containing eandeLprime. We prove the assertion by induction
on the total number of edges (or the rank).
The link-graph with edge eis a nonseparable subgraph. Let Hbe
a maximal proper nonseparable subgraph containing e. If both x
andyare inH, we are done by the induction hypothesis. Otherwise
Gis the union of Hand a path-graph Pjoining vertices aandbof
H, say, and at least one of xoryis aninternal vertex ofP. If both
xandyare vertices of P, a path from atobinHthat traverses
etogether with segments of Pprovides the required path. Finally,
assumexis internal to Pandy∈V(H). SayyLnegationslash=a. Then a path
---PAGE BREAK---
454 A Course in Combinatorics
inHfromytoathat traverses etogether with the segment of P
fromxtoaprovides the required path. /square
Corollary. Any two vertices of a nonseparable graph G(other
than the link-graph )are contained in some polygon in G.
Proof: Choose an edge on each vertex and apply the theorem,
if the edges are distinct. If the edges are the same, there is a
polygon containing that edge, as long as the graph has a secondedge somewhere. /square
The corollary is actually equivalent to Theorem 32.2, since the
theorem can be derived by inserting new vertices into the middleof the given edges, and applying the corollary to the new vertices.
The corollary is the special case k= 2 of the following theorem
of H. Whitney (1932).
Theorem 32.3. AgraphGwithatleast k+1verticesis k-vertex
connected if and only if, for any two distinct vertices xandyof
G, thereexist kinternallydisjointpathsjoining xandy, i.e.paths
which share no vertices other than their ends xandy.
This will be an immediate consequence of Menger’s Theorem
below. We give the latter in the version for directed graphs. As
usual, an undirected graph may be considered as a digraph whenwe replace each undirected edge by a pair of directed edges, one ineach direction.
We will apply Theorem 7.2 on integral ﬂows, and require the
following observation. (This is almost identical to Problem 7B.)
Problem 32B. Letfbe a nonnegative ﬂow from stotin a di-
graphD(capacities are not required).
(i) Show that if fhas positive strength, then there exists a di-
rected path from stotall of whose edge terms ehavef(e)>0.
(ii) Conclude that if fis integral and has strength k, then there
existkdirected paths p
1,p2,...,pkfromstotinDsuch that for all
edgese∈E(D), the number of paths pithat traverse eis≤f(e).
Problem 32C. Letsandtbe distinct vertices in a digraph D.
Show that the maximum number of edge-disjoint directed paths
fromstotis equal to the minimum number of edges in a set E
---PAGE BREAK---
32. Graph connectivity 455
whose deletion disconnects sandtin that direction, i.e. such that
every directed path from stotcontains at least one edge from E.
Lets,tbe two distinct vertices in a digraph D.A n (s,t)-sep-
arating set is a subset S⊆V(D)\{s,t}so that any directed path
fromstotcontains at least one vertex of S.
Theorem 32.4 (Menger’s Theorem). Lets,tbe two distinct
vertices in a digraph Dand assume there is no edge directed from
stot.I fn o (s,t)-separating set has size less than k, then there
existkinternally disjoint directed paths from stotinD.
Proof: We construct a transportation network Nwhose vertices
ares,t, and a pair of new vertices x1,x2for each vertex xofD
other than s,t.F or each edge of Ddirected from sto a vertex xof
D, there is an edge of Ndirected from stox1of inﬁnite capacity
(or any integer capacity ≥k). For each edge of Ddirected from a
vertexxofDtot, there is an edge of Ndirected from x2totof
inﬁnite capacity. For each edge eofDdirected from xtoy, where
x,yare vertices of Dother than s,t, there is an edge directed from
x2toy1of inﬁnite capacity. Finally, for each vertex xofDother
thans,t, there is an edge directed from x1tox2of capacity 1.
Note that, by construction, a directed path from stotinNmust
have vertex terms of the form
s,a1,a2,b1,b2,...,z 1,z2,t
wheres,a,b,...,z,t are the vertex terms of some directed path
fromstotinD.
Suppose we have an integral ﬂow ffromstotinNof strength k.
The values of fcan only be 0 and 1, because every edge of Neither
enters a vertex x1for which the only edge leaving has capacity 1,
leaves a vertex x2for which the only edge entering has capacity 1,
or is an edge x1→x2of capacity 1. By Problem 32B, there exists a
set ofkdirected paths from stotinNthat pass through any edge
eat most once. These paths are edge-disjoint and hence internally
disjoint, because two directed paths sharing a vertex x1orx2must
share that single edge x1→x2. So the corresponding kpaths inD
are internally disjoint.
---PAGE BREAK---
456 A Course in Combinatorics
To ensure that such a ﬂow fexists, we consider a cut ( S,T)i n
Nseparating sandtand suppose, for contradiction, that the cut
has capacity <k. The only edges of Nwith capacity possibly less
thankare those directed from x1tox2for somex∈V(D). If we
letVbe the set of vertices xofDsuch that x1∈Sandx2∈T,
then the capacity of the cut is |V|. Every directed path from stot
inNmust pass through one of these edges x1→x2. Equivalently,
every directed path in Dmust pass through a vertex xofV,s oV
is an (s,t)-separating set. If the hypothesis of the theorem holds,
we have a contradiction. /square
***
Aconvexpolytope PinRnis the convex hull of ﬁnitely many
points, i.e.
P={λ1x1+···+λkxk:λi≥0,λ 1+···+λk=1}.
The dimension of a polytope is the dimension of its aﬃne span.
Asupporting hyperplane ofPis a hyperplane
H={x:plscript(x)=c}
(whereplscriptis a nonzero linear functional Rn→Randca scalar)
withH∩PLnegationslash=∅but such that Plies entirely in one of the closed
halfspaces of H,s a y
P⊆{x:plscript(x)≥c}.
AfaceofPis the intersection of a supporting hyperplane of Pwith
P(though the empty set is often included as a face). A vertex ofP
is a 0-dimensional face; an edgeofPis a 1-dimensional face. The
graphGof a polytope P(also called the 1-skeleton ofP) hasV(G)
andE(G) equal to the vertices and edges, respectively, of Pwith
incidence determined by inclusion.
A faceFis a convex polytope in its own right; indeed, it is the
convex hull of the vertices of Pthat it contains (see Gr¨ unbaum,
1967). The graph of Fis a subgraph of the graph of P.
---PAGE BREAK---
32. Graph connectivity 457
The following result is due to M. Balinski (1961). For the proof,
we require the following fact from the theory of linear programming;
see Gr¨ unbaum (1967). If sis a vertex of a polytope PinRmandplscript
a linear functional, either plscript(s)≥plscript(x) for allx∈Por there exists
a vertextofPadjacent to ssuch that plscript(t)>plscript(s).
Theorem 32.5. Thegraph Gofann-dimensionalconvexpolytope
isn-connected.
Proof: We will use induction on n. A 0-dimensional polytope
consists of a single point. The graph of a 1-dimensional polytopeconsists of two vertices and an edge joining them.
Letx
1,x2,...,xn−1,a,b be distinct vertices in the graph Gof
a convex polytope Pof dimension n. We may assume P⊆Rn.
We want to ﬁnd a walk in Gfromatobthat avoids the vertices
x1,...,xn−1. Choose an (n −2)-dimensional aﬃne space Sthat con-
tainsx1,...,xn−1. Some hyperplane H, i.e. an (n−1)-dimensional
aﬃne subspace, on Sis such that both aandbare on the same
side ofH, i.e.H={z:plscript(z)=α}andplscript(a)≥α,plscript(b)≥α, for some
linear functional plscriptonRnand some scalar α. (We allow the case
that one or both points are in H.)
SinceP/notsubseteqlH, we can assume Pcontains points zwithplscript(z)>α
(otherwise aandbare inHand we can replace plscriptandαby their
negatives—i.e. consider the other side of H).
By the above fact from linear programming, there exist paths p
andqinGfromaandbto vertices aLprimeandbLprime, respectively, at which
plscriptattains its maximum value αLprime, and such that no vertices of pand
qother than their initial vertices lie in H. The intersection P∩HLprime,
whereHLprime:={z:plscript(z)=αLprime}, is a face of Pof dimension at most
n−1, and in particular contains a connected graph, so there is a
pathrinGfromaLprimetobLprimewith vertices in HLprime. We concatenate p,r,
and the reverse of qto ﬁnd a walk from atob. /square
Problem 32D. A graphGis said to be k-Tutte-connected when
for everyplscript<k , it is not possible to ﬁnd a pair ( H,K) of nonempty
edge-disjoint subgraphs of G, each containing at least plscriptedges, such
thatH∪K=Gand|V(H)∩V(K)|=plscript. Such a pair of sub-
graphs may be called an plscript-separation ofG. The concepts of vertex-
connectivity and Tutte-connectivity diﬀer. But it is easy to see, for
---PAGE BREAK---
458 A Course in Combinatorics
a nonnull graph, that 1-Tutte-connectivity is the same as ordinary
connectivity and that 2-Tutte-connectivity is the same as nonsepa-rability. A 2-Tutte-connected graph with at least two edges cannothave any loops, since otherwise we have two edge-disjoint subgraphs(one a loop-graph and the other with all other edges), each with atleast one edge, but with only one vertex in common. Prove that fora graphGwith|V(G)|≥k +1 ,Gisk-Tutte-connected if and only
ifGisk-vertex connected and has no polygons with fewer than k
edges.
Notes.
See the notes to Chapter 34 for some remarks on H. Whitney.
Karl Menger (1902–1985) was an Austrian mathematician who
left Austria in 1937 for the United States, where he spent the restof his life. He worked in many ﬁelds, including logic, didactics, andeconomics, but is best known for his work on dimension theory andcurve theory. After his Ph. D., he worked with L. E. J. Brouwerin Amsterdam to return to Vienna as professor in 1927. Therehe founded the Vienna Mathematical Colloquium that had suchfamous members as K. G¨ odel and A. Wald and a great number ofvisitors. Their results were published in eight volumes before theseminar was forced to stop because of its many Jewish contributors.
References.
M. Balinski (1961), On the graph structure of convex polyhedra in
n-space, Paciﬁc J. Math. 11, 431–434.
L. R. Ford, Jr. and D. R. Fulkerson (1962), Flows in Networks,
Princeton University Press.
B. Gr¨ unbaum (1967), ConvexPolytopes , J. Wiley (Interscience).
H. Whitney (1932), Nonseparable and planar graphs, Trans. Amer.
Math. Soc. 34, 339–362.
---PAGE BREAK---
33
Planarity and coloring
We start with some material on deletion and contraction. We shall
see in the next chapter that these are ‘dual’ concepts; cf. Problem34C.
LetGbe a graph and e∈E(G). We deﬁne two graphs G
Lprime
eand
GLprimeLprimeewith the same edge set E(G)\{e}. The ﬁrst GLprimeeis obtained from
Gby deleting the edge e. (It is sometimes convenient subsequently
to remove any isolated vertices that may arise, but we shall allow
them to remain.) The second GLprimeLprime
eis obtained by identifying the
endpoints of eand removing eitself. We can think of ‘reeling in’
or ‘shrinking’ an edge in a drawing of a graph as in Fig. 33.1.
Figure 33.1
Thechromatic polynomial χGof a ﬁnite graph Gwas introduced
in Chapter 25: χG(λ) is the number of proper colorings of Gwith
λcolors. For example, note that
χKn(λ)=λ(λ −1)(λ−2)···(λ−n+1 ).
ThatχGis a polynomial in λwas shown in Chapter 25—also see
the remark following (33.1).
Example 33.1. We claim that for a tree Tonnvertices,
χT(λ)=λ(λ −1)n−1.
---PAGE BREAK---
460 A Course in Combinatorics
To see this, observe that if xis a monovalent vertex of a tree T,
there areλ−1 colors available for xafter the tree on n−1 vertices,
obtained by removing x, is given any proper coloring. The claim
follows by induction on the number of vertices.
Ifeis an edge of G, not a loop, we can break the proper colorings
ofGLprime
einto two classes: those in which the endpoints of ehave
diﬀerent colors (these are proper colorings of G) and those in which
the endpoints of ehave the same color (and these are in one-to-one
correspondence with the proper colorings of GLprimeLprimee). This establishes
(33.1) χG(λ)=χ G/primee(λ)−χG/prime/primee(λ).
The equation (33.1) provides another way of seeing that χG(λ)i s
a polynomial in λ. A graph Hwith loops has no proper colorings,
i.e.χH(λ) = 0. For an edgeless graph Honnvertices,χH(λ)=λn.
These are both polynomials. Now use (33.1) and induction on the
number of edges.
The chromatic polynomial of a tree Tcould also be obtained by
induction and (33.1): TLprimeLprime
eis a tree and TLprime
ehas two components that
are trees.
Problem 33A. Letτ(G) denote the number of spanning trees in
a graphG(this is sometimes called the complexity ofG). Show
that for any nonloop e∈E(G),τ(G)=τ (GLprime
e)+τ(GLprimeLprimee).
Problem 33B. Find the chromatic polynomial of the n-gonCn.
Find the chromatic polynomial of the n-wheelWn(this is the graph
obtained from Cnby adding a new vertex and joining it to all
vertices of Cn).
It makes no sense to ask for the number of proper colorings of
a graph with −1 colors, but since χG(λ) is a polynomial, we can
evaluateχG(−1). R. P. Stanley (1973) discovered the combinatorial
interpretation of |χG(−1)| that follows. An orientation of a graph
is one of the directed graphs arising by choosing for each edge one
of its endpoints to be the head; the other is the tail. (So the number
of orientations of a graph is 2mwheremis the number of edges that
are not loops—although for topological purposes, there are reasonswhy a loop should also be considered to admit two directions.)
---PAGE BREAK---
33. Planarity and coloring 461
Theorem 33.1. The number of acyclicorientations, i.e. orien-
tations in which there are no directed circuits, of a graph Gis
(−1)|V(G)|χG(−1).
Proof: IfGhas loops, then χG(λ) = 0 and Ghas no acyclic
orientations, so the theorem holds in this case.
Consider an acyclic orientation of GLprime
ewhereeis not a loop. There
are two ways to direct eto get an orientation of G. We claim that
one or both of them are acyclic, and that the cases where both are
acyclic are in one-to-one correspondence with acyclic orientationsofG
LprimeLprime
e. This is because directing efrom one end xto the other y
produces a nonacyclic orientation if and only if there is a directed
path from ytoxinGLprime
e; there cannot be directed paths from xtoy
and also from ytoxinGLprimeesince we assumed an acyclic orientation;
and there is no directed path from ytoxinGLprimeeif and only if
identifying xandyproduces an acyclic orientation of GLprimeLprimee.
Thus
ω(G)=ω (GLprime
e)+ω(GLprimeLprimee)
whenω(H) is taken to be the number of acyclic orientations of a
graphH. But by (33.1), this same recursion is also satisﬁed when
ω(H) is taken to be ( −1)|V(H)|χH(−1). The theorem follows by
induction on the number of edges after we check that it is valid for
edgeless graphs. /square
By anembedding orproper drawing of a graph Gon a surface
S, we mean a drawing where the edges do not cross but meet only
at vertices. More precisely, we mean a representation of the graphwhere the vertices correspond to points in S, the edges correspond
to Jordan arcs (continuous one-to-one images of the unit interval)inSthat join the points of Scorresponding to the ends of the edge
inG, and where no internal point of any of the Jordan arcs is a
point of any other Jordan arc or one of the points correspondingto the vertices of G. We consider only embeddings of ﬁnite graphs.
While the plane is not compact, it can be naturally embedded inthe sphere (its one-point compactiﬁcation) and a graph is planar if
and only if it admits an embedding on the sphere .
Examples of graphs that are not planar include K
3,3andK5;w e
will mention several ways to see this later. Subdivisions of these
---PAGE BREAK---
462 A Course in Combinatorics
graphs, and any graph containing one of these subdivisions, will also
not be planar. An important theorem that we shall not prove hereis the following. Proofs may be found in Chartrand and Lesniak(1986), Tutte (1984), and Diestel (1997).
Theorem 33.2 (Kuratowski). A graphGis planar if and only
if it has no subgraphs isomorphic to subdivisions of K
5orK3,3.
Problem 33C. Find a subdivision of K3,3as a subgraph of the
Petersen graph.
Aminor of a graph Gis a graph Hobtained from Gby delet-
ing and contracting edges, and then possibily deleting some or all
isolated vertices.
It can be seen that that the order in which edges are deleted
or contracted is not important. For example, if the edges of asubsetS⊆E(G) are contracted in any order, we obtain a graph
isomorphic to the graph G
LprimeLprime
S, called a contraction ofG, deﬁned as
follows. The vertices of GLprimeLprimeSare, formally, the components of the
spanning subgraph, denoted G:S,o fGwith edge set S. The edge
set ofGLprimeLprimeSisE(G)\S. The ends of an edge e∈E(G)\Sare, in
GLprimeLprimeS, to be the components of G:Sthat contain the ends of eas an
edge ofG. Informally, the components of G:Sare being shrunk to
single vertices.
We use the notation GLprimeSfor the graph obtained by deleting the
edges inS, i.e.G:(E(G)\S), but it is convenient to require that
any isolated vertices are also deleted when using this notation.
Example 33.2. LetAbe the ﬁve ‘spokes’ in the usual drawing of
the Petersen graph P, on the left of Fig. 1.4. The subgraph P:A
has ﬁve components, so PLprimeLprime
Awill have ﬁve vertices. The contraction
GLprimeLprime
Sin this case is K5.I fBis the set of ﬁve edges in the interior
pentagram, then P:Bhas six components and PLprimeLprime
Bis the wheel W5.
IfCis the edge set of a spanning tree of P, thenPLprimeLprime
Cconsists of a
single vertex and six loops. (A graph with one vertex may be called
acotree .)
Note that it is quite likely that GLprimeLprime
Swill have loops and/or parallel
edges even if Gis simple. (Those contractions of a simple graph
Gthathave no loops are in one-to-one correspondence with the
---PAGE BREAK---
33. Planarity and coloring 463
elements of the lattices Π( G), sublattices of the partition lattices,
introduced in Example 23.6).
A graphGis a contraction of any of its subdivisions H, since
contracting any k−1 edges of a path-graph with kedges produces
a link-graph.
If we have a drawing of a graph Gon a surface Sande∈E(G), it
is clear that there is a natural drawing of GLprime
eonS.I feis a nonloop,
there is also a natural induced drawing of GLprimeLprimeeonS: the ends of the
edge can be continuously brought closer on the surface (see Fig.
33.1). (According to our combinatorial deﬁnition, contracting aloop is the same as deleting it.) In particular, if Gadmits an
embedding on a surface S, then so does every minor of G.
Problem 33D. Show that a graph Gthat has a minor isomorphic
toK
5orK3,3also contains a subdivision of K5orK3,3. Somewhat
more generally, prove:
(i) if a trivalent graph Hoccurs as a minor of a graph G, thenG
contains (as a subgraph) a subdivision of H.Soi fK3,3is a minor,
then a subdivision of K3,3is a subgraph;
(ii) ifK5is a minor of G, thenGcontains a subdivision of K5or
a subdivision of K3,3.
A deep and extremely important theorem due to N. Robertson
and P. Seymour states that in every inﬁnite set of graphs there aretwo such that one is a minor of the other. See Chapter 12 of Diestel(1997) for a discussion of part of this work. It follows that the set ofgraphs that do not embed on a given surface and are minimal withrespect to this property (every proper minor being embeddable) isﬁnite. For the plane, there are two.
Given an embedding of a graph Gon a surface S, we deﬁne
thefaces orregions with respect to the embedding to be the topo-
logically connected components that result when the vertices andedges (more precisely, the points corresponding to vertices and setsof points in the Jordan arcs corresponding to edges) are removedfromS. We denote the set of faces by F(G). We realize that this
ishorrible notation, since the faces depend on the embedding (in
particular, on the surface) and are not in general determined by G.
But we will use it anyway.
---PAGE BREAK---
464 A Course in Combinatorics
In general, these faces may or may not be 2-cells (homeomorphic
to the open unit disk, i.e. without ‘holes’). But for an embedding of
a connected graph on the sphere, the regions willbe 2-cells. This
fact is related to the Jordan curve theorem which asserts that ifthe points of a one-to-one continuous image of the unit circle in thesphere are removed, the resulting topological space has exactly twosimply connected components that are 2-cells.
Theorem 33.3 (Euler’s formula). Foradrawingofaconnected
planar graph Gon the sphere or plane,
f−e+v=2
wheref,e,andvare,respectively,thenumbersoffaces,edges,and
vertices. Moregenerally,foranygraph Gembeddedonthesphere,
(33.2) 1 −|F(G)|+|E(G)|−|V(G)|+|C(G)|=0,
whereC(G)denotes the set of components of G.
Proof: We prove the latter assertion by induction on the num-
ber of edges of G. For an edgeless graph, |C(G)|=|V(G)|and
|F(G)|= 1, so (33.2) holds.
SupposeGhas a nonloop a. Consider an embedding of Gand
note that contracting an edge will not aﬀect the number of faces.
Apply the induction hypothesis to G
LprimeLprime
ato get
1−|F(GLprimeLprime
a)|+|E(GLprimeLprimea)|−|V(GLprimeLprimea)|+|C(GLprimeLprimea)|=0.
We have |E(G)|=|E(GLprimeLprime
a)|+1 ,|V(G)|=|V(GLprimeLprimea)|+1 ,|C(G)|=
|C(GLprimeLprimea)|, and also |F(G)|=|F(GLprimeLprimea)|. So (33.2) holds for G.
SupposeGhas loops; let abe one of these, and apply the induc-
tion hypothesis to GLprimeato get
1−|F(GLprime
a)|+|E(GLprimea)|−|V(GLprimea)|+|C(GLprimea)|=0.
Of course, |E(G)|=|E(GLprime
a)|+1 ,|V(G)|=|V(GLprimea)|, and|C(G)|=
|C(GLprimea)|. On the sphere, the Jordan curve theorem implies that the
two faces incident with eare distinct, so |F(G)|=|F(GLprimea)|+ 1 and
we obtain (33.2) for G. /square
---PAGE BREAK---
33. Planarity and coloring 465
Example 33.3. We show that K5andK3,3are not planar. The
set of edges incident with a face in a planar embedding of a non-
separable graph G(other than the link-graph) contains a polygon
subgraph; see Chapter 34. The degree of a face is the number of
incident edges (i.e. its degree as a vertex of the dual graph of Chap-ter 34). The sum of the degrees of the faces is twice the number ofedges, since every edge is incident with two faces.
Consider a hypothetical embedding of K
5in the plane. By Eu-
ler’s formula, there are seven faces. But each has degree at least3, so the sum of the degrees is at least 21, which, of course, is acontradiction to |E(K
5)|= 10.
Similarly, there would be ﬁve faces in a hypothetical embedding
ofK3,3in the plane, each of degree at least 4 since K3,3has girth
4. Then the sum of the degrees would be at least 20, contradicting|E(K
3,3)|=9 .
(A similar argument shows that the Petersen graph is not planar.
But we already knew this since both K5andK3,3occur as minors
of the Petersen graph and they are not planar.)
Problem 33E. Determine all pairs (d 1,d2) of integers with di≥2,
i=1,2, so that there exists a planar graph (not necessarily simple)
that is regular of degree d1and such that all faces have degree d2.
(This will include the degrees of the vertices and faces of the ﬁve
Platonic solids.)
E. Steinitz (1922) characterized the graphs of 3-dimensional con-
vex polytopes.
Theorem 33.4. AgraphGisthegraphofa 3-dimensionalconvex
polytope if and only if Gis simple, planar, and 3-connected.
That the graph of a 3-dimensional polytope is 3-connected is a
special case of Theorem 32.5. We do not prove the rest of the
theorem.
The question “Can the countries of a map on the sphere be col-
ored with four or fewer colors so that adjacent countries are coloreddiﬀerently?”, occurs in a letter dated October 23, 1852, from Au-gustus de Morgan to Sir William Rowan Hamilton. It is likely thatthe originator of the question was the brother, Francis Guthrie, ofa student, Frederick Guthrie, of de Morgan.
---PAGE BREAK---
466 A Course in Combinatorics
Coloring the countries (regions) of a planar map is equivalent to
coloring the vertices of the dual graph that we will introduce in the
next chapter. So for us, the ‘four color problem’ is the question of
whether every planar graph is 4-colorable.
Four colors are clearly necessary since K4is planar, but it is easy
to ﬁnd many other planar graphs Gthat cannot be 3-colored. This
problem has motivated a great deal of graph theory. More on thehistory of the four color problem may be found in Biggs, Lloyd,and Wilson (1976).
In 1890, P. J. Heawood proved the Five Color Theorem, Theo-
rem 33.6 below: a loopless planar graph Ghas chromatic number
χ(G)≤5. Heawood used ideas of A. B. Kempe (in particular, the
recoloring idea reviewed below). In 1976, K. Appel and W. Hakenﬁnally settled the four color problem with an announcement of aproof of the Four Color Theorem: χ(G)≤4. Surprisingly, perhaps,
their proof did not use the vast quantity of work and theories de-veloped in this century but went back to the ideas of Kempe andHeawood. Another surprise, perhaps, is that their proof requiredover 1000 hours of computer time. It was not clear when they be-gan that the computer would ever ﬁnish. As an oversimpliﬁcation,there were many cases to consider but it was not certain that theirnumber would be ﬁnite; the computer was programmed to gener-ate cases itself and could conceivably have gone on forever breakingcases into subcases. See Appel, Haken, and Koch (1977), and Ap-pel and Haken (1977). We have no space to discuss this work inany detail, but will prove the Five Color Theorem below.
Proposition 33.5. Every nonnull simple planar graph Ghas a
vertex of degree at most 5.
Proof: This follows quickly from Euler’s formula. It suﬃces to
prove that a component has such a vertex, so assume Gis con-
nected. Suppose a drawing of Ghasfregions,eedges, and v
vertices. If no vertex of degree less than six exists, then the sum of
thevdegrees of the vertices, which is 2 e, is at least 6v ; that is,
v≤e
3.
SinceGis simple (and we may assume it is not a link-graph with
---PAGE BREAK---
33. Planarity and coloring 467
two vertices joined by a single edge), each region is incident with
at least three edges, so the sum of the fdegrees of vertices of G∗,
which is 2e,i sa tl e a s t3 v; that is
f≤2e
3.
But then we have the contradiction
2=f−e+v≤e
3−e+2e
3=0.
/square
Of course, coloring a loopless graph is equivalent to coloring a
simple graph (just suppress the multiple edges). An immediateconsequence of the above result is the Six Color Theorem: a looplessplanar graph Ghasχ(G)≤6. When a vertex xof degree at most
ﬁve is deleted from a simple planar graph and the result coloredwith six colors inductively, there is always a color available for x.
We recall the idea of recoloring introduced in Chapter 3. Suppose
Gis properly colored and let αandβbe two of the colors. The
colorsαandβcan be switched on any component of the subgraph
ofGinduced by the vertices of colors αandβto obtain another
proper coloring. So given two vertices xandyof colorsαand
β, respectively, either there is a path (of odd length) with vertex
termsa
0=x,a1,...,an=ythat alternate colors αandβ(a so-
calledKempe chain), or there is a proper coloring in which both x
andyhave color α, say, while vertices of colors other than αand
βretain the same color.
Theorem 33.6. IfGis a loopless planar graph, then χ(G)≤5.
Proof: We use induction on the number of vertices. The assertion
is surely true for graphs with at most ﬁve vertices. Consider aplanar drawing of a loopless graph Gand assume the theorem holds
for all graphs with one vertex less. We can assume Gis simple.
By Proposition 33.5, there exists a vertex x∈V(G) of degree
≤5. LetG
xdenote the graph obtained from Gby deleting the
vertexxand the incident edges. We have a natural planar drawing
ofGxobtained from the drawing of G. By the induction hypothesis,
---PAGE BREAK---
468 A Course in Combinatorics
Gxhas a proper coloring with ﬁve colors. There is a color available
forx, and we are done, unless xhas degree exactly ﬁve and the
verticesy1,y2,...,y 5(which we write in the cyclic order given by
the drawing) adjacent to xinGhave received ﬁve distinct colors
in the coloring of Gx. So we assume that yihas received color i,
i=1,2,3,4,5. See Fig. 33.2.
Consider colors 1 and 3. Either there exists a proper coloring of
Gxin whichy1andy3both have color 1 (while y2,y4, andy5retain
their original colors) or there exists a simple path with vertex terms
(33.3) y1,a1,b1,a2,b2,...,as,bs,y3,
say, inGxwith vertices alternately colored 1 and 3. In the ﬁrst
case,xmay be assigned color 3 and we are done. Similarly, either
there exists a proper coloring of Gxin whichy2andy4both have
color 2 (while y1,y3, andy5retain their original colors) or there
exists a simple path with vertex terms(33.4) y
2,c1,d1,c2,d2,...,ct,dt,y4,
say, inGxwith vertices alternately colored 2 and 4. In the ﬁrst
case,xmay be assigned color 4 and we are done.
To complete the proof, we note that both paths above cannot
exist. If the path in (33.3) exists, then(33.5) x,y
1,a1,b1,a2,b2,...,as,bs,y3,x
is the vertex sequence of a simple closed path, which divides the
plane into two regions. The vertex y2is in one region while y4is
in the other. Any path from y2toy4inGxmust necessarily have
a vertex in common with the path in (33.4) and in particular musthave a vertex of color 1 or 3; thus a path as in (33.5) cannot exist.
/square
---PAGE BREAK---
33. Planarity and coloring 469
Figure 33.2
In Chapter 17, we treated list-colorings of graphs to explain
Galvin’s proof of the Dinitz conjecture. We shall now treat a result
of C. Thomassen (1994) that provides a second proof of the ﬁvecolor theorem by ﬁrst giving each vertex of the graph a list of ﬁvediﬀerent colors, not necessarily the same list for each vertex. Oneof the ideas of the proof should be especially noted because it oftencan be used to make proofs easier. It involves making an inductionhypothesis more stringent with the eﬀect that the induction stepgoes more easily.
Theorem 33.7. LetGbe a planar graph with Nverticesv
1,
v2,...,vN.F o ri=1,...,NletSibe a set of ﬁve elements (which
we call colors ). There exists a mapping fon the vertices, with
f(vi)∈Sisuchthatf(vi)Lnegationslash=f(vj)foralladjacentpairs vi,vj(aﬁve
list-coloring of G).
Proof: We ﬁrst make the problem harder by adding extra edges
which change Ginto a triangulated polygon. Let the numbering be
such that v1,v2,...vkare the succesive vertices of the polygon (see
Fig. 33.3). For each of these vertices remove two colors from its list
so that vertices on the perimeter of the polygon only have lists of
three available colors. Again, the problem is more diﬃcult. Finally,restrict matters even further by selecting two adjacent vertices onthe perimeter and assigning to each a color from their list. We claimthat with these initial conditions, the coloring can be completed.The proof is by induction on the number of vertices (small casesare trivial).
---PAGE BREAK---
470 A Course in Combinatorics
v
v
vk
vk–uu
um
Figure 33.3
For the induction, we distinguish two cases. In the ﬁrst, we
assume that the polygon has an edge connecting two vertices on
the perimeter that are not adjacent on the perimeter, i.e. a chord.The chord divides the polygon into two parts, one of which hasboth of the precolored vertices (one possibly as an endpoint ofthe chord). The coloring of that part can be completed by theinduction hypothesis. From this coloring, the other part inherits a(pre)coloring of two adjacent vertices on the perimeter and againinduction ﬁnishes the job.
Now assume that there is no chord. Let v
1andv2be the pre-
colored vertices on the perimeter and let v1,u1,u2,...,um,vk−1,i n
that order (clockwise, see Fig. 33.3) be the vertices adjacent to vk.
The vertices uiare interior points and because of the triangulation,
there are edges ( v1,u1),(u1,u2),...(u m−1,um),(um,vk−1). The list
ofvkhas at least two colors not equal to the color of v1. We pick
(these) two and remove them from the lists of u1toumand, if nec-
essary, further shorten these lists to size 3. By induction, we cancomplete the coloring of G\{v
k}. Possibly vk−1has obtained one
of the two colors on vk’s list but there is one left to complete the
coloring of G. /square
Notes.
A. B. Kempe (1849–1922) took a degree in 1872 with special dis-
tinction in mathematics at Trinity College, Cambridge where healso gained a musical reputation with his ﬁne countertenor voice.
---PAGE BREAK---
33. Planarity and coloring 471
He chose law as his profession while not relinquishing his mathe-
matical studies.
The Polish mathematician Kazimierz (or Casimir) Kuratowski
(1896–1980) taught at Warsaw University (for nearly 40 years) andLwow Polytech before retiring in 1966. His celebrated theoremcharacterizing planar graphs was proved in 1930.
Ernst Steinitz (1871–1928) was professor of mathematics at Bres-
lau (now Wroclaw) and Kiel. He made important contributions toﬁeld theory (with Hilbert).
In 1993, M. Voigt found an example of a planar graph with 238
vertices that is notfour list-colorable.
References.K. Appel and W. Haken (1977), The solution of the four-color map
problem, Scientiﬁc American 237, 108–121.
K. Appel, W. Haken, and J. Koch (1977), Every planar map is four
colorable, Illinois J. Math. 21, 429–567.
N. L. Biggs, E. K. Lloyd, and R. J. Wilson (1976), Graph Theory
1736–1936 , Oxford University Press.
G. Chartrand and L. Lesniak (1986), Graphs and Digraphs, 2nd
edn., Wadsworth.
R. Diestel (1997), Graph Theory , Springer-Verlag Graduate Texts
in Mathematics 173.
R. P. Stanley (1973), Acyclic orientations of graphs , Discrete Math.
5, 171–178.
E. Steinitz (1922), Polyeder und Raumeinteilungen, Enzykl. Math.
Wiss.3, 1–139.
C. Thomassen (1994), Every planar graph is 5-choosable, J. Com-
bin. Theory Ser. B 62, 180–181.
W. T. Tutte (1984), Graph Theory , Encylopedia of Math. and its
Appl.21, Addison-Wesley. Reissued by Cambridge University
Press.
---PAGE BREAK---
34
Whitney duality
A Jordan arc divides a small neighborhood of one of its internal
points into two ‘halves’. Thus in addition to being incident withtwo vertices (which may coincide), an edge in a map is incidentwith two regions (which may coincide). See Fig. 34.1.
Figure 34.1
This allows us to deﬁne the dualgraphG∗of a graph Gwith
respect to a 2-cell embedding of Gon a surface S. The vertices
V(G∗) are to be the regions with respect to the embedding; the
edgesE(G∗) are to be the same as the edges of G; the ends of an
edgeeinG∗are to be the regions with which eis incident. Two
examples are shown in Fig. 34.2.
We have deﬁned G∗abstractly, but it is important to note that
it admits an embedding on the same surface S: we can represent a
region by a point in its interior; the interior points in two regionssharing an edge ecan be joined by a Jordan arc crossing only the
Jordan arc representing einG. The drawing of the dual of the
cube in Fig. 34.2 is shown in Fig. 34.3.
Examples will convince the reader that ( G
∗)∗is isomorphic to G.
Two other facts that we invite the reader to think about but do
---PAGE BREAK---
34. Whitney duality 473
not attempt to prove formally are: a graph that is not connected
cannot have a 2-cell embedding; the dual graph with respect to a2-cell embedding is always connected.
Figure 34.2
The planar duals of the series of polygons are the bond-graphs,
i.e. the graphs with two vertices and any positive number of edgesjoining them. In particular, the loop-graph and the link-graph aredual. The planar dual of a tree is a cotree, and a planar dual of acotree is a tree.
---PAGE BREAK---
474 A Course in Combinatorics
Figure 34.3
In general, a graph may have several planar dual graphs. Fig.
34.4 shows two isomorphic cotrees and their nonisomorphic planar
duals with respect to the two embeddings. Fig. 34.5 shows twoembeddings of a nonseparable graph Gand the dual graphs with
respect to each embedding, which are not isomorphic.
Figure 34.4
Figure 34.5
The goal of this chapter is to understand the relation between
a planar graph and its dual graph(s) ‘combinatorially’. We willuse this understanding (Whitney duality) to prove some theorems
---PAGE BREAK---
34. Whitney duality 475
about planar graphs and their duals (without any reference to pla-
nar drawings or topology).
Recall that the incidence matrix N=N(G) of a graph Gis
the matrix whose rows are indexed by V(G), whose columns are
indexed by E(G), and where
N(x,e)=

1i fxis incident with a nonloop e,
2i feis a loop incident with x
0i fxis not incident with e.
We are going to work over the ﬁeld F2of two elements, so loops
essentially correspond to columns of all zeros. Every other column
contains two ones and, in particular, the sum modulo 2 of all rowsofNis the zero vector.
We may consider the codeC(G) of a graph G, which is the binary
code generated by the incidence matrix N(G). A graph His a
Whitney dual of a graph GwhenE(G)=E (H) and the code C(G)
ofGis equal to the dual code C(H)
⊥ofH. Clearly,His a Whitney
dual ofGif and only if Gis a Whitney dual of H. This deﬁnition
requires that GandHhave the same edge set, which is convenient
notationally. But, informally, it is only necessary that the edges ofGandHbe labeled by the same set, or otherwise put in one-to-one
correspondence.
Note that the code of a polygon with nedges consists of all even-
weight words of length n; the code of a bond-graph with nedges
consists of the two constant words. The code of a tree consists ofall words; the code of a cotree consists of only the zero word.
Some terms in graph theory are used in many contexts, with
varying meanings. In this chapter, we use ‘cycle’, ‘circuit’, ‘cutset’,and ‘bond’ of a graph Gto mean certain subsets, described below,
of the edge set E(G). Other uses of these terms the reader may
know must be temporarily forgotten.
As in Chapter 20, we use the term support of a codeword xto
denote the subset of the indexing set for its coordinates that arenonzero in x. For binary codes, we can identify the codewords with
their supports. The supports of words in C(G) are called cutsets of
G; supports of words in C(G)
⊥are called cycles ofG. The terms
circuits andbonds are used, respectively, for minimal nonempty
---PAGE BREAK---
476 A Course in Combinatorics
cycles and cutsets. We use cycle space andcutset space to mean
the set of all cycles and cutsets, respectively. Of course, these are
vector spaces over the ﬁeld F2, with addition of two sets equal to
their symmetric diﬀerence.
It is easy enough to understand when a subset S⊆E(G)i sa
cycle, or a cutset. The binary sum of the rows of the incidence ma-trix indexed by vertices in Xhas support equal to the set ×(X,Y )
of edges that ‘cross’ from XtoY:=V(G)\X. i.e. that have one
end inXand one end in Y. That is, Sis a cutset if and only if
S=×(X,Y ) for some X,Y. We use this notation only when X
andYpartition the vertex set; we allow XorYto be empty, in
which case Sis empty.
A vector, with support S, say, is orthogonal over F
2to a row of
Nindexed by a vertex xwhen and only when xis incident with an
even number of edges in S, loops being counted twice. So the cycles
are those subsets of E(G) so that every vertex has even degree in
G:S, the spanning subgraph of Gwith edge set S.
Example 34.1. LetGbe the graph below.
1
d
4e
c 3b2a
The incidence matrix of Gis
abcde
1234
10011
110000110100110
.
There are four cycles in G:∅,{a,b,e},{c,d,e}, and{a,b,c,d}.
The latter three are, in fact, circuits. There are eight cutsets. The
---PAGE BREAK---
34. Whitney duality 477
set{a,b,c,d}is both a cycle and a cutset; it is the support of the
sum of rows 2 and 4. But {a,b,c,d}is not a bond; it contains a
smaller cutset, e.g. the support {a,b}of row 2. The set {a,b}is a
bond. Another example of a bond is {b,d,e}; it is the support of
the sum of rows 1 and 2, or of 3 and 4.
Problem 34A. (i) LetGbe connected. Prove one of the equiva-
lent statements: the number of cutsets of Gis exactly 2|V(G)|−1; the
dimension of the cutset space of Gis|V(G)|−1.
(ii) Prove, in general, that the dimension of the cutset space of G
is|V(G)|−|C(G)|, where C(G) is the set of components of G. (As
a corollary, the dimension of the cycle space is |E(G)|−|V(G)|+
|C(G)|.)
Example 34.2. The cycle spaces of K6and of the Petersen graph
are binary codes of length 15 of dimensions 10 and 6, respectively.
(Fig. 35.1 in the next chapter shows that K6is the dual of the
Petersen graph with respect to an embedding in the real projectiveplane, but they are not Whitney duals, since the dimensions oftheir codes sum to more than the number of edges.) The minimumdistances of these codes are 3 and 5, respectively. We remark thatthe vector of all 1s can be added to a generating set for thesetwo codes and the minimum distances remain 3 and 5 while thedimension goes up by 1 in both cases.
Theorem 34.1. LetGbe a graph.
(i)A setS⊆E(G)is a circuit if and only if it is the edge set of
a polygon subgraph of G.
(ii)AssumeGis connected. A cutset ×(X,Y )is a bond of G
if and only if the subgraphs of Ginduced by XandYare both
connected.Proof: Clearly the edge set of a polygon is a minimal nonempty
cycle. A nonempty cycle is certainly not the edge set of a forest
(since every tree has monovalent vertices, say) and so contains theedge set of a polygon; so a minimal nonempty cycle is the edge setof a polygon.
LetS=×(X,Y ). If the subgraphs induced by XandYare con-
nected, then Scannot properly contain a nonempty cutset because
deleting any proper subset of the edges in Sdoes not produce a
---PAGE BREAK---
478 A Course in Combinatorics
disconnected graph. If the subgraph induced on Y, say, is not con-
nected, there is a partition of Yinto nonempty subsets Y1andY2
with no edges between them. Then SLprime:=×(X∪Y1,Y2) is contained
inS. Connectivity implies that there are edges between XandY1
andXandY2, and this means SLprimeis both nonempty and a proper
subset ofS. /square
The reader may check that a set of edges of an arbitrary graph G
is a bond of Gif and only if it is a bond in one of the components
ofG. Also note that a subset Sof edges of a graph Gis a bond
ofGif and only if the deletion of the edges in Sresults in a graph
with more components than G(e.g. a disconnected graph, if G
is connected to start with) and Sis minimal with respect to this
property.
Given a set Sof edges of a graph G,Sis a circuit if and only if
deleting the edges not in S(and any isolated vertices that result)
produces a polygon; Sis a bond if and only if contracting the edges
not inS(and deleting any isolated vertices that result) produces a
bond-graph.
Notice that the set S(x) of edges of a graph Gthat are incident
with a vertex x, not including loops, is always a cutset. These
span the cutset space—they are the supports of the rows of the
incidence matrix. In view of Theorem 34.1(ii), S(x) is a bond for
everyx∈V(G) if and only if Gis 2-connected (or is a connected
graph with two vertices).
Problem 34B. Show that the circuits of a graph span the cycle
space, and the bonds span the cutset space. To do this, just verify
that the nonzero codewords in a binary linear code C, whose sup-
ports are minimal among the supports of all nonzero codewords,generate the code. (This is true for linear codes over any ﬁeld.)HenceGandHare Whitney duals when the circuits of Gare
exactly the bonds of H, or when the bonds of Gare exactly the
circuits of H.
Example 34.3. The two graphs described by each table in Fig.
34.2 are Whitney duals. This is because each pair consists ofplanar duals (see Theorem 34.2 below). For example, {a,e,g,c}
and{a,j,b}are bonds in the cube Gand circuits in G
∗; the set
---PAGE BREAK---
34. Whitney duality 479
{a,b,c,d}is a circuit in Gand a bond in G∗.
Problem 34C. LetGandHbe Whitney duals with E(G)=
E(H)=E . Explain why GLprime
eandHLprimeLprime
eare Whitney duals for any
e∈E.
Problem 34D. LetGandHbe Whitney duals with E(G)=
E(H)=E , both of which are connected. Show that Sis the edge
set of a spanning tree in Gif and only if E\Sis the edge set of a
spanning tree in H.
Theorem 34.2. AgraphGisplanarifandonlyifithasaWhitney
dual. A dual G∗ofGwith respect to any planar drawing of Gis a
Whitney dual of G.
We prove only the second sentence (which implies the ‘only if’
part of the ﬁrst sentence) at this time, and postpone the other part
until the very end of the chapter.
Proof: LetG∗be a planar dual of Gwith respect to some planar
drawing of G.
LetSbe a circuit of G.S oSis the edge set of a polygon subgraph
PofGthat in the drawing, by the Jordan curve theorem, divides
the sphere or plane into two parts; let F1be the set of faces inside,
andF2the set of faces outside, P. This is a partition of the vertices
ofG∗. Clearly, each edge of Pis incident with one face of F1and
one ofF2. Any other edge of Glies (except possibly for its ends) in
one of the parts and so is incident only with members of F1orF2.
In summary, S=×(F 1,F2) is a cutset in G∗. The circuits generate
the cycle space of G, so we have shown that the cycle space of Gis
contained in the cutset space of G∗.
Now we note the fact that the cutset space of G∗is contained in
the cycle space of Gfor an embedding on anysurface. There is a
cyclic ordering to the edges incident with with a given vertex (loops
appear twice). Partition the vertices of G∗(the regions or faces)—
say they are colored red and blue—and consider the cutset CofG∗
consisting of edges incident with one red and one blue region. Thenumber of edges of Cincident with a vertex of Gis certainly even;
see Fig. 34.6. (This is the same as saying that if the vertices of apolygon are colored red and blue, then the number of edges withends of diﬀerent colors is even.) So Cis a cycle in G.
---PAGE BREAK---
480 A Course in Combinatorics
Hence the cycle space of Gis equal to the cutset space of G∗./square
Figure 34.6
Euler’s formula is a corollary of what we have proved so far.
Problem 34A says the dimension of the cycle space of Gis|E(G)|−
(|V(G)|−|C(G)|), while the dimension of the cutset space of G∗is
|F(G)|−1 (we have remarked that G∗is always connected). When
we equate these, we obtain (33.2).
Whitney’s Theorem allows a quick proof of the following theorem
of S. MacLane (1937).
Theorem 34.3. AgraphGisplanarifandonlyifthecyclespace
ofGhasabasis B={B1,B2,...,Bk}sothateachedgeof Goccurs
in at most two members of B.
Proof: IfGis planar, the boundaries of all but one face will pro-
vide such a basis. For if G∗is the dual of Gwith respect to some
embedding on the plane, then, since G∗is connected, the sets of
all nonloops incident with all but one of the vertices of G∗(faces
ofG) provide a basis for the cutset space of G∗(cycle space of G)
and each edge is an element of at most two of these sets.
Now assume the cycle space of Ghas a basis as in the statement
of the theorem. Let B0=B1+B2+···+Bk. Any edge of Gis in 0
or 2 of the sets Bi,0≤i≤k. Deﬁne a graph Hwhose vertices are
0,1,...,k , whose edge set is E(G) and where an edge eis incident
inHwith the two integers jandplscriptso thate∈Bjande∈Bplscriptwhen
eis in two of the sets Bi, and where ei sal o o pi n H(at any vertex
i)i fe is in none of the sets Bi. We claim His a Whitney dual of
G.
The set of nonloops of Hthat are incident in Hwith a vertex iis
Bi, of course, and this is a cutset in H. Since the Bis generate the
cycles ofG, the cycle space of Gis contained in the cutset space of
---PAGE BREAK---
34. Whitney duality 481
H. But we know that the cycle space of Ghas dimension k, while
the cutset space of Hhas dimension ≤k, sinceHhask+1 vertices.
We conclude that the cycle space of Gis equal to the cutset space
ofH, i.e. they are Whitney duals. Hence Gis planar by Theorem
34.2. /square
As promised, we now give some results about planar graphs and
their duals using Whitney duality (and not referring to the plane
or sphere at all).
Theorem 34.4. IfGandHare Whitney duals and His con-
nected, then Gis bipartite if and only if His Eulerian (admits an
Eulerian circuit ).
Proof:Gis bipartite if and only if the entire edge set E(G)i s
a cutset of G. SinceG∗is connected, it is Eulerian if and only if
E(G) is a cycle of G∗; see Theorem 1.2. The two conditions are
equivalent since G∗is a Whitney dual of G. /square
ATait coloring (after the English mathematician P. G. Tait) of a
trivalent graph is a coloring of the edges with three colors, say α,β,
andγ, so that each color appears at every vertex. Fig. 34.7 shows
such a coloring. The existence of a Tait coloring of a trivalent graph
is equivalent to partitioning the edges into three perfect matchings(cf. Chapter 5) and so a bipartite trivalent graph has a Tait coloringby Problem 5A.
Figure 34.7
Theorem 34.5. IfGandHareWhitneydualsand Gistrivalent,
thenGadmits a Tait coloring if and only if His 4-colorable.
---PAGE BREAK---
482 A Course in Combinatorics
Proof: We claim that a trivalent graph Gadmits a Tait coloring
if and only if there exist two cycles S1andS2inGso thatE(G)=
S1∪S2. Given the coloring, take S1to be the union of the edges of
colorsαandγ, andS2to be the union of the edges of colors βand
γ. These are both cycles since every vertex is incident with two
edges ofS1and two edges of S2. Conversely, if E(G) is the union
of two cycles S1andS2, color an edge ewith color


αife∈S1,e/∈S2,
βife/∈S1,e∈S2,
γife∈S1∩S2.
Every vertex xhas even degree (between 0 and 3) in the spanning
subgraphs with edge sets S1andS2; butE(G)=S1∪S2implies
that both degrees are 2 and that there is one edge of each color
incident with x.
Our second claim is that a graph Hcan be properly 4-colored if
and only if E(H) can be expressed as the union of two cutsets of H.
IfE(H) is the union of ×(X 1,X2) and×(Y 1,Y2), thenX1∩Y1,X1∩
Y2,X2∩Y1,X2∩Y2are the color classes of a proper 4-coloring. If
A,B,C,D are the color classes of a proper 4-coloring, then E(H)
is the union of ×(A∪B,C∪D) and×(A∪C,B∪D).
The two observations and the deﬁnition of Whitney duals com-
plete the proof. /square
Anisthmus of a graph is an edge whose deletion increases the
number of components (i.e. disconnects the graph if it was originallyconnected). This is the dual concept of a loop. An isthmus is anedgeeso that the singleton set {e}is a cutset; a loop is an edge e
so that the singleton set {e}is a cycle. (Some authors use acyclic
edgefor an isthmus since it is an edge contained in no circuits. The
termbridge has also been used.)
Problem 34E. Show that a trivalent graph with an isthmus does
not have a Tait coloring.
In view of the Four Color Theorem, every isthmus-free trivalent
planar graph does admit a Tait coloring. (An isthmus in Gwould
be a loop in the dual which could then not be properly colored.)
---PAGE BREAK---
34. Whitney duality 483
Planarity is necessary, since the Petersen graph is an example of
an isthmus-free trivalent graph which has no Tait coloring.
Conversely, we claim that to prove the Four Color Theorem it
would be suﬃcient to establish that every isthmus-free trivalentplanar graph does admit a Tait coloring. For suppose that the re-gions of every isthmus-free trivalent planar graph Gcan be properly
4-colored. Then, given a planar graph G, replace each vertex xof
degreeLnegationslash= 3 by the conﬁguration indicated for the case of a vertex of
degree 5 in Fig. 34.8. (This may be done even for vertices of degrees1 and 2.) This creates more regions (more vertices in the dual G
∗)
but preserves adjacency of the original regions, so if the regions ofthis larger but trivalent graph can be 4-colored, then we obtain acoloring for the original graph. By Theorem 34.5, the regions ofthe larger but trivalent graph can be 4-colored if and only if it hasa Tait coloring.
Figure 34.8
Tait conjectured in 1880 that every 3-connected planar trivalent
graph has a Hamiltonian circuit, which would have implied that thegraph admits a Tait coloring. W. T. Tutte (1956) found a coun-terexample but did prove that every 4-connected planar trivalentgraph is Hamiltonian.
Theorem 34.6. IfGandHare Whitney duals without isolated
vertices and Gis nonseparable, then His nonseparable.
Proof: Theorem 32.2 shows that any two edges of Gare contained
in a circuit of G. Hence any two edges of Hare contained in a bond
ofH. But if two edges aandbare contained in a bond ×(X,Y ), we
can ﬁnd a simple path in the subgraph induced by X, joining one
end ofaand one of b, and a simple path in the subgraph induced
---PAGE BREAK---
484 A Course in Combinatorics
byYjoining the other ends, and we ﬁnd a polygon containing a
andb. So any two edges of Hare contained in a circuit of H. This
implies that His nonseparable. /square
Corollary. The set of edges incident with a face in a planar em-
bedding of a nonseparable graph G, not a link-graph, is a circuit
inG.
Proof: The setSof edges incident with a face is the set of edges
incident with a vertex in G∗. ButG∗is nonseparable by Theorem
34.5, soSis a bond in G∗. ThenSis a circuit in G. /square
Problem 34F. Two edges aandbof a connected graph Gthat
are contained together in a circuit of Gare also contained in some
bond ofG.
Theorem 34.7. LetGandHbe simple graphs without isolated
vertices that are Whitney duals. If Gis3-connected, then His
3-connected.
Proof: AssumeGis 3-connected. For x∈V(G), letS(x) denote
the set of edges incident with x. Each set S(x) is a bond with
the property that GLprime
S(x)is nonseparable, and these bonds span the
cutset space of Gby deﬁnition.
Thus inH, there exists a family Fof circuits that spans the cycle
space ofHand where each member SofFis a circuit with the
property that HLprimeLprime
Sis nonseparable.
We knowHis nonseparable; suppose for contradiction that it is
not 3-connected. Then His the edge-disjoint union of subgraphs
AandBofH, each with at least two edges, and where A∩Bis a
graph consisting of two isolated vertices, say xandy. If a polygon
inHcontains edges of both AandB, it must have xandyamong
its vertices. If the edges of such a polygon are contracted, we would
obtain a separable graph since it would be the union of the graphsobtained from AandBby contraction of the edges of the polygon
in each (which would identify xandy); these contracted subgraphs
will have only this vertex resulting from the identiﬁcation of thevertices of the polygon in common (and the reader can check thatthere still remains at least one edge in each contracted subgraph).
---PAGE BREAK---
34. Whitney duality 485
Thus the circuits in Fare contained completely in either E(A)
orE(B). LetCbe any circuit of H. SinceFspans the cycle space
ofH,C∩E(A) andC∩E(B) are, respectively, the modulo 2 sum
of members of Fthat are contained in E(A) andE(B). Hence each
ofC∩E(A) andC∩E(B) would be cycles, and then the minimality
ofCwould imply that C∩E(A)o rC ∩E(B) is empty. It follows
thatevery circuit ofHis contained in either E(A)o rE(B), which
contradicts the nonseparability of H. /square
Problem 34G.
(i) LetGbe a simple 3-connected graph and Sa bond in G.
Show that GLprime
Sis nonseparable if and only if Sis equal to S(x), the
set of edges incident with x, for some vertex xofG.
(ii) Prove: If GandHare simple 3-connected graphs with equiv-
alent codes, then Gis isomorphic to H.
Theorem 34.8. LetGbe a simple 3-connected graph embedded
on the sphere. A circuit CofGis the set of edges incident with
some face in this embedding if and only if GLprimeLprimeCis nonseparable.
Proof: The circuit Cis the set of edges incident with a face if
and only if it is the set of edges incident with a vertex in the dual
H:=G∗. By Problem 34G(i), this is the case if and only if HLprime
Cis
nonseparable. This latter graph is a Whitney dual of GLprimeLprime
C. /square
Thus the polygons that are boundaries of faces in an embedding
of a simple 3-connected planar graph are uniquely determined . This
is not true for nonseparable graphs in general—see Fig. 34.5. If we
know the faces, i.e. the circuits that bound faces, the embedding isdetermined (this is explained somewhat in the next chapter), andwe have the following result.
Corollary. A simple 3-connected planar graph has a unique em-
bedding on the sphere.Example 34.4. IfK
5were planar, no 4-gon would be a face, since
contracting the four edges of a 4-gon produces a graph with two
vertices, four links, and two loops at one of the vertices, and thisgraph is not nonseparable. On the other hand, a triangle wouldnecessarily be a face.
---PAGE BREAK---
486 A Course in Combinatorics
We can obtain yet another proof that the simple 3-connected
graphsK5,K3,3, and the Petersen graph are not planar: contracting
the edges of any 3-gon in K5, any 4-gon in K3,3, and any 5-gon in
the Petersen graph, always yields a nonseparable graph. So if these
graphs were planar, every 3-gon, 4-gon, and 5-gon, respectively,would bound a face in the embedding in view of Theorem 34.8.But every edge belongs to three 3-gons, to four 4-gons, and to four5-gons in the respective graphs, a contradiction to planarity.
E. Steinitz (1922) characterized the graphs of 3-dimensional con-
vex polytopes.
Theorem 34.9. AgraphGisthegraphofa 3-dimensionalconvex
polytope if and only if Gis simple, planar, and 3-connected.
That the graph of a 3-dimensional polytope is 3-connected is a
special case of Theorem 32.5. We do not prove the rest of the
theorem here.
We need a lemma for the ‘if’ part of Theorem 34.2.
Lemma 34.10. LetGandHbe graphs with the same edge set
E. Suppose Gistheunionofedge-disjointsubgraphs G
1andG2so
that|V(G1)∩V(G2)|≤1.Le t H1andH2be the subgraphs of H
that have edge sets E(G1)andE(G2), respectively, with isolated
vertices deleted.
(i)IfGandHare Whitney duals, then GiandHiare Whitney
duals for both i=1andi=2.
(ii)IfGiandHiareWhitneydualsforboth i=1andi=2and
|V(H1)∩V(H2)|≤1, then GandHare Whitney duals.
Proof: From Theorem 34.1, it is easy to see that every bond of
Gis contained fully in either E(G1)o rE (G2). Moreover, a subset
S⊆E(Gi)i sab o n do f Giif and only if it is a bond of G.
SupposeGandHare Whitney duals. If Sis a bond of Gi, then
Sis a circuit of Hcontained in E(Hi) and so is a circuit of Hi.
And ifSis a circuit of Hi, then it is a circuit of H, hence a bond
ofGcontained in E(Gi) and so is a bond of Gi.
Suppose that GiandHiare Whitney duals for i=1,2 and that
|V(H1)∩V(H2)|≤1. Let Sbe a bond of G. ThenSis a bond of
---PAGE BREAK---
34. Whitney duality 487
G1orG2and hence a circuit in either H1orH2. But then certainly
Sis a circuit in H.I fSis a circuit of H, then it is a circuit in
eitherH1orH2. Hence it is a bond of G1orG2and so is a bond
ofG. /square
Proof of Theorem 34.2, continued: For the proof of the con-
verse, we ﬁrst establish the following assertion. Given a pair G,H
of Whitney duals with the same edge set Eand no isolated ver-
tices, we claim that there exists a possibly diﬀerent Whitney dual
H0which admits what we will call a system of walks for G. This is
a family{wx:x∈V(G)} of walkswxinH0, one for each vertex x
ofG, such that wxtraverses in H0exactly the edges incident with
xinG, loops being traversed twice and nonloops once. We will
use induction on the number of edges. We may assume Ghas no
isolated vertices.
First note that the assertion is easy if Gis nonseparable. Of
course, it is true for a loop-graph. Otherwise there are no loopsand for every vertex x, the setS(x) of edges incident with xinG
is a bond in Gand hence a circuit in H. We need only let w
xbe a
simple closed path in Htraversing the edges of the circuit S(x)i n
H.
IfGis not nonseparable, there exist edge-disjoint subgraphs G1
andG2, each with at least one edge, and that have no vertices or
one vertex in common, such that their union is G. WithH1and
H2as in Lemma 34.10, Hiis a Whitney dual of Gi,i=1,2. By
the induction hypothesis, there exist graphs H0
ithat are Whitney
duals ofGiand that admit systems of walks {w(i)
x:x∈V(Gi)}
forGi,i=1,2. We may take H0
1andH0
2to be vertex disjoint. If
G1andG2are disjoint, let H0be the disjoint union of H0
1andH0
2;
then the union of the two systems of walks provides a system ofwalks forG.I fG
1andG2have one vertex zin common, there are
walksw(1)
zandw(2)
zinH0
1andH0
2that traverse the edges incident
withzinG1andG2, respectively. Then let H0be obtained as the
union ofH0
1andH0
2but where we identify some vertex in the walk
w(1)
zinH0
1with some vertex in the walk w(2)
zinH0
2. We combine
these two walks into one which traverses the edges incident with z
inG; this together with the remaining walks in the systems in H1
andH2provides a system of walks for G. In either case, H0is a
---PAGE BREAK---
488 A Course in Combinatorics
Whitney dual of Gby Lemma 34.10.
Finally, we prove the following. Let Gbe a graph with a Whitney
dualHwhich admits a system of walks {wx:x∈V(G)} forG.
We assert that Ghas an embedding in the sphere so that the edges
incident with xinGoccur in the same cyclic order as they occur
in the walk wx. We proceed by induction on the number of edges.
IfGhas only loops, then His a forest. Let eb eal o o pi nG
such thateis incident with a monovalent vertex in H. Letzbe the
vertex incident with einG. The walk wzinHevidently traverses
etwice in succession, say
wz=(s0,e,s 1,e,s 2=s0,a3,s3,a4,s4,...,ak,s0),
where the sis are vertices of H. The graphs GLprime
eandHLprimeLprime
eare Whitney
duals and suppressing einwzwill provide a system of walks in HLprimeLprime
e
forGLprimee, so that by the induction hypothesis, GLprimeeadmits a planar
drawing such that the edges incident with zinGLprimeeoccur in the same
cyclic order as they occur in the walk wzwithesuppressed. In a
small neighborhood of the point representing zin the embedding,
we can insert the loop eto obtain the required embedding of G(see
Fig. 34.9).
Figure 34.9
Now letebe a nonloop in Gwith ends yandz. ThenGLprimeLprimeeand
HLprime
eare Whitney duals and we claim that there is a natural system
of walks {ux:x∈V(GLprimeLprimee)}inHLprime
eforGLprimeLprimee.F o rxLnegationslash=y,z, we take
ux:=wx. For the new vertex x0, obtained by identifying yandz,
we combine wyandwzomittingeas follows. Say
wy=(s0,e,s 1,a2,s2,...,sk−1,ak,s0)
---PAGE BREAK---
34. Whitney duality 489
and
wz=(t0,e,t 1,b2,t2,...,tm−1,bm,t0),
wheree,a2,a3,...,akande,b2,b3,...,bmare the edges incident
withyandz, respectively, in G(loops appearing twice) and the
sis andtjs are vertices of H. By reversing one of these walks if
necessary, we can assume s0=t0ands1=t1. Then take
ux0:= (s1,a2,s2,...,sk−1,ak,s0,bm,tm−1,bm−1,...,b 3,t2,b2,s1).
By the induction hypothesis, GLprimeLprime
eadmits an embedding in the plane
so that the edges incident with xinGLprimeLprimeeoccur in same cyclic order
as they occur in the walk ux. In a small neighborhood of the point
representing x0in the embedding, we can ‘uncontract’ eto obtain
the required embedding of G(see Fig. 34.10). /square
Figure 34.10
Problem 34H. In ak-Tutte-connected graph (deﬁned in Prob-
lem 32D) with at least 2k −2 edges, every circuit and every bond
contains at least kedges.
Problem 34I. Amatroid consists of a set X(which we assume
here to be ﬁnite) and a family Cof nonempty subsets called circuits
such that no circuit is a proper subset of another circuit and, if
A,B∈C,x∈A∩B,y∈A\B, then there exists C∈Cso that
C⊆A∪B,y∈C,x/∈C. This latter property is called the
‘elimination axiom’.
(i) Prove that the edge set of a ﬁnite graph together with the
family of all circuits (edge sets of polygons) is a matroid.
(ii) Prove that the family of minimal nonempty supports of code
words in a linear code over any ﬁeld provides the circuits of a ma-troid.
---PAGE BREAK---
490 A Course in Combinatorics
(iii) Let (X,F) be a combinatorial geometry as deﬁned in Chap-
ter 23, and let Cbe the family of minimal dependent subsets of X.
Show that ( X,C) is a matroid.
(To do all parts of this problem, it can save work to do part (iii)
ﬁrst and to derive the others from it.)
Notes.
Hassler Whitney (1907–1989), a pioneer in topology who was
also intensely concerned with mathematical education for the last
twenty years of his life, was a professor at Harvard and later atthe Institute for Advanced Study in Princeton. He was awardedthe Wolf Prize in 1982. Whitney had a degree in music from Yale,played the violin, viola and piano, and was concertmaster of thePrinceton Community Orchestra.
Matroids were introduced by Hassler Whitney in 1935 in order to
abstract certain properties of linear independence, of circuits andbonds in graphs, and of duality. Their theory is ‘cryptomorphic’ tothat of geometric lattices. See Welsh (1976) and Crapo and Rota(1971).
References.
H. Crapo and G.-C. Rota (1971), On the Foundations of Combina-
torial Theory: Combinatorial Geometries , M. I. T. Press.
S. MacLane (1937), A structural characterization of planar combi-
natorial graphs, Duke math. J. 3, 460–472.
P. G. Tait (1880), Remarks on the colouring of maps, Proc. Roy.
Soc. Edinburgh 10, 501–503.
W. T. Tutte (1956), A theorem on planar graphs, Trans. Amer.
Math. Soc. 82, 99–116.
W. T. Tutte (1984), Graph Theory , Encylodpedia of Math. and its
Appl.21, Addison-Wesley.
D. J. A. Welsh (1976), Matroid Theory , Academic Press.
H. Whitney (1932), Nonseparable and planar graphs, Trans. Amer.
Math. Soc. 34, 339–362.
H. Whitney (1935), On the abstract properties of linear depen-
dence,Amer. J. Math. 57, 509–533.
---PAGE BREAK---
35
Embeddings of graphs
on surfaces
We consider embeddings of graphs on surfaces other than the sphere.
The classiﬁcation of surfaces (see Fr´ echet and Fan, 1967) shows thatthere are two inﬁnite families of surfaces, up to homeomorphism.We useT
g,g≥0, to denote the orientable surface of genusg(the
g-torus ). This can be realized as a sphere with g‘handles’ or g
‘holes’;T0is the sphere. We use Nn,n≥1, to denote the nonori-
entable surface which can be constructed by inserting n‘cross-caps’
on the sphere (these cannot be embedded in R3). We state the ex-
tension of Euler’s formula. A proof may be found in Fr´ echet andFan (1967), or in Chartrand and Lesniak (1986) for the orientablecase.
Theorem 35.1. For a 2-cell embedding of a graph GonT
g,
|F(G)|−|E(G)|+|V(G)|=2−2g.
For a 2-cell embedding of a connected graph GonNn,
|F(G)|−|E(G)|+|V(G)|=2−n.
Foranyembedding,notnecessarilya2-cellembedding,theinequal-
itieswhichresultbyreplacing‘ =’by‘≥’intheequationsabovewill
hold.
Example 35.1. Fig. 35.1 shows an embedding of the Petersen
graphPon the real projective plane N1. In this diagram, diamet-
rically opposite points on the boundary are to be identiﬁed. There
are six faces, each a pentagon. More precisely, the dual graph withrespect to this embedding is the complete graph K
6.
---PAGE BREAK---
492 A Course in Combinatorics
Figure 35.1
(This establishes a curious one-to-one correspondence between
the 15 edges of Pand the 15 edges of K6. We have previously seen
that there is a one-to-one correspondence between the 10 vertices
ofPand the 10 edges of K5.)
(The real projective plane can be thought of as the surface of the
sphere where diametrically opposite points have been identiﬁed.The Petersen graph can be thought of as the graph of a regulardodecahedron where diametrically opposite points have been iden-tiﬁed.)
Example 35.2. Fig. 35.2 shows an embedding of the complete
graphK
7on the torus T1. We use the usual representation of the
torus; here the horizontal and vertical boundary lines are to be
identiﬁed. There are 14 triangular faces. The dual graph withrespect to this embedding has 14 vertices of degree 3 and sevenhexagonal faces, any two of which are adjacent. This is the Heawood
graph (deﬁned in Chapter 31), which is given as an example of a
map on the torus whose faces require seven colors.
Figure 35.2
---PAGE BREAK---
35. Embeddings of graphs 493
Theorem 35.2. Ifalooplessgraph Gadmitsanembeddingin Tg,
g>0, then
χ(G)≤7+√1+4 8g
2.
Proof: SupposeGcan be emdedded in Tg. We can assume that
Gis simple, connected and has at least three vertices. We claim
that there exists a vertex xof degree at most N−1 whereN:=
(7 +√1+4 8g)/2. Once this is established, the theorem will follow
by induction on the number of vertices; for if this vertex xis deleted
and the remaining graph properly ⌊N⌋-colored, there remains a
color free for x.
By Theorem 35.1, we have
2−2g≤f−e+v
wheref:=|F(G)|,e:=|E(G)|,v:=|V(G)|. Since every face is
incident with at least three edges, 3 f≤2e. Letdbe the average
degree of the vertices of G. We assume for contradiction that d>
N−1. This implies that v>N . Alsod>6 since N≥7 forg≥1,
and we have
2−2g≤2
3e−e+v=−1
3e+v=−1
6vd+v=1
6v(6−d),
12g−12≥v(d−6)>N(N−7 )=1 2g−12.
This provides the promised contradiction. /square
Here is a small table of bounds from Theorem 35.2:
genusg123456789101112131415
χ≤789101112121313141515161616
The assertion that Theorem 35.2 was the best possible result, i.e.
that⌊7+√1+48g
2⌋colors were required for some graph which could be
embedded in Tg, was known as the Heawood conjecture until it was
proved by Ringel and Youngs in 1968. See Ringel (1974). What
they did is to prove the following stronger result.
---PAGE BREAK---
494 A Course in Combinatorics
Theorem 35.3 (Ringel–Youngs). Giveng≥0, let
n:=⌊7+√1+4 8g
2⌋.
Then the complete graph Kncan be embedded in Tg.
We will prove here only a small part of this result (see Theorem
35.4 below). For example, Theorem 35.3 shows that χ(G)≤19 for
graphsGemdedded in T20,T21, andT22. Theorem 35.4 shows that
K19can be embedded in T20(and hence in T21andT22), verifying
the Heawood conjecture for g=2 0,21,22.
We need to understand 2-cell embeddings combinatorially, in
terms of the graph itself. Here is what is important.
Given a 2-cell embedding of a graph Gon a surface S,w em a y
traverse the boundary of any face Fand we obtain a closed walk wF
inG. The starting vertex is not important, nor is the direction. In
many cases, this may be a simple closed path in G, but, e.g., when G
is a tree embedded in the sphere, there is a single face and this walk
passes through every edge twice (see Fig. 2.4). In general, everyedge will either belong to exactly two walks in {w
F:F∈F(G)} or
occur twice in one of these walks. A system Mof closed walks in
Gwith this property that every edge of Goccurs twice among the
walks inMwill be called a mesh inG.
Example 35.3. Here are two meshes in K5. The walks are de-
scribed by their vertex sequences:
M1={(1,2,3,4,5,1),
(1,2,4,1),(2,3,5,2),(3,4,1,3),(4,5,2,4),(5,1,3,5)},
M2={(1,2,4,5,1),(1,3,2,5,3,4,2,3,5,4,1),(1,4,3,1,5,2,1)}.
The mesh M1consists of simple paths (one pentagon and ﬁve
triangles), but the second walk in M2traverses two edges twice.
Atriangular mesh is a mesh consisting of simple closed paths of
length 3. So a triangular mesh for Knis equivalent to a 2-design
S2(2,3,n) with blocks of size 3 and index 2. But these designs
rarely correspond to embeddings of Knon surfaces because there
is an important additional condition that must hold.
---PAGE BREAK---
35. Embeddings of graphs 495
Given a mesh Min a connected graph G, we may try to construct
a 2-cell embedding of Gin a surface so that these walks bound the
faces. There is really no choice—we must proceed as follows. For
each walk w∈Mof lengthplscript, we need a corresponding closed disk
Fw, for example a convex plscript-gon and its interior in the plane (even
forplscript= 1 and 2, although we cannot use straight line segments as
the edges in these cases). Label the vertices and edges of Fwwith
the vertices of the walk win the order they occur in w. (So some
vertices and perhaps edges of Fwwill receive the same label if w
is not a simple closed path.) We will ‘paste’ or ‘sew’ these diskstogether at their boundaries.
Consider the disjoint union of all disks F
w. For each vertex xof
G, identify all the points labeled with an x. For each edge eofG,
identify the interior points of the edges of the disks labeled withein a one-to-one continuous manner in the direction indicated by
their ends. (It is necessary to agree that loops have two directions.)
Figure 35.3
Figure 35.4
Figs. 35.3 and 35.4 show, respectively, polygonal regions in the
plane (disks) labeled by the vertices of the walks in the meshes of
---PAGE BREAK---
496 A Course in Combinatorics
Example 35.3. In Fig. 35.5, we have started the pasting process for
the disks in Fig. 35.3; it remains to identify diametrically oppositepoints on the boundary (and we obtain the real projective planewithK
5drawn on it).
Figure 35.5
In general, the topological space constructed by this pasting has
neighborhoods homeomorphic to the open disk (2-cell) about pointsxin the interior of the disks F
xand also for points in the interior
of an edge on the boundary of the disks (because every edge isin two of the walks of the mesh). But there may be trouble atvertices, where many of the disks F
wmeet. For example, suppose
that the walks that traverse a vertex xin a certain mesh have vertex
sequences
(...,1,x, 2,...), (...,2,x, 3,...), (...,3,x, 1,...),
(...,4,x, 5,...), (...,5,x, 6,...), and ( ...,6,x, 4,...).
The disks corresponding to the ﬁrst three walks ﬁt together to
make a neighborhood of xwhich is a 2-cell, but with the other
three, a neighborhood of xwill look like two cones touching at
their apexes. The graph Mxdeﬁned in the next paragraph would
consist of two disjoint triangles in this case.
For a vertex x∈V(G), consider the graph MxwhereV(Mx)i s
the set of edges of Gincident with xand where two members a,bof
V(Mx) are adjacent in Mxwhen they occur as consecutive edges
of some walk in M(with the vertex xbetween them). Of course,
joinaandbby two edges in Mxif they occur consecutively twice,
which probably will not often be the case. Clearly, Mxis regular
---PAGE BREAK---
35. Embeddings of graphs 497
of degree 2. The vertexcondition requires that Mxis connected
(i.e. a single polygon) for every vertex x.
The topological space constructed by this pasting from a mesh
in a connected graph is a surface if and only if the mesh satisﬁes
the vertex condition. There is a natural embedding of the graphGin this surface. The meshes in Example 35.3 satisfy the vertex
condition. See Example 35.4 and Fig. 35.6.
Figure 35.6
To discover what surface Shas been constructed from a mesh
M, we ﬁrst compute the Euler characteristic h:=|M|−|E(G)|+
|V(G)|. In view of Theorem 35.1, if his odd, we must have
S=N2−h. But ifhis even, we must decide whether the sur-
face is orientable or not (unless h= 2, when the sphere is the only
possibility): S=T1−h/2 ifSis orientable, S=N2−hotherwise. We
state without proof that Sis orientable if and only if the walks can
be directed (one of the two possible directions being chosen for eachwalk) so that every edge is traversed exactly once in each direction ,
in which case we say the mesh is orientable.
It is easy to check whether a mesh satisfying the vertex condition
is orientable. We give one walk a direction and that determines thedirections of all walks sharing an edge, which in turn determinesthe directions of further walks. The vertex condition implies thatthe direction of every walk in the mesh is determined (why?). Thenwe check each edge to see in what directions it is traversed.
Example 35.3 (continued). The mesh M
1provides an embed-
ding ofK5on the real projective plane N1. The mesh M2is
orientable—the walks may be directed as they have been written
down—and we have a 2-cell embedding of K5on the double torus
T2.
---PAGE BREAK---
498 A Course in Combinatorics
In describing walks in simple graphs in the examples that follow,
we list the vertex sequences in square brackets but suppress the
terminal vertex since it is the same as the initial one. And it isconvenient to refer to paths of length 3 ,4,... as triangles, quadri-
laterals, etc., ignoring the diﬀerence between walks in a graph andsubgraphs that are polygons.
Example 35.4. We show that K
8can be embedded on the double
torusT2. This shows that at least eight colors are required for T2
and proves the Heawood conjecture for g=2 .
There must be 18 faces (so that f−e+v=−2), and their degrees
must add to 56. We display a solution with two quadrilaterals and
16 triangles as the faces. We use ‘diﬀerence methods’ (cf. Chapter19).
As the vertices of K
8, we take Z8, the integers modulo 8. The
quadrilaterals will have vertex sequences [0, 2,4,6] and [1,3,5,7].
The triangles are to be the translates modulo 8 of the two initialtriangles [0 ,1,4] and [0,3,2]. The reader should check that every
edge appears in exactly two of these walks. Let us check the vertexcondition. Since translation modulo 8 preserves the polygons, weneed only check the vertex 0. The walks traversing 0 are [0 ,2,4,6],
[0,1,4], [7, 0,3], [4, 5,0], [0, 3,2], [5, 0,7], and [6,1,0]. They ﬁt to-
gether to form a single polygon as indicated in Fig. 35.6.
It remains to check whether the mesh is orientable. It turns out
that if the quadrilaterals are directed as [0 ,2,4,6] and [7, 5,3,1],
and every other triangle is also reversed (i.e. whenever the initialtriangles are translated by an odd element of Z
8), we obtain an
oriented mesh.
Problem 35A. Find a mesh of ﬁve 4-gons in K5, a mesh of six
5-gons inK6, and a mesh of seven 6-gons in K7, all of which satisfy
the vertex condition. What surfaces have you constructed?Problem 35B. Find a mesh of 16 pentagons in the Clebsch graph
(see Example 21.4). Check the vertex condition and also check for
orientability. What surface, if any, has been constructed? Whatis the dual graph with respect to this embedding? (Cf. Problem35G.)
Problem 35C. (i) Show that if a simple graph Gis embedded in
---PAGE BREAK---
35. Embeddings of graphs 499
the nonorientable surface Ng,g≥1, then
χ(G)≤7+√1+2 4g
2.
(ii) Show that if a simple graph is embedded in the Klein bottle
N2, then either it has a vertex of degree ≤5 or it is regular of
degree 6. Show that there is a unique mesh of 14 triangles in K7
that satisﬁes the vertex condition and that it is orientable, and so
K7does not embed in the Klein bottle. Conclude that χ(G)≤6
for graphs Gembedded in N2.
(ThusK7does not embed in the Klein bottle after all. We con-
clude that χ(G)≤6 for graphs embedded in N2.)
Problem 35D. Before we continue with surfaces other than the
sphere, we remark that our understanding of meshes allows a quickproof of the fact that if GandHarenonseparable Whitney duals,
then there exists an embedding of Gin the sphere with respect to
which the dual G
∗is isomorphic to H. As in the proof of Theorem
34.2, the set of edges incident with a vertex of His a circuit in
G. The system of walks we get in Gis a mesh M. Show that M
satisﬁes the vertex condition. Explain why the surface constructedis the sphere and why the dual G
∗is isomorphic to H.
Problem 35E. Consider a connected graph Gand a mesh M
inGsatisfying the vertex condition (i.e. a map). To keep things
simple, assume that Gis simple and that the walks in Mare simple
closed paths—which we identify with polygons and call faces.A n
automorphism of this map is a permutation of V(G) which takes
edges to edges and faces to faces (i.e. an automorphism of Gthat
preserves M). Show that if an automorphism αﬁxes a vertex x,
an edgeeincident with x, and a face Fincident with e, then it is
the identity.
(It follows, for example, that a simple map as above with graph
Ghas at most 4 |E(G)|automorphisms. Examples where equality
occurs include the Platonic solids and the maps in Examples 35.1and 35.2.)
Theorem 35.8. Ifn≡7 (mod 12), then the complete graph K
n
---PAGE BREAK---
500 A Course in Combinatorics
admits a triangular embedding on an orientable surface of genus
g:= (n−3)(n−4)/12.
Proof: We construct an orientable triangular mesh in Knsatisfy-
ing the vertex condition. Write n=1 2s+ 7. As the vertices of Kn,
we use Zn.
The construction is encoded in the diagrams of Fig. 35.7. The
diagrams are for the cases n=7 ,n=1 9 ,n= 31, and n=1 2s+7
in general. (In the general case, the vertical edges are directed
alternately and are labeled 1 ,2,..., 2s, consecutively.) We could
describe this construction simply as an application of diﬀerencemethods and not give any ﬁgures, but that would be a shame sincethe diagrams were conceptually very helpful in ﬁnding this andother embeddings.
Note that the edges are labeled with the integers from 1 to 6s+3.
The ‘conservation’ law, or ‘Kirchhoﬀ’s current law’, holds: at everyvertex, the sum of values on the incoming edges is equal to the sumof the values on the outgoing edges. (Except that we have no sourceor sink, this is a ﬂow of strength zero as deﬁned in Chapter 7.)
Actually, it will be useful to think that the reverses of the indi-
cated directed edges are also present; the reverse of the edge shownin Fig. 35.7 will carry a label equal to the negative of the shownedge. Then all nonzero values modulo n=1 2s+ 7 appear on the
directed edges, each exactly once. The vertices are of two types:solid (representing ‘clockwise’) and hollow (representing ‘counter-clockwise’).
Every vertex in the diagrams of Fig. 35.7 will provide a family of
ndirected triangles in K
nwhich are translates of one another mod-
ulon. For each solid vertex that is the tail of directed edges with
valuesa,b,cin clockwise order ,w et a k et h e ndirected triangles
[x,x+a,x+a+b],x∈Zn.
Remember that a+b+c=0i n Zn, so we get the same triangles
(but with diﬀerent initial vertices) if we take [ y,y+b,y+b+c],
y∈Znor [z,z +c,z+c+a],z∈Zn. For each hollow vertex that
---PAGE BREAK---
35. Embeddings of graphs 501
is the tail of directed edges with values a,b,cin counter-clockwise
order, we take the ndirected triangles
[x,x+a,x+a+b],x∈Zn.
For example, in the third diagram in Fig. 35.7 (when n= 31),
there is a hollow vertex with incoming edges labeled 7 and 2 and an
outgoing edge labeled 9. We regard this as outgoing edges labeled−7,−2, and 9 (counter-clockwise), and take the 31 directed trian-
gles obtained as the translates of [0 ,−7,−9] modulo 31 (or trans-
lates of [0, 9,2] or [0,−2,7]). Another vertex in that diagram yields
the 31 directed triangles obtained as the translates of [0 ,14,13]
modulo 31.
It is not hard to see that the collection of directed triangles ob-
tained from the diagrams form an oriented triangular mesh. Forexample, when n= 31, to ﬁnd a triangle traversing the edge joining
4t o23 in that direction, notice that 23 −4=−12 in Z
n. The edge
labeled−12 leaves a solid vertex with other outgoing edges labeled
15 and−3, and the triangle [4 ,4+(−12), 4+(−12)+15] = [4 ,23,7]
is found. The triangle traversing the edge joining 23 to 4 in thatorder is found to be [23 ,4,6].
Figure 35.7
---PAGE BREAK---
502 A Course in Combinatorics
It will suﬃce to check the vertex condition only at 0. Let ei
denote the edge {0,i}ofKn. Consider the triangle of the mesh
that traverses 0 and enters 0 on edge ea. In the diagram, the edge
labeledawill enter a vertex that is the tail of edges with labels
−a,p,q, say, in clockwise or counter-clockwise order, depending
on whether the vertex is solid or hollow. That is, the triangle is
[a,0,p] and leaves 0 on the edge ep. To summarize, if a triangle
enters 0 on an edge eiofKn, the value jsuch that the triangle
leaves 0 on ejis found from the diagram as follows: ﬁnd the edge
labelediin the diagram—turn clockwise or counter-clockwise, as
appropriate, at the head of that edge and leave on the next edge—the label on that edge of the diagram will be j.
For example, when n= 31, we ﬁnd the sequence of edges e
i/lscriptof
Knso that the triangle which enters 0 on ei/lscriptwill leave on ei/lscript+1to
be
e1,e−13,e−8,e−9,e−7,e−10,e−6,e5,
e13,e14,e12,e15,e11,e6,e−4,e−15,e−3,e7,e−2,e−14,
e−1,e8,e−5,e−11,e4,e10,e3,e−12,e2,e9,e1,....
Consecutive pairs above will be adjacent in M0, which is seen to
be a single polygon. The reader should check that all diagramsin Fig. 35.7 will similarly yield under this procedure a sequencetraversing each edge of the diagram once in each direction. This isquite amazing. /square
Problem 35F. (i) If the complete graph K
nadmits an embed-
ding on the orientable surface Tgso that all faces are bounded by
triangles, then g=(n−3)(n−4)/12.
(ii) If the complete bipartite graph Kn,nadmits an embedding on
the orientable surface Tgso that all faces are bounded by quadri-
laterals, what is gin terms of n? What is the least value of n>2
for which such an embedding exists?
In order to present the proof of Theorem 35.8 as quickly and
as simply as possible, we have taken the construction out of itsoriginal context. We close this chapter with a brief discussion ofsome of the ideas that allowed Ringel and Youngs to come up withconstructions for all values of n.
---PAGE BREAK---
35. Embeddings of graphs 503
A technique for embedding graphs on orientable surfaces was de-
scribed by J. Edmonds (1960). It may be thought of as arising
from the mesh in the dual graph with respect to the embedding.If we have a connected simple graph Gembedded in an orientable
surfaceS, then the choice of an orientation on Swill induce at
every vertex a cyclic permutation of the edges incident with thatvertex. Edmonds pointed out that any such ‘local cyclic permuta-tions’ determine an embedding. Let Gbe a simple graph. Suppose
a cyclic permutation σ
xof the set S(x) of edges incident with xis
given for each vertex x. Then there is a natural oriented mesh M
determined as follows. In the directed walk traversing an edge e
directed from one of its ends yto the other x, the edge following e
is to beσx(e).
The examples below concern simple graphs, so the local permuta-
tions may be abbreviated as permutations of the adjacent verticesand walks may be described by their vertex sequences.
Example 35.5. ConsiderK
5with vertex set {1,2,3,4,5}and the
following local permutations:
1 : (2435)
2 : (1435)3 : (4125)4 : (1325)5 : (1234).
It might be good to think of the resulting walks as a decompositionof the edges of the complete directed graph on 5 vertices. Let e
ij
denote the edge directed from itoj. Here are the edge terms of
the walks:
(e12,e24,e45,e51),
(e13,e32,e25,e53,e34,e42,e23,e35,e54,e41),
(e14,e43,e31,e15,e52,e21).
The vertex sequences of these walks are exactly those of M2in
Example 35.3.
In the family of graphs with 4 s+ 2 vertices in Fig. 35.7, we
speciﬁed a cyclic order at each vertex by the use of a solid vertexto indicate that the local permutation is to be clockwise and a
---PAGE BREAK---
504 A Course in Combinatorics
hollow vertex to indicate counter-clockwise. As part of the proof of
Theorem 35.8, we had to check that the resulting embeddings haveexactly one face.
Given a ﬁnite group Γ and a subset Sof nonidentity elements of
Γ such that α∈Simplies that α
−1∈S, theCayley graph G(Γ,S )
is the simple graph with vertex set Γ and where vertices αand
βare adjacent if and only if βα−1∈S. A complete graph Kn
is a Cayley graph with respect to any group of order n, whereS
consists of all nonidentity elements. Often it is required that S
generates the group—this ensures that the corresponding Cayleygraph is connected.
W. Gustin (1963) introduced the theory of ‘quotient manifolds’
and developed methods to embed Cayley graphs into orientablesurfaces. We have no space to describe this precisely, but givesome examples. Consider the case where the local permutationsat the vertices of a Cayley graph are all ‘shifts’ of an initial cyclicpermutation ( s
1s2... sk) of the set Sof vertices adjacent to 0;
that is, the local permutation at αis
(s1+αs 2+α. . .s k+α)
(with additive notation).
Example 35.6. ConsiderK7with vertex set {0,1,2,3,4,5,6}and
with local permutation (1 + i3+i 2+i 6+i 4+i 5+i)( m o d7 )
atias below:
0 : (132645)
1 : (243056)2 : (354160)3 : (465201)4 : (506312)5 : (610423)6 : (021534).
The walks are:
[1,2,4] [2, 3,5] [3, 4,6] [4, 5,0] [5, 6,1] [6, 0,2] [0, 1,3]
[3,5,6] [4, 6,0] [5, 0,1] [6, 1,2] [0, 2,3] [1, 3,4] [2, 4,5].
This is the triangular embedding of K
7on the torus we have seen
in Example 35.2.
---PAGE BREAK---
35. Embeddings of graphs 505
If we try this method on K31, for example, with vertex set Z31
and initial local permutation
(1,−13,−8,−9,−7,−10,−6,5,13,14,12,15,11,6,−4,
−15,−3,7,−2,−14,−1,8,−5,−11,4,10,3,−12,2,9),
we obtain the same triangular mesh as in the proof of Theorem
35.8. The diagrams of Fig. 35.7 actually represent the ‘quotientmanifolds’ of the dual graphs of K
nwith respect to the prescribed
embeddings. For n=1 2s+ 7, the embedded graph represented
by the diagram has 4 s+ 2 vertices, 6s + 3 edges, and 1 face; the
resulting embedding of Knhas (4s +2)nfaces, (6s +3)nedges, and
(1)nvertices.
Problem 35G. Letωbe a nonzero element in Fqwhereqis a
power of a prime. Say ωhas order min the multiplicative group
and assume that −1i sap o w e ro fω . Consider the Cayley graph
G(Fq,LangbracketleftωLangbracketright) where LangbracketleftωLangbracketright={1,ω,ω2,...}. We are using the additive
group of Fqfor the Cayley graph, so aandbare adjacent if and
only ifa−b∈LangbracketleftωLangbracketright. (This is a complete graph when ωis a primitive
element in Fq; it is the Clebsch graph when q= 16 andm= 5.)
Let us take the local permutation at 0 to be (1 ,ω,ω2,...,ωm−1)
and obtain the other local permutations as shifts. What is the sizeand number of the faces in the resulting mesh?
Notes.
P. J. Heawood (1861–1955) spent most of his career at Durham,
England as professor of mathematics, ﬁnally to become vice-
chancellor.
References.
G. Chartrand and L. Lesniak (1986), Graphs and Digraphs, 2nd
edn., Wadsworth.
J. Edmonds (1960), A combinatorial representation for polyhedral
surfaces, Notices Amer. Math. Soc. 7, 646.
M. Fr´ echet and K. Fan (1967), Initiation to Combinatorial Topol-
ogy, Prindle, Weber and Schmidt.
---PAGE BREAK---
506 A Course in Combinatorics
W. Gustin (1963), Orientable embedding of Cayley graphs, Bull.
Amer. Math. Soc. 69, 272–275.
G. Ringel (1974), Map Color Theorem , Springer-Verlag.
G. Ringel and J. W. T. Youngs (1968), Solution of the Heawood
map coloring problem, Proc. Nat. Acad. Sci. U.S.A. 60, 438–445.
A. T. White (1973), Graphs, Groups, and Surfaces , Mathematical
Studies8, North-Holland.
---PAGE BREAK---
36
Electrical networks and
squared squares
We start with the matrix-tree theorem, which expresses the number
of spanning trees in a graph as the determinant of an appropriate
matrix.
Theorem 36.1. The number of spanning trees in a connected
graphGonnvertices and without loops is the determinant of
anyn−1×n−1principal submatrix of the matrix D−A, where
Aistheadjacencymatrixof GandDisthediagonalmatrixwhose
diagonal contains the degrees of the corresponding vertices of G.
For multigraphs Gwithout loops we agree that the adjacency
matrixAis deﬁned to have A(x,y ) equal to the number of edges
joiningxandy, for distinct vertices xandy. We postpone the proof
until we have developed some tools, but we give some examples now.
Figure 36.1
Example 36.1. LetGbe the graph in Fig. 36.1. Then
D−A=
2−10−1
−13−1 −1
0−12−1
−1−1−13

---PAGE BREAK---
508 A Course in Combinatorics
andGhas 8 spanning trees.
Example 36.2. TakeGto be the complete graph Knin Theorem
36.1. In this case, the matrix D−AisnI−J, whereIis the
identity matrix of order nandJis then×nmatrix of all 1s. The
calculation of the determinant of a n−1×n−1 principal submatrix
of this simple matrix can be done in several ways (row operations,
consideration of eigenvalues) and is left as an exercise. Once this isdone, we obtain yet another proof of Cayley’s theorem, cf. Chapter2, that the complete graph K
nhasnn−2spanning trees.
Problem 36A. LetMbe ann×nmatrix all of whose line-sums
are 0. Then one of the eigenvalues of Misλ1= 0; letλ2,λ3,...,λn
denote the other eigenvalues. Show that all principal n−1×n−1
submatrices of Mhave the same determinant, and this value is
equal to the product1
nλ2λ3···λn.
Example 36.3. We can use the observation of the above problem
to calculate the number of spanning trees in regular graphs whosespectrum is known. For example, let Abe the adjacency matrix of
the Petersen graph. Then Ahas eigenvalues
3,1,1,1,1,1,−2,−2,−2,−2
(see Chapter 21). The matrix Mis 3I−A, which has eigenvalues
0,2,2,2,2,2,5,5,5,5.
We conclude that the Petersen graph has 2000 spanning trees.
The following lemma is known as the Cauchy–Binet theorem. It
is more commonly stated and applied with the diagonal matrix ∆below taken to be the identity matrix.
Lemma 36.2. LetAandBbe, respectively, r×mandm×r
matrices. Let ∆be them×mdiagonal matrix with entry e
iin
rowi, column i. For anr-subsetSof{1,2,...,m}, letASandBS
denote, respectively, the r×rsubmatrices of AandBconsisting
of the columns of A, or the rows of B, indexed by elements of S.
Then
det(A∆B )=/summationdisplay
Sdet(AS) det(BS)/productdisplay
i∈Sei
---PAGE BREAK---
36. Electrical networks and squared squares 509
where the sum is extended over all r-subsetsSof{1,2,...,m}.
Proof: We will prove this assuming that e1,...,emare indepen-
dent indeterminates. Of course, it will then hold for all values of
e1,...,em.
The entries of the r×rmatrixA∆B are linear forms in the
indeterminates e1,...,em; explicitly, if A=(aij) andB=(bij),
then the (i,k ) entry of A∆B is/summationtextm
j=1aijbjkej. Thus det(A∆B )i sa
homogeneous polynomial of degree rine1,...,em.
Consider a monomial et1
1et2
2...where the number of distinct in-
determinates eithat occur, i.e. that have exponent ti>0, is less
thanr. Substitute 0 for the indeterminates eiwhich do not occur
inet1
1et2
2.... The monomial et1
1et2
2...and its coeﬃcient are unaf-
fected by this substitution. But after this substitution, the rank of
∆ is less than rso the polynomial det( A∆B ) evaluates to the zero
polynomial.
So we see that the coeﬃcient of a monomial in the polynomial
det(A∆B ) is 0 unless the monomial is a product of rdistinct inde-
terminates ei, i.e. unless it is of the form/producttext
i∈Seifor somer-subset
S. The coeﬃcient of a monomial/producttext
i∈Seiin det(A∆B ) can be ob-
tained by setting ei,i∈S, equal to 1 and ej,j/∈S, equal to 0.
When this substitution is made in ∆, A∆B evaluates to ASBS.S o
the coeﬃcient of/producttext
i∈Seiin det(A∆B ) is det(A S) det(BS). /square
We will deal extensively with directed graphs Hin this chapter.
All graph-theoretic terms (trees, components, circuits, etc.) willbe applied to a directed graph with the same meaning as for theunderlying undirected graph we obtain by ignoring the directionsof the edges. Thus a path in a digraph will traverse some edges ina ‘forward’ direction, other edges will be traversed ‘backward’. Itis really undirected graphs we are interested in, but it is convenientfor the theory to choose an orientation and produce a digraph; anyorientation will do and produces essentially the same theory.
As we have often done in previous chapters, we use the functional
notationM(i,j) to denote the entry in row iand column jof a
matrixM, andf(i) to denote the ith coordinate of a vector f.
Theincidence matrix Nof a directed graph His the matrix
whose rows are indexed by V(H), whose columns are indexed by
---PAGE BREAK---
510 A Course in Combinatorics
E(H), and where
N(x,e)=

0i fxis not incident with e,o reis a loop,
1i fxis the head of e,
−1i fxis the tail of e.
We mention that
(36.1) rank( N)=|V (H)|−|C(H)|
whereC(H) is the set of components of H. To see this, suppose
thatgis a row vector with coordinates indexed by V(H) and that
gN= 0. This means for every edge e, directed from xtoy,s a y ,
thatg(y)−g(x) = 0. It is clear then, that gN= 0 if and only if g
is constant on the vertex set of every component of H, and hence
the dimension of the space of all gsuch that gN=0i s|C(H)|.
We also mention that the determinant of any square matrix that
has at most one 1 and at most one −1 in any column, all other
entries being 0, is equal to 0 or ±1. This follows by induction:
if every column has a +1 and a −1, then the sum of all rows is
the zero vector, so the matrix is singular. Otherwise, expand the
determinant by a column with one nonzero entry to ﬁnd it is ±1
times the determinant of a smaller matrix with the same property.So every square submatrix of the incidence matrix of a digraph hasdeterminant 0 or ±1. (Matrices with this property are called totally
unimodular .)
Proof of Theorem 36.1: LetHbe a connected digraph with n
vertices, with incidence matrix N. LetSbe a set of n−1 edges
and, with the notation of the Cauchy–Binet theorem, consider then×n−1 submatrix N
S, whose columns are indexed by elements of
S,of the incidence matrix N.By (36.1),NShas rankn−1i fa n d
only if the spanning subgraph of Hwith edge set Sis connected,
i.e. if and only if Sis the edge set of a tree in H. LetNLprimebe obtained
by dropping any single row from the incidence matrix N. Since the
sum of all rows of N(orNS) is the zero vector, the rank of NLprime
S
is the same as the rank of NS. The observations of this and the
preceding paragraph prove that(36.2)
det(N
Lprime
S)=/braceleftbigg±1i fSis the edge set of a spanning tree in H,
0 otherwise.
---PAGE BREAK---
36. Electrical networks and squared squares 511
Let a connected loopless graph Gonnvertices be given, let H
be any orientation of G, and let Nbe the incidence matrix of H.
ThenNNLlatticetop=D−Abecause
NNLlatticetop(x,y)=/summationdisplay
e∈E(G)N(x,e)N (y,e)
=/braceleftbiggdeg(x)i f x=y,
−t ifxandyare joined by tedges inG.
Ann−1×n−1 principal submatrix of D−Ais of the form
NLprimeNLprimeLlatticetopwhereNLprimeis obtained from Nby dropping any one row. By
Cauchy–Binet,
det(NLprimeNLprimeLlatticetop)=/summationdisplay
Sdet(NLprime
S) det(NLprime
SLlatticetop)=/summationdisplay
S( det(NLprime
S))2,
where the sum is extended over all (n −1)-subsets Sof the edge
set. By (36.2), this is the number of spanning trees of G. /square
Remark. If we view E(G) as a set of indeterminates and apply
Lemma 36.2 to n−1×n−1 principal submatrices of N∆NLlatticetop
where here ∆ is the diagonal matrix whose rows and columns are
indexed by the edges and where the diagonal entries are the edgesthemselves (i.e. ∆( e,e): =e), we ﬁnd that det( N∆N
Llatticetop) is the sum
of monomials corresponding to the edge sets of the trees in G.F o r
example, for the graph Gin Fig. 36.1,
N∆NLlatticetop=
a+b−b 0−a
−bb +c+e−c −e
0−cc +d−d
−a −e−da +d+e
.
Of course, N∆NLlatticetopis a singular matrix (all line-sums are 0), but
the determinant of the 3 ×3 matrix obtained by dropping, e.g.,
the last row and column is
(a+b)(b+c+e)(c+d)−b2(c+d)−c2(a+b)=
abc+abd+acd+ace+ade+bcd+bce+bde,
---PAGE BREAK---
512 A Course in Combinatorics
representing the eight spanning trees in G.
We now give a generalization of Theorem 36.1 due to W. T.
Tutte (1948), with a proof that is shorter than the one we gave
for the ﬁrst theorem! (The generalized statement allows a typeof induction that is not possible in the original.) The statementof Theorem 36.1 is recovered when we apply Theorem 36.3 to thedirected graph obtained from an undirected graph by replacing eachundirected edge with a pair of directed edges, one in each direction.
Theorem 36.3. LetGbeadirectedgraphwithvertices x
1,...,xn.
Deﬁnethematrix M,orM(G),asfollows: M=(mij)wheremiiis
thenumberofedgespointingawayfrom xi,notcountingloops,and
foriLnegationslash=j,mijis the negative of the number of edges directed from
xitoxj. Thenthenumber Aplscript,orAplscript(G),ofspanningarborescences
ofGwithxplscriptas root is the minor of position (plscript,plscript)inM, i.e. the
determinantofthe n−1×n−1principalsubmatrixofthematrix
Mobtained by dropping row plscriptand column plscript.
Proof: For notational convenience, we take plscript= 1. If, for some
i>1, there are no edges directed away from xi, then the statement
of the theorem holds: row iofM(G) is the zero-vector; both the
minor of position (1 ,1) and the number of arborescences are zero.
If, for some i>1, there is more than one edge directed away
fromxi, letG1andG2be directed graphs equal to Gexcept that
some (≥1) of those edges are put into G1and the others (≥ 1)
are put into G2. Since every spanning arborescence of Gwith root
x1must contain exactly one edge directed away from xi,A1(G)=
A1(G1)+A 1(G2). Also note that M(G),M(G1), andM(G2) are
identical except for the ith rows, and the ith row of M(G) is the
sum of the ith rows of M(G1) andM(G2). So the minor of position
(1,1) in the ﬁrst matrix is the sum of those minors in the latter
two matrices.
Hence it will be suﬃcient to verify the statement of the theorem
for digraphs Gsuch that mii= 1 for all i>1. That is, with the
property that there is a unique edge directed away from any vertex
xi,i>1.
If such a digraph Ghas a directed closed path not passing through
x1,s a yx2→x3,x3→x4,...,xk→x2, then the sum of rows 2
---PAGE BREAK---
36. Electrical networks and squared squares 513
throughkis0and hence the minor of position (1 ,1) is 0. There
are no directed paths from any of these vertices to x1, so there are
no spanning arborescences.
If such a digraph Ghas no directed closed paths not passing
throughx1, the directed path starting at any vertex xj, and fol-
lowing the edge directed away from each vertex that is met, must
reachx1. We see that the digraph G, when edges leaving x1are
deleted (these edges may not occur in any spanning arborescence),
is itself a spanning arborescence; so A1(G) = 1. The minor of posi-
tion (1, 1) inM(G) is also seen to be 1, e.g. by induction: expand
the determinant by a column jcorresponding to a vertex xjthat
has indegree 0 in the arborescence (and so a 1 in position ( j,j) and
0s in positions (i,j ),i>1,iLnegationslash=j). /square
We remark that if the edges of a digraph Gare viewed as in-
dependent indeterminates and a matrix like M(G) is formed but
where the entries are formal sums of edges rather than integers,then the minors are the formal sums of all arborescences, each rep-resented by the product of its edges. The reader may easily modifythe above proof. For example, if Gis the digraph on vertices 1 ,2,3
with edge adirected from 2 to 1, edge bdirected from 3 to 1, and
edgecdirected from 3 to 2, then we consider the matrix
M=
00 0
−aa 0
−b−cb +c.
The minor of position (1, 1) isab+ac, which represents the two
arborescences rooted at 1.
Problem 36B. (Easy.) Let T
nbe the ‘transitive tournament’ on
vertices 1,2,...,n with edges directed from jtoiwhenever i<j.
What isM(Tn)? What is the number of spanning arborescences
rooted at 1 in Tn? Describe all such arborescences.
We can now give a second proof of Theorem 8.2 on the number of
De Bruijn sequences. Let the digraph Gnbe as deﬁned in Chapter 8.
All the indegrees and outdegrees of Gnare equal to 2. The solution
of Problem 2B suggested in Appendix 1 shows that the number of
(directed) Eulerian cycles in Gnis equal to the number of spanning
---PAGE BREAK---
514 A Course in Combinatorics
arborescences in Gnrooted at any vertex. By Theorem 36.3 and
Problem 36A, this number can be obtained from knowledge of the
eigenvalues of the matrix M(Gn).
Number the rows and columns of a matrix Bnof size 2n−1by the
integers 0 to 2n−1−1. Letbij=1i fj=2ior 2i + 1 (mod 2n−1).
(Note that the top half and bottom half of Bnare the same.) Then
M(Gn)=2I−Bn. We now calculate the determinant Dn(x)o f
xI−M(Gn). By the obvious row and column operations on the
lower half of this determinant we ﬁnd
Dn(x)=(x−2)2n−2Dn−1(x).
SinceD2(x)=x (x−2), we see that all the nonzero eigenvalues of
Mnare equal to 2 and hence by Problem 36A, the number of De
Bruijn cycles of length 2nis
1
2n−1·22n−1−1=22n−1−n.
***
LetNbe the incidence matrix of a digraph H. The rowspace
ofNis called the coboundary space ofH; the nullspace of NLlatticetop,
i.e. the space of all row vectors fsuch that fNLlatticetop= 0, is called the
cycle space ofH. These are of importance in the theory of electrical
networks and algebraic topology. From (36.1), the dimension of thecoboundary space of a digraph His|V(H)|−|C(H)|, and hence
the dimension of the cycle space is |E(H)|−|V(H)|+|C(H)|.
From the deﬁnition, a vector fis a cycle if and only if for each
vertexx, the sum of the values f(e) on outgoing edges is equal to
the sum of the values f(e) on incoming edges. An example of a
cyclef(a so-called elementary cycle) is obtained from any simple
closed path pinHby deﬁning f(e) to be +1 on the forward edges
of the path, −1 on the backward edges, and 0 on all edges not in
the path. A vector is a coboundary if and only if it is orthogonal toall cycles, so in particular, the sum of the values of a coboundaryon the forward edges of a simple closed path will equal the sum ofthe values on the backward edges of the path.
---PAGE BREAK---
36. Electrical networks and squared squares 515
Problem 36C. A vectorgwith coordinates indexed by E(H)i s
a coboundary on a digraph Hif and only if for every closed walk
w, the signed sum of the values of gon the edges (the sum of the
values ofgon the forward edges of wminus the sum of the values
ofgon the backward edges of w) is zero.
Let us agree that an electrical network consists of a digraph H,
together with a function rassociating to each edge ea ‘resistance’
r(e)≥0, and a function sassociating to each edge ean ‘impressed
electromotive force’ or ‘voltage source’ s(e). That is, each edge is
to be thought of as a resistor or a battery or both. If batteries and
resistors are connected, a ‘current ﬂow’ f(e) will pass through each
edge and a ‘potential diﬀerence’ or ‘voltage’ g(e) will be measurable
across each edge. All that we need to know here is that the vectorsfandgare determined from randsby the rules called Kirchhoﬀ’s
lawsandOhm’s law . Kirchhoﬀ’s current law and voltage law assert,
respectively, that fis a cycle and that gis a coboundary. Ohm’s
law says that g(e)=−s(e)+ r(e)f(e), or, in matrix notation, g=
−s+fRwhereRis the diagonal matrix with the numbers r(e)o n
the diagonal and where we think of s,g, andfas row vectors.
Problem 36D. Suppose {e:r(e)=0}contains no circuits, i.e.
is the edge set of a forest. Show that the electrical network has aunique solution, by which we mean that for any sthere exist unique
vectorsfandgsatisfying the above laws.
18
1415
10
478 9
1
Figure 36.2
---PAGE BREAK---
516 A Course in Combinatorics
By asquared rectangle we mean a rectangle which has been par-
titioned into a ﬁnite number of squares. Two examples appear in
Figs. 36.2 and 36.3. These rectangles have dimensions 33 by 32,and 177 by 176, respectively. Squared rectangles are thought to beelegant when all internal squares have distinct sizes and when theycontain no smaller squared rectangle.
7799
3491643
4157
2578
21
Figure 36.3
Problem 36E. Find integral dimensions for the small squares in
Fig. 36.4 so that the diagram represents a squared rectangle.
xy
z
Figure 36.4
---PAGE BREAK---
36. Electrical networks and squared squares 517
For many years, it was not known whether a square could be par-
titioned into a ﬁnite number of unequal smaller squares. In the late
1930s, such squared squares were ﬁnally discovered. One example
was shown on the cover of the Journal of Combinatorial Theory
until a smaller example was found by A. J. W. Duijvestijn (1978);the cover illustration was updated in January of 1979. This is apartition into the least possible number (21) of squares. Comput-ers are used for these results, but an important tool in the study ofsquared rectangles is the connection with electrical networks whichwas discovered by four undergraduates at Cambridge in 1936–1938.A popular account of some of their work is given by W. T. Tutte(1961) and (1965) who was one of them.
We give an informal description of this connection with electrical
networks. Let us use the term special network for an electrical
network with a distinguished edge e
0so thats(e) = 0 for eLnegationslash=e0,
and where
r(e)=/braceleftbigg1i feLnegationslash=e0,
0i fe=e0.
That is, we have a system of unit resistors and a single battery.
332836
163625
92
5
2816
33619
72
525
Figure 36.5
A special electrical network arises from a squared rectangle as
follows. Deﬁne a digraph Hwhose vertices are the maximal hor-
izontal line segments in the diagram. The edges of Hare to be
the small squares, and we include one special edge e0for the entire
---PAGE BREAK---
518 A Course in Combinatorics
rectangle. We direct each edge (except e0) downward, i.e. towards
the lower line segment. An example is shown in Fig. 36.5. The
digraphHis clearly planar. There is a real number f(e) naturally
associated to edge e, namely the size of the corresponding small
square; we take f(e0) to be the width of the large rectangle. It is
not hard to see that fis a cycle on H: for each maximal horizontal
line segment, the sum of the sizes of the squares ‘sitting on’ thatsegment is equal to the sum of the squares ‘hanging from’ it. More-over, were it not for the special edge, fwould also be a coboundary:
if for each vertex (horizontal line segment) x, we take h(x)t ob e
the distance of the line segment from the top side of the large rect-angle, then for eLnegationslash=e
0,f(e) is equal to h(head of e)−h(tail ofe).
So if we let s(e0) be the height of the rectangle and take gto be
the coboundary of h, thenfandgare the current ﬂow and voltage
vectors which solve this special network, i.e. g=−s+Rf.
Conversely, a special electrical network where the digraph is pla-
narleads to the construction of a squared rectangle. We do not
give a proof. The ratio of its width to its height will be the ratio ofthe current ﬂow f(e
0) to the voltage −g(e0) in the solution to the
network. (Some of the edges may have negative current ﬂow whenthe network is solved, but we could reverse the direction on theseedges to get a positive value. The edges with zero current ﬂow maybe deleted—or contracted; they will not give rise to squares.) Thusa squared square corresponds to a planar network of resistors whichhave the net eﬀect of a resistance of one ohm.
Problem 36F. Solve the special networks in Fig. 36.6 below by
any means you wish, and sketch the corresponding squared rectan-
gles. The dual graphs may also be thought of as special networks—what are the squared rectangles that arise from the dual networks?
Figure 36.6
---PAGE BREAK---
36. Electrical networks and squared squares 519
LetNbe the incidence matrix of a digraph Dand ∆ a diagonal
matrix indexed by E(D) with ∆(e,e)=r(e)>0, the resistance of
the edgee; letC:=N∆−1NLlatticetop. If an additional edge e0is directed
from one vertex yto another vertex xofD, and a suﬃcient voltage
source is impressed on that single edge so that a current f(e0)ﬂ o w s
through it, then Kirchhoﬀ’s laws imply that the potential diﬀerence
g(e) across an edge ejoining vertex ato vertexb, say, is given by
(36.3) g(e)=f(e0)
τ(D)(xy.ab )
where (xy.ab) denotes the cofactor of the element cybin the cofactor
of the element cxaofC=(cij) andτ(D) denotes the number of
spanning trees of D(the complexity of D). See Jeans (1908).
A consequence of this is the following theorem.
Theorem 36.4. If the voltage source s(e0)on the distinguished
edgee0ofaspecialnetworkwithgraph Gistakentobethenumber
ofspanningtrees ontheedgee0,thenallvalues f(a)oftheresulting
currentﬂowwillbeintegral,andthecurrentﬂow f(e0)throughthe
distinguished edge will be equal to the number of spanning treesoﬀthe edgee
0.
Proof: In the discussion preceding the statement of the theorem,
takeDto be an orientation of GLprime
e0and ∆ the identity matrix. If
the current ﬂow f(e0)i sτ(D)=τ(GLprimee
0), then it is clear from (36.3)
that all values of f(a)=g (a) are integral. It remains only to show
that−g(e0) is equal to the number of spanning trees onthe edge
e0.
By (36.3), g(e0)=(xy.yx )=−(xy.xy ). By deﬁnition, ( xy.xy )
is the determinant of the matrix NLprimeLprimeNLprimeLprimeLlatticetopwhereNLprimeLprimeconsists of N
with rows xandydeleted. By the Cauchy–Binet theorem, this is
equal to/summationdisplay
S( det(NLprimeLprime
S))2
where the sum is extended over all ( n−2)-subsets Sof the edge
set andNLprimeLprime
Sis the square submatrix of NLprimeLprimewhose rows are indexed
by elements of S.
---PAGE BREAK---
520 A Course in Combinatorics
The proof is completed by the observation that det(NLprimeLprime
S)i s0
unlessS∪{e0}is the edge set of a spanning tree in G, in which
case it is ±1. This is similar to the proof of (36.2) and is left as an
exercise. /square
In summary, Theorem 36.4 says that the resistance between the
ends of an edge e0of a graph Gwhen all other edges are thought of
as unit resistors, is the ratio τ(GLprimeLprime
e0)/τ(GLprimee
0). Readers might check
that this agrees with their knowledge of electrical networks when
Gis a polygon or a bond-graph. A squared square arises when we
ﬁnd a planar graph Gand an edge e0so thatτ(GLprimeLprime
e0)=τ(GLprimee
0). This
statement alone does not necessarily help in the search for squared
squares (and electrical engineers will think this would be a waste
of resistors anyway). Such graphs appear to be quite rare.
Notes.
The ﬁrst appearance in the literature of the problem of using in-
congruent squares to make a rectangle seems to be M. Dehn (1903).
The ﬁrst extensive tables of squared squares were published by
C. J. Bouwkamp, A. J. W. Duijvestijn, and P. Medema (1960).
W. T. Tutte (1918–) has made numerous signiﬁcant contributions
to graph theory. He is Emeritus Professor of Mathematics in the
Department of Combinatorics and Optimization of the Universityof Waterloo, one of the few academic departments in the worldwhose name includes the word ‘combinatorics’.
For the proof of Theorem 36.3, we have followed De Bruijn and
Van Aardenne-Ehrenfest (1951).
One of the Cambridge students mentioned earlier, C. A. B. Smith,
wrote a very nice account of the history of their collaboration, called‘Did Erd˝ os save Western Civilization?’ (see Graham and Neˇ setˇ ril(1997)). Apparently, Erd˝ os conjectured that any dissection of asquare into smaller squares must contain at least two squares ofequal size. One thing led to another and Tutte ended up at Bletch-ley Park instead of in the army. It is rumored that there he suppliedthe vital clue to the deciphering of the Enigma, which explains thetitle of the paper.
References.
N. G. de Bruijn and T. van Aardenne-Ehrenfest (1951), Circuits
---PAGE BREAK---
36. Electrical networks and squared squares 521
and trees in oriented linear graphs, Simon Stevin 28, 203–217.
C. J. Bouwkamp, A. J. W. Duijvestijn, P. Medema (1960), Tables
relating to simple squared rectangles of order nine through ﬁfteen ,
T. H. Eindhoven.
A. J. W. Duijvestijn (1978), Simple perfect squared square of lowest
order,J. Combinatorial Theory (B)25, 555–558.
M. Dehn (1903), Zerlegung von Rechtecke in Rechtecken, Math.
Ann.57.
R. L. Graham and J. Neˇ setˇ ril (Eds.) (1997), The Mathematics of
P. Erd˝ os, Springer.
J. H. Jeans (1908), The Mathematical Theory of Electricity and
Magnetism , Cambridge University Press.
W. T. Tutte (1948), The dissection of equilateral triangles into
equilateral triangles, Proc. Cambr. Phil. Soc. 44, 463–482.
W. T. Tutte (1961), Squaring the square, in: M. Gardner, The
2nd Scientiﬁc American Book of Mathematical Puzzles and Di-
versions , Simon and Schuster.
W. T. Tutte (1965), The quest of the perfect square, Amer. Math.
Monthly 72, No. 2, 29–35.
---PAGE BREAK---
37
P´ olya theory of counting
We return to counting in this chapter. There are many instances
when we are not interested in the number of primitive objects, butrather the number of equivalence classes of objects with respect toan appropriate equivalence relation. Moreover, these equivalencerelations are often induced by certain permutation groups in a nat-ural way.
Question 1. What is the number of ‘essentially diﬀerent’ neck-
laces which can be made with nbeads of two diﬀerent colors? For
n= 6, this number is, by inspection, 13.
❡❡❡❡❡❡✉❡❡❡❡❡✉✉❡❡❡❡✉❡✉❡❡❡✉❡❡✉❡❡✉✉✉❡❡❡✉✉❡✉❡❡
✉❡✉❡❡✉❡❡✉✉✉✉❡✉❡✉✉✉❡✉✉❡✉✉✉✉✉✉❡✉✉✉✉✉✉✉
Note that we choose to regard the necklaces
(37.1) ❡✉✉❡❡✉and ❡✉✉❡✉❡
as essentially the same, since one can be reﬂected through a ver-
tical axis (or ﬂipped over) to get the other. Evidently, underlyingour concept of ‘essentially diﬀerent’ is the dihedral group D
nof
automorphisms of the n-gon.
Question 2. What is the number of nonisomorphic simple graphs
onnvertices? For n= 4, there are 11.
Question 3. What is the number of essentially diﬀerent ways to
paint the faces (or edges, or vertices) of the cube with ncolors?
---PAGE BREAK---
37. P´ olya theory of counting 523
Question 4. Given three white balls and one black ball, what is
the number of ways to distribute them into two square boxes and
one round box?
[❝❝❝s][ ]( ) [❝❝❝][s]( ) [❝❝][❝s]( ) [❝❝s][❝]( )
[❝❝❝][ ](s)[❝❝][❝](s)[❝❝s][ ](❝)[❝❝][s](❝)
[❝s][❝](❝)[❝s][ ](❝❝)[❝][s](❝❝)[❝❝][ ](❝s)
[❝][❝](❝s)[s][ ](❝❝❝)[❝][ ](❝❝s) [ ][ ](❝❝❝s)
LetAandBbe ﬁnite sets and Ga group of permutations of A
(or more generally, a ﬁnite group acting on A). The elements of B
will be called colors . The group Gacts on the set BAof mappings
f:A→Bwhen forσ∈Gandf∈BA, we deﬁne σ(f)∈BAby
(σ(f))(x): =f(σ−1(x)).
It is the orbits of an appropriate Gon the set BAthat we wish to
count in the ﬁrst three questions above.
(The use of σ−1rather than σon the right-hand side above is
not an error. It is required to ensure that σ(τ(f) )=(στ)(f),
which is necessary in order to have a legitimate ‘action’ of Gon
BA. Formally, we have a homomorphism of Ginto the symmetric
group onBA.)
In the necklace problem, we would take Ato be the vertex set
of ann-gon, and Gas its automorphism group represented as a
permutation group on the vertices (i.e. the dihedral group Dnof
order 2n in its usual representation). A slightly diﬀerent problem
arises when the beads to be used are not round, but, say, ﬂat onone side. Then the necklaces cannot be ﬂipped over and those in(37.1) are regarded as distinct.
Here, we would take Gto be the cyclic group of order nin its
regular representation; cf. Example 10.5.
Asking for the number of orbits of mappings is the simplest ques-
tion we can pose. We might further want to know the number oforbits of a given ‘weight’; for example, the number of necklaces ofnbeads,kof which are to be white, or the number of graphs on
nvertices with kedges. We might introduce a permutation group
---PAGE BREAK---
524 A Course in Combinatorics
HonBand, with respect to a more general equivalence relation,
ask for the number of ‘conﬁgurations’. (This would be necessary
for the distribution problem.)
To begin, we recall Burnside’s lemma, Theorem 10.5: the number
of orbits of a ﬁnite group Gon a setXis the average number of
ﬁxed points:
(37.2)1
|G|/summationdisplay
σ∈Gψ(σ),
whereψ(σ) denotes the number of points of Sthat are ﬁxed by the
permutation σ. Recall that this formula followed from counting
ordered pairs ( x,σ)∈X×Gsuch that σ(x)=x.
Theorem 37.1. LetAandBbe ﬁnite sets and let Gact onA.
Denoteby ck(G)thenumberofpermutationsin Gthathaveexactly
kcycles in their cycle decomposition on A. Then the number of
orbits ofGon the set BAof all mappings f:A→Bis
1
|G|∞/summationdisplay
k=1ck(G)|B|k.
Proof: By Burnside’s lemma, the number of orbits is given by
(37.2) where ψ(σ) is here the number of mappings f:A→Bsuch
thatσ(f)=f , i.e.f(a)=f (σ−1(a)) for all a∈A. But a mapping
fis ﬁxed by σif and only if fis constant on every cycle of σ; the
reader should check this. Such mappings are obtained by assigning
an element of Bto each cycle of σ, and thus if σhaskcycles, the
number of mappings fﬁxed byσis|B|k. /square
We encourage the reader to pause at this point and to verify that
Theorem 37.1 produces the answer 13 when applied to the necklacecounting problem raised as Question 1 above.
Since it is to be used extensively later, it is appropriate to intro-
duce the cycle index of a permutation group at this point. First,
in this chapter, it will be convenient to use the venerable notation(1
k12k2...nkn) for the partition of the integer nwhich has kiparts
of sizei,i=1,2,...,n . Do not compute powers or multiply; this
is just notation.
---PAGE BREAK---
37. P´ olya theory of counting 525
For a permutation σof a setA, letzi(σ) denote the number
of cycles of σhaving length i;s o( 1z1(σ)2z2(σ)...) is a partition of
n=|A|, called the typeofσ. Given a group Gacting on A,w e
deﬁne the cycle index ZGas a polynomial in nlettersX1,X2,...,Xn
by
ZG(X1,X2,...,Xn): =1
|G|/summationdisplay
σ∈GXz1(σ)
1···Xzn(σ)
n.
The assertion of Theorem 37.1 is that the number of orbits of G
onBAis
ZG(b,b,...,b )=1
|G|/summationdisplay
σ∈Gbz1(σ)+z2(σ)+···+zn(σ)
whereb:=|B|.
Example 37.1. A cyclic group Cnof ordernhasϕ(d) elements
of orderdfor each divisor dofn. As a permutation in the regular
representation of Cn, an element of order dhasn/dcycles of length
d. Thus, for the regular representation of Cn,w eh a v e
ZCn(X1,...,Xn)=1
n/summationdisplay
d|nϕ(d)Xn/d
d.
We can now count the number of ‘one-sided’ necklaces of nbeads
of two colors. The answer is ZCn(2,2,..., 2) =1
n/summationtext
d|nϕ(d)2n/d; cf.
equation (10.12). For n= 6, we get 14, one more than with dihedral
equivalence (the two necklaces in (37.1) are now distinguished). For
n= 10, we get 108.
Example 37.2. To ﬁnd the cycle index of the dihedral group Dn
in its usual representation on npoints, we must account for the
permutations (reﬂections) outside of its cyclic subgroup of order n.
There are two cases depending on the parity of n:
ZDn=

1
2n/parenleftBig/summationtext
d|nϕ(d)Xn/d
d+nX1Xn−1
2
2/parenrightBig
fornodd,
1
2n/parenleftBig/summationtext
d|nϕ(d)Xn/d
d+n
2X2
1Xn
2−1
2+n
2Xn
2
2/parenrightBig
forneven.
---PAGE BREAK---
526 A Course in Combinatorics
The number of ‘two-sided’ necklaces with nbeads of two diﬀerent
colors isZDn(2,2,..., 2). Forn= 6, we get 13 (verifying the list
following Question 1). For n= 10, we get 78.
Problem 37A. Compute the cycle index of the group of rotations
of the cube represented as permutations of the six faces. (There
are 24 rotations—including the identity—that map the cube, as arigid body in 3-space, onto itself. We are ignoring the 24 reﬂectionsof the cube.) What is the number of essentially diﬀerent ways topaint the faces of the cube in 2 colors? In 3 colors? In ncolors?
Before going further, let us write down the cycle index of the
symmetric groups. We noted the formula for the number of parti-
tions of a given type (1
k12k2...nkn) in equation (13.3). Each block
of sizeimay be equipped with a cyclic permutation in ( i−1)! ways,
so we have
ZSn=/summationdisplay
(1k12k2...)1
1k12k2...nknk1!k2!...kn!Xk1
1Xk2
2...Xknn.
We list the ﬁrst several polynomials below:
1!ZS1=X1,
2!ZS2=X2
1+X2,
3!ZS3=X3
1+3X1X2+2X3,
4!ZS4=X4
1+6X2
1X2+3X2
2+8X1X3+6X4,
5!ZS5=X5
1+1 0X3
1X2+1 5X1X2
2+2 0X2
1X3+2 0X2X3
+3 0X1X4+2 4X5,
6!ZS6=X6
1+1 5X4
1X2+4 5X2
1X2
2+4 0X2
3+4 0X3
1X3+1 5X3
2
+1 2 0X1X2X3+9 0X2
1X4+9 0X2X4+1 4 4X1X5+1 2 0X6.
Example 37.3. Theorem 37.1 can be used for the enumeration of
graphs. Let Vbe a ﬁxed set of nvertices and let Econsist of all
2-subsets of V. Then the simple graphs with vertex set Vcan be
viewed as mappings f:E→{0,1}, the graph corresponding to f
having edge set f−1(1) ={e:f(e)=1}.
---PAGE BREAK---
37. P´ olya theory of counting 527
Two graphs on Vare isomorphic if and only if there exists a
permutation of Vtaking the edges of one onto the edges of the
other. To describe this in a manner suitable for the application
of Theorem 37.1, let Snbe the symmetric group on Vand let
S(2)
n={σ(2):σ∈Sn}be the induced group, isomorphic to Sn,o f
permutations of Ewhere
σ(2):{x,y} Lmapsto→{σ(x),σ (y)}.
ThenS(2)
nacts on{0,1}Eand we note that f,g:E→{0,1}corre-
spond to isomorphic graphs if and only if they lie in the same orbitofS
(2)on{0,1}E.
It is not a pleasant task to compute the types of all permutations
inS(2)
n. For example, if σ∈S5has type (2131), then it turns out
thatσ(2)has type (113161) on the 10 edges of K5. The cycle index
ofS(2)
5is
1
120(X10
1+1 0X4
1X3
2+1 5X2
1X4
2+2 0X1X3
3
+2 0X1X3X6+3 0X2X2
4+2 4X2
5).
In general, we will have a sum over all partitions of n. The number
of nonisomorphic graphs on ﬁve vertices is found, by substituting2 for all indeterminates, to be 34.
We now generalize Theorem 37.1 to allow for weights. Let Abe
ann-set, letGact onA, and let Bbe a ﬁnite set of colors. Let R
be a commutative ring containing the rationals and let w:B→R
assign a weightw(b)∈Rto each color b∈B.F o rf:A→B,
deﬁne
W(f): =/productdisplay
a∈Aw(f(a))∈R;
hereW(f)i st h eweight of the function f. Note that two mappings
representing the same orbit of GonBAhave the same weight, i.e.
W(σ(f)) =W(f) for every σ∈G. The sum
/summationdisplay
f∈RW(f),
---PAGE BREAK---
528 A Course in Combinatorics
extended over a system of representatives Rfor the orbits, is called
theconﬁguration counting series . (The orbits are often called con-
ﬁgurations; the term series becomes appropriate when the weights
are monomials.) If all weights w(b) are 1, then the following theo-
rem reduces to Theorem 37.1.
Theorem 37.2. Withtheterminologyasabove,theconﬁguration
counting series is given by
/summationdisplay
W(f)=ZG/parenleftBigg/summationdisplay
b∈Bw(b),/summationdisplay
b∈B[w(b)]2,...,/summationdisplay
b∈B[w(b)]n/parenrightBigg
.
Proof: LetN=/summationtextW(f), the sum extended over all pairs ( σ,f)
withσ∈G,f∈BA, andσ(f)=f . We have
N=/summationdisplay
f∈BAW(f)|Gf|,
whereGfis the stabilizer of f. Consider the terms W(f)|Gf|asf
ranges over an orbit OofGonBA: each is equal to W(f0)|G|/|O|
wheref0is a representative of the orbit O, so these terms sum to
|G|W (f0). It is now clear that Nis|G|times the conﬁguration
counting series.
On the other hand,
N=/summationdisplay
σ∈G
/summationdisplay
σ(f)=fW(f).
Recalling the deﬁnition of Z
G, we see that the proof will be com-
plete if we show that
/summationdisplay
σ(f)=fW(f)=/parenleftBigg/summationdisplay
b∈Bw(b)/parenrightBiggk1/parenleftBigg/summationdisplay
b∈B[w(b)]2/parenrightBiggk2
···/parenleftBigg/summationdisplay
b∈B[w(b)]n/parenrightBiggkn
whenever σis a permutation of type (1k12k2···nkn).
A mapping f:A→Bis ﬁxed by σif and only if fis constant
on every cycle of σonA. Let
C1,C2,...,Ck,k:=k1+k2+···+kn
---PAGE BREAK---
37. P´ olya theory of counting 529
be the cycles of σ. The mappings f∈BAﬁxed byσare in one-to-
one correspondence with k-tuples (b 1,b2,...,bk) of elements of B
(the corresponding mapping is the one associating bito all elements
ofCi). The weight of the mapping fcorresponding to ( b1,...,bk)
is
W(f)=k/productdisplay
i=1[w(bi)]|Ci|,
and summing over all k-tuples (b 1,b2,...,bk),
/summationdisplay
σ(f)=fW(f)=/summationdisplay
b1,b2,...,bk[w(b1)]|C1|[w(b2)]|C2|···[w(bk)]|Ck|
=/parenleftBigg/summationdisplay
b1[w(b1)]|C1|/parenrightBigg/parenleftBigg/summationdisplay
b2[w(b2)]|C2|/parenrightBigg
···
=n/productdisplay
c=1/parenleftBigg/summationdisplay
b[w(b)]c/parenrightBiggkc
,
as required. /square
Example 37.4. Consider the necklace problem with cyclic equiv-
alence. Here G=Cn,B={black,white }.W e t a k e Rto be the
polynomial ring Q[X] and deﬁne w(black )=1 ,w(white )=X .
Then the weight of a coloring f:A→Bis
W(f)=Xk
wherekis the number of white beads.
Thus the number of essentially diﬀerent cyclic necklaces with n
beads,kof which are white, is the coeﬃcient of Xkin the conﬁgu-
ration counting series
ZCn(1 +X,1+X2,1+X3,...,1+Xn)
=1
n/summationdisplay
d|nϕ(d)[1 +Xd]n/d
=1
n/summationdisplay
d|nϕ(d)n/d/summationdisplay
r=0/parenleftbiggn/d
r/parenrightbigg
xrd.
---PAGE BREAK---
530 A Course in Combinatorics
This coeﬃcient is
1
n/summationdisplay
d|(k,n )ϕ(d)/parenleftbiggn/d
k/d/parenrightbigg
.
So ifkandnare relatively prime, the number is simply1
n/parenleftbign
k/parenrightbig
,
while forn=1 2 ,k= 4, there are1
12/parenleftBig
ϕ(1)/parenleftbig12
4/parenrightbig
+ϕ(2)/parenleftbig6
2/parenrightbig
+ϕ(4)/parenleftbig31/parenrightbig/parenrightBig
=
43 necklaces.
Problem 37B. What is the number of essentially diﬀerent ways
to paint the faces of a cube such that one face is red, two are blue,
and the remaining three are green? Do this ‘by hand’ (which maybe quicker) as well as by using Theorem 37.2, and compare youranswers.
LetAandBbe ﬁnite sets, |A|=n, and let GandHbe ﬁnite
groups,Gacting onAandHonB. The direct product G×Hacts
onB
Awhen forf∈BAand (σ,τ)∈G×Hwe deﬁne (σ,τ )(f)b y
((σ,τ )(f))(a)=τ (f(σ−1(a)).
Theorem 37.3. The number of orbits of G×HonBAis
1
|H|/summationdisplay
τ∈HZG(m1(τ),m 2(τ),...,m n(τ))
where
mi(τ): =/summationdisplay
j|ijzj(τ),i =1,2,...,n.
Proof: By Burnside’s lemma, the number of orbits is
1
|G||H|/summationdisplay
σ∈G,τ∈Hψ(σ,τ)
whereψ(σ,τ) is the number of mappings f∈BAwith (σ,τ )(f)=f .
To complete the proof, it will suﬃce to show that for each τ∈H,
(37.3)1
|G|/summationdisplay
σ∈Gψ(σ,τ)=ZG(m1(τ),m 2(τ),...,m n(τ)).
---PAGE BREAK---
37. P´ olya theory of counting 531
Fixσ∈Gandτ∈H, and let
C1,C2,...,Ck,k:=z1(σ)+z 2(σ)+··· +zn(σ)
be the cycles of σonA. A mapping f:A→Bis ﬁxed by (σ,τ )i f
and only if all the restrictions fi:=f|Ciare ﬁxed, 1 ≤i≤k.S o
ψ(σ,τ) is the product, over iin the range 1 ≤i≤k, of the numbers
of mappings fi:Ci→Bsatisfying
fi(σ(a)) =τ(fi(a)) for all a∈Ci.
LetCihave length plscriptand ﬁxao∈Ci. Suppose that fi:Ci→B
is ﬁxed by ( σ|Ci,τ) and that fi(ao)=b. Then fiis completely de-
termined: fi(σt(ao)) =τt(b). Moreover, b=fi(ao)=fi(σplscript(ao)) =
τplscript(b) and so we see that the cycle of τcontaining bmust have length
plscriptLprime, a divisor of plscript.
Conversely ,i fbis an elemen to fB lying in a cycle of τhaving
a length dividing plscript:=|Ci|, then we can deﬁne a mapping fionCi
byfi(σt(ao)) :=τt(b) (check that fiis well deﬁned) and this fiis
ﬁxed by (σ|Ci,τ).
In summary, when |Ci|=plscript, the ﬁxed mappings fi:Ci→Bare
equinumerous with the elements of Blying in cycles of τof length
dividingplscript. The number of such elements is, of course,
mplscript(τ)=/summationdisplay
j|plscriptjzj(τ).
Then
ψ(σ,τ)=k/productdisplay
i=1m|Ci|(τ)=[m1(τ)]z1(σ)[m2(τ)]z2(σ)···[mn(τ)]zn(σ),
from which the desired equation (37.3) is immediate. /square
Example 37.5. What is the number of ways to distribute 2 red,
2 yellow, and 4 green balls into 1 round and 3 square boxes? We
take
A={R1,R2,Y1,Y2,G1,G2,G3,G4},
---PAGE BREAK---
532 A Course in Combinatorics
G=S2×S2×S4,B ={r,s 1,s2,s3},H =S1×S3.
It is easy to see that the cycle index of Gis the product of the
cycle indices of the symmetric groups of which it is the product, so
(37.4)ZG=ZS2·ZS2·ZS4
=1
2!2!4!(X2
1+X2)2(X4
1+6X2
1X2+3X2
2+8X1X3+6X4).
There are three types of permutations in H.I fτis the identity,
then
m1(τ)=4,m 2(τ)=4,m 3(τ)=4,m 4(τ)=4 ;
ifτtransposes two of {s2,s2,s3}, then
m1(τ)=2,m 2(τ)=4,m 3(τ)=2,m 4(τ)=4 ;
ifτﬁxes only r, then
m1(τ)=1,m 2(τ)=1,m 3(τ)=4,m 4(τ)=1.
By Theorem 37.3, the number of distributions is
1
3!1
2!2!4!/bracketleftbig
(42+4 )2(44+6·42·4+2· 42+8·4·4+6· 4)
+ 3(22+4 )2(24+6·22·4+3· 42+8·2·2+6· 4)
+ 2(12+1 )2(14+6·12·1+3· 12+8·1·4+6· 1)/bracketrightbig
= 656 (if we did the arithmetic correctly).
Problem 37C. GivenGonA,HonB, ﬁnd an expression for the
number of orbits of injective mappings f:A→B.
We give, without proof, a statement of the extension of Theorem
37.3 to include weights. See De Bruijn (1964) for a proof. If all
weights are 1, then this reduces to Theorem 37.3.
Theorem 37.4. LetGactonA,HonB,letRbeacommutative
ring andw:B→R. Assume that wis constant on each orbit of
HonB. WithW(f): =/producttext
a∈Aw[f(a)],thesum/summationtextW(f),extended
---PAGE BREAK---
37. P´ olya theory of counting 533
over a system of representation for the orbits of G×HonBA,i s
equal to
1
|H|/summationdisplay
τ∈HZG/parenleftbig
M1(τ),M 2(τ),...,M n(τ)/parenrightbig
where
Mi(τ)=/summationdisplay
τi(b)=b[w(b)]i.
Example 37.6. We continue Example 13.5. Take
w(r)=r, w (s1)=w (s2)=w (s3)=s,
whereR=Q[r,s ]. The number of distributions with tballs in the
round box and the remaining 8 −tin square boxes is the coeﬃcient
ofrts8−tin
1
6/parenleftBig
ZG(r+3s,r2+3s2,r3+3s3,r4+3s4)
+3ZG(r+s,r2+3s2,r3+s3,r4+3s4)+2ZG(r,r2,r3+3s3,r4)/parenrightBig
whereZGis the polynomial in (37.4).
Problem 37D. Identify necklaces of two types of colored beads
with their duals obtained by switching the colors of the beads. (We
can now distinguish between the two colors, but we can’t tell which
is which.) Now how many of these reduced conﬁgurations are there?(For example, with n= 6 and dihedral equivalence, there are 8
distinct conﬁgurations.) How many necklaces are self-dual?
Problem 37E. The faces of the cube are to be colored with scol-
ors, and the vertices with tcolors (which can be assumed diﬀerent,
though it is not important). In how many essentially diﬀerent ways
(with respect to the rotation group of the cube) can this be done?
***
The theorems of this chapter are also sources of algebraic iden-
tities.
---PAGE BREAK---
534 A Course in Combinatorics
Consider the case of ‘distribution of like objects into unlike cells’.
(We are recalling something which was discussed in Chapter 13.)
For example, in how many ways can we distribute 23 apples toFred, Jane, and George? More generally, consider the distributionsof a setAofnapples to a set Bofxindividuals (the elements
ofAare ‘like’, whereas the elements of Bremain distinct, i.e. are
‘unlike’). Such a distribution amounts to the selection of a family(k
b:b∈B) of nonnegative integers kbwith/summationtext
b∈Bkb=n,kbapples
going to individual b.
Thus the number of distributions, as shown in Theorem 13.3, is
/parenleftbiggn+x−1
n/parenrightbigg
.
However, the best formal deﬁnition of such a distribution is as
an orbit of mappings f:A→Bwith respect to the symmetric
groupSnacting on A. (Two mappings f,g∈BAdetermine the
same distribution if and only if they ‘diﬀer’ by a permutation ofthe apples.) By Theorem 37.1, the number of distributions is
1
n!n/summationdisplay
k=0ck(Sn)xk,
whereck(Sn) is the number of permutations of nletters with ex-
actlykcycles. In Chapter 13, the numbers ck(Sn) were called the
signless Stirling numbers of the ﬁrst kind, and denoted by c(n,k ).
By Theorem 37.2, for every nonnegative integer x,
(x+n−1)(n)=n/summationdisplay
k=0ck(Sn)xk,
and hence this must hold as a polynomial identity. We have there-fore re-proved the formula (13.7).
TakeGto beS
non ann-setA, letBbe ﬁnite and let wbe
the insertion of Binto the polynomial ring Q[B]. Here the weight
of a mapping f:A→Bis a monomial and two mappings are
equivalent, that is, represent the same conﬁguration, if and only if
---PAGE BREAK---
37. P´ olya theory of counting 535
they have the same weight. The conﬁguration counting series
(37.5)/summationdisplay
W(f)=ZSn/parenleftBigg/summationdisplay
b∈Bb,/summationdisplay
b∈Bb2,...,/summationdisplay
b∈Bbn/parenrightBigg
expresses the so-called homogeneous-product-sum symmetric func-
tions as a polynomial in the power-sum symmetric functions. Forexample, with n= 3 andB={X,Y},
6(X
3+X2Y+XY2+Y3)=
(X+Y)3+3 (X+Y)(X2+Y2)+2 (X3+Y3).
Withn= 4 andB={X,Y,Z}, (37.5) expresses
/summationdisplay
i+j+k=4XiYjZk
as a polynomial in
X+Y+Z, X2+Y2+Z2,X3+Y3+Z3,andX4+Y4+Z4.
Notes.
We remark that ZSn(X1,...,Xn) is the coeﬃcient of Ynin
exp/parenleftbigg
X1Y+1
2X2Y2+1
3X3Y3+···/parenrightbigg
as an element of (Q[X 1,X2,...])[[Y]].
The answers provided by P´ olya theory have the advantage (over
inclusion-exclusion, say) that the formula produced is the sum ofpositive terms rather than an alternating sum.
G. P´ olya (1887–1985) was a Hungarian mathematician whose
bookProblems and Theorems in Analysis written in 1924 with G.
Szeg˝ o is still a classic. But he is perhaps best known for How to
Solve It, which has sold more than one million copies. He wrotepapers on number theory, complex analysis, combinatorics, proba-bility theory, geometry and mathematical physics.
References.
N. G. de Bruijn (1964), P´ olya’s theory of counting, in: E. F. Beck-
enbach (ed.), Applied Combinatorial Mathematics , Wiley.
F. Harary and E. D. Pulver (1966), The power group enumeration
theorem, J. Combinatorial Theory 1.
---PAGE BREAK---
38
Baranyai’s theorem
In this chapter we shall give an elegant application of the integrality
theorem on ﬂows to a problem in ‘combinatorial design’.
Example 38.1. Suppose we have been entrusted to draw up a
schedule for the ‘Big Ten’ football teams. Each weekend they are
to divide into 5 pairs and play. At the end of 9 weeks, we wantevery possible pair of teams to have played exactly once.
Here is one solution. Put 9 teams on the vertices of a regular
9-gon and one in the center. Start with the pairing indicated belowand obtain the others by rotating the ﬁgure by multiples of 2 π/9.
0
1
2
3
4 5678
x
Explicitly, here is the schedule:
x••0
1••8
2••7
3••6
4••5x••1
2••0
3••8
4••7
5••6x••2
3••1
4••0
5••8
6••7x••3
4••2
5••1
6••0
7••8x••4
5••3
6••2
7••1
8••0x••5
6••4
7••3
8••2
0••1x••6
7••5
8••4
0••3
1••2x••7
8••6
0••5
1••4
2••3x••8
0••7
1••6
2••5
3••4
There are many other ways to do this. For example, start with theinitial pairing shown below.
---PAGE BREAK---
38. Baranyai’s theorem 537
0
1
2
3
4 5678
x
A perfect matching in a graph is also called a 1-factor. A parti-
tion of the edge set of a graph into 1-factors is a 1-factorization .I n
the above example, we constructed 1-factorizations of K10. There
are 396 nonisomorphic 1-factorizations of K10, a computer result of
E. N. Gelling (1973). See also Mendelsohn and Rosa (1985).
Example 38.2. Let Γ be any abelian group of odd order. Consider
the complete graph on the vertex set Γ ∪{∞}.F o r g∈Γ, let
Mg:={{g,∞}}∪{{a,b}:a+b=2g,aLnegationslash=b}.
Then{Mg:g∈Γ}is a 1-factorization of the complete graph.
We consider the following generalization of this problem: let us
use the term parallel class ofk-subsets of an n-set to mean a set
ofn/k k -subsets which partition the n-set. Can the set of all k-
subsets be partitioned into parallel classes of k-subsets? Of course,
this necessitates that kdividesn. The number of parallel classes
required would bek
n/parenleftbign
k/parenrightbig
=/parenleftbign−1
k−1/parenrightbig
.
This was not hard for k= 2. It is much harder for k=3 ,
but was done by R. Peltesohn in 1936, and for k= 4 by J.-C.
Bermond (unpublished). The reader might try to ﬁnd appropriate
parallel classes for n=9 ,k= 3. It is certainly not clear that our
generalization always admits a solution and so it was surprisingwhen Zs. Baranyai proved Theorem 38.1 in 1973. All known proofsuse a form or consequence of Theorem 7.2 or 7.4. The proof wegive is due to A. E. Brouwer and A. Schrijver (1979).
Theorem 38.1. Ifkdividesn, the set of all/parenleftbig
n
k/parenrightbig
k-subsets of
ann-set may be partitioned into disjoint parallel classes Ai,i=
1,2,...,/parenleftbign−1
k−1/parenrightbig
.
Proof: In this proof, we will use the term m-partition of a setX
for a multiset Aofmpairwise disjoint subsets of X, some of which
---PAGE BREAK---
538 A Course in Combinatorics
may be empty, whose union is X. (The normal use of ‘partition’
forbids the empty set, but it is important here to allow it to occur,
perhaps with a multiplicity, so that the total number of subsets ism.)
In order to get an inductive proof to work, we prove something
seemingly stronger than the original statement. Let nandkbe
given, assume kdividesn, and let m:=n/k,M:=/parenleftbig
n−1
k−1/parenrightbig
.W e
assert that for any integer plscript,0≤plscript≤n, there exists a set
A1,A2,...,AM
ofm-partitions of {1,2,...,plscript}with the property that each subset
S⊆{1,2,...,plscript}occurs in exactly
(38.1)/parenleftbiggn−plscript
k−|S|/parenrightbigg
of them-partitions Ai. (The binomial coeﬃcient above is inter-
preted as zero if |S|>k, of course, and for S=∅, them-partitions
containing ∅are to be counted with multiplicity equal to the num-
ber of times the empty set appears.)
Our assertion will be proved by induction on plscript. Notice that it is
trivially true for plscript= 0, where each Aiwill consist of mcopies of
the empty set. Also notice that the case plscript=nwill prove Theorem
38.1, since the binomial coeﬃcient in (38.1) is then
/parenleftbigg0
k−|S|/parenrightbigg
=/braceleftbigg1i f|S|=k,
0 otherwise.
Remark. This somewhat technical statement is not really more
general, but would follow easily from Theorem 38.1. If Mparallel
classes exist as in the statement of Theorem 38.1, then for anysetLofplscriptpoints of X, the intersections of the members of the
parallel classes with Lwill provide m-partitions of Lwith the above
property.
Assume for some value of plscript<n thatm-partitions A
1,...,AM
exist with the required property. We form a transportation networkas follows. There is to be a source vertex σ, another named A
i
---PAGE BREAK---
38. Baranyai’s theorem 539
for eachi=1,2,...,M , another vertex named Sfor every subset
S⊆{1,2,...,plscript}, and a sink vertex τ. There is to be a directed edge
fromσto eachAiwith capacity 1. There are to be directed edges
fromAito the vertices corresponding to members of Ai(usejedges
to∅,i f∅occursjtimes inAi); these may have any integral capacity
≥1. There is to be a directed edge from the vertex corresponding
to a subset Stoτof capacity
/parenleftbiggn−plscript−1
k−|S|−1/parenrightbigg
.
We exhibit a ﬂow in this network: assign a ﬂow value of 1 to the
edges leaving σ, a ﬂow value of ( k−|S|)/(n−plscript) to the edges from
Aito each of its members S, and a ﬂow value of/parenleftbign−plscript−1
k−|S|−1/parenrightbig
to the
edge from Stoτ. This is easily checked to be a ﬂow: the sum of
the values on edges leaving a vertex Aiis
/summationdisplay
S∈Aik−|S|
n−plscript=1
n−plscript/parenleftBig
mk−/summationdisplay
S∈Ai|S|/parenrightBig
=1
n−plscript(mk−plscript)=1.
The sum of the values on the edges into a vertex Sis
/summationdisplay
i:S∈Aik−|S|
n−plscript=k−|S|
n−plscript/parenleftbiggn−plscript
k−|S|/parenrightbigg
=/parenleftbiggn−plscript−1
k−|S|−1/parenrightbigg
.
Since all the edges leaving σare saturated, this is a maximum ﬂow
and has strength M. The edges into τare also saturated in this
ﬂow, and hence in any maximum ﬂow.
---PAGE BREAK---
540 A Course in Combinatorics
By Theorem 7.2, this network admits an integral -valued maxi-
mum ﬂow f. All edges leaving σwill be saturated, so it is clear
that for each i,fassigns the value 1 to one of the edges leaving
Aiand 0 to all others. Say fassigns 1 to the edge from Aito its
memberSi. For each subset S, the number of values of isuch that
Si=Sis/parenleftbign−plscript−1
k−|S|−1/parenrightbig
.
(The desired integral ﬂow fcould also have been obtained with-
out explicitly introducing capacities and using Theorem 7.2, but
simply by applying Theorem 7.4 to the exhibited rational ﬂow com-pleted to a circulation with the aid of an extra edge from τtoσ
with ﬂow value M.)
Finally, we obtain a set of m-partitions A
Lprime
1,...,ALprime
Mof the set
{1,2,...,plscript +1}by letting ALprime
ibe obtained from Aiby replacing the
distinguished member SibySi∪{plscript+1},i=1,...,M . Readers
should check that each subset Tof{1,2,...,plscript +1}occurs exactly
/parenleftbiggn−(plscript+1 )
k−|T|/parenrightbigg
times among ALprime
1,...,ALprime
M. This completes the induction step. /square
Problem 38A. Letvandube integers with v≥2uandveven,
and consider the complete graph Kuas a subgraph of Kv. Suppose
the edges of Kuare colored with v−1 colors so that distinct edges of
the same color are disjoint. Show that this coloring can be extended
to a coloring of E(Kv) withv−1 colors so that edges of the same
color are disjoint. (Such a coloring of E(Kv) is equivalent to a
1-factorization of Kv, with the edges of any given color forming a
1-factor.)
Notes.
Zsolt Baranyai (1948–1978) was a Hungarian mathematician who
was also a professional recorder player. He toured Hungary with
theBarkfark Consort giving concerts and died in a car accident on
a country road after one of them. His mathematical work includedmany other wonderful results on ‘complete uniform hypergraphs’.
One-factorizations of complete graphs are related to symmetric
Latin squares—see Chapter 17. The result of Problem 38A is due
---PAGE BREAK---
38. Baranyai’s theorem 541
to Cruse (1974). Generalizations may be found in Baranyai and
Brouwer (1977).
References.
Zs. Baranyai and A. E. Brouwer (1977), Extension of colourings of
the edges of a complete (uniform hyper) graph, Math. Centrum
Dep. Pure Math. ZW. 91, 10 pp.
A. E. Brouwer and A. Schrijver (1979), Uniform hypergraphs, in:
A. Schrijver (ed.), Packing and Covering in Combinatorics,
Mathematical Centre Tracts 106, Amsterdam.
A. Cruse (1974), On embedding incomplete symmetric Latin
squares, J. Combinatorial Theory (A)16, 18–22.
E. N. Gelling (1973), On 1-factorizations of the complete graph and
the relationship to round robin schedules, M.Sc. Thesis, Univer-sity of Victoria.
E. Mendelsohn and A. Rosa (1985), One-factorizations of the com-
plete graph—a survey, Journal of Graph Theory 9.
R. Peltesohn (1936), Das Turnierproblem f¨ ur Spiele zu je dreien,
Dissertation Berlin, August Pries, Leipzig.
---PAGE BREAK---
Appendix 1
Hints and comments
on problems
Problem 1A. Show that the/parenleftbig5
2/parenrightbig
pairs from {1,..., 5}can be used
to label the vertices in such a way that a simple rule determines
when there is an edge. To ﬁnd the full automorphism group, con-sider the subgroup that ﬁxes a vertex and its three neighbors. Thisgraph is known as the Petersen graph. It was ﬁrst studied by the
Danish mathematician J. P. C. Petersen (1839–1910). See alsoChapter 21.
Problem 1B. Let the vertex set Vbe the disjoint union of V
1and
V2, with no edges from V1toV2. What is the maximum number of
edges possible?Problem 1C. Use (1.1). (i) Consider a vertex of degree 1; use
induction. (ii) A circuit has as many edges as vertices; if the graph
is connected, every vertex has degree ≥1.
Problem 1D. Call the vertices a
1,a2,a3andb1,b2,b3. First, omit
a3and show that there is only one way to draw the graph with the
remaining six edges in the plane. A better way is to use Euler’sformula (see Chapter 33).
Problem 1E. Each color occurs an even number of times in a cir-
cuit. See J. A. Bondy, Induced subsets, J. Combinatorial Theory
(B)12(1972), 201–202. The problem can also be formulated as
follows. Given a square (0 ,1)-matrix with distinct rows, it is pos-
sible to delete a column so that the resulting matrix has distinct
rows. This fact can also easily be proved by induction.
Problem 1F. Consider the vertices at distance 2 from a ﬁxed
---PAGE BREAK---
Hints and comments on problems 543
vertex. See Fig. 1.4.
Problem 1G. Use the pigeonhole principle.
Problem 1H. Consider when aij=ajk=1 .
Problem 1I. Find an inductive procedure for constructing the
required circuit.Problem 1J. For (i), establish a one-to-one correspondence be-
tween the vertices adjacent to xand those adjacent to y.
Problem 2B. Any ordering of 22335 works.
Problem 2C. LetA
ibe the number of spanning arborescences
withxias root and denote byrithe number of edges out of xi.
The assertion can be proved by showing that the number of diﬀerent
Eulerian circuits in Gis
AiΠn
j=1(rj−1)!.
To do this, take i= 1 and consider some spanning arborescence
withx1as root. Fix some edge out of x1as the ﬁrst edge of an
Eulerian circuit. Number the other edges out of x1arbitrarily. For
i=2,3,...,n , number the edges out of xiarbitrarily but such
that the edge of the spanning arborescence has number ri. This
numbering leads in a natural way to the construction of an Eulerian
circuit and this process can be reversed. See Chapter 9 of J. H.van Lint, Combinatorial Theory Seminar Eindhoven University of
Technology, Lecture Notes in Mathematics 382, Springer-Verlag,
1974.
Problem 2D. One approach is as follows. Show that T
nhas the
property that for each of its edges a,ahas ends in diﬀerent com-
ponents of G:{e∈E(G):c(e) <c(a)}. Then show that any
spanning tree Twith this property is a cheapest spanning tree.
Problem 2E. There is only one way to obtain the diﬀerence n−1,
etc.Problem 2F. Use Problem 1C.
Problem 2G. Show that if Gis a graph with this property, there
is a graph G
Lprimewith the same property, the same number of edges,
---PAGE BREAK---
544 A Course in Combinatorics
and in which the vertex of degree mis connected to all other ver-
tices with degree >1. Then use induction ( m→m+ 2). The
construction can be done inductively by the same idea.
Problem 3A. For part (ii), if the conclusion fails, then Hcan
be written as the union of two edge-disjoint subgraphs A,B which
intersect in two vertices s,t. Apply the induction hypothesis to
graphsALprime,BLprimeobtained by adding an edge joining s,ttoA,B,r e -
spectively.Problem 3B. It is possible to use the same type of argument as
given for K
6(below this problem). Show that there must be a
vertex that is in two monochromatic triangles. Then, argue on the
remaining six vertices. The argument will be long and tricky. Thereader who has cheated and has read on, knows the Corollary toTheorem 3.2.
Problem 3C. Call the terms, both even, on the right-hand side n
1
andn2. Suppose equality holds and consider a graph with n1+n2−1
vertices. If there is no red Kpand no blue Kq, what is the red-degree
of any vertex? How many red edges are there in this graph?Problem 3D. InZ
17consider ±2i, withi=0,1,2,3. For the
other problem use Z13. Apply (3.4).
Problem 3E. (a) Fix a vertex and consider all edges to, respec-
tively from, this vertex. Pick the larger set and use induction.
(b) Use the probabilistic method. A solution can be found in
Theorem 1.1 of P. Erd˝ os and J. Spencer (1974), where this problem
is used to illustrate the method.
Problem 3F. Take as vertices {1,2,...,n}. Color{i,j}with the
color of|i−j|.To avoid a triple for two colors, if 1 is red, then 2
must be blue and hence 4 must be red, etc. N(2) = 5. Separate two
such 2-colored conﬁgurations by ﬁve numbers with a third color to
estimateN(13). See I. Schur, ¨Uber die Kongruenz xm+ym≡zm
(modp),Jber. Deutsche Math. Ver. 25(1916), 114–116.
Problem 3G. Color with four ‘colors’ as follows:
{i,j} Lmapsto→(aij,aji)(i<j).
---PAGE BREAK---
Hints and comments on problems 545
Problem 3H. Use the argument that was used for K6and two
colors.
Problem 3I. Let the color depend on ν(mod 3). Show that the
sum of two cubes in F⋆
16is not a cube.
Problem 3J. Consider a maximal subgraph with the required
property and then count the vertices not in that subgraph.
Problem 3K. Consider vertices of a ﬁxed color and delete edges
in such a way that recoloring is possible.
Problem 4A. (i) ColorK10in such a way that red corresponds
to an edge of G, blue to a nonedge. There are triangles with 3 red
edges, 2 red and 1 blue, 2 blue and 1 red, and ﬁnally with 3 blue
edges. Let ai(i=1,2,3,4) be the numbers of these. Set up a
system of equations and inequalities for these numbers, expressedin the degrees of the vertices of G. These should show that there
are at least four triangles in Gand equality can then be excluded,
again by looking at the equations.
(ii) A second solution is as follows. Show there is a triangle.
Then consider a triangle, the ary 7-set, and edges in between. Thisgives a number of new triangles of two types; estimate it.
Problem 4B. Use induction. First review the proof of Theorem
4.1.Problem 4C. The number of triangles on an edge awith ends x
andyis at least deg( x) + deg(y )−n. Sum this over all edges a.
Problem 4D. Fix any vertex xand letD
idenote the set of ver-
tices at distance ifromxinG.
Forg=2t+1 ,|V(G)|≥1+r +r(r−1) +···+r(r−1)t−1since
it is easy to see that |Di|=r(r−1)i−1fori=1,2,...,t .
Forg=2t, we still have |Di|=r(r−1)i−1fori=1,2,...,t−1.
We can also get a lower bound |Dt|≥r−1
rDt−1since each vertex
y∈Dt−1is adjacent to r−1 vertices in Dtwhile a vertex y∈Dt
can of course be adjacent to at most rvertices in Dt−1.
Problem 4E. The graph is bipartite.
Problem 4F. By Theorem 4.3, there exists a Hamiltonian circuit
H. Assume that Hdoes not contain an edge ewith ends xandy.
---PAGE BREAK---
546 A Course in Combinatorics
LetxLprime, respectively yLprime, be the successors of x, respectively y,o nH.
Consider the path PfromxLprimetoyalongH, then along {y,x}, and
fromxtoyLprimealongHin the reverse direction. If the edge {xLprime,yLprime}is
inG, we are done. If not, argue as in the proof of Theorem 4.3 to
show that Pcan be completed to a circuit by removing one edge
and adding two others.
For a further generalization, see L. Lov´ asz (1979).
Problem 4G. Show that the maximum value of Soccurs when
zi>0 only on points of a clique.
Problem 4H. Count pairs of edges with a common vertex in two
ways.
Problem 5A. (i) GivenA⊆X, one side of a bipartition, count
the number of edges that have one end in Aand the other in Γ( A).
(ii) A trivalent graph with no perfect matching is the graph on
four vertices and six edges with one vertex incident with three non-
loops and loops incident with the other three vertices. Replace theloops by appropriate simple graphs.
(iii) Same hint as for part (i).
Problem 5B. Construct a sequence of sets A
iof sizemiusing new
elements only when it is necessary to keep condition Hsatisﬁed. A
solution is given on p. 41 of Van Lint (1974).
Problem 5C. Use induction on the number of nonzero entries of
the matrix. The argument of Theorem 5.5 can be used similarly.Problem 5D. Theorem 5.5.
Problem 5E. Express the number of SDR’s with 1, respectively
2, representing A
1in terms of Siwithi<n. See Problem 14A.
Problem 5F. Count the number of sets {x1,x2,...,xn}withxk∈
Akfor allkand withxi=xj.
Problem 5G. (i) is easy but (ii) gets messier. Consult Example
10.1Problem 6A. Deﬁne a poset using both the index and the size of
the integers a
i.
---PAGE BREAK---
Hints and comments on problems 547
Problem 6B. (i) Consider AandA. (ii) Let xbe in all the sets.
Problem 6C. Show that large sets can be replaced by their com-
plements, and apply Theorem 6.5.
Problem 6D. (i) No two of the subsets are in the same chain. (ii)
Use induction.Problem 6E. See C. Greene and D. Kleitman, Strong versions of
Sperner’s Theorem, J. Combinatorial Theory (A)20(1976), 80–88.
Problem 7A. This is a straightforward application of the algo-
rithm. The minimum cut capacity is 20.Problem 7B. Given a ﬂow fwith nonzero strength, show that
the edges ewithf(e)Lnegationslash= 0 contain the edges of a simple directed
path from stot. Subtract a scalar multiple of the corresponding
elementary ﬂow to obtain a ﬂow f
Lprimewhich vanishes on more edges
thanfand proceed by induction.
Four vertices suﬃce for the required example.
Problem 7C. Consider a maximum ﬂow f. From Equation (7.1),
edges from XitoYiare saturated and edges from YitoXihave
zero ﬂow value.Problem 7D. Given the bipartite graph Gwith vertices X∪Y,
construct a network by adding two vertices sandt, edges directed
fromsto elements of Xof capacity 1, and edges directed from
elements of Ytotof capacity 1. Direct all original edges from X
toY; it is convenient to assign them a large capacity, say |X|+1 ,
so that no such edges are present in a minimum cut. Explain why
there exists a complete matching from XtoYinGif and only if
this network has maximum ﬂow strength X.
Problem 7E. For (iv), apply Theorem 7.2, with d= 2, to the
incidence matrix of the graph. (This result is also a quick conse-quence of Theorem 1.2.) For (v), consider the bipartite incidence
matrixMof a bipartite graph G, which is deﬁned as follows. Say
Ghas bipartition ( X,Y). The rows of Mare indexed by the ver-
tices inX, and the columns of Mare indexed by the vertices in Y.
The entry in row x∈Xand column y∈Yis the number of edges
joiningxandy(0 or 1 ifGis a simple graph).
---PAGE BREAK---
548 A Course in Combinatorics
Problem 7F. LetTbe a spanning tree in D. Show that for any
assignment of real numbers to the |E(D)|−|V(D)|+ 1 edges of D
notinT, there is a unique way to extend this to a circulation fon
D. It may be useful to remember that a tree with at least one edge
has a monovalent vertex.
Problem 8A. Assume that some subsequence of nconsecutive
elements occurs twice. Show that αsatisﬁes an equation of degree
less thann.
Problem 8B. The vertices of the digraph are the ordered pairs
from{0,1,2}; the edges are the 27 ordered triples.
Problem 8C. The sequence must contain four 0’s and four 1’s.
Three consecutive 0’s force 00010111 which does not work; the pair
00 must occur twice and this then forces 00110011 which does notwork either.
Problem 8D. Since every vertex in G
nhas indegree 2 and outde-
gree 2, we do get a closed path from 00 ...0t o0 0...0. The ﬁnal
edge must come from 10 ...0 (which we identify with the integer
1 in binary). The fact that this edge is used implies that the edge
from 1 = 10 ...0t o0...01 has already been used. So, we came into
the vertex 1 twice, i. e. from 2 = 010 ...0 and from 3 = 110 ...0.
For the same reason as above, both 2 and 3 were entered twice.Proceeding by induction, we see that all vertices were visited twiceon the path through G
n, proving the assertion.
Problem 9A. Apply the algorithm.
Problem 9B. A trivial addressing of length nas in Theorem 9.2
is easily found. What is the diameter of the graph?
Problem 9C. Use Theorems 9.1 and 9.6. Somewhere in the calcu-
lation/summationtextkcos(kx) will appear. This is the derivative of/summationtextsin(kx )
and that sum is determined by multiplying by sin(1
2x).
Problem 9D. See Theorem 9.7.4.
Problem 10A. Use Theorem 10.1, where Ei(i=1,2,3,4) are the
integers≤1000 divisible by 2,3,5,7, respectively.
---PAGE BREAK---
Hints and comments on problems 549
Problem 10B. Use inclusion-exclusion and the fact that if f(i)=
0, then (x −i) dividesf(x).
Problem 10C. Use⌊x⌋=/summationtext
k≤x1 and Theorem 10.3.
Problem 10D. Multiply/summationtextann−sand/summationtextbmm−s. Determine the
coeﬃcient of k−s, and use Theorem 10.3.
Problem 10E. Determine/summationtext
d|nlogfd(z); use Theorem 10.3 or
10.4.
Problem 10F. There are clearly 2n + 1 colorings. Use inclusion-
exclusion where a set Eiconsists of colorings with ired andi−1
blue. To determine Nj, use Example 10.6.
For a direct solution, calculate
∞/summationdisplay
n=0n/summationdisplay
k=0(−1)k/parenleftbigg2n−k
k/parenrightbigg
22n−2kx2n.
To do this, use (10.6) and the fact that/summationtext(2n+1 )x2n=(x
1−x2)Lprime.
Problem 10G. Use Theorem 10.1.
Problem 10H. Count permutations of 1 ,2,...,n that ﬁx none of
1,2,...,n−k.
Problem 11A. Consider an all-one matrix of size nbyk. Adjoin
a column of 0’s and then complete to a square matrix by adding
rows of type (0 ,...,0,1).
Problem 11B. (i) Theorem 5.3; (ii) Theorem 11.5; (iii) use a
direct product of matrices Jk.
Problem 11C. Determine A=(aij) withaij=|Ai∩Bj|.T o
ﬁnd the permanent of this matrix, compare with the probl` eme des
m´enages.
Problem 11D. Use Theorem 11.7.
Problem 11E. Calculate the corresponding permanent Bnby ex-
panding by the ﬁrst row and column. Show that Bn=Bn−1+
---PAGE BREAK---
550 A Course in Combinatorics
Bn−2−2. So{Bn−2|n≥3}is a Fibonacci sequence. Also see
Problem 5E.
Problem 12A. Use Theorem 12.1.
Problem 12B. SupposeAALlatticetopis decomposable. Explain the block
of 0 entries by considering some row of A, its nonzero entries, and
the inner products with other rows.Problem 12C. Do four averaging operations on pairs of rows and
similarly for columns. Note that the element a
55does not change
during these operations. Determine the permanent and minimize.
This shows that the matrix was1
5Jfrom the start.
Problem 13A. Use Theorem 13.1.
Problem 13B. (i) Multiply two powers of (1 −x). (ii) Let kbe
in position a+ 1; what can precede this term?
Problem 13C. (i) Choose A1and then choose A2as a subset
of its complement; determine the sum of products of binomial co-eﬃcients. (ii) Consider a 2 by nmatrix for which the rows are
the characteristic functions of A
1, respectively A2. Translate the
condition on A1andA2to a condition on this matrix.
Problem 13D. First, ﬁx the union Uof the sets in A. Apply
Example 13.6 and then sum over all choices of U. The answer
shows that we could have found a better solution. To ﬁnd thisbetter solution, again depict Aby a (0,1)-matrix of size kbyn.
To this matrix adjoin a ‘special’ row, namely the characteristicfunction of the union of the sets of A. Calculate the number of
these (0,1)-matrices that hav ea1i nas p eciﬁed position in their
‘special’ row.
Problem 13E. In each path, consider the laststep of type ( x,y)→
(x+1,y+ 1). Use Theorem 13.1. For the last question, insert k
balls inton+kpossible positions; let x
kbe the length of the interval
preceding the k-th ball.
Problem 13F. (i) Prove by induction. If a permutation of 1 to
n−1 is written as a product of cycles, there are nways to adjoin
---PAGE BREAK---
Hints and comments on problems 551
the element n, one of which has one more cycle. (ii) In Theorem
13.7, sum both sides over k; use (13.5).
Problem 13G. Insert (13.13) into (13.11) and change the order
of summation.
Problem 13H. Use (10.6).
Problem 13I. Use the relation F(a)=G(a) of page 123.
Problem 13J. Use the binomial formula with x=ζ, whereζ3=
1.Problem 13K. Count partitions of an n-set into n−2 parts di-
rectly.Problem 14A. (i) The sequences end in 10 or in 1. Establish the
Fibonacci recursion and solve by trying a
n=tnas a solution (use
linearity). The method of Example 14.3 also can be used.
(ii) Express bnin terms of the numbers cnof such sequences end-
ing in a 1. Find a recurrence for cn. The constant cwill be the
largest root of a polynomial equation of degree 4; it is approxi-
mately 1.22075.
Problem 14B. Consider a trivalent planted plane tree T. Make
a new tree TLprimeas follows. Take as vertices the root of Tand all its
vertices of degree 3. Join two vertices in TLprimeif there is a path from
one to the other in Tusing exactly one edge with slope to the left
(see Figure 14.3). Finally, add a new root at the bottom. Show
how to reverse this mapping. Show that the number of vertices ofT
Lprimeequals the number of vertices of degree 1 in T. See p. 25. of J. H.
van Lint Combinatorial Theory Seminar, Eindhoven University of
Technology , Lecture Notes in Mathematics 382, Springer–Verlag,
1974.
Problem 14C. Fix one edge; number others cyclicly: a,b,c,... .
Give the chords the obvious names; be careful about the order in
which these names are given. See also p. 25. of Van Lint (1974),ibid.
Problem 14D. Use the method of Fig. 2.2. One ﬁxed point pro-
duces an arborescence; the remainder is a mapping with no ﬁxedpoints. See (14.15). Take M
1(0) = 1,A(0) = 0.
---PAGE BREAK---
552 A Course in Combinatorics
Problem 14E. Fix an edge and then consider the quadrilateral
that it belongs to. The other three sides divide the ( n+1)-gon into
possibly empty polygons; see (14.10). Solve f=x+f3by applying
Theorem 14.3.
A combinatorial proof that the number of ways of dividing an
(n+ 1)-gon into quadrangles by nonintersecting diagonals is 0 if n
is even, and1
3k+1/parenleftbig3k+1
k/parenrightbig
ifn=2k+ 1, can be given as follows. Since
the case of even nis trivial, we assume n=2k+ 1. There are k−1
diagonals and kquadrangles in the dissection. Put a vertex in each
quadrangle and on each edge; ﬁx one edge-vertex as a root. Vertices
of quadrangles are joined by an edge if the quadrangles share adiagonal; an edge-vertex is joined to the quadrangle-vertex of itsquadrangle. Describe a walk around the tree, that was just deﬁned,by a sequence of symbols xandy, where we use an xevery time we
reach a quadrangle vertex not visited before, and similarly a yfor
edge-vertices. We ﬁnd a sequence of ksymbolsxand 2k+1 symbols
y. We know, see Example 10.6, that there are
1
3k+1/parenleftbig3k+1
k/parenrightbig
circular
sequences of this type. It remains to show a one-one correspondencebetween these circular sequences and the sequences describing thetrees. Describe the x,ysequence as follows: an xcorresponds to a
step in the X-Yplane one unit to the right and one unit upwards;
ayto a step one unit to the right and k/(2k+ 1) steps downward.
The walk starts in (0,0) and ends in (3 k+1,0), never meeting
theX-axis in between. If we describe a circular sequence of the
given type in the same way, it will have a unique minimum because
(k,2k+ 1) = 1. This will give us the unique starting point to make
it correspond to one of the trees.
Problem 14F. See Appendix 2 on formal operations. Take loga-
rithms and use Theorem 10.3.Problem 14G. Show equivalence with Example 14.11.
Problem 14H. Make a path as in Example 14.8 and ﬁnd a lowest
point.Problem 14I. (i) See (14.10). (ii) Put a vertex on the circle, say
between 1 and 2n. This will be the root of a tree. Put a vertex in
each region and join vertices in the obvious way. Show equivalencewith one of the Catalan problems. See Van Lint (1974), p.26.
---PAGE BREAK---
Hints and comments on problems 553
Problem 14J. A labeled regular graph of valency 2 is a union of
(labeled) polygons. Apply Theorem 14.2.
Problem 14K. Call the number of walks A4nand deﬁne A(z): =
1+/summationtext∞
n=1A4nz4n.I fB2nis the number of walks from (0,0) to ( n,n)
that avoid points ( i,i), then we know from (14.12) that B(z): =/summationtext∞n=1B2nz2n=1−√
1−4z2. Find a relation between A(z) and
B(z) by considering the ﬁrst crossing of x=yfor each walk.
It is also possible to prove the result by ﬁnding a one to one
mapping from the walks counted by A4nto the walks counted in
Example 14.8. This is diﬃcult. For a solution see the solution to
Problem 3096 by W. Nichols in American Mathematical Monthly
94(1987).
Problem 14L. Show that an=3an−1−an−2and thatF2nsatisﬁes
the same recurrence.
Problem 14M. Forgwithkﬁxed points, count their number and
the number of appropriate fand sum over k; forfwith image of
sizei, split{1,2,...,r}into preimages, count the fand the number
of appropriate g; sum over i. Use (13.9) and (13.11). This is the so-
lution to Problem 3057 of the American Mathematical Monthly 94
(1988), given by J. M. Freeman, S. C. Locke, and H. Niederhausen.Problem 14N. Introduce b
k,n:= the number of walks from (0,0)
to (n,n) that meet the line x=yfor the second time in ( k,k).
Problem 15A. Distinguish between xk= 1 andxk>1, in which
case takeyi=xi−1. Use induction.
Problem 15B. LetE,I, andSdenote the number of equilateral,
isosceles, and scalene triangles, respectively. Calculate E,I+E,
and express/parenleftbign
3/parenrightbig
inE,I, andS.
(This proof is due to J. S. Frame, Amer. Math. Monthly 47,
(1940), 664.)Problem 15C. Use partial fractions. Find cusing the coeﬃcient
of (1−x)
−tand (10.6).
Problem 15D. Count the compositions of nintokparts which
h a v ea3i np ositionj. Do this for all jand sum; (a composition
withmparts 3 is thus counted mtimes).
---PAGE BREAK---
554 A Course in Combinatorics
A second solution with a more general result is as follows. First
show that in a list of all possible compositions there are exactly
(n+1 )· 2n−2integers. This can be done using the argument with
the red balls. Then prove by induction on nthat for 1 ≤m<n
a list of the 2n−1compositions of ncontains the integer mexactly
(n−m+ 3)2n−m−2times. For this, use the formula 1 +/summationtextn−1
k=1(k+
3)2k−2=(n+1 )· 2n−2which is also shown by induction.
Problem 15E. Leave out the ﬁrst column.
Problem 15F. For the unequal odd parts, use ‘hook’ shaped ﬁg-
ures to form a Ferrers diagram and read this in the usual way.
Problem 15G. Show a correspondence with Example 14.8.
Problem 15H. See Chapter 13.
Problem 15I. Generalize Theorem 15.4.
Problem 15J. Apply Theorem 15.10 to an n×nsquare.
Problem 16A. Use induction; compare two initial segments of r
ands.
Problem 16B. Determine the ﬁrst column of a matrix with row-
sumrand column-sum r∗. Use induction.
Problem 16C. Use Problem 16A and switch edges. Another pos-
sibility is to describe the graph by its adjacency matrix and use the
same idea as in the proof of Theorem 16.2.
Problem 16D. Estimate the number of solutions of s1+···+sn=
1
2n2by just using the fact that each siis at most n.
Problem 16E. For the ‘if’ part, ﬁrst note that there exists a tour-
nament with degree sequence (n −1,..., 2,1,0). Then use Problem
16A. Show that if in a tournament the outdegree of xis greater
than the outdegree of y, then there is a tournament on the same
vertex set and with the same outdegrees except that outdegree of x
is one less than it was originally, and the outdegree of yis 1 greater.
One can do this by changing the directions on at most two edges.Problem 16F. For the generalization, one considers the hyper-
graph given by choosing the ﬁrst mof thek-subsets in lexicograph-
ical order. For the ‘if’ parts, again use Problem 16A.
---PAGE BREAK---
Hints and comments on problems 555
Problem 16G. A(5,3) =A(5,2). See (16.2). Counting directly is
possible as follows: (i) Fix the ﬁrst row as (1 ,1,0,0,0); this means
that the ﬁnal result must be multiplied by 10. (ii) Put a 1 in
position (2,1); this means that we should also multiply by 4. (iii)Split into two cases: a 1 in position (2,2), etc. or a 1 in position(2,3), in which case a factor 3 is introduced, etc.
Another solution is obtained by observing that A
∗(5,2) has car-
dinality1
25!4! = 1440, and that there are (/parenleftbig5
2/parenrightbig
)2·3! = 600 decom-
posable matrices in A(5,2).
Problem 16H. In case 1, there are n−1 possible choices. In case
2, remove row 1 and column 1, substitute an element of A(n−1,2)
and in two ways then produce an element of A(n,2).
Problem 16I. Straightforward substitution.
Problem 17A. Index the ﬁrst two rows by xandy, the ﬁrst two
columns by uandv, all under the assumption that we have the
multiplication table of a group of order 5. Show that ( v−1u)2=1 .
Problem 17B. This is already diﬃcult, despite the small size of
the square! Take a= 1. Note that the 1 in the upper left-hand
corner is in subsquares of type/parenleftBig1i
i1/parenrightBig
fori=2,3,4,5. Consider
any Latin square with this property. If the (2,3) entry is not 4,
then permuting rows 4 and 5, columns 4 and 5, and symbols 4 and5, changes the square into an equivalent one with a 4 in position(2,3). At this point, there is only one way to complete the square.So, if a Latin square has any cell with a property like the one wementioned for the upper left hand 1, then it is equivalent to thisone.
Using the same kind of argument one can show that there are
only a few possibly inequivalent squares of order 5. For some, onethen has to establish the equivalence, a tedious task.
Problem 17C. At this point, trial and error is prescribed. How-
ever, see Chapter 22.Problem 17D. Suﬃciency is shown by an example (you can, but
do not have to, use Theorem 17.1). For necessity, observe that just
---PAGE BREAK---
556 A Course in Combinatorics
appending one more column to a Latin square of order mrequires
mnew symbols.
Problem 17E. Apply the algorithm.
Problem 17F. For part (i), describe an algorithm that recovers
the original Latin square of order nfrom the constructed Latin
square of order n+1 with constant back diagonal. For (ii), explain
why the number of Latin squares of order nwithn’s on the back
diagonal is equal to N(n)/n!.
Problem 17G. (a) Forn= 6, an example is 6, 1,5,2,4,3.
(b) Add the diﬀerences.
(c) Assume two pairs are equal and solve.
Problem 17H. Start by replacing the diagonal entries of the
smaller square by ( n+ 1)’s.
Problem 17I. See Example 10.6.
Problem 17J. (i) Use inclusion exclusion. If kintegers are in the
wrong place, write k=2i+jwhere there are ipairs in the wrong
place, etc.
(ii) UseJ−Iof sizen.
Problem 18A. To show this directly, argue as in Theorem 18.1
concerning the ﬁrst three rows. Show that no further row can startwith three +1’s. Hence, rows 5,6, and 7 all start with + + −
(why?). These can then be completed in a unique way, etc. Foranother solution, see Problem 19D.
Problem 18B. Use the method of Theorem 18.1. Note that a
permutation of rows and columns, that preserves the 0-diagonal,
does not help us to make a matrix symmetric or antisymmetric.So, only multiplications by −1 will do the job. Normalize the ﬁrst
row and make the ﬁrst column (except for the 0th entry) all 1 orall−1. It is now suﬃcient to show that the (2,3) entry and the
(3,2) entry are the same, respectively opposites, whenever n≡2
(mod 4), respectively n≡0 (mod 4).
Problem 18C. A trivial exercise!
Problem 18D. W e have 28 = 1+9+9+9 and 28 = 1+1+1+25.
Use the ﬁrst of these. Note that each W
ihas 1 on the diagonal
---PAGE BREAK---
Hints and comments on problems 557
and if it has wij= 2, then w7−i,jis also 2; similarly for −2. The
observation about occurrences of the Uiin the matrices Wjthen
completely forces the choice of the four matrices Wi. They prove
to work.
Problem 18E. Show by induction that M(i)
n...M(m)
n=H2m−i+1⊗
I2i−1.For the second part, count the number of non-zero elements
ofM(i)
n. See the reference E. C. Posner (1968).
Problem 18F. For both questions use induction.
Problem 18G. For (2), show that the number of rows with ﬁrst
coordinate 0 (or 1) is at most n.
Problem 18H. Straightforward; see Theorem 18.4.
Problem 18I. Review the properties of Q.
Problem 19A. For the isomorphism in part (i): Label the vertices
ofK6with 0000, 1000, 0100, 0010, 0001, 1111 in F4
2and label an
edge with the sum in F4
2of the labels on its ends. This gives a one-
to-one correspondence between the edges of K6and the 15 nonzero
vectors in F4
2.
For part (ii), consider conﬁgurations consisting of three edges
(there are four types). The construction is due to E. S. Kramer
(1990),Discrete Math. 81, 223–224.
Problem 19B. Calculate bi,i=3,2,1,0;b1/∈Z.
Problem 19C. This is Theorem 19.4.
Problem 19D. (i) LetNhave column-sums ci. Then/summationtextci=
66. The sum of all inner products of rows is/summationtext/parenleftbigci
2/parenrightbig
. Use the
Cauchy-Schwarz inequality. Conclude that all column-sums are 6and all inner products are 3. (ii) To show uniqueness, consider thecomplement: a 2-(11,5,2) design. Without loss of generality, theﬁrst row is (11111000000); the remaining ten rows start with the/parenleftbig
5
2/parenrightbig
pairs (110 ...), (1010...), etc. Then show that the rows 2 to
5 can be completed in one way. This leaves a 6 by 6 square to be
completed. At ﬁrst sight, there seem to be two ways to do this.Find a permutation that maps one into the other.
---PAGE BREAK---
558 A Course in Combinatorics
Problem 19E. Denote by aithe number of blocks that meet Bin
ipoints. Calculate/summationtextai,/summationtextiai, and/summationtext/parenleftbigi
2/parenrightbig
ai. Derive an inequality
fora0using the form/summationtext(i−c)2ai. Compare with Theorem 19.9.
Problem 19F. The mapping xLmapsto→2xhas six orbits, two of which
are too long to use (e.g. (1,2,4,8,16,11)). See Example 28.2.
Problem 19G. Use the corresponding orthogonal array. Use the
common {0,1}to{1,−1}mapping.
Problem 19H. For (1) use (19.2) or (19.4). For (3) count pairs
p,q /∈Bthat are contained in blocks that meet p. Thus ﬁnd the
parameters of DB. For (4), ﬁrst suppose that DBis a single block.
Consider Example 19.3. In the other case Fisher’s inequality yields
k≥(λ+ 1)(λ + 2). Now, express b0as a fraction in kandλand
deduce that kmust divide 2(λ + 1)(λ + 2).
Problem 19I. (i) Fix a point xonO. Count pairs ( y,L),y∈O,
La line through xandy. (ii) From (i) we see that if |O|=n+2 ,
then every line that meets O, meets it twice. Take a point z/∈O
and count the lines through zthat meet O. (iii) Take any four
points, no three on a line. These determine six lines, that togethercontain 19 points of the plane.
Problem 19J. Forp
1top5take (1,0,0), (0,1,0), (0,0,1), (1,1,1)
and (1,t,t2) and show that there are two ways to group these to
producep6=( 1,x,x2), wherex=t/(1 +t).
Problem 19K. LetB1∼B2. How many blocks meet B1? Take
x∈B1,y∈B2; how many blocks meet both B1andB2? There are
n+ 1 equivalence classes, each with nlines (blocks). To each class
append a point that is to be added as an extra point to each line
of that class, etc.
Problem 19L. Use Theorem 19.11. Consider the equation mod-
ulo 3.Problem 19M. Forveven, use quadratic forms, as in the proof
of Theorem 19.11. See J. H. van Lint and J. J. Seidel (1966),
Equilateral point sets in elliptic geometry, Proc. Kon. Nederl. Akad.
Wetensch. 69, 335–348.
---PAGE BREAK---
Hints and comments on problems 559
Problem 19N. (a) The method of Example 19.14 also works if
|V|= 1; (85 = 7(13 −1) + 1). (b) 15 = 7(3 −1 )+1 .
Problem 19O. Consider the n×bincidence matrix N, where
b=|A|. Check that in case (i), NLlatticetopNis nonsingular modulo 2. For
part (ii), let N1be obtained by adding column of all 1’s to N, and
show that NLlatticetop
1N1has rank at least bmodulo 2.
Problem 19P. The last of the displayed sums should evaluate to
zero. This implies each µii s1o r2 .
Problem 19Q. Use induction; start the induction with t=2 .
Count, in two ways, ordered triples ( x,A,B ) whereAandBare
distinct blocks, both of which contain the point x.
Problem 19R. Represent lines as in Example 19.6 and use the
fact that this is a cyclic representation. Distinguish diﬀerent cases
by the number of ‘ﬁrst’ elements used in the SDR.
Problem 19S. It is possible to give a construction using induction
onk, but it is quicker to give a direct construction using Fk
2as the
point set. Review Example 19.1.Problem 19T. Use the result of Problem 19H. The extensions
will appear in Chapter 20.Problem 19U. Apply Theorem 5.5.
Problem 20A. Use (20.5).
Problem 20B. Apply the pigeonhole principle to the last two bits
of the words. A binary code with three words is easily handled!Problem 20C. For each of the three ways in which the conditions
for a codeword can be violated, change a suitable coordinate to
remedy the situation.
Problem 20D. (i) The rows of the generator matrix correspond
to±a
i,i=1,...,n , where the aiare the rows of a Hadamard
matrix. Let u∈Fn
2, wheren=22k.B yu⋆we denote the ±1
representation. Calculate/summationtextLangbracketleftu⋆,aiLangbracketright2to ﬁnd the upper bound.
(ii) For equality, ﬁrst ﬁnd the weight of z. Then use the fact that
the codewords correspond to linear functions and adding a linear
function to xyields an equivalent quadratic form.
---PAGE BREAK---
560 A Course in Combinatorics
Problem 20E. (i) See Problem 20A. (ii) Count words of weight 5
‘covered’ by codewords of weight 7; the other words of weight 5 are
covered by codewords of weight 8. Using this idea, set up a systemof linear equations for the A
i.
Problem 20F. A codeword at distance ≤efrom a word of weight
e+ 1 must have weight 2 e+1 .
Problem 20G. The codewords in the dual of the binary Hamming
code of length 2r−1 may be identiﬁed with linear functionals on
Fr
2(cf. the geometric description of Reed-Muller codes in Chapter
18); each nonzero codeword has weight 2r−1.
Problem 20H. Use (19.6) and the fact that G24is linear and has
minimum weight 8; note that there are/parenleftbig21
2/parenrightbig
pairs of lines. If α=1 ,
consider the 7-point conﬁguration B∗in the plane. Any line that
meetsB∗must meet it in 1 point or in 3 points. How many meet
B∗in 3 points?
Problem 20I. (i) Find the standard generator matrix for C. (ii)
The conditions (1) and (2) clearly deﬁne a linear code. In (1)we have two choices for parity; in (2) we have 4
3choices for the
codeword; in ﬁve of the columns of Awe then have two possibilities
(not in the last one!). For the choice ‘even’, it is clear that anonzero codeword in Cforces weight ≥8;0has to be treated
separately. For the choice ‘odd’, it is clear that we obtain a weightof at least 6; condition (1) ensures that equality cannot hold. Formore on this wonderful description of the Golay code and manyconsequences see: J. H. Conway, The Golay codes and the Mathieugroups, Chapter 11 in J. H. Conway and N. J. A. Sloane, Sphere
Packings, Lattices and Groups , Springer-Verlag, 1988.
Problem 20J. Self-duality is done as in Example 20.6. All weights
inSym
12are divisible by 3. Consider linear combinations of two
rows of the generator matrix and then conclude what happens ifwe combine with a third row. Use (20.5).
Problem 20K. Prove the generalization by induction on r.F o r
eachr, ﬁnd such a matrix none of whose columns is a constant
vector. For the induction step, concatenate three copies of the
matrix with rrows, to which have been appended a row of all 0’s,
---PAGE BREAK---
Hints and comments on problems 561
all 1’s, and all 2’s, respectively, and then add three appropriate
columns.
Problem 20L. The hint in the chapter should be suﬃcient.
Problem 21A. The argument is the same as for (21.4), now with
inequalities.Problem 21B. Use the integrality condition. Also see the refer-
ence A. J. Hoﬀman and R. R. Singleton (1960) from Chapter 4.Problem 21C. Use (19.2); see Problem 20F. If two blocks are
disjoint, count the number of blocks that meet both of them, each
in two points. How many meet only one of them? Similar countingarguments (distinguish a few cases!) are used to show that µ=6 .
Problem 21D. Suppose such a graph exists. Pick a vertex xand
consider the sets Γ( x) and ∆( x). We consider these as the points
and blocks of a design. Show that this is a 2-(9,4,3) design. Next,ﬁx a block of this design and let a
ibe the number of blocks that
meet this block in ipoints. Show that a0≤1 (see Problem 19E)
and show that the fact that ∆( x) has degree 5 implies that a0
should be at least 5.
Problem 21E. The ﬁrst two questions are straightforward. For
the third we refer to textbooks on matrix theory (see ‘interlacing’)
or to Chapter 31. The theorem we are alluding to states that theeigenvalues of a principal submatrix Bof a symmetric matrix Aare
bounded by the largest and the smallest eigenvalue of the matrix A.
To prove this, just consider any vector xand calculate x
LlatticetopAx/xLlatticetopx.
Specialize by letting xbe an eigenvector of Bwith 0’s appended.
Problem 21F. Review the proof of Theorem 21.5. Show that
Γ(x)=Kn−1,n−1 . Deﬁne a grand clique to be a clique of size nand
show that any edge is in exactly one grand clique. Show that thereare exactly 2n grand cliques, which fall into two classes of nso that
grand cliques in the same class are disjoint. See S. S. Shrikhande,The uniqueness of the L
2association scheme, Ann. Math. Stat. 30
(1959), 781–798.
Problem 21G. Count ﬂags and other conﬁgurations, e.g. two in-
tersecting lines and a point on one of them.
---PAGE BREAK---
562 A Course in Combinatorics
Problem 21H. See Problem 21E for v;kis obvious. Take two
points on line L. Points joined to both of them are on Lor on one
of the other R−1 lines through one of them. A similar argument
yieldsµ.F o rrandssee (21.6).
Problem 21I. On Γ(x) use the fact that µ= 1. Then consider
{x}∪Γ(x).
Problem 21J. Eq. (21.8) leads to an equation like (21.6) with t
instead of k. Although Ais not symmetric the eigenvectors for
eigenvalue Lnegationslash=kare orthogonal to j.
Problem 21K. Show that if ( λ−µ)2+4 (t−µ) is not a square,
then the eigenvalues have multiplicities 1, f, andg, wheref=g=
1
2(v−1). Then show that A=ALlatticetop=J−IandAALlatticetop=lJ+(l+1)I,
wherev=4l+ 3. Deﬁne Q:=A−ALlatticetop.
Problem 21L. Letd:=/radicalbig
(λ−µ)2+4 (t−µ). Apply (21.8) to j
and then show that ddivides (k−1)2. Using 4k −7=d2, prove
thatdmust divide 9.
Forv= 18, use the matrix
/parenleftbigg
cI (c−1)I+J
(c−1)I+JcI/parenrightbigg
and replace cby the matrix Cof Example 21.11 and dbyC2to
obtain a matrix Aof size 18 ×18.
Problem 21M. (i) Consider Γ(x )∩Γ(y) where (xy ) is an edge.
(ii) Prove that Gis also neighborhood regular.
Problem 21N. (i) Γ(x 1)=C∪Bis regular with degree a,s o
|CB|=a|C|−|CC|, etc.
(ii) Eliminate |BC|and|BD|from the relations in (i).
(iii) Interchange x1andx2.U s ed1Lnegationslash=d2.
(iv) Express diinki,a,a, and the number of vertices nofG.
Then prove that k1+k2=2n−3a−a−5.
Problem 21O. Part (i) is straightforward. For example, λ=
(n+3 )/2. (ii) If four triples of a clique Ccontain a point x, then
all triples of the clique must contain x. (iii) Ifn>15, the cliques
---PAGE BREAK---
Hints and comments on problems 563
of size (n −1)/2 in the graph of a triple system are in one-to-one
correspondence with the points of the triple system.
Problem 21P. Equality would imply the existence of a srg(a2+
a+1,a+1,1,1). Use Theorem 21.1. Only a= 1 is possible and a
K3obviously has no circuit on four vertices.
Problem 21Q. The graph Grepresenting the friendship relation
is either a union of triangles with one vertex common to all of them
orGis regular. Use Theorem 21.1.
Problem 22A. Show, by computation, that the complement of
the graph of an ( n,n)-net has the parameters of the graph of an
(n,1)-net. Then show that it isthe graph of an ( n,1)-net, i.e. there
is a partition of the points into nsets of size n, no two points of
which are collinear.
(More generally, an ( n,r)-net may be completed to an (n,n +1)-
net if and only if the complement of the graph of the ( n,r)-net is
the graph of an ( n,n+1−r)-net.)
Problem 22B. Use the constructions from ﬁelds described before
the problem. Take S(x,y): =(x+y)/2 forqodd, for example.
For evenq, we can use AandSto schedule mixed-doubles tennis
matches. Suppose we have qcouples—Mrs. iand Mr.ifori∈
Fq. Let Mrs. iand Mrs.jplay against each other with respective
partners Mr. A(i,j ) and Mr. A(j,i ) during round S(i,j). There
will beq−1 rounds, labeled by the oﬀ-diagonal symbols in S,
during which everyone is playing in exactly one match. It will befound that no one meets her or his spouse as partner or opponentthe entire tournament, but meets everyone else exactly once as anopponent, and has everyone of the opposite sex exactly once as apartner. For qodd, we can have qrounds in which one couple sits
out each round.
Problem 22C. Show that m,m+1,tandueach have the property
that for each prime p<x , they are either prime to por divisible
byp
x.
Problem 22D. Review the connection between sets of pairwise
orthogonal Latin squares and transversal designs.
---PAGE BREAK---
564 A Course in Combinatorics
Problem 22E. Use Theorem 22.6.
Problem 22F. Columns of Aconsist of integers between 1 and k.
For every column of Aand ofSreplace an integer iin the column
ofAby thei-th element in the column of S. By adding suitable
columns and one row, complete to an OA(v,c+ 1).
Problem 22G. The proof is similar to the proof of Theorem 22.6.
One now also needs a (V ,K,D), aTD(v,k).
Problem 22H. Use Problem 22F.
Problem 22I. Use Problem 22G.
Problem 22J. Use Problem 22G.
Problem 23A. Note that the closure of a set Sof edges consists
of all edges that have both ends in the same connected component
of the spanning subgraph of Gwith edge set S.
Problem 23B. The lines of AGr(2) have size 2.
Problem 23C. Dispose ﬁrst of the cases when the union of two
lines is the whole point set. Then show how to set up a one-to-onecorrespondence between the points of any two lines.
Problem 23D. The hardest part is showing that F={F
1∪F2:
F1∈F 1,F2∈F 2}. Prove that F1∪F2=F1∪F2using the fact that
the rank of F1∪F2is the sum of the ranks of F1andF2.
See H. Crapo and G.-C. Rota (1970) for a complete discussion
of connectedness of combinatorial geometries and irreducibility of
geometric lattices.
Problem 23E. SupposeA∩F=∅and rank( A) + rank( F)=
rank(A∪F). Show that these equations remain valid if Ais re-
placed by ALprime:=A∪{x}wherexis any point not in A∪F.
Problem 23F. Use (23.4).
Problem 23G. We may work in PG2(F) and assume without loss
of generality that L1=[ 1,0,0] andL2=[ 0,1,0]. Then (explain
why)a1=Langbracketleft0,α 1,1Langbracketright,b1=Langbracketleft0,β 1,1Langbracketright, andc1=Langbracketleft0,γ 1,1Langbracketright, whilea2=
Langbracketleftα2,0,1Langbracketright,b2=Langbracketleftβ2,0,1Langbracketright, andc2=Langbracketleftγ2,0,1Langbracketright.
---PAGE BREAK---
Hints and comments on problems 565
Problem 23H. See Chapter 13.
Problem 23I. Just use the deﬁnition of λ.
Problem 24A. See Chapter 13.
Problem 24B. One answer is ei=i(m−k+i).Considerkby
n+mmatrices of rank kthat are in echelon form. How many of
these have ileading 1’s in the ﬁrst ncolumns?
Problem 24C. Check that xandyare contained in a coset of a
subspaceUif and only if x−yis contained in U.
Problem 24D. Count all n×nmatrices.
Problem 24E. See Theorem 6.4.
Problem 25A. For a subspace Uof ther-dimensional space W,
letf(U) be the number of k-subspaces which intersect WinU.
Use (25.5).
Problem 25B. For a subspace U, letf(U) denote the number of
nonsingular mappings whose set of ﬁxed vectors is (exactly) U, and
h(U) the number of nonsingular linear mappings that ﬁx (at least)
the vectors in U. It is easy to give a formula for h(U) in terms of
n,qand the dimension of U. We require a formula for f({0}).
Problem 25C. Use (25.2) to calculate µ(0,x ) forxof rank 1 or
2.Problem 25D. There are only n−1 partitions xLnegationslash=0
L(each
consisting of one block of size 2 and n−2 singletons) that satisfy
x∧a=0L.
Problem 25E. Forx<z<y a chain of length kfromxtoz
extends to a chain of length k+ 1 fromxtoy.
Problem 25F. See Theorem 25.1 (iii). Count injective mappings
fromVtoSand then vary |S|.
Problem 26A. The number of lines on a point xnot inAwhich
meetAis a constant, i.e. independent of x.
Problem 26B. Any line disjoint from the arc can be used to ob-
tain a partition of the blocks into parallel classes, one parallel class
for each point of the line.
---PAGE BREAK---
566 A Course in Combinatorics
Problem 26C. The point of intersection of the line though Langbracketleft1,0,0Langbracketright
andLangbracketleft0,1,0Langbracketrightand the line though Langbracketleft0,0,1LangbracketrightandLangbracketleft1,1,1Langbracketright, for example,
isLangbracketleft1,1,0Langbracketright.
Problem 26D. Letµibe the cardinality of the intersection of the
i-th line with S. The inequality is easy if some µi≥√n+1 , s o
assume otherwise and consider/summationtext
i(µi−1)(µi−√n−1).
Problem 26E. Whether the characteristic is even or odd, fis
degenerate if and only if x(C+CLlatticetop) = 0 for some xwithf(x)=0 .
To ﬁnd such an xwhenfis degenerate, take the last row of a
nonsingular matrix Asuch that ACALlatticetophas a last row and column
of all zeros, which exists because xn, say, does not occur in some
projectively equivalent form. Also see J. W. P. Hirschfeld (1979).
Problem 26F. By Theorem 26.6 with q= 2 andn=2m−1,
nondegenerate quadratic forms in 2 mvariables have either 22m−1−
2m−1or 22m−1+2m−1zeros, where we are counting the zero vector
here. So the codewords (vectors of length 2m) corresponding to such
forms have weight 22m−1+2m−1or 22m−1−2m−1. Since, as functions
overF2,x2
i=xi, we may think of the polynomials f(x)+a(x)a s
quadratic forms, or their complements when there is a constant
term 1. Show that all these forms are nondegenerate.
Alternatively, show that there is an ‘invertible aﬃne substitution’
(where e.g. ximay be replaced by xi+ 1) that takes f(x)+a(x)a s
a function on F2m
2,t of (x)o rf(x)+1 .
Problem 26G. It is relatively straightforward to show that QLprimeis
a nondegenerate quadric in W. There is nothing more to do if nis
odd. Theorem 26.5 can be used to complete the proof for neven.
It is easy to see that if QLprimeis hyperbolic, then so is Q. Next use
equation (26.4) to show that every point pon a hyperbolic quadric
QinPGn−1(q) is contained in a ﬂat F⊆Qof projective dimension
n/2−1. Check that such a ﬂat is contained in Tpso that the ﬂat
F∩W⊆QLprimehas dimension one less than that of F.
Problem 26H. If pointxis not on line plscript, consider the plane
determined by xandplscript.
Problem 26I. The points of a triangle are on a line. For (iii) see
Chapter 21.
---PAGE BREAK---
Hints and comments on problems 567
Problem 26J. See the argument for arcs in projective planes.
Problem 26K. Consider three points. Let xibe the number of
blocks of the complementary design that contain iof these points.
Use the usual counting argument to show that x0+x3=λ.
Problem 27A. It is not diﬃcult to see that the even numbered
items are equivalent to each other, and similarly for the odd num-
bered items. To show (3) and (4) are equivalent, for example,introduce an incidence matrix Nand show that one is equivalent
to the matrix equation NN
Llatticetop=(k−λ)I+λJ, and the other to
NLlatticetopN=(k−λ)I+λJ.
Problem 27B. View (Z 2)4as a vector space over the ﬁeld F2.W e
may assume the diﬀerence set contains the zero vector. It will span(Z
2)4and so contains a basis.
Problem 27C. Count separately the number of times a nonzero
element of G×Hcan be written as a diﬀerence of two elements of
A×(H\B), a diﬀerence of two elements of ( G\A)×B, and as a
diﬀerence of one element of each of these sets.
Problem 27D. Multiply the sum of the elements, that we want
to show is 0, by any square.Problem 27E. We already said that this problem is similar to the
illustrated calculation of λ
2.
Problem 27F. Use Theorem 27.5. (A table of cyclic diﬀerence
sets may be found in L. D. Baumert, Cyclic Diﬀerence Sets , Lecture
Notes in Math. 182, Springer-Verlag, 1971.)
Problem 27G. A zeroωof the polynomial y3+3y+2 (coeﬃcients
inF7) is a primitive element of F73.
Problem 27H. The cardinality of the intersection of a translate
D+gofDwith the set −Dis the number of times garises as a
sumfromD.
Problem 27I. For distinct iandj, the diﬀerences x−y,x∈
Ui,y∈Uj, comprise all vectors in V, each exactly once.
---PAGE BREAK---
568 A Course in Combinatorics
Problem 28A. The Frobenius automorphism of Fpt(n+1) is an
automorphism of the symmetric design of 1-dimensional and n-
dimensional subspaces of Fps(n+1) overFpt.
Problem 28B. We may take S(x) as in Lemma 28.4 with D=
{1,2,4}but where αis not a multiplier.
Problem 28C. Ifn≡0 (mod 10), say, then for any x∈D,
{x,2x,4x,5x}⊆D and the diﬀerence xis seen to occur twice
unless 3x =0 . I f3x= 0 for all x∈D, then 3x= 0 for all xin
the group, and then n2+n+ 1 must be a power of 3. Show that
n2+n+ 1 is never divisible by 9.
Problem 28D. The numbers of normalized diﬀerence sets with
these parameters are, respectively: 2, 2, 4, 2, 0, 4.
Problem 28E. There are two normalized (15, 7,3) diﬀerence sets;
they are equivalent since one consists of the negatives of the ele-
ments of the other. There are no normalized diﬀerence sets for anyof the other parameters. To prove this in each case, ﬁrst ﬁnd amultiplier by Theorem 28.7.
For e.g. (v,k,λ ) = (25, 9,3), Example 28.3 shows 2 is a multiplier
of a hypothetical normalized diﬀerence set D. If the group is cyclic,
Dis the union of cycles of xLmapsto→2xonZ
25which are
{0},{5,10,20,15}andZ25\{0,5,10,15,20};
but no such union has nine elements. If the group is elementaryabelian (exponent 5), then Dmust consist of 0 and two cycles of
the form {x,2x,4x,8x=3x}; but the diﬀerence xoccurs ﬁve times
already among 0 and the elements of such a cycle.
Problem 28F. AssumeD(x
−1)=D (x) and use Lemma 28.2 with
p=2 .
Problem 28G. Recall the construction of a symmetric design
with those parameters from a Latin square of order 6 in Problem
19G.
Problem 28H. AssumeD(xq)=D (x). Note that q3≡−1
(mod|H|). Show D(xα)≡0( m o dq,H) and conclude that one
of the coeﬃcients of D(xα)i sq + 1 and all others are 1.
---PAGE BREAK---
Hints and comments on problems 569
Problem 28I. The ﬁrst part is similar to Problem 28H. Then
show that if, in PG3(q), a line meets a set Sof sizeq2+1i nk≥3
points, then one of the q+1 planes on that line contains more than
q+ 1 points of S.
Problem 29A. Review the proof of Theorem 20.6.
Problem 29B. Review the latter part of the proof of Proposition
29.5.
Problem 29C. The answer is (v,k,λ )=( 4n−1,2n−1,n−1)
or (4n−1,2n,n), i.e. Hadamard or the complement of Hadamard.
Review the proof of Theorem 29.7.Problem 30A. A
1A2=8A1+8A2+9A3andA3
1=9 0A0+83A1+
56A 2+3 6A3.
Problem 30B. By (30.3), AiAj=/summationtextk
α=0Pi(α)Pj(α)Eα. Then by
(30.4),
NAiAj=k/summationdisplay
α=0Pi(α)Pj(α)k/summationdisplay
β=0Qα(β)Aβ,
so evidently pplscript
ij=1
N/summationtextk
α=0Pi(α)Pj(α)Qα(plscript). The second eigenma-
trixQcan be calculated by inverting P(also see Theorem 30.2).
Problem 30C. For the Latin square graphs,
P=/parenleftBigg
1(n−1)r (n−1)(n−r +1)
1n−r −n+r−1
1−rr −1/parenrightBigg
.
Problem 30D. To evaluate the entries Pplscript(0) of the top row of
P, take the inner product (as introduced in the proof of Theorem
30.2) of both sides of (30.3) with E0.
Problem 30E. This is the dual to Problem 30B.
Problem 30F. Try|A|=|B|=3 .
Problem 30G. Note that for any automorphism σ,|A∩σ(B)|≤1.
Count the number of automorphisms of G.
Problem 30H. Given a metric scheme arising from a distance
regular graph G, ﬁrst note that Ai
1is a linear combination of
---PAGE BREAK---
570 A Course in Combinatorics
A0,A1,...,Aiwhere the coeﬃcient of Aiis positive. Given a P-
polynomial scheme, deﬁne a graph Gby saying that xandyare
adjacent in Gif and only if they are 1st associates in the scheme,
and show that two points are i-th associates if and only if they are
at distance iinG.
Problem 30I. Use the counting argument of Problem 20K for
words of weight 8 ﬁrst; then ﬁnd the other words satisfying the
condition. Use the subcodes with a ﬁxed jand the subcode of
Problem 20K.
Problem 30J. If such a code did exist, it would be equivalent to
a code with a generator matrix with (1111100 ...0) as ﬁrst row and
below that ( AB), whereBgenerates a code of length 8, dimension
5, and minimum distance at least 3. Now use the fact that the
[7,4,3] Hamming code is unique (up to equivalence).
Problem 30K. (i) Distance depends on the size of the intersec-
tion only; just count; (ii) The graph has degree 4 and two triples
corresponding to the Fano plane meet in one point.
Problem 30L. ForJ(k,v) show that a necessary condition is that
1+k(v−k) divide/parenleftbigv
k/parenrightbig
.
Problem 31A. Consider the intersection of the eigenspaces of A1
andA2corresponding to the eigenvalue 1.
Problem 31B. Since the adjacency matrix of the complement of
a graphGwith adjacency matrix AisJ−I−A, the eigenvalues
ofGare easily determined from those of G. The ﬁrst examples in
Chapter 21 are instances in which equality can occur.Problem 31C. (i) The Petersen graph has 3- claws, i.e. induced
subgraphs on four vertices consisting of three edges incident with
a common vertex (and no other edges). Explain why a line graphcannot contain a 3-claw. (ii) The matrix N
LlatticetopNis positive semidef-
inite and is equal to 2I +A, whereAis the adjacency matrix.
Problem 31D. From the equation following (31.1) with xthe
vector of all 1’s, it follows that the largest eigenvalue of a graph isbounded below by the minimum degree of the graph. By Lemma31.5, the largest eigenvalue of a graph Gis bounded below by the
---PAGE BREAK---
Hints and comments on problems 571
minimum degree of any induced subgraph HofG.I fχ(H)=χ(G)
and the deletion of any vertex xofHdecreases the chromatic
number, then deg( x)≥χ(H)−1.
Problem 31E. If there are no directed paths from xtoyin a
digraphGwith adjacency matrix A, letSbe the set of vertices
zsuch that there does exist a directed path in Gfromxtoz.
ThenA(x,y ) = 0 whenever a∈Sandb∈V(G)\S,s oAis not
irreducible. The converse is even easier.
Problem 31F. (i) Show by straightforward calculation that ujA=
λjuj, whereuj=( 1,ωj,ω2j,...,ω(n−1)j). For (ii), deﬁne, for each
character χ, a vector uχwhose coordinates are indexed by Gand
whereuχ(g)=χ(g ), and show that uχA=λχuχ.
Problem 31G. To prove the lemma, show that if xis a row-vector
so thatxS=0, thenxa= 0. Apply the lemma to S=A+I,
whereAis the adjacency matrix of the graph. The lemma may
be found in B. Bagchi and N. S. Narasimha Sastry, Even order
inversive planes, generalized quadrangles and codes, Geometriae
Dedicata 22(1987), 137–147. The graph problem (phrased in terms
of ‘acquaintances’) is Problem 10851, by D. Beckworth, from theAmerican Mathematical Monthly 108.
Problem 31H. Most of the work has been done in the proof of
Theorem 31.10: If the distinct eigenvalues of Gare its degree dand
µ
i,i=1,2, then (A−µ1I)(A−µ2I)=1
v(d−µ1)(d−µ2)JwhereA
is the adjacency matrix of G. This means that A2is in the algebra
generated byI,J, andA.S oGis strongly regular.
Problem 31I. LetGbe ansrg(v,k,λ,µ ). The eigenvalues of
∆(x) interlace the eigenvalues
k,r,r,...,r,s,s,...,s (r>s ,s a y )
ofG. Any sequence that interlaces this can have at most one term
which is greater than r.
Except in the half-case, randsare integers with rs=µ−k;i n
particular, r≤k−µ(even in the half-case). The graph ∆(x)i s
---PAGE BREAK---
572 A Course in Combinatorics
regular of degree k−µ. Were it not connected, k−µwould be an
eigenvalue of ∆(x) of multiplicity greater than one.
Problem 31J. The eigenspace of Acorresponding to eigenvalue 1,
and the eigenspace of Bcorresponding to −1, both have dimension
5, but are contained in the 9-dimensional space of vectors orthogo-
nal to the vector of all 1’s, and so there is a nonzero vector uin the
intersection of the eigenspaces. Show that connectivity of Kleads
to a contradiction to Theorem 31.11.
Problem 31K. (i) This follows from Theorem 31.13 or part of its
proof. (ii) Multiply (31.6) by J. (iii) The number of undirected
edges is one-half the trace of A2. (iv) Show that the undirected
edges do not have a common vertex and that they are not joined
by an edge. Up to reversing directions, this leaves only one way tocomplete the graph.
Problem 32A. One of the graphs has two vertices, one has three
vertices, and two have four vertices.
Problem 32B. LetXbe the set of vertices reachable by a directed
path from swithf(e)>0 on all edges of the path, and let Ybe
the remaining vertices, if any. If t/∈X, we have a contradiction to
Eq. (7.1) (why?). For part (ii), use induction on k.
Problem 32C. Assign capacity 1 to all edges of D. Use Theorem
7.1.
Problem 32D. If (H,K )i sa nplscript-separation and the deletion of
theplscriptverticesS:=V(H)∩V(K) does not disconnect the graph,
then at least one of HorKhas vertex set contained in S.
Problem 33A. Brieﬂy explain why spanning trees of Gthat con-
tain the edge eare in one-to-one correspondence with the spanning
trees ofG
LprimeLprime
eand why spanning trees of Gthat do not contain the
edgeeare in one-to-one correspondence with the spanning trees of
GLprimee.
Problem 33B. Find an answer of the form f(λ)+(−1)ng(λ). Use
induction, Equation (32.1), and Example 32.1.
Problem 33C. More strongly, a subdivision of K3,3(where edges
are replaced by paths) occurs as a subgraph of the Petersen graph.
---PAGE BREAK---
Hints and comments on problems 573
Problem 33D. Suppose a vertex of GLprimeLprime
Sis incident with three dis-
tinct edges e1,e2,e3. Such a vertex is a connected component Cof
G:S.S oeihas an end xiinC,i=1,2,3 (these ends are not
necessarily distinct). Explain why the connectivity of Cimplies
that there exists a vertex xand possibly degenerate but internally
disjoint paths in Cfromxto each of x1,x2, andx3. That is, we
have a subgraph of Cisomorphic to a subdivision of the letter Y
with thexi’s at the ends of the arms if the paths all have length
≥1, but otherwise some of the arms may be degenerate. This ob-
servation immediately leads to a solution of the ﬁrst part of the
problem.
Given four vertices xi,i=1,2,3,4, of a connected graph C, show
that there is a subgraph isomorphic to a subdivision of either theletterXor the letter I, though with possibly degenerate arms, and
with thex
i’s at the ends of the arms.
Check that if a vertex, say 1, of K5is replaced by two vertices
1Land 1Rjoined by an edge, and the edges joining 1 to the other
vertices are split, say 1 Lis joined to 2 and 3, and 1 Ris joined to 4
and 5, then the resulting graph has K3,3as a subgraph. Combine
this with the observation of the previous paragraph to ﬁnish theproblem.
Problem 33E. Use Euler’s formula. The only pairs ( d
1,d2) that
arise other than those (3 ,3), (3, 4), (3, 5), (4, 3), (5, 3) that corre-
spond to the ﬁve Platonic solids are those (2 ,n) and (n,2),n≥2,
that correspond to the polygons and bond-graphs.Problem 34A. We have a linear mapping from the vector space
overF
2of all subsets Xof the vertex set V(G) onto the cutset space
ofG, namely XLmapsto→×(X,V (G)\X). (The matrix of this mapping
isN, the incidence matrix.) What are the sets Xin the kernel of
this mapping? The dimension of the cutset space is the number of
vertices minus the dimension of the kernel.
Problem 34B. Use induction on the cardinality of the support of
codewords.Problem 34C. The circuits of G
Lprime
eare exactly those circuits of G
that do not contain e. What are the bonds of HLprimeLprime
e?
---PAGE BREAK---
574 A Course in Combinatorics
Problem 34D. One way to do this would be to ﬁrst prove two
things about subsets Sof the edge set of a connected graph K: (1)
Sis the edge set of a spanning tree in Kif and only if no circuit of
Kis contained in SandSis maximal with respect to this property
and (2)Sis the edge set of a spanning tree in Kif and only if every
bond ofKmeetsSnontrivially and Sis minimal with respect to
this property.
Problem 34E. Show ﬁrst that the two components that result
from deleting an isthmus from a connected trivalent graph each
have an odd number of vertices.
Problem 34F. Here is an idea to construct bonds. Deleting any
edge of a spanning tree of Gleaves a subgraph with two compo-
nents; the set of edges with one end in each component is a bond
ofG.
Problem 34G. Deleting the edges of a bond Sfrom a connected
graphGalways gives a graph with two components, but recall that
we have chosen to delete isolated vertices when we deﬁned GLprime
S.I n
part (ii), an equivalence of codes gives a one-to-one correspondence
between the edge sets of HandGthat takes circuits to circuits and
bonds to bonds. Use part (i) and the fact that a graph withoutisolated vertices is nonseparable if and only if any two edges arecontained together in a circuit; cf. Theorem 32.2.
Problem 34H. Given a polygon PinG, one may consider the
subgraphs HandKwhereH=PandKis the spanning subgraph
ofGcontaining all edges of Gother than those of P.
Consider a bond BinGthat consists of all edges with one end
inXand one end in Y, whereXandYpartitionV(G) and each
induces a connected subgraph. Suppose for contradiction that Gis
Tutte-k -connected but that |B|=plscript<k . Letplscript
1be the number of
vertices in Xincident with edges of B. If the subgraph induced by
Xhas at least plscript1edges, we easily ﬁnd an plscript1-separation of G. Deal
with the remaining situation.Problem 34I. We give independent hints, even though one can
derive (i) from (ii), or, as we have mentioned, the ﬁrst two parts
from (iii).
---PAGE BREAK---
Hints and comments on problems 575
(i) IfAandBare edge sets of polygons PandQ, start traversing
Pin both directions starting with the edge y, and stop as soon as
vertices in Qare reached.
(ii) IfAandBare the supports of codewords aandb, the support
Sof some linear combination of aandbwill contain coordinate y
but notx. Show that any support Sof a codeword is the union of
minimal supports of codewords, by induction on |S|.
(iii) Show that, in general, if z∈S, then there is a minimal
dependent set Dso thatz∈D⊆S∪{z}. (Review Lemma 23.2.)
Then show that yis in the closure of ( A∪B)\{x,y}.
Problem 35A. Take the vertices of Knto beZn.F o rn= 5, use
all cyclic shifts (translates) of [1 ,2,4,3] (mod 5).
Problem 35B. Let us drop the last coordinate in the description
of Example 21.4 and describe the Clebsch graph as having vertex
setF4
2and where xandyare adjacent when x+yhas weight 3 or
4. Try to choose one walk wand obtain the others as translates of
wby all elements of F4
2.
Problem 35C. Part (i) is similar to Theorem 33.5. For the proof
of uniqueness of the mesh, we may take V(K7)={0, 1,..., 6}and,
without loss of generality, the walks traversing 0 are
[6,0,1],[1,0,2],[2,0,3],[3,0,4],[4,0,5],[5,0,6].
The walk traversing the edge (6 ,1) has third vertex 3 or 4 (otherwise
the vertex condition is violated at 1 or 6) and in either case theother walks are uniquely determined.
Problem 35D. The vertices of the graph M
xare the edges inci-
dent with x. These edges form the edge set of a bond in Gand
hence are the edges of a circuit in H.
Problem 35E. Let us use the term ﬂagfor a triple ( x,e,F ) con-
sisting of a vertex x, an edgeeincident with x, and a face Fincident
withe. There is exactly one other vertex xLprimeso that (xLprime,e,F)i sa
ﬂag, exactly one other edge eLprimeso that (x,eLprime,F) is a ﬂag, and ex-
actly one other face FLprimeso that (x,e,FLprime) is a ﬂag; these objects
must hence be ﬁxed by any automorphism αthat ﬁxes the terms
of (x,e,F ).
---PAGE BREAK---
576 A Course in Combinatorics
Problem 35F. Use Theorem 35.1. The least value of n>2 for
whichKn,nembeds in an orientable surface so that all faces are
quadrilaterals is n=6 ;nmust be even, but K4,4does not so
embed in T0. Some ideas and/or analysis of cases is required.
Problem 35G. All faces will have the same size. Consider the
walk traversing the edge (0, 1). The next several edges will be
(1,1−ω), (1−ω,1−ω+ω2), (1−ω+ω2,1−ω+ω2−ω3), etc. If
m≡2 (mod 4), for example, then the walk has length m/2.
Problem 36A. The sum of the determinants of all principal n−1
byn−1 submatrices of Mis an appropriate sign times the coeﬃ-
cient ofxin the characteristic polynomial det( xI−M)o fM.
Problem 36B. There is one such arborescence for every mapping
f:{2,3,...,n}→{ 1,2,...,n−1}so thatf(i)<ifor eachi.
Problem 36C. If a vector gwith coordinates indexed by E(H)
has the property that for every closed walk w, the signed sum of the
values ofgon the edges of wis zero, then deﬁne a vector hindexed
byV(H) as follows. (We assume His connected for convenience;
otherwise work separately with each component.) Fix a vertex x,
deﬁneh(x) := 0, and for any vertex y, leth(y) be the signed sum
of the values of gon the edges of any walk from xtoy. Check that
his well deﬁned and that gis the coboundary of h.
Problem 36D. LetZdenote the cycle space and Bthe cobound-
ary space. These are orthogonal complements, so their (direct) sum
isRm(the space of all vectors with coordinates indexed by E(D)).
Show that the linear transformation Ris one-to-one on Zand that
ZR∩B={0}, so that Rmis the direct sum of these subspaces.
Problem 36E. The sizes of all squares in Fig. 36.4 may be ex-
pressed as integral linear combinations of the sizes x,y,z of the
three indicated squares. For example, the smallest square has sizez−xand the next smallest has size x+z−y. It will be found
that the sizes of some squares can be so expressed in more than oneway, and we thus have linear relations between x,y,z . Eventually,
we can express the size of any square as a rational scalar multipleofx, and the least common denominator of these rational numbers
is the value we should take for x.
---PAGE BREAK---
Hints and comments on problems 577
Problem 36F. It may be quickest to proceed as in Problem 36E;
letx,y,z , for example, denote the values of the current on three
edges, etc. But one can evaluate determinants as in equation (36.3)
to ﬁnd the solutions.
Problem 37A. The rotations include: the identity (1), rotations
of 90, 180, and 270 degrees about an axis through the centers of
two opposite faces ( 3+3+3 ) , rotations of 180 degrees about an
axis through the centers of two opposite edges (6), and rotations of120 and 240 degrees about an axis through two opposite vertices( 2+2+2+2 ) . T h el a tter eight rotations, for example, contribute
8X
2
3to the cycle index.
Problem 37B. Use Theorem 37.2 and Problem 37A.
Problem 37C. Explain why the number of injections fﬁxed by
(σ,τ) depends only on the cycle structure of σandτ(i.e. on the
numbersziof cycles of length ifor eachi) and ﬁnd an expression
for the number of injections in terms of the zi(σ)’s and the zi(τ)’s.
Problem 37D. In Theorem 37.3, take Gto be dihedral and Hto
be the symmetric group S2.
Problem 37E. If a rotation ρof the cube has acycles on the faces
andbcycles on the vertices, the number of colorings ﬁxed by ρis
tasb. Use Burnside’s Lemma.
Problem 38A. Letm:=v/2. For each of the M:=v−1 colors
i, we obtain an m-partition of V(Kv) by taking the edges of color
i, all singletons {x}forxnot incident with an edge of color i, and
enough copies of the empty set to make an m-partition. Check that
the condition (38.1) holds. Review the proof of Theorem 38.1.
---PAGE BREAK---
Appendix 2
Formal power series
Before introducing the subject of this appendix, we observe that
many of the assertions that we shall make will not be proved. Inthese cases the proof will be an easy exercise for the reader.
Consider the set
C
N0:={(a0,a1,a2,...):∀ i∈N0[ai∈C]}.
On this set we introduce an addition operation and a multiplicationas follows:
(a
0,a1,...)+(b0,b1,...): =(a0+b0,a1+b1,...),
(a0,a1,...)(b 0,b1,...): =(c0,c1,...),
wherecn:=/summationtextn
i=0aibn−i.
This deﬁnition produces a ringthat we denote as C[[z]] and call
the ring of formal power series . This name is explained in the
following way. Let z:= (0, 1,0,0,...). Then znis the sequence
(0,..., 0,1,0,...) with a 1 in the n-th position. So, formally we
have
a=(a0,a1,...)=∞/summationdisplay
n=0anzn=:a(z).
We shall use both notations, i.e. aanda(z), for the sequence. We
say thatanis thecoeﬃcient of znina(ora(z)). Notice that C[z],
the ring of polynomials with coeﬃcients in C, is a subring of C[[z]].
Some of the power series will be convergent in the sense of analysis.
For these, we can use results that we know from analysis. Quiteoften these results can be proved in the formal sense, i.e. not usingconvergence or other tools from analysis.
---PAGE BREAK---
Formal power series 579
Example 1. Letf:= (1,1,1,...). Using the deﬁnition of multi-
plication and 1 −z=( 1,−1,0,...), we ﬁnd (1 −z)f=( 1,0,0,...)=
1. So, in C[[z]], we have f=( 1−z)−1, i.e.
1
1−z=∞/summationdisplay
n=0zn,
a result that we knew from analysis.
The regular elements in C[[z]] are the power series with a0Lnegationslash=0 .
This can be seen immediately from the deﬁnition of multiplication.
From the relation a(z)b(z) = 1 we can calculate the coeﬃcients bn,
sinceb0=a−1
0andbn=−a−10/summationtextn
i=1aibn−i. From this we see that
the quotient ﬁeld of C[[z]] can be identiﬁed with the set of so-called
Laurent series/summationtext∞n=kanzn, wherek∈Z. Since it plays a special
role further on, we give the coeﬃcient of z−1a name familiar from
analysis. If a(z) is the series, we say that a−1is theresidue ofa(z).
This will be written as Res a(z).
Letfn(z)=/summationtext∞i=0cnizi(n=0,1,2,...) be elements of C[[z]] with
the property
∀i∃ni[n>ni⇒cni=0 ].
Then we can formally deﬁne
(1)∞/summationdisplay
n=0fn(z)=∞/summationdisplay
i=0/parenleftBiggni/summationdisplay
n=0cni/parenrightBigg
zi.
This deﬁnition allows us to introduce substitution of a power series
b(z) for the ‘variable’ zof a power series a(z). Ifb0= 0, which we
also write as b(0) = 0, then the powers bn(z): =(b(z))nsatisfy the
condition for formal addition, i.e.
a(b(z)) :=∞/summationdisplay
n=0anbn(z)
makes sense.
---PAGE BREAK---
580 A Course in Combinatorics
Example 2. Letf(z): =( 1−z)−1,g(z)=2z−z2. Then formally
h(z): =f (g(z) )=1+( 2 z−z2)+( 2z−z2)2+···
=1+2z+3z2+4z3+···.
From calculus we know that this is the power series expansion of
(1−z)−2, so this must also be true in C[[z]]. Indeed we have
(1−z)h(z)=∞/summationdisplay
n=0zn=( 1−z)−1.
This also follows from (legitimate) algebraic manipulation:
f(g(z)) =/parenleftbig
1−(2z−z2)/parenrightbig−1=( 1−z)−2.
Many power series that we often use represent well known func-
tions, and in many cases the inverse function is also represented bya power series. This can also be interpreted formally for series f(z)
withf
0= 0 andf1Lnegationslash= 0. We ‘solve’ the equation f(g(z)) =zby
substitution. This yields f1g1=1 ,f1g2+g2
1= 0, and in general
an expression for the coeﬃcient of znstarting with f1gnfor which
the other terms only involve coeﬃcients fiand coeﬃcients gkwith
k<n . Setting this 0 allows us to calculate gn.
Example 3. The reader who likes a combinatorial challenge can
give a proof by counting of the formula
n/summationdisplay
k=0/parenleftbigg2k
k/parenrightbigg/parenleftbigg2n−2k
n−k/parenrightbigg
=4n.
This would be equivalent to proving that the formal power seriesf(z): =/summationtext
∞
n=0/parenleftbig2n
n/parenrightbig
(z/4)nsatisﬁes the relation f2(z)=( 1−z)−1.B y
similar arguments or by algebraic manipulation one can then ﬁnd
the formal power series that deserves the name (1 + z)1
2.
Now consider the formal power series f(z): =2z+z2. The ‘in-
verse function’ procedure that we described above will yield a power
seriesg(z) that satisﬁes 2g (z)+g2(z)=z, i.e. (1 +g(z))2=1+z.
So this should be the series that we just called (1 + z)1
2. It should
---PAGE BREAK---
Formal power series 581
no longer be surprising that algebraic relations that hold for con-
vergent power series are also true within the theory of formal powerseries.
Remark. We point out that substitutions that make perfect sense
in calculus could be forbidden within the present theory. The power
series/summationtext
∞
n=0zn
n!will of course be given the name exp( z). In calculus
we could substitute z=1 +xand ﬁnd the power series for exp(1+ x).
We do not allow that under formal addition.
We now introduce formal derivation of power series.
Deﬁnition. Iff(z)∈C[[z]], then we deﬁne the derivative
(Df)(z)=fLprime(z)
to be the power series/summationtext∞n=1nfnzn−1.
The reader should have no diﬃculty proving the following rules
by using the deﬁnitions in this appendix:
(D1) (f (z)+g(z))Lprime=fLprime(z)+gLprime(z);
(D2) (f (z)g(z))Lprime=fLprime(z)g(z)+f(z)gLprime(z);
(D3) (fk(z))Lprime=kfk−1(z)fLprime(z);
(D4) (f (g(z)))Lprime=fLprime(g(z))gLprime(z).
The chain rule (D4) is an example of a more general statement,
namely that
D/parenleftBigg∞/summationdisplay
n=0fn(z)/parenrightBigg
=∞/summationdisplay
n=0D(fn(z)).
If convergence plays a role, this is a diﬃcult theorem with extraconditions, but for formal power series it is trivial!
The familiar rule for diﬀerentiation of a quotient is also easily
proved. So we can carry the theory over to Laurent series. Weshall need the following two facts. Again we leave the proof as anexercise.
Ifw(z) is a Laurent series, then
(R1) Res( w
Lprime(z)) = 0;
(R2) the residue of wLprime(z)/w(z) is the least integer plscriptsuch that the
coeﬃcient of zplscriptinw(z) is nonzero.
---PAGE BREAK---
582 A Course in Combinatorics
We have already mentioned the idea of an ‘inverse function’ and
have shown how to calculate its coeﬃcients recursively. The nexttheorem gives an expression for the coeﬃcients.
Theorem 1. LetW(z)=w
1z+w2z2+···beapowerserieswith
w1Lnegationslash=0.Le tZ(w)=c 1w+c2w2+···be a power series in w, such
thatZ(W(z)) =z. Then
cn= Res/parenleftbigg1
nWn(z)/parenrightbigg
.
Proof: Observe that c1=w−1
1. We now use formal derivation and
apply it to the relation Z(W(z)) =z. This yields
(2) 1 =∞/summationdisplay
k=1kckWk−1(z)WLprime(z).
Consider the series obtained by dividing the right-hand side of (2)
bynWn(z). IfnLnegationslash=k, then the term Wk−1−n(z)WLprime(z) is a derivative
by (D3) and hence has residue 0 by (R1). By applying (R2) to theterm with n=kwe ﬁnd the assertion of the theorem. /square
This theorem makes it possible for us to give a proof of the
Lagrange inversion formula (see Theorem 14.3) within the theoryof formal power series. Let f(z) be a power series with f
0Lnegationslash=0 .
ThenW(z): =z/f(z) is a power series with w1Lnegationslash= 0. Now apply
Theorem 1. We ﬁnd that z=/summationtext∞
n=1cnwnwith
cn= Res/parenleftbiggfn(z)
nzn/parenrightbigg
=1
n!(Dn−1fn)(0),
which is (14.19). This approach is based on P. Henrici, An alge-
braic proof of the Lagrange–B¨ urmann formula, J. Math. Anal. and
Appl.8(1964), 218–224. The elegant simpliﬁcation is due to J. W.
Nienhuys.
As was observed above, we deﬁne
(3) exp(z): =∞/summationdisplay
n=0zn
n!.
---PAGE BREAK---
Formal power series 583
From previous knowledge we expect that replacing zby−zwill
yield the inverse element in the ring C[[z]]. Formal multiplication
and the fact that/summationtextn
k=0(−1)k/parenleftbign
k/parenrightbig
= 0 forn>0 shows that this is
true.
It is now completely natural for us to also deﬁne
(4) log(1 +z): =∞/summationdisplay
n=1(−1)nzn
n.
Again, calculus makes us expect a relation between the ‘functions’
log and exp. By our substitution rule, it makes sense to considerthe power series log(exp(z )). From (D4) we then ﬁnd
D(log(exp(z))) =exp(z )
exp(z )=1,
i.e. log(exp( z)) =z. (Here we have used the fact that the formal
derivative of log(1 + z)i s( 1+z)−1.)
Of course, much more can be said about formal power series.
One could explore how many familiar results from analysis can becarried over or given a formal proof. We hope that this sketchytreatment will suﬃce to make things clearer.
---PAGE BREAK---
Name Index
Aardenne–Ehrenfest, T. van 520
Alltop, W.O. 223, 241Andr´ e, D. 138, 151Andr´ e, J. 320, 324Assmus, E.F. 249, 259, 260
Appel, K. 24, 34, 35, 466, 471
Baer, R. 255
Bagchi, N. 571Baker, R.D. 300Balinski, M. 457, 458Bannai, E. 413, 431Baranyai, Zs. 536, 537, 540, 541Batten, L.M. 324, 363, 368Baumert, L.D. 204, 214, 294,
295, 567
Beauregard Robinson, G. de
165, 167
Beckworth, D. 571
Beineke, L.W. 281
Belevitch, V. 200, 214, 265
Bermond, J.-C. 537
Bertrand, J.L.F. 151
Best, M.R. 207, 214Beth, T. 301Bhattacharya, K.N. 240, 241Biggs, N. 450, 466, 471Binet, A. 508, 510
Birkhoﬀ, G. 48, 51, 52, 111Block, R.E. 371, 382Blokhuis, A. 367, 368
Bollob´ as, B. 38, 41, 57
Bondy, J.A. 9, 542
Bose, R.C. 240, 264, 271, 272,
279, 280, 284, 288, 300, 301,
365, 367, 368, 409
Bouwkamp, C.J. 520, 521Br´ egman, L.M. 101, 108
Brooks, R.L. 24, 35Brouwer, A.E. 85, 87, 88, 272,
279, 280, 355, 368, 407, 431,
537, 541
Brouwer, L. E. J. 458Bruck, R.H. 230, 241, 280, 381,
382, 383, 398
Bruijn, N.G. de 55, 59, 71, 75,
76, 216, 241, 433, 513, 514,520, 532, 535
Buekenhout, F. 281
B¨urmann, H. 582
Burnside, W. 94, 370
Cameron, P.J. 259, 260, 279,
280, 281
Catalan, E. 150, 151
Catherine the Great 284Cauchy, A.L. 94, 108, 508, 510
Cayley, A. 12, 22, 504, 505, 508
---PAGE BREAK---
Name Index 585
Chakravarti, I.M. 367, 368
Chandrasekharan, K. 167, 230,
241
Chang, L.C. 271, 280, 281Chartrand, G. 462, 471, 491, 505Chowla, S. 230, 241, 301, 383,
398
Chv´ atal, V. 70Clebsch, A. 263, 279, 498, 505,
575
Cohen, A.M. 407, 431Cohen, G.D. 241Connor, W.S. 228, 241, 280, 281Conway, J.H. 216, 560
Crapo, H. 324, 490, 564Crawley, P. 304, 313, 319,324Cruse, A. 541Cvetkovi´ c, D.M. 440, 450
Da Silva, D.A. 96De Clerck, F. 280, 281Dedekind, J.W.R. 167Dehn, M. 520, 521Delsarte, P. 279, 280, 281, 405,
412, 413, 419, 422, 424, 431
Dembowski, P. 324, 368D´enes, J. 197
Denniston, R.H.F. 223, 242, 252,
268
Desargues, G. 317, 323Diaconis, P. 181Diestel, R. 462, 463, 471Dilworth, R.P. 53, 60, 304, 313,
319, 324
Dinitz, J.H. 294, 301, 469Dirac, G.A. 40Doob, M. 450Dowling, T. 341, 342, 349Duijvestijn, A.J.W. 517, 520,
521
Dulmage, A.L. 295, 302Duval, A.M. 276, 281
Ebbenhorst Tengbergen, C. van
55, 59
Edmonds, J. 69, 503, 505
Egoritsjev, G.P. 110Eˇ gecioˇ glu, ¨O. 16, 23
Elspas, B. 446, 450Erd˝ os, P. Preface, 5, 10, 33, 35,
51, 59, 216, 241, 301, 331,418, 430, 433, 520, 544
Euler, L. 6, 10, 136, 157, 166,
182, 284, 290, 300, 465, 466,480, 491, 497, 513 542, 573
Evans, T. 189, 197
Falikman, D.I. 110
Fan, K. 491, 505Fano, G. 225, 240, 242, 492Fekete, M. 103, 109Ferrers, N.M. 166, 327Fibonacci 150Fisher, R.A. 222, 240, 558Flye Sainte-Marie, C. 75, 76Ford, L.R. 64, 66, 70Fourier, J.B. 212Frame, J.S. 165, 167, 553Frankl, P. 59, 60, 331, 332Franklin, F. 157, 167Fr´echet, M. 491, 505
Freeman, J.M. 553Frobenius, G. 94, 167, 442, 568Fulkerson, D.R. 64, 66, 69
Gale, D. 181
Galvin, F. 194, 197, 469Gantmacher, F.R. 442, 450Gardner, M. 521Garey, M. 9, 10Gauss, C.F. 97, 325, 332Gelling, E.N. 537, 541
---PAGE BREAK---
586 Name Index
Gewirtz, A. 267, 281
G¨ odel, K. 458Godlewski, P. 241Godsil, C.D. 227, 281Goethals, J.-M. 266, 279, 280,
281
Golay, M.J.E. 252, 259, 417, 429Golomb, S.W. 204, 214Gordon, B. 381, 382Goulden, I.P. 150, 151Graham, R.L. 32, 35, 78, 88,
332, 432, 521
Granell, M.J. 223, 242Greene, C. 59, 60, 312, 334, 547Griggs, T.S. 223, 242Grinstead, C.M. 35Grossman, J.W. 10Gr¨ unbaum, B. 349, 350, 456,
457, 458
Gustin, W. 504, 506Guthrie, Francis 465Guthrie, Frederick 465
Hadamard, J. 213, 268, 375
Haemers, W. 280, 435, 450Haken, W. 24, 34, 35, 466, 471Hall, M. 51, 60, 196, 204, 214,
281, 298, 302, 319, 324, 383,394, 395
Hall, P. 43, 51, 52Halmos, P.R. 51, 52Hamilton, W.R. 8, 10, 465Hamming, R.W. 259, 406, 417Harary, F. 535Hardy, G.H. 166, 167Hautus, M.L.J. 51Heawood, P.J. 433, 466, 493,
494, 498, 505
Henrici, P. 582Hickerson, D. 150Higman, D.G. 267, 279, 281Hilbert, D. 470Hirschfeld, J.W.P. 358, 359, 368,
566
Hoﬀman, A.J. 41, 280, 282, 434,
440, 450, 561
Hoﬀman, D. 197Hsieh, W.N. 331, 332Hu, T.C. 70Hubaut, X. 279, 282Hughes, D.R. 321, 324
Ito, T. 413, 431Jackson, D.M. 150, 151, 181,
280, 431
Jacobi, C.G.J. 167
Jeans, J.H. 519, 521Johnson, D. 295, 302Johnson, D.S. 9, 10Johnson, S. 35, 406Jones, B.W. 80, 88Joyal, A. 141, 151Jungnickel, D. 227, 242, 301, 404
Karp, R.M. 69
Katona, G.O.H. 59, 60Keedwell, A.D. 197Kempe, A.B. 466, 467, 470Kirchhoﬀ, G.R. 500, 515Kirkman, T.P. 240, 242Klarner, D.A. 132, 151Klein, F. 285, 499Kleitman, D.J. 59, 60, 547Knuth, D. 87, 163, 167, 181Ko, Chao 51, 331, 418, 430Koch, J. 466, 470, 471K¨ onig, D. 51, 52K¨ orner, J. 258Koornwinder, T.H. 280, 282Kramer, E.S. 557Krause, M. 172, 181
---PAGE BREAK---
Name Index 587
Kreher, D.L. 224, 242
Krein, M.G. 267, 279, 280Kronecker, L. 201, 268Kruyswijk, D. 55, 59Kuratowski, K. 462, 470
Lagrange, J.L. 145, 151, 230,
240, 582
Lam, C.W.H. 242
Lander, E.S. 394, 398, 404La Poutr´ e, J.A. 86, 88Laurent, P.M.H. 579Leavitt, D.W. 224, 242Leeb, K. 332Lenz, H. 301Leonardo of Pisa 150Lesniak, L. 462, 491, 505Lewin, M. 35, 36Lint, J.H. van 51, 52, 60, 86, 88,
108, 109, 110, 118, 166, 167,259, 260, 279, 280, 281, 282,431, 543, 546, 551, 552, 558
Lloyd, E.K. 466, 471Lloyd, S.P. 425, 427, 431Locke, S.C. 553London, D. 114, 118Lorentz, H.A. 118Lov´ asz, L. 41, 42, 436, 437, 438,
450, 546
Lubell, D. 54, 60Lucas, F.E.A. 95, 97, 150
MacLane, S. 480, 490
MacMahon, P.A. 166, 167MacNeish, H.F. 288, 290, 300,
302
MacWilliams, F.J. 248, 258, 259,
260
Magliveras, S.S. 224, 242Maldeghem, H. Van 280, 282Mann, H.B. 298, 302, 394, 395Mantel, W. 37, 42Marcus, M. 112, 114, 118
Mathieu, ´E. 260
Mathon, R. 280
Mattson, H.F. 249, 259, 260McFarland, R.L. 381, 382McKay, B.D. 176, 181, 277, 281Medema, P. 520, 521Mendelsohn, E. 537, 541Mendelsohn, N.S. 295, 302Menger, K. 454, 455, 458Merkx, F. 241Mesner, D.M. 264, 279, 280, 409Mills, W.H. 223, 242, 381, 382Minc, H. 101, 108, 109, 118Mirsky, L. 54, 60M¨ obius, A.F. 97, 333, 362Moivre, A. de 108Montmort, P.R. de 97Moon, J.W. 108, 109Moore, E.H. 300, 302Morgan, A. de 465Muir, T. 108Muller, D.E. 199ﬀ, 213, 214, 261Muzychuk, M. 448
Narasima Sasbry, N.S. 571
Neˇsetˇril, J. 521
Neumaier, A. 270, 272, 282, 407,
431
Neumann, P.M. 97Newman, M. 112, 114, 118Nichols, W. 553Niderhausen, H. 553Nienhuys, J.W. 582Niven, I. 150, 151Nordstrom, A.W. 419
Ohm, G.S. 515
Ostrand, P. 51, 52
---PAGE BREAK---
588 Name Index
Paige, L.J. 298, 302
Paley, R.E.A.C. 203, 213, 214,
262, 375
Paola, J. di 368Pappus of Alexandria 318, 323Parker, E.T. 284, 288, 301Pasch, M. 314, 323Payne, S.E. 280, 282Pedoe, D. 319, 324Peltesohn, R. 537, 541Perron, O. 442Petersen, J.P.C. 261, 433, 462,
465,477, 483, 491ﬀ, 508, 542
Petrenjuk, A.Ya. 222, 242Pierce, J.R. 88Piper, F.C. 321, 324Pless, V. 252, 260, 404Plotkin, M. 212Pl¨ ucker, J. 239Pollak, H.O. 78, 88, 432P´ olya, G. 522, 535Posner, E.C. 213, 214, 557Pr¨ ufer, H. 13, 23Pulver, E.D. 535Pythagoras 166
Rademacher, H. 166, 167
Rado, R. 51, 331, 418, 430Radziszowski, S.P. 35, 36, 224,
242
Ramanujan, S. 166, 167Ramsey, F.P. 28, 35, 36Raney, G.N. 151Ray-Chaudhuri, D.K. 222, 242,
367, 368, 425, 431
Reed, I.S. 213, 214, 361Rees, G.M.J., van 294, 302Remmel, J.B. 16, 23Riemann, G.F.B. 97Ringel, G. 493, 494, 502, 506Roberts, S.M. 35Robertson, N. 463
Robinson, J.P. 419Rogers, D.G.E.D. 181Rosa, A. 537, 541Rota, G.-C. 151, 324, 349, 350,
378, 490, 564
Rothschild, B.L. 32, 33, 35, 332Ryser, H.J. Preface, 99, 108,
109, 181, 187, 197, 213, 229,230, 241, 292, 383, 394, 395,398
Sachs, H. 450Schellenberg, P.J. 294, 302Schl¨ aﬂi, L. 275Sch¨ onheim, J. 59, 60Schrijver, A. 65, 101, 107, 108,
109, 280, 282, 355, 368, 537,541
Schur, I. 22, 34, 544Schutzenberger, M.P. 240, 242Schwenk, A.J. 450Scott, L.L. 279Seberry, J. 213Segner, J.A. von 136Seidel, J.J. 266, 279, 280, 281,
282, 558
Seymour, P. 463
Shannon, C.E. 259, 260, 436Shimamoto, T. 279Shrikhande, S.S. 284, 288, 301,
561
Simonyi, G. 258Sims, C.C. 267, 279, 281Singer, J. 377, 378, 382Singleton, R.R. 41, 561Skolem, Th. 241, 242Sloane, N.J.A. 258, 259, 260, 560Smetaniuk, B. 189, 197Smith, C. A. B. 520Spencer, J.L. 33, 35, 59, 60, 332,
544
---PAGE BREAK---
Name Index 589
Sperner, E. 54, 59, 60, 326
Sprott, D.A. 376, 384Stanley, R.P. 150, 151, 349, 350,
460, 471
Stanton, R.G. 376, 384Staudt, K.G.C. von 240Steiner, J. 217, 240, 242Steinitz, E. 465, 470, 471, 486Stinson, D.R. 284, 302Stirling, J. 108, 128Strauss, E.G. 301Swiercz, S. 241Sylvester, J.J. 96, 166, 432Szeg˝ o, G. 535Szekeres, G. 33, 35
Tait, P.G. 481–486, 490
Tarry, G. 284Tarsy, M. 35Teirlinck, L. 224, 242Thas, J.A. 280, 287Thiel, L. 242Thomas, S. 330, 332Thomassen, C. 469, 471Thompson, J.G. 259, 260Thompson, T.M. 258, 263Thrall, R.M. 165, 167Tits, J. 221, 242Todd, J.A. 375Tur´ an, P. 38, 41, 42Turner, J. 446, 450Tutte, W.T. 457, 458, 462, 471,
483, 489, 490, 512, 517, 520
Tverberg, H. 53, 60
Valiant, W.G. 107, 109
Vall´ ee-Poussin, C.J. De La 213Vandermonde, A.-T. 163Vanstone, S.A. 181, 227, 242,
280, 294, 302, 431
Vaughan, H.E. 51
Veblen, O. 279, 290
Vedder, K. 362Voigt, M. 470Voorhoeve, M. 105, 109
Waerden, B.L. van der 32, 36,
76, 110, 118, 197
Wald, A. 458
Wallis, J.S. 213, 214Watkins, J.J. 10, 11Watson, G.N. 151Wedderburn, J.H.M 319, 402Weisner, L. 335, 339, 350Welch, L.R. 381, 382Welsh, D.J.A. 490White, A.T. 506Whitney, H. 454, 458, 472ﬀ, 490Whittaker, E.T. 151Wilbrink, H.A. 396, 404Wilf, H. 450Williamson, J. 204, 214Wilson, R.J. 10, 11, 281, 466,
471
Wilson, R.M. 222, 242, 279, 282,
301, 302, 331, 334, 341, 350,412, 430
Winkler, P. 80, 88Witt, E. 223, 242, 397Woolhouse, W.S.B. 240, 243Wright, E.M. 160, 166, 167, 168
Yamamoto, K. 395
Young, A. 167, 168Young, J.W. 313, 324Youngs, J.W.T. 493, 494, 502,
506
---PAGE BREAK---
Subject Index
(0,1)-matrices 48, 100ﬀ, 169ﬀ
1-skeleton of a polytope 456
1-factor in a graph 5371-factorization of a graph 53715 schoolgirls problem 240
2-cell embedding of a graph 463,
473, 494–495
2-designs 224ﬀ, 3113-claw 570
3-connected graph 483–48436 oﬃcers problem 2845-designs 223, 242, 249, 252–253,
255, 266
6-designs 224
absolute bound for strongly
regular graphs 270, 273
acyclic edge 482
acyclic orientations of a graph
461
addressing problem 77ﬀadjacency matrix of a digraph
432
adjacency matrix of a graph
263ﬀ, 391–402, 449ﬀ
adjacency matrix of a
multigraph 507
adjacency matrix of a scheme
409adjacency matrix of a
tournament 432
adjacent vertices in a graph 4
aﬃne geometry 304aﬃne hyperplane 211aﬃne plane 227, 273, 287aﬃne subspace 304aﬃne translation plane 320algebraic methods 264, 267,
432ﬀ
alphabet of a code 244ancestor 20Andr´ e’s reﬂection principle 118antichain 53ﬀ, 327
arborescence 15, 145
arc 351–353, 367arithmetic progression 32Assmus–Mattson theorem 249associates in a scheme 406ﬀassociation matrices of a scheme
409ﬀ
association scheme 279, 405ﬀassociative block design 83ﬀatomic lattice 305augmenting path; see also special
path63, 69
automorphism of a code 260automorphism of a graph 3, 422,
542, 569
---PAGE BREAK---
Subject Index 591
automorphism of a map 499, 575
automorphism of a symmetric
design 316, 329ﬀ, 379, 566
automorphism of a tree 13axis of perspectivity 317
Baer subplane 255, 355, 394
balanced incomplete block
design (BIBD) 217ﬀ
balanced orientation of a graph
68
ballot problem 150Baranyai’s theorem 536ﬀbase blocks 236, 241base of a Ferrers diagram 158bases in a combinatorial
geometry 310ﬀ
Bell numbers 125, 149binary code 244binary Golay code 243, 252–255,
259, 417, 560
binary relation on a set 406binary tree 139bipartite graph 24, 43, 55, 69,
196, 324
biplane 267Birkhoﬀ’s theorem 48, 65, 111block design 217ﬀblock graph of a design 266Block’s Lemma 371block of cheese 41blocking set in a projective plane
355
blocks of an incidence structure
215
block-size of a t-design 216
bond-graph 451, 473bond of a graph 475ﬀBoolean algebra 303Bose–Mesner algebra of a
scheme 409ﬀ, 419, 430Bose–Mesner algebra of a
strongly regular graph 264ﬀ
breadth-ﬁrst search 19, 81bridge 20, 482bridges of K¨ onigsberg 6, 7, 10,
59
Brooks’ theorem 24, 34Bruck–Ryser–Chowla theorem
230, 241, 383, 398
De Bruijn graphs 71ﬀDe Bruijn sequences 71ﬀ, 513De Bruijn–Erd˝ os theorem 216,
433
Burnside’s lemma 94, 97, 370,
524
capacity of a cut 62ﬀcapacity of an edge 62ﬀCatalan numbers 136–141, 150,
16
Cauchy–Binet theorem 508, 510Cauchy inequality 115Cayley graph 446, 504–505Cayley’s theorem 12ﬀ, 145, 508cell 162central collineation 367chain 53ﬀ, 305, 348Chang graphs 271, 280character 202, 248, 394cheapest spanning tree 18, 543Chinese Remainder Theorem
293
chromatic number 24, 327, 398,
466, 571
chromatic polynomial 341, 349,
459
circle geometries 365circuits of a graph 475ﬀcirculant graph 446, 448circular sequences 94–95, 120circulation on a digraph 66ﬀ
---PAGE BREAK---
592 Subject Index
claw 218, 500
claw bound 272–273Clebsch graph 263, 276, 279,
440, 447, 498, 505, 575
clique in a graph 271, 435clique in a scheme 421closed path 5closed walk 5, 515closure in a combinatorial
geometry 308ﬀ
coboundary space of a digraph
514
coclique in a graph 434–435, 440coclique in a scheme 421code 244ﬀ, 396ﬀcode in a scheme 422code of a design 256–258, 396ﬀcode of a graph 475ﬀcodewords 244coding theory 244ﬀcoline 309collinear 272collineation of a projective plane
353, 366
colorings of graphs 24, 306, 459ﬀcolumn-complete 196column of a Latin square 182combinatorial design 351combinatorial geometry 306ﬀcombinatorial proofs of identities
121–122, 125, 138, 147, 552
cometric scheme 422complement of a design 220,
251, 569
complement of a diﬀerence set
391
complement of a graph 393, 563,
570
complement of a symmetric
design 401
complement of an incidence
structure 215complementing permutation 342
complete bipartite graph 6, 39,
432
complete cycle 72–75complete graph 3, 12, 24, 27–28,
30, 33, 37ﬀ, 78, 217, 261, 432,491, 492, 494, 500, 502, 508,540
complete mapping of a group
298
complete matching in a bipartite
graph 43ﬀ, 56
complete multipartite graph 38complete uniform hypergraph
540
complexity of a graph 460, 519component 5composition methods 288composition of a number 154,
553
conference matrix 200ﬀ, 233,
265, 402
conﬁguration counting series 528confoundable words 436conjugate of a partition 156, 169conjugates of a Latin square 183connected combinatorial
geometry 313, 564
connected graph 5–6, 347, 451connected strongly regular graph
261
connectivity of a graph 451ﬀconservation of ﬂow 62contraction of edges 462ﬀconvexn-gon 33, 139, 146
convex combination of
permutation matrices 49, 111
convex polytope 336, 349, 456,
465, 486
cost of an edge 17cotree 462, 473
---PAGE BREAK---
Subject Index 593
counting in two ways 4, 207,
212, 219, 262
covering radius 245, 247
covering in a poset 303, 305, 335cut in a transportation network
62
cutset space of a graph 476ﬀcutsets of a graph 475ﬀcycle index 524cycle space of a digraph 514cycle space of a graph 453cycles of a graph 475ﬀcycles of a permutation 123, 127,
524ﬀ
cyclic diﬀerence set 373ﬀ, 386,
567
cyclotomic scheme 408
d-code in a metric scheme 422
De Bruijn graphs 71ﬀDe Bruijn sequences 71ﬀDe Bruijn–Erd˝ os theorem 216,
433
decode 209, 212Dedekind η-function 167
degree of a face 465degree of a vertex 4degrees of a scheme 406deletion of edges 459Delsarte’s inequalities 405, 416,
418
dependency graph 31depth-ﬁrst search 19, 81depth of an orthogonal array 183derangements 90, 97, 129, 142,
149
derivation 146derived design 228Desargues conﬁguration 317Desargues’ theorem 318, 321,
322Desarguesian planes 319, 352descendant 20design of experiments 240design theory 215designs in a scheme 422determinant of the distance
matrix 80
diﬀerence methods 234, 240,
288, 294ﬀ, 498
diﬀerence set 369ﬀ, 389ﬀdigraph 2, 194, 454Dilworth’s theorem 53, 55dimension of a combinatorial
geometry 304
Dinitz conjecture 194, 469directed Eulerian circuit 16, 71,
75
directed graph 2directed path 16discrepancy function 82distance in a code 244distance between vertices 5distance matrix of a graph 79–80distance regular graph 407distribution vector in a scheme
406, 416–417
dodecahedron 8, 492dominant eigenvalue 444doubly stochastic matrix 49,
104, 108, 110ﬀ
drawing of a graph 1, 461dual arc in projective planes
352–353
dual code 246dual graph 466ﬀ, 472ﬀdual of a symmetric design 228dual partial geometry 272dual poset 307
echelon form 246, 327–328
edge colorings 27
---PAGE BREAK---
594 Subject Index
edges of a graph 1
eigenmatrices of a scheme 413,
415
eigenspaces 264, 410eigenvalues of a graph 264, 433ﬀelectrical network 507, 514, 515elementary cycle 514elementary ﬂow 64elliptic quadratic form 359ﬀelliptic quadric 359ﬀembedding of a graph 461ﬀendpoints of an edge 1ends of an edge 1equivalent codes 246equivalent designs 221equivalent diﬀerence sets 374equivalent Latin squares 183Erd˝ os–Ko-Rado theorem 56, 59,
331, 418, 430
Erd˝ os–number 5, 10error-correcting code 208,
244–246, 258-259
Euler characteristic 497Euler function 92Euler’s conjecture 281ﬀ, 288, 300Euler’s formula 349, 464, 465,
466, 480, 491, 542, 573
Euler’s identity 157Eulerian circuit 6–9, 71, 513Eulerian graph 6Eulerian poset 350Evans conjecture 189–193excess of a Hadamard matrix
207
exchange axiom 309exponential generating function
129ﬀ
extended code 246extended design 239extremal graphs 38–40extremal set theory 56, 59face of a convex polytope 456face of a graph or an embedding
463
falling factorial 119Fano conﬁguration or plane 225,
237, 255, 258, 354, 394, 430,434, 492
fast Fourier transform 212feasible ﬂow 61ﬀfeasible parameters for strongly
regular graphs 265
Fekete’s lemma 103, 106, 108,
130, 150, 436
Ferrers diagram 156ﬀ, 170–171,
327–328
Fibonacci numbers or sequence
97, 149, 150, 550
Fibonacci recursion 150, 159,
551
ﬁnite diﬀerences, calculus of 97ﬁnite graph 4ﬁrst order Reed–Muller code
210–212, 361
Fisher’s inequality 222, 226, 353,
364, 405, 430
Five Color Theorem 34, 466, 469ﬁxed points of an automorphism
353, 369
ﬂags of an incidence structure
215
ﬂats 303, 309, 315ﬂow 61Ford sequence 75forest 17formal derivative 145, 581formal power series 130–151,
578ﬀ
formally dual schemes 420formally dual theorems 424four color problem 459ﬀ
---PAGE BREAK---
Subject Index 595
Four Color Theorem 24, 34, 427,
466, 482
Friendship Theorem 279
Frobenius automorphism 568fully indecomposable matrix 111
g-torus 491
Gaussian coeﬃcients 325
Gaussian numbers 312, 325ﬀGaussian polynomials 326generalized quadrangle 273–274,
280, 363, 367
generating function 126, 129ﬀgenerator matrix of a code 246,
570
Generalized Steiner System
238–239, 304
genus of a surface 491geometric graph 272geometric lattice 305ﬀ, 340, 342,
490, 564
Gewirtz graph 267girth of a graph 9, 39–40Golay codes 241–244, 252–255,
259, 279, 417, 429, 560
graceful labeling 22Graeco-Latin square 284grand clique in a strongly
regular graph 271, 280, 561
graph of a polytope 456graph 1greedy algorithm 18group ring 383ﬀ
Hadamard 2-design 218
Hadamard 3-design 218, 220,
252
Hadamard diﬀerence set
375–377, 380, 569
Hadamard matrix 199ﬀ, 218,
279, 411–412, 424Hadamard product of matrices
268–269, 409, 415, 419
half-case of strongly regular
graphs 265, 277
Hall multiplier 386Hall’s theorem 43–47, 65Hamiltonian circuit 8, 40–41,
449, 483, 545
Hamming bound 245Hamming code 246–247, 376,
560
Hamming distance 77, 244Hamming scheme 406, 411ﬀhandle of a representation 437hash-coding 84hash functon 84head of a directed edge 2, 460Heawood conjecture 493, 498Heawood graph 433, 434, 492hermitian form 364ﬀhermitian variety 364ﬀhigher incidence matrices of a
t-design 222
Higman–Sims graph 267, 279Hoﬀman–Singleton graph 41homeomorphic graphs 453homogeneous coordinates 317homomorphisms of the group
ring 385ﬀ
hooks in Young tableaux 165hooklengths 165–166horizontally convex polyomino
132
hyperbolic quadratic form 359ﬀhyperbolic quadric 359ﬀhypercube 77hyperoval 227, 248, 255, 258,
266–267, 274
hyperplanes in combinatorial
geometries 309ﬀ
---PAGE BREAK---
596 Subject Index
idempotent quasigroup 28ﬀ
idempotents in the Bose–Mesner
algebra 236, 410
idempotents in the group ring
402
incidence algebra of a poset 333ﬀincidence in a graph 1incidence matrix 221incidence matrix of a design
221ﬀ, 225
incidence matrix of a directed
graph 62, 509
incidence matrix of a graph 475incidence matrix of a symmetric
design 228ﬀ
incidence structure 215inclusion–exclusion 89–97, 98,
122, 177, 337, 535, 549, 556
independence number of a graph
436
independent edges in a graph 18independent set 37independent subset of a
combinatorial geometry 309ﬀ
independent vertices in a graph
37, 434–435
index of a design 216index of an orthogonal array
216, 423
induced drawing 463induced subgraph 4, 77information rate 209inner (or dot or scalar) product
115–116, 396ﬀ, 415
Instant Insanity 7integral ﬂow 64–66, 171, 540integrality condition for strongly
regular graphs 265, 561
interlacing of eigenvalues
439–440, 561, 571
interval of a poset 307invariant factors 399inversive plane 362involution 323irreducible matrix 442isolated vertex 1isomorphic designs 221isomorphic diﬀerence sets 380isomorphic graphs 2, 411, 466isomorphic Latin squares 183isomorphic orthogonal arrays
183
isotropic vector 115isthmus of a graph 20, 482
Jacobi triple product identity
160
Johnson scheme 406, 413ﬀ
join (least upper bound) 305ﬀjoins (in a graph) 1Jordan arcs 472ﬀJordan curve theorem 464Joyal theory 141ﬀ
k-class association scheme 406
k-connected graph 451
k-subspace 325
k-Tutte connected 457, 489
k-vertex connected 451, 454
Kempe chain 467
Kirchhoﬀ’s laws 500, 515Kirkman schoolgirl problem 240Klein bottle 499K¨ onig’s theorem 48, 51Krein condition 267, 269, 273,
279, 280
Krein parameters of a scheme
420
Kronecker product 201, 208,
213, 268, 287, 309, 437
Kuratowski’s theorem 462
---PAGE BREAK---
Subject Index 597
labeled graph 12, 149
labeled tree or forest 12ﬀ, 141,
145
Lagrange inversion formula 145,
151, 582
Latin rectangle 186Latin square 182ﬀ, 226, 273, 358Latin square graph 274, 276, 414Latin squares, number of
186–187, 192
lattice (poset) 305ﬀ, 333ﬀlattice graph 262lattice of contractions 308, 340Laurent series 579, 581length of a walk 5length of an edge 17line graph 194, 435–436, 570line of a block design 323line of a linear space 215line of a matrix 48line of a projective plane 225line of perspectivity 317linear code 244ﬀ, 398linear order 53linear programming 69, 457linear programming bound 406,
418, 419
linear recursion 130–134linear space 215, 289ﬀ, 303, 313line-sums of (0, 1)-matrices
100-101, 173–181
link-graph 451, 471, 453list assignment 194list-colored graph 194Lloyd’s theorem 405, 427loop of a graph 1loop switching problem 88Lorentz space 115–118Lov´ asz Sieve 31
MacNeish’s theorem and
conjecture 288, 290MacWilliams’ theorem 248, 418
MacWilliams relations 249magic square 300majorize 169–170Mantel’s theorem 37map on a surface 491marriage theorem 43, 65matching in a graph 43Mathieu groups 259, 560matrix-tree theorem 507matroid 324, 489, 490maxﬂow–mincut theorem 64,
171, 540
maximal arc in a projective
plane 367
maximal chain in a poset 53–54,
306, 325
maximum distance separable
code 248, 259, 347–348
maximum ﬂow 62maximum matching 69meet (greatest lower bound) 305Menger’s theorem 454, 455mesh in a graph 494method of diﬀerences; see
diﬀerence methods
metric scheme 407, 422Minc’s conjecture 101–103, 108minimal counterexample 24–26minimizing matrix 110ﬀminimum cut 64ﬀminimum distance of a code 211,
244
minimum weight 245minor of a graph 462M¨ obius function of a poset 333ﬀ,
344
M¨ obius function, number
theoretic 92–94, 333
M¨ obius inversion 93, 136, 298,
333, 336, 337, 339, 346, 347,370
---PAGE BREAK---
598 Subject Index
M¨ obius plane 362
modular combinatorial geometry
313ﬀ
modular law 313modular complement 314monochromatic triangles 27–28monotone subsequence 55monovalent vertex 13multigraph 2multinomial coeﬃcients 16, 120multiple edges 2multiplicities of a scheme 411multiplier of a diﬀerence set
386ﬀ
Multiplier Theorem 386ﬀ, 390ﬀmutually orthogonal Latin
squares 300
n-gon 6, 153, 460near pencil 216, 313, 354necklaces 94–95, 522, 525–530,
533
negative Latin square graphs 414neighborhood regular graph 277neighbors of a vertex 4net (partial geometry) 273, 280,
286, 287, 563
nonassociative product operation
136
nondegenerate quadratic form
356
nonembeddable design 228–229,
240
nonnegative matrices 111ﬀ, 442ﬀnonseparable graph 451ﬀ, 483ﬀ,
499
nontrivial diﬀerence set 372Nordstrom–Robinson code 419normalized diﬀerence set 374,
388
normalized Hadamard matrix
199NP-complete 9
numerical multiplier of a
diﬀerence set 386
odd graph 430Ohm’s law 515optimal representation of a
graph 437
orbits of a group 95, 370, 407,
523, 528, 530, 532
order of a Hadamard matrix 199order of an orthogonal array 183order of a projective plane 225ordinary generating function 129orientable mesh 497orientation of a graph 21, 460orthogonal array 182, 294, 423orthogonal idempotents of a
scheme 410
orthogonal Latin squares 283ﬀ,
563
orthogonality relations 415orthomorphism of an abelian
group 297–298, 339
orthonormal representation of a
graph 437
oval in a projective plane 227,
381
oval in a symmetric design 367ovoid in projective 3-space 362,
394
P-polynomial 422
pairwise orthogonal Latin
squares 285, 300
Paley graph 262, 265Paley matrix 203, 252–253, 256,
374
Paley–Todd diﬀerence sets
375–377
Pappian planes 319
---PAGE BREAK---
Subject Index 599
Pappus’ theorem 318
parabolic quadratic form 359ﬀparabolic quadric 359ﬀparallel class in a Steiner system
353
parallel class in an aﬃne plane
227, 273
parallel class of sets 537parallel edges 2parameters of a scheme 406parent 20parity check matrix of a code
246
parity check symbol 246partial fractions 153, 553partial geometry 271ﬀ, 363partial Latin square 185partial match query 84partially balanced design 430partially ordered set (poset) 53,
333ﬀ
partition function 155ﬀ, 166partition lattice 307–308, 336,
344–346
partitions of a number 152ﬀ,
169, 327–329
partitions of a set 49, 106–107,
126, 537ﬀ
partly decomposable matrix 111Pasch axiom 314ﬀpath in a graph 5paths in the X,Y plane 122,
130, 138, 149, 552
pentagonal numbers 157perfect arc 351–353, 367perfect code 245, 248, 250, 254,
259, 405, 425, 427, 430
perfect matching 44, 546permanent of a matrix 98ﬀ, 549permanents of (0,1)-matrices
100–104permanents of nonnegative
integral matrices 105ﬀ
permutation matrices 48, 83,
114, 148, 205, 221, 193, 329
Perron–Frobenius theorem
442–443
perspective from a line 317perspective from a point 317Petersen graph 9, 40, 261, 263,
276, 430, 433–434, 436, 449,462, 465, 477, 483, 485, 486,491, 492,508, 542, 570, 572
pigeonhole principle 55, 559planar diﬀerence set 372,
388–389, 396, 403
planar graph 1, 461ﬀ, 479, 480plane at inﬁnity 367plane tree 139planted plane trees 139Platonic solids 465, 499, 573Plotkin’s bound 212point graph of a partial
geometry 272
point of a combinatorial
geometry 303, 309
point of an incidence structure
215
point of a lattice 305point of perspectivity 317P´ olya theory 522ﬀpolygon 5, 83, 475polynomial scheme 422polyomino 132, 150poset (partially ordered set) 53,
333ﬀ
positive and negative vectors 115positive semideﬁnite or deﬁnite
223, 435, 439
probabilistic method 30–32, 35,
544
probl` eme des m´ enages 95, 549
---PAGE BREAK---
600 Subject Index
probl` eme des rencontres 97
projective design 224projective geometry 225, 303,
304, 313, 351
projective plane 225, 232, 256,
280, 287, 290, 313, 351–355,396
projectively equivalent hermitian
forms 364
projectively equivalent quadratic
forms 356ﬀ
proper coloring of a graph 24,
341, 459
proper drawing of a graph 461ﬀproper partial geometry 273, 280Pr¨ ufer code 13pseudo-geometric graph 272, 280
q-analogues 326, 337, 408
q-ary code 244
Q-polynomial 422
quadratic form 78–80, 231, 355,
558, 559, 566
quadric in projective space 356ﬀ,
566
quasigroup 182, 288ﬀquasiresidual design 228, 275quasisymmetric design 266, 275quotient set 372–373
rain in Holland 97
Raleigh quotient 434Ramsey’s theorem 27ﬀ, 37, 332rank in a combinatorial
geometry 309ﬀ
rank of a connected graph 453rank of a ﬂat 309rank of a hermitian form 364rank of a quadratic form 356rational function 132real projective plane 226, 492,
496recoloring 24, 467
recurrence relation 124, 134ﬀ,
159, 329
recursive method 201, 233Reed–Muller codes 210–213,
361, 560
reﬁnement order on partitions
307
regions of an embedding 463,
472
regular bipartite graph 44regular graph 4, 40, 149, 422,
445
regular Hadamard matrix 208,
218, 226, 375
repeated blocks 215, 223repetition 177repetition code 209, 245replication number 219, 240, 430residual design 228, 275resolvable Steiner system 353resolvable transversal designs
291
Riemann zeta function 93Ringel–Youngs theorem 494rooted trees and forests 15, 19,
145–146
rotating drum problem 71rotations of the cube 526, 577row 182row-complete 196row-sum 169
saturated edge 63ﬀ
scheme 405fSchlaeﬂi graph 275Schr¨ oder–Bernstein Theorem 51SDR theorem; see Hall’s
theorem
SDR’s and permanents 100self-conjugate partitions 162
---PAGE BREAK---
Subject Index 601
self-dual code 246, 396ﬀ
self-orthogonal codes 246, 396ﬀsemi-simple algebra 402semimodular lattice 306ﬀ, 342semimodular law 311semiregularity 44Shannon capacity of a graph
436–437
sieve methods 96signless Stirling numbers 123,
534
simple answers 288simple closed path 5simple design 215ﬀ, 223simple diﬀerence set 372simple digraph 2simple graph 2simple path 5, 25simplex code 247Singer diﬀerence sets 378–380Singer’s theorem 377, 381Singleton bound 247sink in a transportation network
61
Six Color Theorem 467Skolem sequences 241slope of a Ferrers diagram 158Smith normal form 399source in a transportation
network 61
spanning arborescence 16ﬀ, 512,
543
spanning subgraph 4spanning subset in combinatorial
geometries 310
spanning tree 12ﬀ, 81, 479,
507ﬀ, 519, 543, 548, 572, 574
special network 517special path 63ﬀSperner’s theorem 54, 56, 59,
326, 484sphere packing bound 245, 419,
425
spherical 2-distance set 269spread 320, 330square design 224squared rectangle 516ﬀsquared square 507standard tableaux 162Stanton–Sprott diﬀerence sets
376
Steiner system 216ﬀ, 221, 223,
303, 351ﬀ, 362, 364–365
Steiner triple system 233–241,
276, 278
Stirling numbers 123–127, 534Stirling’s formula 32, 107, 108,
187, 208
strength of a ﬂow 62strength of an orthogonal array
423
strong product of graphs 436strongly connected digraph 442strongly regular graph 261ﬀ,
405, 407, 449
sub-Latin square 185subdivision of a graph 452ﬀsubgeometry 304subgraph 4subplane of a projective plane
353ﬀ
subsquare of a Latin square 185subsquares of orthogonal Latin
squares 298
substitution of power series 579substitution principle 114, 117substructure of an incidence
structure 353
support of a codeword 249, 475supporting hyperplane 446surjections, number of 90, 125,
337
---PAGE BREAK---
602 Subject Index
Sylvester’s law 96, 432
symbol 182symmetric chain 55, 57, 58symmetric designs 224, 299, 367,
369, 396ﬀ, 568
symmetric functions 535symmetry code 252system of distinct representatives
(SDR) 43ﬀ, 100, 106–108, 186
system of walks in a graph 487ﬀ
t-designs 216ﬀ, 223, 249–253,
255, 266, 330, 405, 423
tail of a directed edge 2, 460
Tait coloring of a graph 481–483tangent 367tennis matches 563ternary code 244ternary Golay code 256, 417tight design 223, 425, 428torus 492total order 53totally isotropic 397totally unimodular matrices 510tournament 33, 432transitive tournament 33translation plane 320, 331transportation network 61ﬀ,
170, 538
transversal design 273, 290, 563tree 6, 12–22, 77–80, 459triangles in a graph 27, 37–39,
543, 544
triangular embedding of a graph
500, 505
triangular graph 262, 270, 275triangular mesh 494triﬀerent code 258trivalent graph 481–482, 546,
551, 574
trivalent tree 139Tur´ an’s theorem 37ﬀTutte connectivity 451, 457, 458type of a partition of a set 346,
526
type of a permutation 370,
525–528
unipotent Latin square 288unital 365unordered partition 152
valency or valence of a vertex 4
Van der Waerden conjecture
104, 108, 186, 197
Vandermonde determinant 163Vandermonde matrix 251varieties 240vertex condition 497vertex connectivity 451vertices of a graph 1
van der Waerden conjecture 104,
110–118, 186, 197
walk in a graph 5
walks in the X,Y plane 122,
130, 138, 149, 552
weight of a codeword 244weight enumerator of a code 248weighted graph 17, 434Weisner’s theorem 335, 339, 344Whitney dual of a graph 472ﬀWhitney’s theorem 479, 480Williamson’s method 204, 206Wilson–Petrenjuk inequality 222Witt design 223, 255, 256, 266write-once memory 237
Young diagram 156
Young tableau 162–167
zeta function of a poset 333
zeta function, Riemann 93, 97